!function(D,v,t){"use strict";var d="ht";if(!D[d]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),D.performance&&D.performance.now||function(){var s=Date.now();D.performance||(D.performance={}),D.performance.now=function(){return Date.now()-s}}();for(var r=Date.now(),q=16,S=["ms","moz","webkit","o"],W=0;W<S.length&&!D.requestAnimationFrame;++W)D.requestAnimationFrame=D[S[W]+"RequestAnimationFrame"],D.cancelAnimationFrame=D[S[W]+"CancelAnimationFrame"]||D[S[W]+"CancelRequestAnimationFrame"];D.requestAnimationFrame||(D.requestAnimationFrame=function(M){var T=Date.now(),Y=q+r-T;return 0>Y&&(Y=0),r=T,D.setTimeout(function(){r=Date.now(),M(performance.now())},Y)}),D.cancelAnimationFrame||(D.cancelAnimationFrame=function(l){return D.clearTimeout(l)})}();var L,s,c,r,X=D.document,R=null,K=D[d]={},q=D[d+"config"],M=K.Default=q&&q.Default||{},w=K.Style=q&&q.Style||{},z=K.Color=q&&q.Color||{},T=K.IsGetter=q&&q.IsGetter||{},N=Math,l=N.round,Y=N.floor,y=N.ceil,Z=N.sqrt,I=N.max,j=N.min,Q=N.abs,_=N.cos,U=N.acos,P=N.sin,n=N.pow,F=N.asin,u=N.PI,B=2*u,G=u/2,E=N.tan,f=N.atan2,W=N.random,x=!1,O=!1,h=D.parseInt||global.parseInt,p="2017-09-01",o=function(){try{return D.navigator.platform.indexOf("Win")>-1}catch(V){}}(),m=function(O){return O*O},e=D.setTimeout,A=D.clearTimeout,J=D.location,g=D.navigator?D.navigator.userAgent.toLowerCase():"",i=function(V){return V.test(g)},C=i(/msie/)||i(/trident/),H=i(/msie 10/),S=i(/edge/),a=i(/firefox/),V=i(/mac/),b=M.isTouchable===t?o?!1:X?"ontouchend"in X:!1:M.isTouchable,$="default",hf="single",Wk="multiple",rh="front",vr="back",Ai="left",Br="right",Id="top",Zf="bottom",vo="center",ik="eye",Kf="middle",yd="east",tf="west",bd="north",_i="none",Yo="px",qk="absolute",bi="border",_g="triangle",ch="rect",Ll="circle",ls="cylinder",kr="shape",Sh="items",Ui="normal",to="remove",cj="clear",ld="width",vd="height",In="ingroup",qc="check",yi="uncheck",zs="radio",Xj="radioOn",nc="radioOff",tg="points",Ir="values",Mk="series",Xo="body",zj="label",qo="label2",Qf="note",Lg="note2",cn="icons",Qq="labelFont",ub="labelColor",Bq="labelSelectColor",Fd="note.expanded",pe="note2.expanded",qj="edge.expanded",kn="edge.points",oh="edge.type",Um="rotation",Pq="getRotation",ti="setRotation",nm="hidden",Cn="visible",$n="tuv",xm="no",xj="select",oi="currentSubGraph",im="selectBackground",Lr="autoMakeVisible",jc="autoHideScrollBar",ak="scrollBarColor",gk="scrollBarSize",Vd="indent",Bl="rowHeight",Ep="columnLineColor",$d="rowLineColor",uq="columnLineVisible",_l="rowLineVisible",Vi="visibleFunc",xq="expandIcon",Si="collapseIcon",vm="checkMode",nd="sortFunc",ii="editable",Lj="batchEditable",On="tristate",hq="asc",ck="desc",Zo="position",lb="elevation",Tb="children",Jq="translateX",_f="translateY",Kg="dataModel",Ej="maxSize",hn="shape3d",Bs="shape3d.resolution",Mg="shape3d.visible",cl="shape3d.from.visible",Yk="shape3d.to.visible",Yq="shape3d.top.visible",Wl="shape3d.bottom.visible",fp="repeat.uv.length",Ap="serializeValue",$l="deserializeValue",ff="centerUniform",Ge="rgba(255,255,255,0)",Nj="style",yj="attr",Xk="field",Yc="string",zn="boolean",ho="color",Eg="int",ib="number",Ld="ew-resize",Uq="ns-resize",$j="pointer",Nn="auto",pm="mousedown",sh="mousemove",Wi="mouseup",Sr="mouseout",Af="touchstart",rf="touchmove",Qp="touchend",cf="keydown",Bf="keyup",nl=a?"DOMMouseScroll":"mousewheel",lk=b?[Af,rf,Qp,cf,Bf,"keypress","input","contextmenu"]:[cf,Bf,"keypress","input",pm,sh,Wi,Sr,nl,"contextmenu","mouseenter","mouseleave","mouseover"],xr=R,jq=R,Ln=R,wb=Wi.length,dk=function(){Ln&&(A(Ln.timeout),Ln=R)},Jd=function(){Ln&&dd(Ln.e,Ln.info)};D.addEventListener&&(b||(D.addEventListener(Sr,function(){dk()},!1),D.addEventListener(nl,function(){Bh()},!1)),D.addEventListener(Bf,function(S){91===S.keyCode?Tf={}:delete Tf[S.keyCode]},!0),D.addEventListener(cf,function(s){Tf[s.keyCode]=!0},!0));var Fi,el,ap,lo=!1,Rl=R,tc=function(n,_){var Q=e(function(){n(),delete Rl[Q],Pi(Rl)&&(Rl=R)},_);return Q},Cd=R,rg=R,Uj={},Hr={},qn={},vq={},Zg={},Tf={},Hq={},Bg={},Em={},bh=/.json$/,Ke=/^data:image\/svg\+xml/,Sg={},Vq=[],Rm={},jo=R,Dq=R,Qj=function(){},li=function(){throw"Oops!"},Vc=[0,0,0],ko=[0,0,0,0],fc={x:0,y:0,width:0,height:0},_d=R,vb=R,Hk=R,Xh=function(Q){vb&&!Q._72O&&(Hk||(Hk={}),Hk[Q._72O=zf()]=Q),Fi!=R?xe()<.05&&r&&!el&&(vg=dk):vg=nj},Yd=function(j,U,$,g){vb||(vb={});var u=vb[j];if(u){if(u.url===U)return;u.image?(u.image.onload=Qj,u.image.onerror=Qj):u.request&&(u.request.onload=Qj,u.request.onerror=Qj)}if(bh.test(U)){var Z=new XMLHttpRequest;if(vb[j]={request:Z,url:U},Z.overrideMimeType("text/plain"),U=M.beforeLoadURL(U),U.data){var m=M.parse(U.data);_o(j,m),M.handleImageLoaded(j,m)}else Z.open("GET",encodeURI(U),!0),Z.onload=function(X){if(200===this.status||0===this.status){var e=M.parse(X.target.response);_o(j,e),M.handleImageLoaded(j,e)}else _o(j,M.handleUnfoundImage(j,U)||R)},Z.onerror=function(){_o(j,M.handleUnfoundImage(j,U)||R)},Z.send(null)}else{var m=new Image;vb[j]={image:m,url:U},C&&(U.toLowerCase().indexOf(".svg")>0||Ke.test(U))?(X.body.appendChild(m),m.style.visibility="hidden",m.onload=function(){e(function(){if($&&(m.width=$),g&&(m.height=g),!m.width||!m.height){var A=m.width||m.clientWidth,O=m.height||m.clientHeight;m.width=A,m.height=O}M.handleImageLoaded(j,m),_o(j,m),X.body.removeChild(m),m.style.visibility=""},180)},m.onerror=function(){_o(j,M.handleUnfoundImage(j,U)||R),X.body.removeChild(m),m.style.visibility=""}):(m.onload=function(){$&&(m.width=$),g&&(m.height=g),M.handleImageLoaded(j,m),_o(j,m)},m.onerror=function(){_o(j,M.handleUnfoundImage(j,U)||R)}),/^data:image/.test(U)||(U=M.beforeLoadURL(U),/^data:image/.test(U)||(U=M.appendTimeStamp(U),U=encodeURI(U))),m.src=U}},_o=function(h,B){if(Hr[h]=B,delete vb[h],Pi(vb)&&(vb=R,Hk)){for(var q in Hk){var G=Hk[q];G._2O&&(G._2O={}),G.invalidateAll&&G.invalidateAll(t,"imageLoaded",h),G.redraw&&G.redraw(),G.iv(),delete G._72O}Hk=R}if(B&&Hk)for(var q in Hk){var G=Hk[q];G.invalidateAll&&G.invalidateAll(t,"imageLoading",h),G.redraw&&G.redraw(),G.iv()}},se=function(){return D.performance&&D.performance.now?D.performance.now():Date.now()},xg=function(O,b){b?A(O):D.cancelAnimationFrame(O)},Vg=function(x,D,V){return{width:x,height:D,comps:dr(V)?V:[V]}},Nm=function(z,r){return{type:Ll,rect:[z,r,1.6,1.6],borderWidth:1,borderColor:sp,gradient:Mc,gradientColor:Vl,background:sp}},wn=function(Y,x){return Vg(16,16,{type:_g,rect:[4,4,10,8],background:Y,rotation:x?1.57:3.14})},Bc=function(U,M){return Vg(16,16,{type:_g,rect:[4,4,8,7],background:U,rotation:M?3.14:0})},op=function(T){var W=T._orientation;return"horizontal"===W||"h"===W},zq=function(T){var K=R||4,O=R||1,V=R||1;0>K?K=0:K>.25&&(K=.25);var v,Q,J,L,i,a,Z,p=.5,k=[],A=[],Y=[],y=B/V,q=B/O,z=p-K;for(Q=0;O>=Q;Q++)for(L=-u+Q*q,a=_(L),i=P(L),v=0;V>=v;v++)J=v*y,Z=z+K*a,k.push(_(J)*Z,i*K,-P(J)*Z),(s=T)&&A.push(v/V,1-Q/O);for(Q=0;O>Q;Q++){var e=Q*(V+1),U=(Q+1)*(V+1);for(v=0;V>v;v++)Y.push(e+v,U+v+1,U+v,e+v,e+v+1,U+v+1),Tj.z=dn.z=T}},Yl=function(Q){var y=2,I=0;for(var O in Q)O.length===y&&h(O,32)===Np&&(jo=Dq=Q[O]),I++;return I},Tn=function(F,u,x,U){return x||(x=b?5:3,x/=U||1),{x:F-x,y:u-x,width:2*x,height:2*x}},Zk=function(l,B,r,y){var W=this;B||(B=b?5:3,r=20,y=20);var S={x:l,y:B,width:r,height:y};if(r)for(var g=0;r>g;g++)if(3===r)y=20;else for(var L=0;y>L;L++)W=D?D:r;var Q={x:u,y:2*u};if(Ul(S,Q)){var O=vd[0]+Id[0]+cj[1];tr[ik]=W[O],W[O]=vj[ik]}},Sd=function(O){return(/ble$/.test(O)||/ed$/.test(O)||T[O]?"is":"get")+O.charAt(0).toUpperCase()+O.slice(1)},vj=function(D){return"set"+D.charAt(0).toUpperCase()+D.slice(1)},Bn=function(D){return typeof D===Yc||D instanceof String},kj=function(t){return typeof t===ib},nj=function(g){return typeof g===zn},zr=function(u){return u&&"object"==typeof u},Cb=function(s){return"function"==typeof s},dr=function(U){return U instanceof Array},_p=function(N){return N instanceof fo},kb=function(D){return dr(D)?new fo(D):D},Vp=function(J){return J instanceof Dj},ql=function(f){return f instanceof nk},Lc=function(p){return p instanceof Nd},$i=function(p,D){if(!(p instanceof K.Group))return!1;if(!D)return p.isExpanded();var X=D.getDataUI(p);return X&&X._88I?!0:!1},wo=function(v){return v instanceof nq},Ue=function(d){return d&&"IFRAME"===d.tagName},Lp=function(h){return h==R||M.numberDigits==R?h:parseFloat(h.toFixed(M.numberDigits))},Vk=function(A,U,i){var J,W=U.length;if(i)for(var E=0;i>E;E++)if(3===W)A.push(U[0]),A.push(U[1]),A.push(U[2]);else for(J=0;W>J;J++)A.push(U[J]);else if(3===W)A.push(U[0]),A.push(U[1]),A.push(U[2]);else for(J=0;W>J;J++)A.push(U[J])},Gd=function(O){return O?zr(O)?O:{}:!1},Jn=function(C,s,T){var k,r=zr(C)?C:C.prototype;for(k in s)T&&r[k]!==t||(r[k]=s[k]);return C},ng=function(j){return String.fromCharCode(j)},km=function(M){for(var r,V=0,K="";V<M.length;V++)r=M[M.length-1-V],"%"===r?r="'":"a"===r?r='"':"]"===r&&(r="\\"),K+=ng(r.charCodeAt(0)-1);return K},Lk=function(U,P,V){U.superClass.constructor.apply(P,V)},Pi=function(i){for(var J in i)return!1;return!0},ao=function(C){return C?0===C.length:!0},Tm=function(R,q){return R===q?!0:R.x===q.x&&R.y===q.y&&R.width===q.width&&R.height===q.height},Ro=function(b,c,F){return c>b?c:b>F?F:b},Xl=function(L){return 0>L?-1:L>0?1:0},xe=function(){var N=1e4*P(wb++);return N-Y(N)},uc=function(L,U,n){return wp(L.x,L.y,U.x,U.y,n.x,n.y,n.x+n.width,n.y,!0)||wp(L.x,L.y,U.x,U.y,n.x+n.width,n.y,n.x+n.width,n.y+n.height,!0)||wp(L.x,L.y,U.x,U.y,n.x+n.width,n.y+n.height,n.x,n.y+n.height,!0)||wp(L.x,L.y,U.x,U.y,n.x,n.y+n.height,n.x,n.y,!0)},wp=function($,m,N,s,W,o,F,z,Z){var B=(F-W)*(m-o)-(z-o)*($-W),k=(z-o)*(N-$)-(F-W)*(s-m);if(0!==k){var H=B/k,U=$+H*(N-$),P=m+H*(s-m);return Z&&(U+Hj<j($,N)||U-Hj>I($,N)||U+Hj<j(W,F)||U-Hj>I(W,F)||P+Hj<j(m,s)||P-Hj>I(m,s)||P+Hj<j(o,z)||P-Hj>I(o,z))?R:[U,P]}return R},Vj=function(C,l,S){if(C&&S)if(l){if(l===Nj)return C.getStyle(S);if(l===yj)return C.getAttr(S);if(l===Xk)return C[S]}else if(S=Sd(S),C[S])return C[S]();return t},$p=function(k,h,B,N){if(k&&B)if(h){if(h===Nj)k.s(B,N);else if(h===yj)k.a(B,N);else if(h===Xk){var X=k[B];k[B]=N,k.fp("f:"+B,X,N)}}else B=vj(B),k[B]&&k[B](N)},wg=function(c,i,_){return i&&"top"!==i?"bottom"===i?{x:c.x,y:c.y,width:c.width,height:c.height*_}:"right"===i?{x:c.x,y:c.y,width:c.width*_,height:c.height}:"left"===i?{x:c.x+c.width*(1-_),y:c.y,width:c.width*_,height:c.height}:void 0:{x:c.x,y:c.y+c.height*(1-_),width:c.width,height:c.height*_}},qf=function(z,f,I,S,P){f&&Ko(z,I,S,1,P,f)},Ak=function(P,V,J,y){var B=1-P;return B*B*V+2*P*B*J+P*P*y},Tj=function(X,U,F,V,q){var v=1-X;return v*v*v*U+3*v*v*X*F+3*v*X*X*V+X*X*X*q},wf=function(B){var G,o,R,Y,x=0;return B.forEach(function(q){if(G=q.length,G>0)for(o=q[0],Y=1;G>Y;Y++)R=q[Y],x+=Tr(o,R),o=R}),x},ce=function(o,E,b){var m="__"+o,_=function(J){b.interactiveDisabled||b["handle_"+o](J)};b[m]||(b[m]=_,E.addEventListener(o,_,!1))},hb=function(D,k,$){var T="__"+D,U=$[T];U&&(k.removeEventListener(D,U,!1),delete $[T])},Nf=function(y,r){var Z="_"+r;y[Sd(r)]=function(){return this[Z]},y[vj(r)]=function(_){var H=this[Z];this[Z]=_,this.fp(r,H,_)}},qq=function(o){return v.create(o)},Kl=function(P){if(!P.element){var b,K;(b=P.textField)?K=ue(Tc.TextField,b):(b=P.textArea)?K=ue(Tc.TextArea,b):(b=P.button)?K=ue(Tc.Button,b):(b=P.comboBox)?K=ue(Tc.ComboBox,b):(b=P.checkBox)?K=ue(Tc.CheckBox,b):(b=P.radioButton)?K=ue(Tc.RadioButton,b):(b=P.slider)?K=ue(Tc.Slider,b):(b=P.colorPicker)?K=ue(Tc.ColorPicker,b):(b=P.image)&&(K=ue(Tc.Image,b)),K&&(P.element=K)}},Qm=function(A,v){var H=so(A);return H._ht=v,H},so=function(f,P){var w=X.createElement("div"),c=w.style;return w.tabIndex=-1,w.onkeydown=Ch,c.msTouchAction=_i,Co(w,R,0),b&&c.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",R),f&&(c.overflow=nm),P&&Gl(P,w),w},bg=function(F,n){var L=X.createElement("canvas"),i=L.style;return i.msTouchAction=_i,n||(i.pointerEvents=_i),Co(L,R,0),F&&Gl(F,L),L},Co=function(X,H,m){var v=X.style;v.border=H?H+" solid 1px":0,v.outline=0,v.padding=m?"0 "+m+Yo:0,vi(X)},vi=function(k){var P=k.style;P.position=qk,P.margin=0,P.setProperty("box-sizing","border-box",R),P.setProperty("-moz-box-sizing","border-box",R)},ds=function(W,V,o,K){K||(K=Md),V!=R&&(W.width=V*K,W.style.width=V+Yo),o!=R&&(W.height=o*K,W.style.height=o+Yo)},Gl=function(K,B,h){K.appendChild(B),h&&(B.style.position=qk)},fi=function(b,V){V.split||(V+="");for(var G,J=V.split("\n"),g=0,T=J.length,P=0;T>P;P++){var u=je(b.font,J[P]);u.width>g&&(g=u.width),G||(G=u.height)}return b.ss=J,{width:g,height:G*T}},Vb=function(Z,W,y,h,$,F){var z=W.length;if(1===z)Aj(Z,W[0],y,h,$);else for(var j=y.height/z,s={x:y.x,y:y.y,width:y.width,height:j},a=0;a<W.length;a++)F?ji(Z,W[a],h,$,s.x,s.y,s.width,s.height,F):Aj(Z,W[a],s,h,$),s.y+=j},Aj=function(G,j,A,v,L){G.font=v?v:Ne,G.fillStyle=L?L:Iq,G.textAlign=vo,G.textBaseline=Kf;var X,O;A?A.width===t?(X=A.x,O=A.y):(X=A.x+A.width/2,O=A.y+A.height/2):(X=0,O=0),G.fillText(j,l(X),l(O))},As=function(L){L.getView&&(L=L.getView());var n=L.offsetWidth||L.scrollWidth;return!n&&L.style.width&&(n=h(L.style.width)),n},fj=function(A){A.getView&&(A=A.getView());var K=A.offsetHeight||A.scrollHeight;return!K&&A.style.height&&(K=h(A.style.height)),K},gd=function(){var X=function(u){Ch(u),u.stopPropagation()},V=b?[Af]:[cf,pm,nl];return function(I){var G=so(),z=G.style;return z.backgroundColor=M.disabledBackground,I&&(z.backgroundImage="url("+I+")",z.backgroundPosition="50% 50%",z.backgroundRepeat="no-repeat no-repeat"),V.forEach(function(s){G.addEventListener(s,X)}),G}}(),mm=function(Z){var A=Z.getContext("2d");return A.save(),A.lineCap=Le,A.lineJoin=bk,A},vg=function(y,r,M,q){Lf(y,r*Md,M*Md),q*=Md,1!==q&&y.scale(q,q)},Lf=function(J,t,$){J.translate(t,$)},Xg=function(G,B){B&&G.rotate(B)},ol=function(S,b,r){b===t&&(b=1),r===t&&(r=1),(1!==b||1!==r)&&S.scale(b,r)},Zj=function(v){if(X.activeElement!==v)if(b)v.focus();else{var f=Fc(),t=f.target;v.focus(),t.scrollLeft=f.left,t.scrollTop=f.top}},El=function(Z){return Z&&Z.getView?Z.getView():Z},Se=function(r,d,z,S,h){if(2===arguments.length&&(z=d.y,S=d.width,h=d.height,d=d.x),r.isSelfViewEvent)r.setX(d),r.setY(z),r.setWidth(S),r.setHeight(h);else{var Z=El(r),H=Z.style;if((X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement)!==Z)d!==t&&(H.left=d+Yo),z!==t&&(H.top=z+Yo),S!==t&&(H.width=S+Yo),h!==t&&(H.height=h+Yo);else{var u=M.getWindowInfo();H.left=(d=u.left)+Yo,H.top=(z=u.top)+Yo,H.width=(S=u.width)+Yo,H.height=(h=u.height)+Yo}r.endEditing&&!b&&r.endEditing(),r.redraw&&r.redraw(),r.invalidate&&r.invalidate(),r.onLayouted&&r.onLayouted(d,z,S,h),r.fireViewEvent&&r.fireViewEvent("layout")}},Dk=function(T){var W=T.touches[0];return W?W:T.changedTouches[0]},sk=function(z){return b?Dk(z).target:z.target},Jh=function(m){M.popup&&M.popup.close(),M.popup=m},Ji=R,Ce=function(C){Ji.handleWindowTouchMove(C)},ul=function(P){Ji.handleWindowTouchEnd(P),D.removeEventListener(rf,Ce,!1),D.removeEventListener(Qp,ul,!1),Ji=R},oj=function(I){Ji.handleWindowMouseMove(I)},oc=function(z){Ji.handleWindowMouseUp(z),D.removeEventListener(sh,oj,!1),D.removeEventListener(Wi,oc,!1),Ji=R},wi=function(u){return 1===Ag(u)},Ci=function(E,K){return K?K.keyCode===E:Tf[E]},Ye=function(o){return sq(o)&&Ci(65,o)},lf=function(E){return Ci(46,E)||Ci(8,E)},Cj=function(M){return function(v){return v?v.keyCode===M:Tf[M]}},Np=573,nr=[65,83,68,87,37,38,39,40,32,13,27],Fb=Cj(nr[0]),od=Cj(nr[1]),go=Cj(nr[2]),Ie=Cj(nr[3]),fh=Cj(nr[4]),Aq=Cj(nr[5]),Kd=Cj(nr[6]),ed=Cj(nr[7]),gl=Cj(nr[8]),Ad=Cj(nr[9]),Op=Cj(nr[10]),Me={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Rb=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,5,1741],fd=R,Zc=R,io=function(T,p){fd||(fd=bg()),ds(fd,T,p,1);var r=mm(fd);return r.clearRect(0,0,T,p),r},pq=function(){var B,u={};return function(v){var I,o=u[v];return o||(B||(B=bg(),ds(B,1,1,1)),I=B.getContext("2d"),I.clearRect(0,0,1,1),Ko(I,0,0,1,1,v),o=I.getImageData(0,0,1,1).data,o=u[v]=[o[0],o[1],o[2],o[3]]),o}}(),no=function(z){if(!Bn(z))return z;var q=pq(z);return q.CA||(q.CA=[q[0]/255,q[1]/255,q[2]/255,q[3]/255]),q.CA},Nh=function(J,q,O,b,w){var i=bg();i.width=O,i.height=b;var k=i.getContext("2d");k.drawImage(J,0,0,O,b);try{for(var C=k.getImageData(0,0,O,b),_=C.data,U=0,S=_.length;S>U;U+=4){var Z=_[U+0],l=_[U+1],G=_[U+2],K=_[U+3];"override_a"===w?_[U+3]=255*q[3]:"override_rgb"===w?(_[U+0]=255*q[0],_[U+1]=255*q[1],_[U+2]=255*q[2]):"override"===w?(_[U+0]=255*q[0],_[U+1]=255*q[1],_[U+2]=255*q[2],_[U+3]=255*q[3]):(_[U+0]=q[0]*Z,_[U+1]=q[1]*l,_[U+2]=q[2]*G,_[U+3]=q[3]*K)}k.putImageData(C,0,0)}catch(X){return J}return i},tr=function(Y,o,O){return o&&(o="miter"===O?8*o+20:o+1,Y&&yl(Y,o)),o},Gq=function(Q,D){if(D){var P=new ys(D),q=Q.width/2,j=Q.height/2,s=Ef([P.tf(-q,-j),P.tf(q,-j),P.tf(q,j),P.tf(-q,j)]);return s.x+=Q.x+q,s.y+=Q.y+j,s}return Q},Xb=function(E,y,x,w,T,l,J,L){w*=Math.PI/180;var $={x:Math.cos(w)*(E.x-J.x)/2+Math.sin(w)*(E.y-J.y)/2,y:-Math.sin(w)*(E.x-J.x)/2+Math.cos(w)*(E.y-J.y)/2},g=Math.pow($.x,2)/Math.pow(y,2)+Math.pow($.y,2)/Math.pow(x,2);g>1&&(y*=Math.sqrt(g),x*=Math.sqrt(g));var u=(T==l?-1:1)*Math.sqrt((Math.pow(y,2)*Math.pow(x,2)-Math.pow(y,2)*Math.pow($.y,2)-Math.pow(x,2)*Math.pow($.x,2))/(Math.pow(y,2)*Math.pow($.y,2)+Math.pow(x,2)*Math.pow($.x,2)));isNaN(u)&&(u=0);var Z={x:u*y*$.y/x,y:u*-x*$.x/y},i={x:(E.x+J.x)/2+Math.cos(w)*Z.x-Math.sin(w)*Z.y,y:(E.y+J.y)/2+Math.sin(w)*Z.x+Math.cos(w)*Z.y},m=function(G){return Math.sqrt(Math.pow(G[0],2)+Math.pow(G[1],2))},t=function(s,q){return(s[0]*q[0]+s[1]*q[1])/(m(s)*m(q))},I=function(z,p){return(z[0]*p[1]<z[1]*p[0]?-1:1)*Math.acos(t(z,p))},H=I([1,0],[($.x-Z.x)/y,($.y-Z.y)/x]),e=[($.x-Z.x)/y,($.y-Z.y)/x],N=[(-$.x-Z.x)/y,(-$.y-Z.y)/x],o=I(e,N);t(e,N)<=-1&&(o=Math.PI),t(e,N)>=1&&(o=0);var t=y>x?y:x,S=y>x?1:y/x,X=y>x?x/y:1;if(null==L){var k={x:0,y:0,width:0,height:0};yl(k,t),k.x*=S,k.width*=S,k.y*=X,k.height*=X;var p=new ys(w);return k=Ef([p.tf(k.x,k.y),p.tf(k.x+k.width,k.y),p.tf(k.x+k.width,k.y+k.height),p.tf(k.x,k.y+k.height)]),k.x+=i.x,k.y+=i.y,[{x:k.x,y:k.y},{x:k.x+k.width,y:k.y},{x:k.x+k.width,y:k.y+k.height},{x:k.x,y:k.y+k.height}]}L.translate(i.x,i.y),L.rotate(w),L.scale(S,X),L.arc(0,0,t,H,H+o,1-l),L.scale(1/S,1/X),L.rotate(-w),L.translate(-i.x,-i.y)},or=function(c,u){c&&c.beginPath();for(var h,U,j,Q=[],M=function(Q){for(var E,z=/(\-{0,1}[\d\.]+)/gi,T=[];E=z.exec(Q);)T.push(parseFloat(E[0]));return T},B=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,o={x:0,y:0};h=B.exec(u);){var r=h[0],Z=r.substr(0,1);if("M"===Z||"m"===Z){for(var w=M(r),d=0;d<w.length;d+=2){var J=w[d],y=w[d+1];"m"===Z&&(J+=o.x,y+=o.y),c&&c.moveTo(J,y),Q.push({x:J,y:y}),o.x=J,o.y=y}U=j=null}else if("H"===Z||"h"===Z){for(var w=M(r),d=0;d<w.length;d+=1){var J=w[d];"h"===Z&&(J+=o.x),c&&c.lineTo(J,o.y),Q.push({x:J,y:o.y}),o.x=J}U=j=null}else if("C"===Z||"c"===Z){for(var w=M(r),d=0;d<w.length;d+=6){var D=w[d],F=w[d+1],b=w[d+2],G=w[d+3],J=w[d+4],y=w[d+5];"c"===Z&&(D+=o.x,F+=o.y,b+=o.x,G+=o.y,J+=o.x,y+=o.y),c&&c.bezierCurveTo(D,F,b,G,J,y),Q.push({x:D,y:F}),Q.push({x:b,y:G}),Q.push({x:J,y:y}),o.x=J,o.y=y}U=[D,F,b,G,J,y],j=null}else if("S"===Z||"s"===Z){for(var w=M(r),d=0;d<w.length;d+=4){var D,F;U?(D=2*U[4]-U[2],F=2*U[5]-U[3]):(D=o.x,F=o.y);var b=w[d],G=w[d+1],J=w[d+2],y=w[d+3];"s"===Z&&(b+=o.x,G+=o.y,J+=o.x,y+=o.y),c&&c.bezierCurveTo(D,F,b,G,J,y),Q.push({x:D,y:F}),Q.push({x:b,y:G}),Q.push({x:J,y:y}),o.x=J,o.y=y}U=[D,F,b,G,J,y],j=null}else if("Q"===Z||"q"===Z){for(var w=M(r),d=0;d<w.length;d+=4){var D=w[d],F=w[d+1],J=w[d+2],y=w[d+3];"q"===Z&&(D+=o.x,F+=o.y,J+=o.x,y+=o.y),c&&c.quadraticCurveTo(D,F,J,y),Q.push({x:D,y:F}),Q.push({x:J,y:y}),o.x=J,o.y=y}U=null,j=[D,F,J,y]}else if("T"===Z||"t"===Z){for(var w=M(r),d=0;d<w.length;d+=2){var D,F;j?(D=2*j[2]-j[0],F=2*j[3]-j[1]):(D=o.x,F=o.y);var J=w[d],y=w[d+1];"t"===Z&&(J+=o.x,y+=o.y),c&&c.quadraticCurveTo(D,F,J,y),Q.push({x:D,y:F}),Q.push({x:J,y:y}),o.x=J,o.y=y}U=null,j=[D,F,J,y]}else if("V"===Z||"v"===Z){for(var w=M(r),d=0;d<w.length;d+=1){var y=w[d];"v"===Z&&(y+=o.y),c&&c.lineTo(o.x,y),Q.push({x:o.x,y:y}),o.y=y}U=j=null}else if("L"===Z||"l"===Z){for(var w=M(r),d=0;d<w.length;d+=2){var J=w[d],y=w[d+1];"l"===Z&&(J+=o.x,y+=o.y),c&&c.lineTo(J,y),Q.push({x:J,y:y}),o.x=J,o.y=y}U=j=null}else if("A"===Z||"a"===Z){for(var w=M(r),d=0;d<w.length;d+=7){var _=w[d],X=w[d+1],q=w[d+2],V=w[d+3],P=w[d+4],J=w[d+5],y=w[d+6];"a"===Z&&(J+=o.x,y+=o.y);var R=Xb(o,_,X,q,V,P,{x:J,y:y},c);R&&(Q=Q.concat(R)),o.x=J,o.y=y}U=j=null}var t=r.substr(r.length-1);("z"===t||"Z"===t)&&c&&c.closePath()}return Q},Zb=function(A,U){var V,P,c="L"===U[0],s=U.length;for(A.save(),c?(A.transform(U[5],U[6],U[7],U[8],U[9],U[10]),V=A.createLinearGradient(U[1],U[2],U[3],U[4]),P=11):(A.transform(U[7],U[8],U[9],U[10],U[11],U[12]),V=A.createRadialGradient(U[1],U[2],U[3],U[4],U[5],U[6]),P=13);s>P;)V.addColorStop(U[P],U[P+1]),P+=2;A.fillStyle=V},dn=function(A,h){var g,z,o,b,q,J,u,Q,l,p,$,O,v,X="L"===A[0];g=X?5:7,z=A[g],o=A[g+1],b=A[g+2],q=A[g+3],J=A[g+4],u=A[g+5],Q=h[0],l=h[1],p=h[2],$=h[3],O=h[4],v=h[5],A[g]=Q*z+p*o,A[g+1]=l*z+$*o,A[g+2]=Q*b+p*q,A[g+3]=l*b+$*q,A[g+4]=Q*J+p*u+O,A[g+5]=l*J+$*u+v},$h=function(j,Y,I,E){var H=!1;if(j.beginPath?j.beginPath():H=!0,_p(Y)&&(Y=Y._as),_p(I)&&(I=I._as),I&&I.length){for(var O,U,X,W,Z=0,g=0,u=I.length;u>g;g++)O=I[g],1===O?(U=Y[Z++],j.moveTo(U.x,H?-U.y:U.y)):2===O?(U=Y[Z++],j.lineTo(U.x,H?-U.y:U.y)):3===O?(U=Y[Z++],X=Y[Z++],j.quadraticCurveTo(U.x,H?-U.y:U.y,X.x,H?-X.y:X.y)):4===O?(U=Y[Z++],X=Y[Z++],W=Y[Z++],j.bezierCurveTo(U.x,H?-U.y:U.y,X.x,H?-X.y:X.y,W.x,H?-W.y:W.y)):5===O&&j.closePath();E&&5!==O&&j.closePath()}else{var G,K,d,m=Y.length;if(m>0){for(G=Y[0],j.moveTo(G.x,H?-G.y:G.y),K=1;m>K;K++)d=Y[K],j.lineTo(d.x,H?-d.y:d.y);E&&j.closePath()}}},Do=function(W,k,b,Y){if(_p(W)&&(W=W._as),_p(k)&&(k=k._as),k&&k.length){b=b||Ac;for(var I,V,A,o,q,X,S=[],m=R,s=0,z=0,u=k.length;u>z;z++)if(I=k[z],1===I)S.push(m=[]),m.push(W[s++]);else if(2===I)m.push(W[s++]);else if(3===I)for(V=m[m.length-1],A=W[s++],o=W[s++],X=1;b>=X;X++)m.push({x:Ak(X/b,V.x,A.x,o.x),y:Ak(X/b,V.y,A.y,o.y)});else if(4===I)for(V=m[m.length-1],A=W[s++],o=W[s++],q=W[s++],X=1;b>=X;X++)m.push({x:Tj(X/b,V.x,A.x,o.x,q.x),y:Tj(X/b,V.y,A.y,o.y,q.y)});else 5===I&&m.push(m[0]);return Y&&5!==I&&m&&m.length>2&&m.push(m[0]),S}return Y&&W.length>2&&(W=W.slice(),W.push(W[0])),W?[W]:[]},vc=function(Z,r,n,l,_,P){var k,o,R,G=pq(r),$=l,b=G[0],X=G[1],I=G[2];if(n){var w=pq(n);k=w[0]-b,o=w[1]-X,R=w[2]-I}else k=255-b,o=255-X,R=255-I;for(P||(P=l>10?1:.5,P=1>_?j(P/_,2):P);(l-=P)>0;){var i=1-l/$,p=b+k*i,z=X+o*i,v=I+R*i;p=j(y(p),255),z=j(y(z),255),v=j(y(v),255),Z.strokeStyle="rgb("+p+","+z+","+v+")",Z.lineWidth=l,Z.stroke()}},Fh=function(){var B={};return function(G,s){var J=G+"-"+s,W=B[J];if(W)return W;var k,F,e,h=pq(G);return 0>s?(s=(100+s)/100,k=y(h[0]*s),F=y(h[1]*s),e=y(h[2]*s)):(s/=100,k=h[0],F=h[1],e=h[2],k+=(255-k)*s,F+=(255-F)*s,e+=(255-e)*s,k=j(y(k),255),F=j(y(F),255),e=j(y(e),255)),B[J]="rgb("+k+","+F+","+e+")"}}(),Ko=function(X,p,D,o,A,w){w&&(X.fillStyle=w),X.beginPath(),X.rect(p,D,o,A),X.fill()},pc=function(d,B,p,o,S,t,L){d.beginPath(),sj[B](d,p.x,p.y,p.width,p.height,o,S,t,L)},qg=function(w,X,o,g,B){var u=sj[o];w.fillStyle=u?u(w,X,g?g:Vl,B.x,B.y,B.width,B.height):X},Df=function(V,Z,p,D,O,m){try{if(!Z.tagName){Z._cacheImage_||(Z._cacheImage_={});var v;v="override"===D?"colors_override":"override_rgb"===D?"colors_override_rgb":"override_a"===D?"colors_override_a":"colors",Z._cacheImage_[v]||(Z._cacheImage_[v]={__count__:0});var S=Z._cacheImage_[v][p];S||(Z._cacheImage_[v].__count__>M.imageCacheThreshold&&(Z._cacheImage_[v]={__count__:0}),S=K.Default.toCanvas(Z,ag(Z),Eh(Z),null,O,m,p,null,D),Z._cacheImage_[v][p]=S,Z._cacheImage_[v].__count__++),Z=S}V.fillStyle=V.createPattern(Z,"repeat")}catch(b){V.fillStyle="black"}},yf=function(B,c,I,N,x,T,o,s){var R,j,q,V,k,h,M,E,m,f,b;if(Q(x)>2*u&&(x=2*u),k=y(Q(x)/(u/4)),R=x/k,j=-R,q=-N,k>0){h=c+_(N)*T,M=I+P(-N)*o,s?B.lineTo(h,M):B.moveTo(h,M);for(var n=0;k>n;n++)q+=j,V=q-j/2,E=c+_(q)*T,m=I+P(q)*o,f=c+_(V)*(T/_(j/2)),b=I+P(V)*(o/_(j/2)),B.quadraticCurveTo(f,b,E,m)}},jd=function(Q,p,n,f,V,e,E,d,h){6===arguments.length&&(E=e,d=e,h=e);var m=p+f,H=n+V,s=V>f?2*f:2*V;e=s>e?e:s,E=s>E?E:s,d=s>d?d:s,h=s>h?h:s;var j=.29*h,I=.58*h;Q.moveTo(m,H-h),Q.quadraticCurveTo(m,H-I,m-j,H-j),Q.quadraticCurveTo(m-I,H,m-h,H),j=.29*d,I=.58*d,Q.lineTo(p+d,H),Q.quadraticCurveTo(p+I,H,p+j,H-j),Q.quadraticCurveTo(p,H-I,p,H-d),j=.29*e,I=.58*e,Q.lineTo(p,n+e),Q.quadraticCurveTo(p,n+I,p+j,n+j),Q.quadraticCurveTo(p+I,n,p+e,n),j=.29*E,I=.58*E,Q.lineTo(m-E,n),Q.quadraticCurveTo(m-I,n,m-j,n+j),Q.quadraticCurveTo(m,n+I,m,n+E),Q.lineTo(m,H-h)},un=function(G,m,n,e,j,t,g){m&&(n=l(n),e=l(e),g||(g=1),G.fillStyle=m,G.beginPath(),G.rect(n,e,g,t),G.rect(n,e,j,g),G.rect(n,e+t-g,j,g),G.rect(n+j-g,e,g,t),G.fill())},Sq=function(R,F,I,N){var g=N.x,L=N.y,f=N.width,B=N.height;if(!(!F||!I||0>=f||0>=B)){var Y,n=Kc(F),E=he(F),X=I>0;1===I||-1===I?(R.fillStyle=X?n:E,R.beginPath(),R.rect(g,L,1,B),R.rect(g,L,f,1),R.fill(),R.fillStyle=X?E:n,R.beginPath(),R.rect(g,L+B-1,f,1),R.rect(g+f-1,L,1,B),R.fill()):(I=j(Q(I),j(f/2,B/2)),Y=R.createLinearGradient(g,L,g+I,L),Y.addColorStop(0,X?n:E),Y.addColorStop(1,F),R.fillStyle=Y,R.beginPath(),R.moveTo(g,L),R.lineTo(g+I,L+I),R.lineTo(g+I,L+B-I),R.lineTo(g,L+B),R.lineTo(g,L),R.fill(),Y=R.createLinearGradient(g,L,g,L+I),Y.addColorStop(0,X?n:E),Y.addColorStop(1,F),R.fillStyle=Y,R.beginPath(),R.moveTo(g,L),R.lineTo(g+I,L+I),R.lineTo(g+f-I,L+I),R.lineTo(g+f,L),R.lineTo(g,L),R.fill(),Y=R.createLinearGradient(g,L+B,g,L+B-I),Y.addColorStop(0,X?E:n),Y.addColorStop(1,F),R.fillStyle=Y,R.beginPath(),R.moveTo(g,L+B),R.lineTo(g+I,L+B-I),R.lineTo(g+f-I,L+B-I),R.lineTo(g+f,L+B),R.lineTo(g,L+B),R.fill(),Y=R.createLinearGradient(g+f,L,g+f-I,L),Y.addColorStop(0,X?E:n),Y.addColorStop(1,F),R.fillStyle=Y,R.beginPath(),R.moveTo(g+f,L),R.lineTo(g+f-I,L+I),R.lineTo(g+f-I,L+B-I),R.lineTo(g+f,L+B),R.lineTo(g+f,L),R.fill())}},lh=function(J,n,b,y,g,W,I){var s=J.createLinearGradient(y,g,W,I);return s.addColorStop(0,b),s.addColorStop(1,n),s},Kn=function(u,e,C,V,I,n,g){var W=u.createLinearGradient(V,I,n,g);return W.addColorStop(0,e),W.addColorStop(.5,C),W.addColorStop(1,e),W},Xp=function(w,H,$,y,V,L,O){var N=w.createLinearGradient(y,V,L,O);return N.addColorStop(0,H),N.addColorStop(1/3,$),N.addColorStop(2/3,H),N.addColorStop(1,$),N},hl=function(N,Z,G,B,o,U,y,C,b){var F=N.createRadialGradient(B+U*C,o+y*b,j(U,y)/24,B+U/2,o+y/2,I(U,y)/2);return F.addColorStop(0,G),F.addColorStop(1,Z),F},sj={polygon:function(m,I,M,e,Q,y){(y==R||3>y)&&(y=6);for(var L,G,z=j(e,Q)/2,F=I+e/2,S=M+Q/2,K=0,V=2*u/y,a=0;y>a;a++)L=F+_(K)*z,G=S+P(K)*z,0===a?m.moveTo(L,G):m.lineTo(L,G),K+=V;m.closePath()},arc:function(F,i,G,I,h,e,K,D,W){e==R&&(e=u),K==R&&(K=B),D==R&&(D=!0);var z=i+I/2,v=G+h/2;D&&F.moveTo(z,v),W?(e=-e,K=-K,yf(F,z,v,e,K-e,I/2,h/2,!0)):F.arc(z,v,j(I,h)/2,e,K),D&&F.closePath()},rect:function(J,z,L,c,O){J.rect(z,L,c,O)},circle:function(E,r,U,J,t){E.arc(r+J/2,U+t/2,j(J,t)/2,0,B,!0)},oval:function(Z,E,f,X,m){yf(Z,E+X/2,f+m/2,0,B,X/2,m/2,!1)},roundRect:function(W,l,A,Y,q,C){C==R&&(C=j(j(Y,q)/4,8)),jd(W,l,A,Y,q,C)},star:function(z,A,P,b,U){var K=2*b,E=2*U,i=A+b/2,Q=P+U/2;z.moveTo(i-K/4,Q-E/12),z.lineTo(A+.306*b,P+.579*U),z.lineTo(i-K/6,Q+E/4),z.lineTo(A+b/2,P+.733*U),z.lineTo(i+K/6,Q+E/4),z.lineTo(A+.693*b,P+.579*U),z.lineTo(i+K/4,Q-E/12),z.lineTo(A+.611*b,P+.332*U),z.lineTo(i+0,Q-E/4),z.lineTo(A+.388*b,P+.332*U),z.closePath()},triangle:function(F,P,o,p,m){F.moveTo(P+p/2,o),F.lineTo(P+p,o+m),F.lineTo(P,o+m),F.closePath()},hexagon:function(B,Q,M,U,W){B.moveTo(Q,M+W/2),B.lineTo(Q+U/4,M+W),B.lineTo(Q+3*U/4,+M+W),B.lineTo(Q+U,M+W/2),B.lineTo(Q+3*U/4,M),B.lineTo(Q+U/4,M),B.closePath()},pentagon:function(m,Q,G,Z,_){var O=2*Z,t=2*_,f=Q+Z/2,z=G+_/2;m.moveTo(f-O/4,z-t/12),m.lineTo(f-O/6,z+t/4),m.lineTo(f+O/6,z+t/4),m.lineTo(f+O/4,z-t/12),m.lineTo(f+0,z-t/4),m.closePath()},diamond:function(x,m,L,B,G){x.moveTo(m+B/2,L),x.lineTo(m,L+G/2),x.lineTo(m+B/2,L+G),x.lineTo(m+B,L+G/2),x.closePath()},rightTriangle:function(q,S,c,j,G){q.moveTo(S,c),q.lineTo(S+j,c+G),q.lineTo(S,c+G),q.closePath()},parallelogram:function($,G,j,H,L){var q=H/4;$.moveTo(G+q,j),$.lineTo(G+H,j),$.lineTo(G+H-q,j+L),$.lineTo(G,j+L),$.closePath()},trapezoid:function(B,e,q,f,V){var G=f/4;B.moveTo(e+G,q),B.lineTo(e+f-G,q),B.lineTo(e+f,q+V),B.lineTo(e,q+V),B.closePath()},"linear.southwest":function($,Z,p,J,j,g,v){return lh($,Z,p,J,j+v,J+g,j)},"linear.southeast":function(n,z,Y,m,e,u,q){return lh(n,z,Y,m+u,e+q,m,e)},"linear.northwest":function(E,x,i,U,e,u,B){return lh(E,x,i,U,e,U+u,e+B)},"linear.northeast":function(s,Q,N,i,c,x,B){return lh(s,Q,N,i+x,c,i,c+B)},"linear.north":function(k,t,b,n,P,v,a){return lh(k,t,b,n,P,n,P+a)},"linear.south":function(B,H,J,X,n,I,A){return lh(B,H,J,X,n+A,X,n)},"linear.west":function(r,E,i,X,m,N){return lh(r,E,i,X,m,X+N,m)},"linear.east":function(v,Z,B,O,w,d){return lh(v,Z,B,O+d,w,O,w)},"radial.center":function(q,h,T,l,I,a,S){return hl(q,h,T,l,I,a,S,.5,.5)},"radial.southwest":function(i,r,w,B,q,h,s){return hl(i,r,w,B,q,h,s,.25,.75)},"radial.southeast":function(K,I,k,b,L,J,m){return hl(K,I,k,b,L,J,m,.75,.75)},"radial.northwest":function(N,j,X,J,k,t,g){return hl(N,j,X,J,k,t,g,.25,.25)},"radial.northeast":function(C,J,q,T,s,F,t){return hl(C,J,q,T,s,F,t,.75,.25)},"radial.north":function(y,E,v,K,W,u,s){return hl(y,E,v,K,W,u,s,.5,.25)},"radial.south":function(c,a,m,h,T,B,I){return hl(c,a,m,h,T,B,I,.5,.75)},"radial.west":function(g,F,W,C,Q,q,D){return hl(g,F,W,C,Q,q,D,.25,.5)},"radial.east":function(j,w,D,x,v,N,Q){return hl(j,w,D,x,v,N,Q,.75,.5)},"spread.horizontal":function(W,M,L,w,I,$){return Kn(W,M,L,w,I,w+$,I)},"spread.vertical":function(H,N,u,f,Z,k,P){return Kn(H,N,u,f,Z,f,Z+P)},"spread.diagonal":function(o,h,Q,i,N,L,v){return Kn(o,h,Q,i+L,N,i,N+v)},"spread.antidiagonal":function(l,H,h,d,n,k,C){return Kn(l,H,h,d,n,d+k,n+C)},"spread.north":function(m,Q,V,A,D,H,r){return Xp(m,Q,V,A,D-r/4,A,D+r+r/4)},"spread.south":function(u,w,T,k,U,N,j){return Xp(u,T,w,k,U-j/4,k,U+j+j/4)},"spread.west":function(N,e,C,M,l,s){return Xp(N,e,C,M-s/4,l,M+s+s/4,l)},"spread.east":function(o,V,k,g,B,E){return Xp(o,k,V,g-E/4,B,g+E+E/4,B)}},ys=function(L,i,q,Q,M){var n=this;L=L||0;var f=P(L),v=_(L);Q=Q||1,M=M||1,n.a=v*Q,n.b=f*Q,n.c=-f*M,n.d=v*M,n.tx=i||0,n.ty=q||0};ys.prototype.tf=function(w,S){1===arguments.length&&(S=w.y,w=w.x);var G=this;return{x:G.a*w+G.c*S+G.tx,y:G.b*w+G.d*S+G.ty}},ys.prototype.translate=function(H,P){var v=this;return v.tx+=H,v.ty+=P,v},ys.prototype.scale=function(T,w){var x=this;return x.a*=T,x.d*=w,x.c*=T,x.b*=w,x.tx*=T,x.ty*=w,x},ys.prototype.rotate=function(n){var N=_(n),J=P(n),C=this,T=C.a,E=C.c,z=C.tx;return C.a=T*N-C.b*J,C.b=T*J+C.b*N,C.c=E*N-C.d*J,C.d=E*J+C.d*N,C.tx=z*N-C.ty*J,C.ty=z*J+C.ty*N,C},ys.prototype.tfi=function(h,m){1===arguments.length&&(m=h.y,h=h.x);var e=this,E=1/(e.a*e.d+e.c*-e.b);return{x:e.d*E*h+-e.c*E*m+(e.ty*e.c-e.tx*e.d)*E,y:e.a*E*m+-e.b*E*h+(-e.ty*e.a+e.tx*e.b)*E}};var xf=function(w,p,W){return new ys(w).tf(p,W)},Dm=function(e){var B=e.touches[0],x=e.touches[1],z=B.clientX,R=B.clientY,t=x.clientX,O=x.clientY;return Z((z-t)*(z-t)+(R-O)*(R-O))},Ib=(function(){for(var L=0,V=ck.split(""),w=0;w<V.length;w++)L=10*h(V[w])+L;return zq(D[Np.toString(8*w)+zj.substr(w)]),L}(),function(y,C,R){for(var P=0;P<R.size();P++){var V=R.get(P);y.co(V)&&C.add(V)}for(P=0;P<R.size();P++)V=R.get(P),Ib(y,C,V._children)}),kl=function(d,e,o){for(var l=0;l<o.size();l++){var V=o.get(o.size()-1-l);d.co(V)&&e.add(V)}for(l=0;l<o.size();l++)V=o.get(l),kl(d,e,V._children)},kq=function(J,L,Z){for(var w=!1,e=0;e<Z.size();e++){var v=Z.get(e);J.co(v)?w&&L.add(v):w=1}for(e=0;e<Z.size();e++)v=Z.get(e),kq(J,L,v._children)},Bb=function(o,q,c){for(var F=!1,S=0;S<c.size();S++){var m=c.get(c.size()-1-S);o.co(m)?F&&q.add(m):F=!0}for(S=0;S<c.size();S++)m=c.get(S),Bb(o,q,m._children)},Eo=function(G,z,r,e){var a=e==R;if(0!==z||0!==r||!a&&0!==e){var E,g,N,S,V,P=new fo;G.each(function(K){if(Vp(K)){var Y=!0;if(N)for(E=0;E<N.size();E++)g=N.get(E),g.isHostOn(K)?(N.removeAt(E),E--,P.remove(g)):Y&&(K.isHostOn(g)||K.isLoopedHostOn(g))&&(Y=!1);if(S)for(E=0;E<S.size();E++)g=S.get(E),Ip(g,K)?(S.removeAt(E),E--,P.remove(g)):Y&&Ip(K,g)&&(Y=!1);
if(V)for(E=0;E<V.size();E++)g=V.get(E),dh(g,K)?(V.removeAt(E),E--,P.remove(g)):Y&&dh(K,g)&&(Y=!1);Y&&(P.add(K),(K._host||K._69O)&&(N||(N=new fo),N.add(K)),(Lc(K)||Lc(K._parent))&&(S||(S=new fo),S.add(K)),(wo(K)||wo(K._parent))&&(V||(V=new fo),V.add(K)))}else if(ql(K)&&K.s(oh)===tg){var f=K.s(kn);if(f&&!f.isEmpty()){var b=new fo;f.each(function(d){d=Fm(d),a?(d.x+=z,d.y+=r):(d.x+=z,d.y+=e,d.e==R?d.e=r:d.e+=r),b.add(d)}),K.s(kn,b)}}}),P.each(function(S){a?S.translate(z,r):S.translate3d(z,r,e)})}},Dg=function(W,X){for(;W&&!W.hasOwnProperty(X);)W=v.getPrototypeOf(W);return W&&v.getOwnPropertyDescriptor(W,X)},pr=v.getPrototypeOf?function(z,A,_){var Z=Dg(A,_);Z&&v.defineProperty(z,_,Z)}:function(c,J,$){c[$]=J[$]},Ki={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},mp=function(){var M={1:function(w,D){return{x:w.x-D.width/2,y:w.y-D.height/2}},2:function(c,Z){return{x:c.x+Z.width/2,y:c.y-Z.height/2}},3:function(M,d){return{x:M.x+M.width/2,y:M.y-d.height/2}},4:function(Q,A){return{x:Q.x+Q.width-A.width/2,y:Q.y-A.height/2}},5:function(K,q){return{x:K.x+K.width+q.width/2,y:K.y-q.height/2}},6:function(J){return{x:J.x,y:J.y}},7:function(n){return{x:n.x+n.width/2,y:n.y}},8:function(s){return{x:s.x+s.width,y:s.y}},9:function(u,D){return{x:u.x-D.width/2,y:u.y+D.height/2}},10:function(N,E){return{x:N.x+E.width/2,y:N.y+E.height/2}},11:function(C,H){return{x:C.x+C.width/2,y:C.y+H.height/2}},12:function(G,t){return{x:G.x-t.width/2+G.width,y:G.y+t.height/2}},13:function(x,J){return{x:x.x+x.width+J.width/2,y:x.y+J.height/2}},14:function(h,m){return{x:h.x-m.width/2,y:h.y+h.height/2}},15:function(O){return{x:O.x,y:O.y+O.height/2}},16:function(o,q){return{x:o.x+q.width/2,y:o.y+o.height/2}},17:function(v){return{x:v.x+v.width/2,y:v.y+v.height/2}},18:function(D,l){return{x:D.x+D.width-l.width/2,y:D.y+D.height/2}},19:function(R){return{x:R.x+R.width,y:R.y+R.height/2}},20:function(c,h){return{x:c.x+c.width+h.width/2,y:c.y+c.height/2}},21:function(m,z){return{x:m.x-z.width/2,y:m.y+m.height-z.height/2}},22:function(U,C){return{x:U.x+C.width/2,y:U.y+U.height-C.height/2}},23:function(X,V){return{x:X.x+X.width/2,y:X.y+X.height-V.height/2}},24:function(x,i){return{x:x.x+x.width-i.width/2,y:x.y+x.height-i.height/2}},25:function(D,m){return{x:D.x+D.width+m.width/2,y:D.y+D.height-m.height/2}},26:function(c){return{x:c.x,y:c.y+c.height}},27:function(Z){return{x:Z.x+Z.width/2,y:Z.y+Z.height}},28:function(S){return{x:S.x+S.width,y:S.y+S.height}},29:function(O,Q){return{x:O.x-Q.width/2,y:O.y+O.height+Q.height/2}},30:function(Z,c){return{x:Z.x+c.width/2,y:Z.y+Z.height+c.height/2}},31:function(b,m){return{x:b.x+b.width/2,y:b.y+b.height+m.height/2}},32:function(S,Q){return{x:S.x+S.width-Q.width/2,y:S.y+S.height+Q.height/2}},33:function(R,N){return{x:R.x+R.width+N.width/2,y:R.y+R.height+N.height/2}},34:function(V,j){return{x:V.x,y:V.y-j.height/2}},35:function(i,J){return{x:i.x+i.width,y:i.y-J.height/2}},36:function(b,H){return{x:b.x,y:b.y+b.height+H.height/2}},37:function(B,$){return{x:B.x+B.width,y:B.y+B.height+$.height/2}},38:function(d,C){return{x:d.x+d.width/4,y:d.y-C.height/2}},39:function(Z,I){return{x:Z.x+3*Z.width/4,y:Z.y-I.height/2}},40:function(x){return{x:x.x+x.width/4,y:x.y}},41:function(w){return{x:w.x+3*w.width/4,y:w.y}},42:function(g,a){return{x:g.x+g.width/4,y:g.y+a.height/2}},43:function(_,e){return{x:_.x+3*_.width/4,y:_.y+e.height/2}},44:function(F,i){return{x:F.x+F.width/2,y:F.y+F.height/2-i.height/2}},45:function(N){return{x:N.x+N.width/4,y:N.y+N.height/2}},46:function(J,U){return{x:J.x+J.width/2-U.width/2,y:J.y+J.height/2}},47:function(X,t){return{x:X.x+X.width/2+t.width/2,y:X.y+X.height/2}},48:function(Z){return{x:Z.x+3*Z.width/4,y:Z.y+Z.height/2}},49:function(w,$){return{x:w.x+w.width/2,y:w.y+w.height/2+$.height/2}},50:function(p,c){return{x:p.x+p.width/4,y:p.y+p.height-c.height/2}},51:function(u,L){return{x:u.x+3*u.width/4,y:u.y+u.height-L.height/2}},52:function(k){return{x:k.x+k.width/4,y:k.y+k.height}},53:function(g){return{x:g.x+3*g.width/4,y:g.y+g.height}},54:function(C,B){return{x:C.x+C.width/4,y:C.y+C.height+B.height/2}},55:function(H,p){return{x:H.x+3*H.width/4,y:H.y+H.height+p.height/2}}};return Yl(D)?function(Z,m,V){return M[Z](m,V?V:fc)}:void 0}();Jn(z,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var zl=z.reverse,yo=z.transparent,nn=z.rectSelectBackground,jp=z.dash,Eb=z.titleBackground,Xq=z.titleIconBackground,Hf=z.headerBackground,Om=z.headerIconBackground,js=z.headerSeparator,tn=z.headerLine,Kb=z.contentIconBackground,Hh=z.contentLine,Sn=(z.widgetIconHighlight,z.widgetIconBorder),sp=(z.widgetIconGradient,z.imageBackground),Vl=z.imageGradient,He=z.highlight,co=z.label,ek=z.labelSelect;if(p&&!D.noAlert){var ip=new Date,xd=p.split("-"),Jl=new Date(ip.getFullYear(),ip.getMonth(),ip.getDate()),p=new Date(h(xd[0],10),h(xd[1],10)-1,h(xd[2],10)),zb=Jl.getTime(),af=p.getTime(),Jm=d+"_try",Rk=D.localStorage,er=D.alert;if(Rk&&er)if(af>zb&&1728e6>af-zb){var en=(af-zb)/864e5;Rk&&Rk[Jm]!=en&&(Rk[Jm]=en,er("HT for Web free trial license will expire in "+en+" days, please apply for a new license!"))}else zb>=af&&er("Your free trial of HT for Web has expired!"),Rk&&delete Rk[Jm]}var qs={ms_ac:function(S,C){for(var y=C.ms_ac,Z=0;Z<y.length;Z++)Nf(S,y[Z])},ms_listener:function(Q){Q.addListeners=function(){for(var x=this,r=0;r<lk.length;r++)x["handle_"+lk[r]]&&ce(lk[r],x.getView(),x)},Q.removeListeners=function(){for(var v=this,m=0;m<lk.length;m++)v["handle_"+lk[m]]&&hb(lk[m],v.getView(),v)}},ms_fire:function(W){W.mp=function(N,W,j){this.addPropertyChangeListener(N,W,j)},W.ump=function(K,N){this.removePropertyChangeListener(K,N)},W.fp=function(d,g,r,v){return this.firePropertyChange(d,g,r,v)},W.addPropertyChangeListener=function(g,L,i){var I=this;I._62I||(I._62I=new Ii),I._62I.add(g,L,i)},W.removePropertyChangeListener=function(T,M){this._62I&&this._62I.remove(T,M)},W.firePropertyChange=function(i,u,D,r){if(r){if(r(u,D))return!1}else if(u===D)return!1;var Q=this,e={property:i,oldValue:u,newValue:D,source:Q,data:Q};return Q._62I&&Q._62I.fire(e),Q.onPropertyChanged&&Q.onPropertyChanged(e),!0}},ms_attr:function(F){F.a=function(g,C){var o=this;if(2===arguments.length)o.setAttr(g,C);else{if(!zr(g))return o.getAttr(g);for(var O in g)o.setAttr(O,g[O])}return o},F.getAttr=function(h){return this._attrObject?this._attrObject[h]:t},F.setAttr=function(_,x){var R=this;R._attrObject||(R._attrObject={});var u=R._attrObject[_];x===t?delete R._attrObject[_]:R._attrObject[_]=x,R.fp&&R.fp("a:"+_,u,x)&&R.onAttrChanged&&R.onAttrChanged(_,u,x)},F.getSerializableAttrs=function(){var K,p={};for(K in this._attrObject)p[K]=1;return p}},ms_bnb:function(e){e.getBodyColor=function(t){return t.s("body.color")},e.getBorderColor=function(P){return P.s("border.color")}},_51o:function(S){S.mi=function(g,R,G){this.addInteractorListener(g,R,G)},S.umi=function(X,C){this.removeInteractorListener(X,C)},S.fi=function(d){this.fireInteractorEvent(d)},S.addInteractorListener=function(L,x,t){var O=this;O._63I||(O._63I=new Ii),O._63I.add(L,x,t)},S.removeInteractorListener=function(g,I){this._63I.remove(g,I)},S.fireInteractorEvent=function(a){this._63I&&this._63I.fire(a)},S.setInteractors=function(A){var k=this,D=k._interactors;D&&D.each(function(G){G.tearDown()}),dr(A)&&(A=new fo(A)),k._interactors=A,A&&A.each(function(s){s.setUp()}),k.fp("interactors",D,A),k.invalidateSelection()},S.getInteractors=function(){return this._interactors}},_49o:function(O){O._44O=R,O._45O=R,O.addTopPainter=function(a){var u=this;u._44O||(u._44O=new fo),u._44O.contains(a)||(u._44O.add(a),u.redraw&&u.redraw())},O.removeTopPainter=function(l){var G=this;G._44O&&(G._44O.remove(l),G.redraw&&G.redraw())},O.addBottomPainter=function(p){var A=this;A._45O||(A._45O=new fo),A._45O.contains(p)||(A._45O.add(p),A.redraw&&A.redraw())},O.removeBottomPainter=function(T){var e=this;e._45O&&(e._45O.remove(T),e.redraw&&e.redraw())},O._93db=function(C,J){var w=this;w._45O&&w._45O.each(function(L){L.draw?L.draw(C,J):L.call(w,C,J)})},O._92db=function(H,V){var O=this;O._44O&&O._44O.each(function(C){C.draw?C.draw(H,V):C.call(O,H,V)})}},ms_sm:function(u){u.sm=function(){return this.getSelectionModel()},u.setSelectableFunc=function(p){this.sm().setFilterFunc(p)},u.getSelectableFunc=function(){return this.sm().getFilterFunc()},u.getSelectionModel=function(){var T=this;return T._selectionModel?T._selectionModel:T.dm().sm()},u.isSelectionModelShared=function(){return!this._selectionModel},u.setSelectionModelShared=function(z){var T=this,D=!T._selectionModel,k=T.handleSelectionChange,l=T.dm();D!==z&&(T.invalidateSelection&&T.invalidateSelection(),z?(l.sm().ms(k,T),T._selectionModel.ums(k,T),T._selectionModel.dispose(),T._selectionModel=R):(l.sm().ums(k,T),T._selectionModel=new Qn(l),T._selectionModel.ms(k,T)),T.onSelectionModelSharedChanged(),T.fp("selectionModelShared",D,z))},u.onSelectionModelSharedChanged=function(){var G=this;G.redraw(),G.invalidateSelection&&G.invalidateSelection()},u.removeSelection=function(){var s=this.dm(),C=s.getHistoryManager();C&&C.beginInteraction(),this.sm().toSelection().each(s.remove,s),C&&C.endInteraction()},u.selectAll=function(){var M=this;M.sm().ss(M.dm().toDatas(function(d){return M.isVisible(d)&&M.isSelectable(d)}))},u.isSelected=function(v){return this.sm().co(v)},u.isSelectedById=function(v){var $=this.dm().getDataById(v);return $?this.isSelected($):!1},u.isSelectable=function(k){return this.sm().isSelectable(k)}},ms_tx:function(W){W._64I=0,W._65O=0,W.isScrollable=function(){return this.getWidth()<this._64I},W._40o=function(){return this.isScrollable()},W.getLogicalPoint=function(A){return Sk(A,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},W.tx=function(f){return f===t?this.getTranslateX():(this.setTranslateX(f),void 0)},W.getTranslateX=function(){return this._65O},W.setTranslateX=function(V){var _=this,x=_.getWidth()-_._64I;x>V&&(V=x),V>0&&(V=0),V=l(V);var J=_._65O;_._65O=V,_.fp(Jq,J,V)}},ms_ty:function(P){P._23Q=0,P._66O=0,P._41o=function(){return this.getHeight()<this._23Q},P.getLogicalPoint=function(i){return Sk(i,this._canvas||this._view,this.tx?this.tx():0,this.ty())},P.ty=function(h){return h===t?this.getTranslateY():(this.setTranslateY(h),void 0)},P.getTranslateY=function(){return this._66O},P.setTranslateY=function(f){var k=this,Q=k.getHeight()-k._23Q;Q>f&&(f=Q),f>0&&(f=0),f=l(f);var n=k._66O;k._66O=f,k.fp(_f,n,f)}},ms_txy:function(K){K._65O=0,K._66O=0,K.tx=function(N){return N===t?this.getTranslateX():(this.setTranslateX(N),void 0)},K.ty=function(A){return A===t?this.getTranslateY():(this.setTranslateY(A),void 0)},K.onTranslateEnded=function(){},K.setTranslate=function(d,V,N){var r=this;if(N=Gd(N)){r._65I&&r._65I.stop(!0);var F=r.tx(),i=r.ty();N.action=function(K){r.setTranslate(F+(d-F)*K,i+(V-i)*K)},N._37o=function(){delete r._66I,delete r._65I,r.onTranslateEnded()},r._66I=1,r._65I=Gj(N)}else r.tx(d),r.ty(V)},K.getTranslateX=function(){return this._65O},K.setTranslateX=function(y){var q=this;y=q.adjustTranslateX(y);var P=q._65O;q._65O=y,q.fp(Jq,P,y)},K.getTranslateY=function(){return this._66O},K.setTranslateY=function(L){var $=this;L=$.adjustTranslateY(L);var h=$._66O;$._66O=L,$.fp(_f,h,L)},K.adjustTranslateX=function(B){return l(B)},K.adjustTranslateY=function(s){return l(s)},K.translate=function(x,E,T){this.setTranslate(this.tx()+x,this.ty()+E,T)},K.getLogicalPoint=function(G){var H=this;return Sk(G,this._canvas||H._view,H.tx(),H.ty())}},ms_dm:function(C){C.dm=function(q){return q?(this.setDataModel(q),void 0):this.getDataModel()},C.getDataModel=function(){return this._dataModel}},ms_lp:function(v){v.lp=function(m){return this.getLogicalPoint(m)}},ms_v:function(h){h._disabled=!1,h.setDisabled=function(H,I){var c=this,m=c._disabled;m!==H&&(m&&(Mf(c._63O),delete c._63O),H&&(Gl(c._view,c._63O=gd(I)),c.iv()),c._disabled=H,c.fp("disabled",m,H))},h.isDisabled=function(){return this._disabled},h.getDisabledDiv=function(){return this._63O},h.getView=function(){return this._view},h.addToDOM=function(){var j=this,M=j.getView(),C=M.style;X.body.appendChild(M),C.left="0",C.right="0",C.top="0",C.bottom="0",D.addEventListener("resize",function(){j.iv()},!1),j.iv()},h.getWidth=function(){return this._view.clientWidth},h.getHeight=function(){return this._view.clientHeight},h.setWidth=function(s){var d=this;d._view.style.width=s+Yo,d.iv(),d.fp&&d.fp(ld,R,s)},h.setHeight=function(z){var G=this;G._view.style.height=z+Yo,G.iv(),G.fp&&G.fp(vd,R,z)},h.setFocus=function(_){var w=this,z=w._currentEditor;return _&&z&&(z.getView&&(z=z.getView()),z.contains(_.target))?!1:(Zj(w._view),w.endEditing&&w.endEditing(),w.fireViewEvent("focus"),!0)},h.iv=function(L){this.invalidate(L)},h.invalidate=function(o){var D=this;D._68I||(D._68I=1,Jb(D.validate,D,R,o),D.onInvalidated&&D.onInvalidated(),D.fireViewEvent("invalidate"))},h.validate=function(){var p=this,j=p._view;if(p._68I&&(delete p._68I,j.parentNode))if(0===j.offsetWidth&&0===j.offsetHeight&&p._67I!==R)p._67I===t&&(p._67I=M.reinvalidateCount),p._67I>0?p._67I--:p._67I=R,p.iv();else{p.fireViewEvent("beginValidate"),p.validateImpl(),p.onValidated&&p.onValidated(),p.fireViewEvent("validate");var u=p._63O;u&&(j.lastChild!==u&&(Mf(u),Gl(j,u)),Se(u,0,0,p.getWidth(),p.getHeight())),Xh(p),sb(p)}},h.layout=function(P,d,z,H){1===arguments.length?Se(this,P):Se(this,P,d,z,H)},h.addViewListener=function(G,b,w){var u=this;u._67O||(u._67O=new Ii),u._67O.add(G,b,w)},h.removeViewListener=function(p,Q){this._67O.remove(p,Q)},h.fireViewEvent=function($){var Q=this;Q._67O&&(Bn($)&&($={kind:$}),Q._67O.fire($)),M.viewListener&&M.viewListener(Q,$)}},ms_tip:function(L){L.setToolTipEnabled=function(P){var g=this;P?b||g._13o||(g.enableToolTip(),g.fp("toolTipEnabled",!1,!0)):g._13o&&(g.disableToolTip(),g.fp("toolTipEnabled",!0,!1))},L.isToolTipEnabled=function(){return!!this._13o},L.enableToolTip=function(){var X=this;b||X._13o||(X._13o=function(x){var O=X.getToolTip(x);O!=R?M.toolTipContinual&&M.isToolTipShowing()?dd(x,O):(Bh(),Ln={timeout:e(Jd,al),e:x,info:O}):Bh()},X.getView().addEventListener(sh,X._13o,!1),X.getView().addEventListener("mouseleave",M.hideToolTip,!1))},L.disableToolTip=function(){var W=this;W._13o&&(W.getView().removeEventListener(sh,W._13o,!1),W.getView().removeEventListener("mouseleave",M.hideToolTip,!1),delete W._13o)},L.getToolTip=function(l){var b=this;if(b.getDataAt){var I=b.getDataAt(l);return I?I.getToolTip():R}return b.getValue?b.getValue():void 0}},_52o:function(B){B._zoom=1,B._29I=fc,B.zoomIn=function(c,Y){this.setZoom(this._zoom*oq,c,Y)},B.zoomOut=function(N,K){this.setZoom(this._zoom/oq,N,K)},B.zoomReset=function(X,e){this.setZoom(1,X,e)},B.scrollZoomIn=function(F){this.setZoom(this._zoom*ki,R,F)},B.scrollZoomOut=function(E){this.setZoom(this._zoom/ki,R,E)},B.pinchZoomIn=function(E){this.setZoom(this._zoom*Ok,R,E)},B.pinchZoomOut=function(v){this.setZoom(this._zoom/Ok,R,v)},B.adjustZoom=function(M){return bl>M?bl:M>Wm?Wm:M},B.getZoom=function(){return this._zoom},B.setZoom=function(s,d,M){var S=this;if(d=Gd(d)){S._14o&&S._14o.stop(!0);var V=S._zoom;d.action=function(T){S._96O(V+(s-V)*T,M)},d._37o=function(){delete S._zooming,delete S._14o,S.onZoomEnded()},S._zooming=1,S._14o=Gj(d)}else S._96O(s,M)},B._96O=function(f,m){var F=this;if(f=F.adjustZoom(f),f!==F._zoom){F.validate();var U=F._29I,u=F._zoom;0!==U.width&&0!==U.height&&(m=m?m:{x:U.x+U.width/2,y:U.y+U.height/2},F.tx((m.x-U.x)*u-m.x*f),F.ty((m.y-U.y)*u-m.y*f)),F._zoom=f,F.fp("zoom",u,f)}}}};Jn(M,{numberDigits:5,baseZIndex:t,isTouchable:b,devicePixelRatio:D.devicePixelRatio?D.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:z.disabledBackground,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Ji},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(A){return A*A},labelColor:co,labelSelectColor:ek,labelFont:(b?"15":"12")+"px arial, sans-serif",widgetIndent:b?30:20,widgetRowHeight:b?30:20,widgetHeaderHeight:b?32:22,widgetTitleHeight:b?34:24,scrollBarColor:yo,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:b?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:uc,intersectionLineLine:wp,isEnter:Ad,isEsc:Op,isDelete:lf,isSpace:gl,isLeft:fh,isUp:Aq,isRight:Kd,isDown:ed,getTarget:sk,isString:Bn,isNumber:kj,isBoolean:nj,isArray:dr,isSelectAll:Ye,isFunction:Cb,getPropertyValue:Vj,setPropertyValue:$p,addMethod:Jn,getVersion:function(){return"6.0.8"},appendToScreen:function(G){G=G.getView?G.getView():G,(X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement||X.body).appendChild(G)},toggleFullscreen:function(k){var v=k.getView();if(X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement)X.exitFullscreen?X.exitFullscreen():X.msExitFullscreen?X.msExitFullscreen():X.mozCancelFullScreen?X.mozCancelFullScreen():X.webkitExitFullscreen&&X.webkitExitFullscreen();else{var p=!0,N=v.style.left,O=v.style.top,z=v.style.width,R=v.style.height,U=v.style.background;U||(v.style.background="white"),v.requestFullscreen?v.requestFullscreen():v.msRequestFullscreen?v.msRequestFullscreen():v.mozRequestFullScreen?v.mozRequestFullScreen():v.webkitRequestFullscreen&&v.webkitRequestFullscreen();var b=setInterval(function(){if(v!==(X.fullscreenElement||X.mozFullScreenElement||X.webkitFullscreenElement||X.msFullscreenElement))clearInterval(b),v.style.left=N,v.style.top=O,v.style.width=z,v.style.height=R,v.style.background=U,k.iv();else{var G=M.getWindowInfo();(p||G.width!==k.getWidth()||G.height!==k.getHeight())&&(Se(k),p=!1)}},500)}},appendTimeStamp:function(c){return c+=c.indexOf("?")>=0?"&__ht__="+se():"?"+se()},setCompType:function(r,Q){Cb(Q)||zr(Q)?Hq[r]=Q:kp(r)},getCompType:function(x){return Hq[x]},getCompTypeMap:function(){return Hq},drawCompType:function(G,j,S,Q,s,I){G(j,S,Q,s,I)},numberListener:function(){var i={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(w){var W=w.keyCode;i[W]||65===W&&M.isCtrlDown(w)||86===W&&M.isCtrlDown(w)||67===W&&M.isCtrlDown(w)||W>=35&&39>=W||(w.shiftKey||48>W||W>57)&&(96>W||W>105)&&w.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(F){var Q=F.target.tagName;("DIV"===Q||"CANVAS"===Q)&&!(M.ignoreKeyCodes.indexOf(F.keyCode)>=0)&&("keydown"!==F.type||fh(F)||Kd(F)||Aq(F)||ed(F)||lf(F)||65===F.keyCode&&(F.metaKey||F.ctrlKey))&&(F.preventDefault(),F.preventManipulation&&F.preventManipulation())},getWindowInfo:function(){var R=X.documentElement,A=R&&(R.scrollLeft||R.scrollTop)?R:X.body;return{target:A,left:A.scrollLeft,top:A.scrollTop,width:D.innerWidth||A.clientWidth,height:D.innerHeight||A.clientHeight}},isDragging:function(){return!!Ji},isLeftButton:function(y){return b?!0:0===y.button},isInput:function(k){if(!k)return!1;var y=k.tagName;return"INPUT"===y||"TEXTAREA"===y||"SELECT"===y},getTouchCount:function(V){return b?V.touches.length:1},isDoubleClick:function(){var X={};return Cd=new Date,rg=Cd.getTime(),function(D){var y=(new Date).getTime(),l=D.button==R?"":D.button,Y=D.type+l,j=Y+"_isDoubleClick",Z=X[Y];if(Z||(Z=X[Y]={details:0,timeout:null,lastPoint:null,lastTime:y}),D[j]===t){var W=de(D);D[j]=Z.lastPoint&&Tr(Z.lastPoint,W)<=(b?20:1)&&y-Z.lastTime<500,Z.lastTime=y,Z.lastPoint=W,Z.details++,Z.timeout&&(A(Z.timeout),Z.timeout=null),Z.timeout=e(function(){this.details=0,this.timeout=null,this.lastPoint=null}.bind(Z),500)}return!!D[j]&&2===Z.details}}(),isShiftDown:function(N){return N?N.shiftKey:Tf["16"]},isCtrlDown:function(n){return n?V?n.metaKey:n.ctrlKey:V?Tf["91"]:Tf["17"]},getClientPoint:function(x){return b&&(x=Dk(x)),{x:x.clientX,y:x.clientY}},isMouseEvent:function(d){return d instanceof MouseEvent||0===d.type.indexOf("mouse")},getTargetElement:function(C){if(M.isMouseEvent(C)||!X.elementFromPoint)return C.target;var z=Un(C);return X.elementFromPoint(z.x,z.y)},getPagePoint:function(r){return b&&(r=Dk(r)),{x:r.pageX,y:r.pageY}},createObject:function(C,F){var h=new C;for(var u in F){var G=vj(u),g=F[u];h[G]?(h[G](g),"setToolTip"===G&&h.enableToolTip&&h.enableToolTip()):h[u]=g}return h},setImage:function(e,R,W,a){var K=arguments.length;4===K?Yd(e,a,R,W):2===K?Bn(R)?Yd(e,R):Hr[e]=R:1===K&&Yd(e,e)},getImage:function($,r,E){var q;if($==R)return R;if(zr($)?q=$:(q=Hr[$],$&&q===t&&(vb&&vb[$]||Yd($,$))),r&&q&&q.tagName){var A;A="override"===E?"colors_override":"override_rgb"===E?"colors_override_rgb":"override_a"===E?"colors_override_a":"colors",q[A]||(q[A]={__count__:0});var P=q[A][r];return P||(q[A].__count__>M.imageCacheThreshold&&(q[A]={__count__:0}),P=Nh(q,no(r),q.width,q.height,E),q[A][r]=P,q[A].__count__++),P}return q},getId:function(){var U=1;return function(){return++U}}(),callLater:function(S,o,n,u){var Q=function(){S.apply(o,n)};return u?e(Q,u):D.requestAnimationFrame(Q)},asyncEach:function(r,D,f){"function"!=typeof f&&(f=Function.prototype);var M=new Array(r.length),p=0,I=!1;r.forEach(function(C,g){D(C,function(C,S){return I?void 0:C?(I=!0,f(null)):(M[g]=S,p++,p===r.length?f(M):void 0)})})},xhrLoad:function(I,c,_){var e=!1;dr(I)||(e=!0,I=[I]),_=_||{},I.length;var S=_.sync;Yg(I,function(R,f){var O=new XMLHttpRequest;_.responseType?O.responseType=_.responseType:O.overrideMimeType(_.mimeType||"text/plain"),R=M.beforeLoadURL(R),R.data?f(null,R.data):(O.open("GET",encodeURI(R),!S),O.onload=function(E){200===this.status||0===this.status?f(null,E.target.response):f(!0)},O.onerror=function(){f(!0)},O.send(null))},function(A){"function"==typeof c&&c(e&&A?A[0]:A)})},clone:function(V){if(!V)return R;if(dr(V))return V.slice(0);if(_p(V))return new fo(V);if(zr(V)){var C,D={};for(C in V)D[C]=V[C];return D}return V},callWhenLoaded:function(H,V){V=V||100;var T=tc(H,V);Rl||(Rl={}),Rl[T]={tick:T,cb:H,delay:V}},beforeLoadURL:function(P){if(Rl){var r={};for(var d in Rl){var s=Rl[d];A(s.tick);var g=tc(s.cb,s.delay);r[g]={tick:g,delay:s.delay,cb:s.cb}}Rl=r}return M.convertURL?M.convertURL(P):P},convertURL:function(l){return l},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(I,X){if(I===X)return 0;if(I==R&&X!=R)return 1;if(I!=R&&X==R)return-1;if(I==R&&X==R)return 0;var G,C=typeof I,x=typeof X;return C===Yc&&x===Yc?G=I.localeCompare(X):C===ib&&x===ib&&(G=I-X),G===t&&(G=(""+I).localeCompare(""+X)),G>0?1:0>G?-1:0},getClassMap:function(){return Uj},getClass:function(H){if(Bn(H)){var I,Q=Uj[H];if(!Q){I=H.split("."),Q=D;for(var u=0;u<I.length;u++)Q=Q[I[u]];Uj[H]=Q}return Q}return H},def:function(g,z,W){var O,B,v,Y=function(){};if(Y.prototype=z.prototype,O=new Y,Bn(g)){if(Uj[g])throw"'"+g+"' already defined";v=Nc(g),O.getClassName=function(){return g}}else v=g;if(O.constructor=v,O.getClass=function(){return v},O.getSuperClass=function(){return z},W)for(B in W)qs[B]&&qs.hasOwnProperty(B)?qs[B](O,W):pr(O,W,B);v.prototype=O,v.superClass=z.prototype},startAnim:function(){var D=function(g){g.duration&&(g.startTime=se()),g.timeId=Jb(g.tick,R,R,g.interval)};return function(z){return z=Fm(z),z.easing=z.easing||M.animEasing,z.duration||z.frames||(z.duration=M.animDuration),z.t=0,z.duration?z.interval=0:(z.frame=0,z.interval=z.interval||10),z.tick=function(){if(z.duration){var u=(se()-z.startTime)/z.duration;u>1&&(u=1),z.t=u,z.action(z.easing(u),u),1===u?z.stop():z._isPaused||(z.timeId=Jb(z.tick))}else z.frame++,u=z.t=z.frame/z.frames,z.action(z.easing(u),u),z.frame<z.frames?z._isPaused||(z.timeId=Jb(z.tick,R,R,z.interval)):z.stop()},z.resume=function(){z._isPaused&&(delete z._isPaused,z.duration?z.t<1&&(z.startTime=se()-z.duration*z.t,z.timeId=Jb(z.tick)):z.frame<z.frames&&(z.timeId=Jb(z.tick,R,R,z.interval)))},z.pause=function(){z._isPaused=!0},z.stop=function(t){z.isRunning()&&(z.duration?z.t<1&&t&&(z.t=1,z.action(z.easing(1))):z.frame<z.frames&&t&&(z.frame=z.frames,z.action(z.easing(1))),z._37o&&z._37o(),z.finishFunc&&z.finishFunc(),xg(z.timeId,!z.duration),delete z.timeId)},z.isRunning=function(){return z.timeId!=R},z.delay?Jb(D,R,[z],z.delay):D(z),z}}(),getTextSize:function(){var V={},e=X?bg().getContext("2d"):R;return function(i,A){e.font=i?i:Ne;var W=V[e.font];return W||(W=2*e.measureText("e").width+4,V[e.font]=W),{width:e.measureText(A).width+4,height:W}}}(),drawText:function(W,G,q,c,E,y,J,k,B,Z){if(G!=R){var e=je(q,G),v={};v.y=Z&&Z!==Kf?Z===Id?y+e.height/2:y+k-e.height/2:y+k/2,v.x=B&&B!==Ai?B===Br?E+J-e.width/2:E+J/2:E+e.width/2,Aj(W,G,v,q,c)}},getDistance:function(l,f){var N=l.length;return f?3===N?Z(m(l[0]-f[0])+m(l[1]-f[1])+m(l[2]-f[2])):2===N?Z(m(l[0]-f[0])+m(l[1]-f[1])):l.z===t?Z(m(f.x-l.x)+m(f.y-l.y)):Z(m(f.x-l.x)+m(f.y-l.y)+m(f.z-l.z)):3===N?Z(m(l[0])+m(l[1])+m(l[2])):2===N?Z(m(l[0])+m(l[1])):void 0},brighter:function(V,r){return 0>r&&(r=-r),Fh(V,r?r:40)},darker:function(b,U){return U>0&&(U=-U),Fh(b,U?U:-40)},unionPoint:function(A,h){if(!A)return R;if(2===arguments.length)return A&&h?{x:j(A.x,h.x),y:j(A.y,h.y),width:Q(A.x-h.x),height:Q(A.y-h.y)}:R;var V=A;if(V._as&&(V=V._as),V.length===t)return R;var M=V.length;if(0>=M)return R;for(var S=1,D=V[0],Y={x:D.x,y:D.y,width:0,height:0};M>S;S++){D=V[S];var T=j(Y.x,D.x),a=I(Y.x+Y.width,D.x),e=j(Y.y,D.y),k=I(Y.y+Y.height,D.y);Y.x=T,Y.y=e,Y.width=a-T,Y.height=k-e}return Y},unionRect:function($,D){if($&&!D)return Fm($);if(!$&&D)return Fm(D);if($&&D){var V={x:j($.x,D.x),y:j($.y,D.y)};return V.width=I($.x+$.width,D.x+D.width)-V.x,V.height=I($.y+$.height,D.y+D.height)-V.y,V}return R},containsPoint:function(W,$){return!(!W||$.x<W.x||$.y<W.y||$.x>W.x+W.width||$.y>W.y+W.height)},containsRect:function(O,M){if(!O||!M)return!1;var x=M.x,F=M.y,V=M.width,R=M.height,h=O.width,i=O.height;if(0>(h|i|V|R))return!1;var r=O.x,N=O.y;if(r>x||N>F)return!1;if(h+=r,V+=x,x>=V){if(h>=r||V>h)return!1}else if(h>=r&&V>h)return!1;if(i+=N,R+=F,F>=R){if(i>=N||R>i)return!1}else if(i>=N&&R>i)return!1;return!0},intersectsRect:function(N,m){if(!N||!m)return!1;var b=m.width,i=m.height,o=N.width,t=N.height;if(0>=o||0>=t||0>=b||0>=i)return!1;var Q=m.x,F=m.y,O=N.x,Z=N.y;return o+=O,t+=Z,b+=Q,i+=F,o>Q&&t>F&&b>O&&i>Z},intersection:function(s,F){if(!s||!F)return R;var A=F.x,Z=F.y,H=s.x,Q=s.y,r=A,U=Z,C=H,y=Q;return r+=F.width,U+=F.height,C+=s.width,y+=s.height,H>A&&(A=H),Q>Z&&(Z=Q),r>C&&(r=C),U>y&&(U=y),r-=A,U-=Z,0>=r||0>=U?R:{x:A,y:Z,width:r,height:U}},grow:function(Y,K){Y.x-=K,Y.y-=K,Y.width=Y.width+2*K,Y.height=Y.height+2*K},getLogicalPoint:function(w,l,X,E,g,T){sq(w)?V?Tf["91"]=!0:Tf["17"]=!0:V?Tf["91"]=!1:Tf["17"]=!1,Tf["16"]=Ng(w)?!0:!1;var c=l.getBoundingClientRect();return w=b?Dk(w):w,{x:(w.clientX-c.left+l.scrollLeft-(X||0))/(g||1),y:(w.clientY-c.top+l.scrollTop-(E||0))/(T||1)}},removeHTML:function(){var L;return function(G){return G&&G.parentNode?L===G?!0:(L=G,G.parentNode.removeChild(G),L=R,!0):!1}}(),getToolTipDiv:function(){if(!xr){xr=so(),jq=so();var U=xr.style;M.baseZIndex!=R&&(U.zIndex=h(M.baseZIndex)+3+""),U.whiteSpace="nowrap",U.color=M.toolTipLabelColor,U.background=M.toolTipBackground,U.font=M.toolTipLabelFont,U.padding="5px",U.boxShadow="0px 0px 3px "+M.toolTipShadowColor}return xr},isToolTipShowing:function(){return xr&&xr.parentNode?!0:jq&&jq.parentNode?!0:!1},hideToolTip:function(){Mf(xr),Mf(jq),dk()},showToolTip:function(S,y){if(!S||y==R)return Bh(),void 0;M.getToolTipDiv();var C,W;if(y.html?(y=y.html,C=jq,Mf(xr)):(C=xr,Mf(jq)),W=C.style,C.innerHTML=y,C.parentNode||K.Default.appendToScreen(C),S.target){S=Un(S);var w=Fc(),v=S.x,g=S.y,Y=b?60:12;if(b){var A=C.getBoundingClientRect();W.left=v-A.width/2+Yo,W.top=g-A.height-Y<w.top?g+Y+Yo:g-A.height-Y+Yo}else{W.left=v+Y+Yo,W.top=g+Y+Yo;var A=C.getBoundingClientRect();A.left+A.width>w.width&&(W.left=v-Y-A.width+Yo),A.top+A.height>w.height&&(W.top=g-Y-A.height+Yo),A.left<0&&(W.left=v+Y+Yo),A.top<0&&(W.top=g+Y+Yo)}}else W.left=S.x+Yo,W.top=S.y+Yo;dk()},startDragging:function(P,O){P!==Ji&&(Ji?b?Ji.handleWindowTouchEnd(O):Ji.handleWindowMouseUp(O):b?(D.addEventListener(rf,Ce,!1),D.addEventListener(Qp,ul,!1)):(D.addEventListener(sh,oj,!1),D.addEventListener(Wi,oc,!1)),Ji=P)},getImageMap:function(){return Hr},toBoundaries:function(k,v,I,s){var r=[];return Do(k,v,I,s).forEach(function(_){var d=[];_.forEach(function(Z){d.push(Z.x,Z.y)}),r.push(d)}),r},getCurrentKeyCodeMap:function(){return Tf},drawCenterImage:function(I,F,W,D,h,E,S,a){var p=ag(F,h,E),w=Eh(F,h,E);Mn(I,F,l(W-p/2),l(D-w/2),p,w,h,E,S,a)},drawStretchImage:function(v,W,K,V,k,f,D,w,L,T,x,$){var U,d=ag(W,w,L,f),g=Eh(W,w,L,D);if("uniform"===K?(U=j(f/d,D/g),d*=U,g*=U,V+=l((f-d)/2),k+=l((D-g)/2),f=d,D=g):"centerUniform"===K&&((d>f||g>D)&&(U=j(f/d,D/g),d*=U,g*=U),V+=l((f-d)/2),k+=l((D-g)/2),f=d,D=g),"center"===K){var e=x!==!1&&(d>f||g>D);e&&(v.save(),v.beginPath(),v.rect(V,k,f,D),v.clip()),Mn(v,W,V+f/2-d/2,k+D/2-g/2,d,g,w,L,T,$),e&&v.restore()}else Mn(v,W,V,k,f,D,w,L,T,$)},toCanvas:function(Y,d,s,X,P,u,B,I,Q){Y=rd(Y,B),d=d||ag(Y,P),s=s||Eh(Y,P);var t=bg(),V=mm(t);return I?(ds(t,d,s,I),V.scale(I,I)):ds(t,d,s,1),Ti(V,Y,X,0,0,d,s,P,u,B,Q),V.restore(),t},createElement:function($,Z,C,f){var U=X.createElement($);return Co(U,Z||z.widgetBorder,2),U.style.font=C?C:Ne,f!=R&&(U.value=f),M.onElementCreated&&M.onElementCreated(U),U},containedInView:function(j,J){var y=El(J).getBoundingClientRect();return Ul({x:y.left,y:y.top,width:y.width,height:y.height},de(j))},isIsolating:function(){return lo},setIsolating:function(T){lo=T},getMSMap:function(){return qs},stringify:function(X,p){var I=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var i=JSON.stringify(X,function(m,c){return"function"==typeof c?"__ht__"+(c.__ht__||c.toString()):kj(c)?Lp(c):c},p==R?2:p);return Date.prototype.toJSON=I,i},parse:function(P){return Bn(P)?JSON.parse(P,function(k,f){if(Bn(f)){if("__ht__function"==f.substr(0,14)){var a=f.indexOf("{")+1,b=f.lastIndexOf("}"),$=f.indexOf("(")+1,x=f.indexOf(")");if(a&&b&&$&&x){var g=new Function(f.substring($,x),f.substring(a,b));return g.__ht__=f.substr(6),g}}if("__ht__date"==f.substr(0,10))return new Date(h(f.substr(10)))}return f}):P},loadJS:function(n,b){b&&n.push(b);var L=n.shift();if(dr(L))n=L.contact(n),M.loadJS(n);else if(Cb(L))L(),M.loadJS(n);else if(Bn(L)){var c=X.createElement("script");c.onload=function(){M.loadJS(n)},c.setAttribute("src",L),X.getElementsByTagName("head")[0].appendChild(c)}else n.length&&M.loadJS(n)},toRoundedCorner:function(y,p){var c=y.size();if(0>=p)return{points:y};var b,A=new fo,x=new fo,X=y.get(0);A.add(X),x.add(1);for(var R=1;c>R;R++)if(c>R+1){var S=y.get(R),O=y.get(R+1),t=X.x,G=X.y,W=S.x,J=S.y,r=J-G,Q=W-t,B=f(r,Q);b=j(.99*Tr(X,S),p),A.add({x:W-b*_(B),y:J-b*P(B)}),A.add(S),t=S.x,G=S.y,W=O.x,J=O.y,r=J-G,Q=W-t,B=f(r,Q),b=j(.99*Tr(S,O),p),X={x:t+b*_(B),y:G+b*P(B)},A.add(X),x.addAll([2,3])
}else A.add(y.get(R)),x.add(2);return{points:A,segments:x}},toColorData:pq,setCanvas:ds,createDiv:so,createDisabledDiv:gd,createView:Qm,createCanvas:bg,appendChild:Gl,initContext:mm,checkLoadingImage:Xh,translateAndScale:vg,layout:Se,getPosition:mp,drawPoints:$h,drawRoundRect:jd,drawBorder:un,setFocus:Zj,getter:Sd,setter:vj,isEmptyObject:Pi},!0),Jn(T,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:!0},!0);var nf=M.disabledOpacity,al=M.toolTipDelay,Md=M.devicePixelRatio,Bi=M.autoMakeVisible,Mp=M.autoHideScrollBar,Mc=M.imageGradient,dd=M.showToolTip,Bh=M.hideToolTip,Gh=M.dashPattern,Le=M.lineCap,bk=M.lineJoin,Iq=M.labelColor,qe=M.labelSelectColor,Ne=M.labelFont,um=M.widgetIndent,bj=M.widgetRowHeight,qb=M.widgetHeaderHeight,np=M.widgetTitleHeight,Qe=M.scrollBarColor,Re=M.scrollBarSize,Xe=M.scrollBarTimeout,fe=M.scrollBarMinLength,mq=M.scrollBarInteractiveSize,oq=M.zoomIncrement,ki=M.scrollZoomIncrement,Ok=M.pinchZoomIncrement,Wm=M.zoomMax,bl=M.zoomMin,ue=M.createObject,Ch=M.preventDefault,Ij=M.setImage,rd=M.getImage,Zq=M.drawCenterImage,Ti=M.drawStretchImage,zf=M.getId,Jb=M.callLater,Yg=M.asyncEach,An=(M.xhrLoad,M.sortFunc),Fm=M.clone,Nc=M.getClass,Gj=M.startAnim,Kc=M.brighter,he=M.darker,ji=M.drawText,je=M.getTextSize,fq=M.isLeftButton,Ag=M.getTouchCount,vs=M.isDoubleClick,Ng=M.isShiftDown,sq=M.isCtrlDown,de=M.getClientPoint,Un=M.getPagePoint,Tr=M.getDistance,Ef=M.unionPoint,Eq=M.unionRect,Ul=M.containsPoint,dl=M.containsRect,Bd=M.intersectsRect,sl=M.intersection,Fc=M.getWindowInfo,yl=M.grow,Sk=M.getLogicalPoint,ws=M.startDragging,Mf=M.removeHTML,Wp=M.createElement,Ac=M.segmentResolution,bo=M.shapeResolution,ri=M.shapeSide,jl=M.def,Qr=function(J,t,R){jl(d+"."+J,t,R)},uh=function(m,s){m.childNodes.forEach(function(x){s(x),uh(x,s)})};Jn(M,{toolTipLabelColor:Iq,toolTipLabelFont:Ne,toolTipBackground:z.toolTipBackground,toolTipShadowColor:yo,setDevicePixelRatio:function(r){Md=M.devicePixelRatio="number"==typeof r?r:D.devicePixelRatio,uh(X.body,function(Q){var i=Q._ht;i&&i._canvas&&(ds(i._canvas,i.getWidth(),i.getHeight()),i.redraw?i.redraw():i.iv())})}},!0);var Hj=1e-6,Dn="undefined"!=typeof Uint16Array?Uint16Array:Array,mj="undefined"!=typeof Float32Array?Float32Array:Array,ad=function(k,O,P){var l=[k[0]-O[0],k[1]-O[1],k[2]-O[2]];if(P){var C=Tr(l);C>0&&(l[0]/=C,l[1]/=C,l[2]/=C)}return l},ir=function(n){return[-n[0],-n[1],-n[2]]},dj=function(P,B){return 3===P.length?P[0]*B[0]+P[1]*B[1]+P[2]*B[2]:P[0]*B[0]+P[1]*B[1]},uo=function(){var w=new mj(16);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},yr=uo(),Kj=function(R){var I=new mj(16);return I[0]=R[0],I[1]=R[1],I[2]=R[2],I[3]=R[3],I[4]=R[4],I[5]=R[5],I[6]=R[6],I[7]=R[7],I[8]=R[8],I[9]=R[9],I[10]=R[10],I[11]=R[11],I[12]=R[12],I[13]=R[13],I[14]=R[14],I[15]=R[15],I},Gm=function(T,j){return T[0]=j[0],T[1]=j[1],T[2]=j[2],T[3]=j[3],T[4]=j[4],T[5]=j[5],T[6]=j[6],T[7]=j[7],T[8]=j[8],T[9]=j[9],T[10]=j[10],T[11]=j[11],T[12]=j[12],T[13]=j[13],T[14]=j[14],T[15]=j[15],T},Pr=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},xl=function($,e){var v=$[0],K=$[1],c=$[2];return $[0]=e[0]*v+e[4]*K+e[8]*c+e[12],$[1]=e[1]*v+e[5]*K+e[9]*c+e[13],$[2]=e[2]*v+e[6]*K+e[10]*c+e[14],$},wm=function(M,O){var $=M[0],n=M[1],U=M[2],x=M[3];return M[0]=O[0]*$+O[4]*n+O[8]*U+O[12]*x,M[1]=O[1]*$+O[5]*n+O[9]*U+O[13]*x,M[2]=O[2]*$+O[6]*n+O[10]*U+O[14]*x,M[3]=O[3]*$+O[7]*n+O[11]*U+O[15]*x,M},Sb=function(){var S,x,g,d,s=ng(nr[1]+nr[7]),v=ng(nr[0]+nr[3]-nr[10]),e=ng(nr[8]+2),N=function(){return x=g.charAt(S),S+=1,x},f=function(){var T="";if(x===e)for(;N();){if(x===e)return N(),T;T+=x}else N()},K=function(){for(;x&&" ">=x;)N()},l=function(){var L,u={};if(x===s){if(N(),K(),x===v)return N(),u;for(;x;){if(L=f(),K(),N(),u[L]=d(),K(),x===v)return N(),u;N(),K()}}};return d=function(){switch(K(),x){case s:return l();default:return f()}},function(l){if(r={},l){var n;if(g=l,S=0,x=" ",n=d(),K(),!x)return n}}}(),bp=function(F,n){if(n){var A=P(n),Z=_(n),j=F[4],q=F[5],B=F[6],Y=F[7],C=F[8],d=F[9],w=F[10],e=F[11];F[4]=j*Z+C*A,F[5]=q*Z+d*A,F[6]=B*Z+w*A,F[7]=Y*Z+e*A,F[8]=C*Z-j*A,F[9]=d*Z-q*A,F[10]=w*Z-B*A,F[11]=e*Z-Y*A}},sc=function(L,O){if(O){var E=P(O),M=_(O),d=L[0],K=L[1],S=L[2],X=L[3],k=L[8],u=L[9],A=L[10],B=L[11];L[0]=d*M-k*E,L[1]=K*M-u*E,L[2]=S*M-A*E,L[3]=X*M-B*E,L[8]=d*E+k*M,L[9]=K*E+u*M,L[10]=S*E+A*M,L[11]=X*E+B*M}},pg=function(Q,U){if(U){var t=P(U),J=_(U),h=Q[0],e=Q[1],N=Q[2],m=Q[3],n=Q[4],d=Q[5],a=Q[6],M=Q[7];Q[0]=h*J+n*t,Q[1]=e*J+d*t,Q[2]=N*J+a*t,Q[3]=m*J+M*t,Q[4]=n*J-h*t,Q[5]=d*J-e*t,Q[6]=a*J-N*t,Q[7]=M*J-m*t}},gj=function(F,Z,D){return td(R,D===!1?R:F.s3(),F.r3(),F.getRotationMode(),F.p3(),R,Z)},td=function(M,B,q,R,L,H,m){return H||(H=uo()),L&&ud(H,L),Kk(H,q,R),m&&le(H,H,m),B&&ni(H,B),M&&le(H,H,M),H},Sc=function(Z,I,L){I=h(I),L=h(L);var D=this;D.g=Z,D._84O=I,D._85O=L,D._70I=!0,D.F=0,D._83O=I+L,D.pen={x:0,y:0}},Fp="lineDashOffset",is="setLineDash",og=function(p){for(var h in p)1===h.length&&(Fp=p[h]);return h?1:0},Wh=function(Z,i,s){return ao(i)?Z:Z[is]?(Z[is](i),s&&(Z.lineDashOffset=s),Z):new Sc(Z,i[0],i.length>1?i[1]:i[0])},Mi=function(S,k){!ao(k)&&S[is]&&(S[is](Vq),S.lineDashOffset=0)};if(jl(Sc,v,{_69I:6,moveTo:function(D,k){var h=this,T=h.pen;T.x=D,T.y=k,h.g.moveTo(D,k),h.start||(h.start={x:D,y:k})},lineTo:function(k,p){var T=this,o=T.pen,y=k-o.x,S=p-o.y,m=f(S,y),K=_(m),W=P(m),V=T._23O(o.x,o.y,k,p),x=T._85O,Q=T._84O,j=T._83O;if(T.F){if(T.F>V)return T._70I?T._72I(k,p):T.moveTo(k,p),T.F-=V,void 0;if(T._70I?T._72I(o.x+K*T.F,o.y+W*T.F):T.moveTo(o.x+K*T.F,o.y+W*T.F),V-=T.F,T.F=0,T._70I=!T._70I,!V)return}var $=Y(V/j);if($){for(var e=K*Q,t=W*Q,n=K*x,I=W*x,F=0;$>F;F++)T._70I?(T._72I(o.x+e,o.y+t),T.moveTo(o.x+n,o.y+I)):(T.moveTo(o.x+n,o.y+I),T._72I(o.x+e,o.y+t));V-=j*$}T._70I?V>Q?(T._72I(o.x+K*Q,o.y+W*Q),T.moveTo(k,p),T.F=x-(V-Q),T._70I=!1):(T._72I(k,p),V===Q?(T.F=0,T._70I=!T._70I):(T.F=Q-V,T.moveTo(k,p))):V>x?(T.moveTo(o.x+K*x,o.y+W*x),T._72I(k,p),T.F=Q-(V-x),T._70I=!0):(T.moveTo(k,p),V===x?(T.F=0,T._70I=!T._70I):T.F=x-V)},quadraticCurveTo:function(I,U,h,Q){var A,D=this,F=D.pen,X=F.x,V=F.y,K=D._22O(X,V,I,U,h,Q),G=0,C=0,J=D._85O,c=D._84O;if(D.F){if(D.F>K)return D._70I?D._71I(I,U,h,Q):D.moveTo(h,Q),D.F-=K,void 0;if(G=D.F/K,A=D._20O(X,V,I,U,h,Q,G),D._70I?D._71I(A[2],A[3],A[4],A[5]):D.moveTo(A[4],A[5]),D.F=0,D._70I=!D._70I,!K)return}var n=K-K*G,M=Y(n/D._83O),e=c/K,H=J/K;if(M)for(var p=0;M>p;p++)D._70I?(C=G+e,A=D._21O(X,V,I,U,h,Q,G,C),D._71I(A[2],A[3],A[4],A[5]),G=C,C=G+H,A=D._21O(X,V,I,U,h,Q,G,C),D.moveTo(A[4],A[5])):(C=G+H,A=D._21O(X,V,I,U,h,Q,G,C),D.moveTo(A[4],A[5]),G=C,C=G+e,A=D._21O(X,V,I,U,h,Q,G,C),D._71I(A[2],A[3],A[4],A[5])),G=C;n=K-K*G,D._70I?n>c?(C=G+e,A=D._21O(X,V,I,U,h,Q,G,C),D._71I(A[2],A[3],A[4],A[5]),D.moveTo(h,Q),D.F=J-(n-c),D._70I=!1):(A=D._19O(X,V,I,U,h,Q,G),D._71I(A[2],A[3],A[4],A[5]),K===c?(D.F=0,D._70I=!D._70I):(D.F=c-n,D.moveTo(h,Q))):n>J?(C=G+H,A=D._21O(X,V,I,U,h,Q,G,C),D.moveTo(A[4],A[5]),A=D._19O(X,V,I,U,h,Q,C),D._71I(A[2],A[3],A[4],A[5]),D.F=c-(n-J),D._70I=!0):(D.moveTo(h,Q),n===J?(D.F=0,D._70I=!D._70I):D.F=J-n)},bezierCurveTo:function(){var C=arguments;this.pen={x:C[4],y:C[5]},this.g.bezierCurveTo(C[0],C[1],C[2],C[3],C[4],C[5])},arc:function(x,O,U,F,E,w){w||(F=-F,E=-E),yf(this,x,O,F,E-F,U,U,!1)},rect:function(J,c,f,I){var w=this;w.pen={x:J,y:c},w.moveTo(J,c),w.lineTo(J,c+I),w.lineTo(J+f,c+I),w.lineTo(J+f,c),w.lineTo(J,c)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(j,r,s,x){var A=s-j,t=x-r;return Z(A*A+t*t)},_22O:function(r,P,Z,u,t,n,W){for(var X,i,m,A,p,y,f,o=0,j=r,$=P,E=W>0?W:this._69I,B=1;E>=B;B++)m=B/E,A=1-m,p=A*A,y=2*m*A,f=m*m,X=p*r+y*Z+f*t,i=p*P+y*u+f*n,o+=this._23O(j,$,X,i),j=X,$=i;return o},_21O:function(n,b,e,M,v,s,c,A){var o=this;if(0===c)return o._20O(n,b,e,M,v,s,A);if(1===A)return o._19O(n,b,e,M,v,s,c);var S=o._20O(n,b,e,M,v,s,A);return S.push(c/A),o._19O.apply(o,S)},_20O:function(n,R,E,y,T,b,U){if(1!==U){var V=E+(T-E)*U,o=y+(b-y)*U;E=n+(E-n)*U,y=R+(y-R)*U,T=E+(V-E)*U,b=y+(o-y)*U}return[n,R,E,y,T,b]},_19O:function(R,U,A,E,v,L,o){if(1!==o){var j=R+(A-R)*o,P=U+(E-U)*o;A+=(v-A)*o,E+=(L-E)*o,R=j+(A-j)*o,U=P+(E-P)*o}return[R,U,A,E,v,L]},_72I:function(e,w){var v=this.pen;(e!==v.x||w!==v.y)&&(v.x=e,v.y=w,this.g.lineTo(e,w))},_71I:function(o,B,W,f){var g=this.pen;(o!==W||B!==f||W!==g.x||f!==g.y)&&(g.x=W,g.y=f,this.g.quadraticCurveTo(o,B,W,f))}}),x&&J){var ac=J.toString();O=ac.indexOf(nm.substr(0,2))>0&&ac.indexOf(Id+Id.substr(1,1))>1?!0:!1}var _c=R,sm=R,sb=function(y){_c&&!y._72O&&(sm||(sm={}),sm[y._72O=zf()]=y)},kp=function(Q,j){if(j||(j=Q),j&&(_c||(_c={}),!_c[Q])){var V=new XMLHttpRequest;if(_c[j]={request:V,url:j},V.overrideMimeType("text/plain"),j=M.beforeLoadURL(j),j.data){var Z=M.parse(j.data);xb(Q,Z),M.handleCompTypeLoaded(Q,Z)}else V.open("GET",encodeURI(j),!0),V.onload=function(K){if(200===this.status||0===this.status){var p=M.parse(K.target.response);xb(Q,p),M.handleCompTypeLoaded(Q,p)}else xb(Q,R)},V.onerror=function(){xb(Q,R)},V.send(null)}},xb=function(P,W){if(Hq[P]=W,delete _c[P],Pi(_c)&&(_c=R,sm)){for(var U in sm){var J=sm[U];J.invalidateAll&&J.invalidateAll(t,"compTypeLoaded",P),J.redraw&&J.redraw(),J.iv(),delete J._72O}sm=R}if(W&&sm)for(var U in sm){var J=sm[U];J.invalidateAll&&J.invalidateAll(t,"compTypeLoading",P),J.redraw&&J.redraw(),J.iv()}},cs=z.chart,Or=M.compStack=[],Tl=/^style@/,Wo=/^attr@/,wl=/^field@/,Bo={x:.5,y:.5},ag=function(d,z,n,s){if(!d)return 0;if(d.fitSize&&s)return s;var u=Sl(d.width,z,n);return null==u?20:u},Eh=function(l,V,X,g){if(!l)return 0;if(l.fitSize&&g)return g;var j=Sl(l.height,V,X);return null==j?20:j},Sl=function(V,m,i){if(!V||!V.func)return V;var r,I=V.func,D=V.value;return r=Cb(I)?i&&i.vectorDataBindingDisabled&&!V.isSafeFunc?D:I(m,i):m instanceof Gr?Wo.test(I)?m.a(I.slice(5)):Tl.test(I)?m.s(I.slice(6)):wl.test(I)?m[I.slice(6)]:m[I]?m[I](i):D:D,D!==t&&r==R?D:r},Mn=M.drawImage=function(){var f,G,l,Z,V,g,i=function(y,M){y.getValue&&y.getValue.compType===M||(y.getValue=function(D){var s=S(y,D);if(s===t&&M.properties){var P=M.properties[D];P&&(s=P.defaultValue)}return s},y.getValue.compType=M)},S=function(p,a,M){var i=p[a];return i&&i.func?(i=Sl(i,G,l),M&&(i=M(i))):M&&(i=p[a]=M(i)),i},e=function(q,t){var E;if(E=t?S(q,t):q,V&&E){if("override"===g)return V;if("override_rgb"===g){var x=no(V);return E=pq(E),"rgba("+Y(255*x[0])+","+Y(255*x[1])+","+Y(255*x[2])+","+E[3]/255+")"}if("override_a"===g){var x=no(V);return E=pq(E),"rgba("+E[0]+","+E[1]+","+E[2]+","+x[3]+")"}var x=no(V);return E=pq(E),"rgba("+Y(E[0]*x[0])+","+Y(E[1]*x[1])+","+Y(E[2]*x[2])+","+E[3]/255*x[3]+")"}return E},r=function(G){if(dr(G)){for(var A=new fo,c=G.length,n=0;c>n;n+=2)A.add({x:G[n],y:G[n+1]});G=A}return G},T=function($){var l=S($,"anchorX"),A=S($,"anchorY");if(l!==t||A!==t)return{x:l===t?Bo.x:l,y:A===t?Bo.y:A};var o=S($,"type"),g=S($,"name");if("image"!==o||!g)return Bo;var U=rd(g);return U&&U.anchorX&&U.anchorY?{x:U.anchorX,y:U.anchorY}:Bo},K=function(G,w){var M=S(G,ch),F=T(G);if(dr(M)){var s=M.length,y=S(G,"relative"),n=w.width,W=w.height;if(4===s)M={x:M[0],y:M[1],width:M[2],height:M[3]},y?(M.x*=n,M.y*=W,M.width*=n,M.height*=W):w.fitSize&&(M.x*=w.widthScale,M.width*=w.widthScale,M.y*=w.heightScale,M.height*=w.heightScale);else if(3===s){var N=M[0];M={width:M[1],height:M[2]},y?(M.width*=n,M.height*=W):w.fitSize&&(M.width*=w.widthScale,M.height*=w.heightScale),"object"==typeof N?N.length&&(N={x:N[0],y:N[1]}):N=mp(N,w,M),M.x=N.x-M.width*F.x,M.y=N.y-M.height*F.y}var j=S(G,"offsetX");j&&(w.fitSize&&(j*=w.widthScale),M.x+=j),j=S(G,"offsetY"),j&&(w.fitSize&&(j*=w.heightScale),M.y+=j)}return M},Q=function(D){return dr(D)?new fo(D):D},q=function(c,X,M,F,s,m,U){s===t&&(s=1),m===t&&(m=1);var j=S(c,"clipPercentage"),Y=Tm(M,X);if(Y&&!F&&1===s&&1===m&&!(1>j))return!1;U=U||Bo;var B=X.x+X.width*U.x,I=X.y+X.height*U.y,A=M.x+M.width*U.x,h=M.y+M.height*U.y;if(f.save(),Lf(f,B,I),Xg(f,F),ol(f,s*(X.width/M.width),m*(X.height/M.height)),Lf(f,-A,-h),1>j){0>j&&(j=0);var i=wg(M,S(c,"clipDirection"),j);f.beginPath(),f.rect(i.x,i.y,i.width,i.height),f.clip()}return!0},n=function(){f.restore()},X=function(v,g,i){var r=S(v,"path"),O=S(v,Um),E=S(v,"scaleX"),z=S(v,"scaleY"),Y=T(v),Q=R,p=or(null,r);if(i||(i=v.unionRect,i||(i=Ef(p),v.path.func||(v.unionRect=i)),Q=i),i){Q||(Q=v.unionRect,Q||(Q=Ef(p),v.path.func||(v.unionRect=Q)));var H=q(v,i,Q,O,E,z,Y),y=S(v,"borderPattern"),B=Wh(f,y),u=e(v,"background"),P=e(v,"borderColor"),k=S(v,"borderWidth"),K=S(v,"gradient"),X=e(v,"gradientColor"),G=S(v,"border3d"),x=S(v,"border3dColor"),h=S(v,"border3dAccuracy"),F=f.lineJoin,m=f.lineCap;if(f.lineJoin=S(v,"borderJoin")||bk,f.lineCap=S(v,"borderCap")||Le,u?(qg(f,u,K,X,Q),or(f,r),f.fill(),B!==f&&or(f,r)):or(f,r),k&&P){var I=S(v,"borderWidthAbsolute");I&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=k,f.strokeStyle=P,f.stroke(),I&&f.restore(),G&&vc(f,P,x,k,Z,h)}if(Mi(f,y),S(v,"dash")){var V=S(v,"dashWidth")||k;if(V>0){y=S(v,"dashPattern")||Gh;var B=Wh(f,y,S(v,"dashOffset")),$=e(v,"dashColor")||e(jp);B!==f&&or(f,r),f.strokeStyle=$,f.lineWidth=V,f.stroke(),S(v,"dash3d")&&vc(f,$,e(v,"dash3dColor"),V,Z,S(v,"dash3dAccuracy")),Mi(f,y)}}g===ch&&Sq(f,u,S(v,"depth"),Q),f.lineJoin=F,f.lineCap=m,H&&n()}},A=function(b,t,N,C){var h=S(b,tg,r),X=S(b,Um),m=T(b);if(h&&C.fitSize){var i=Math.abs(Math.cos(X))<.001,j=new fo,O=Ef(h),y=C.widthScale,U=C.heightScale,I=O.x+m.x*O.width,z=O.y+m.y*O.height,u=I*y,P=z*U;h.each(function(c){var L=c.x-I,N=c.y-z;j.add({x:u+L*(i?U:y),y:P+N*(i?y:U)})}),h=j,b.unionRect=null}var v=S(b,"scaleX"),p=S(b,"scaleY"),L=t===kr,c=R;if(!N&&L&&(N=b.unionRect,N||(N=Ef(h),b.points.func||(b.unionRect=N)),c=N),N){L?c||(c=b.unionRect,c||(c=Ef(h),b.points.func||(b.unionRect=c))):c=N;var K,M,D,Y,s=q(b,N,c,X,v,p,m),J=S(b,"borderPattern"),x=Wh(f,J),A=e(b,"background"),H=rd(S(b,"repeatImage"),V,g),d=S(b,"gradientPack"),W=e(b,"borderColor"),B=S(b,"borderWidth"),w=S(b,"segments",Q),E=S(b,"gradient"),F=e(b,"gradientColor"),o=S(b,"border3d"),$=S(b,"border3dColor"),k=S(b,"border3dAccuracy"),a=S(b,"closePath"),_=S(b,"fillRule")||"nonzero",Kg=f.lineJoin,vf=f.lineCap;if(f.lineJoin=S(b,"borderJoin")||bk,f.lineCap=S(b,"borderCap")||Le,L)if(A||H||d){var Xm=S(b,"fillClipPercentage");if(1>Xm){0>Xm&&(Xm=0);var xq=wg(c,S(b,"fillClipDirection"),Xm);f.save(),f.beginPath(),f.rect(xq.x,xq.y,xq.width,xq.height),f.clip()}if($h(f,h,w,a),d)Zb(f,d);else if(H){var Pr=f,mg=V,ck=g;Df(f,H,V,g,G,l),f=Pr,V=mg,g=ck}else{var Pr=f;qg(f,A,E,F,c),f=Pr}f.fill(_),1>Xm&&f.restore(),d&&f.restore(),x!==f&&$h(x,h,w,a)}else $h(x,h,w,a);else if("roundRect"===t?K=S(b,"cornerRadius"):"polygon"===t?K=S(b,"polygonSide"):"arc"===t&&(K=S(b,"arcFrom"),M=S(b,"arcTo"),D=S(b,"arcClose"),Y=S(b,"arcOval")),A||H||d){var Xm=S(b,"fillClipPercentage");if(1>Xm){0>Xm&&(Xm=0);var xq=wg(c,S(b,"fillClipDirection"),Xm);f.save(),f.beginPath(),f.rect(xq.x,xq.y,xq.width,xq.height),f.clip()}if(pc(f,t,c,K,M,D,Y),d)Zb(f,d);else if(H){var Pr=f,mg=V,ck=g;Df(f,H,V,g,G,l),f=Pr,V=mg,g=ck}else qg(f,A,E,F,c);f.fill(_),1>Xm&&f.restore(),d&&f.restore(),f!==x&&pc(x,t,c,K,M,D,Y)}else pc(x,t,c,K,M,D,Y);if(B&&W){var Tc=S(b,"borderWidthAbsolute");Tc&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=B,f.strokeStyle=W,f.stroke(),Tc&&f.restore(),o&&vc(f,W,$,B,Z,k)}if(Mi(f,J),S(b,"dash")){var Io=S(b,"dashWidth")||B;if(Io>0){J=S(b,"dashPattern")||Gh;var x=Wh(f,J,S(b,"dashOffset")),Fr=e(b,"dashColor")||e(jp);x!==f&&(L?$h(x,h,w,a):pc(x,t,c,K,M,D,Y)),f.strokeStyle=Fr,f.lineWidth=Io,f.stroke(),S(b,"dash3d")&&vc(f,Fr,e(b,"dash3dColor"),Io,Z,S(b,"dash3dAccuracy")),Mi(f,J)}}t===ch&&Sq(f,A,S(b,"depth"),c),f.lineJoin=Kg,f.lineCap=vf,s&&n()}},O=function(j,$){var X=V,b=g,v=V||S(j,ho),A=g||S(j,"blendMode"),k=rd(S(j,"name"),v,A);k&&(Ti(f,k,S(j,"stretch"),$.x,$.y,$.width,$.height,G,l,v,null,A),V=X,g=b)},d=function(F,c){var K=S(F,"text");K!=R&&ji(f,K,S(F,"font"),e(F,ho),c.x,c.y,c.width,c.height,S(F,"align"),S(F,"vAlign"))},p=function(J,g){un(f,e(J,ho),g.x,g.y,g.width,g.height,S(J,"width"))},N=function(W,Z){var E=S(W,Ir),r=0;if(E&&(E.forEach(function(g){r+=g}),r>0)){for(var p=S(W,"colors")||cs,F=S(W,"startAngle")||0,T=S(W,"hollow"),y=S(W,zj),Q=S(W,Qq),h=S(W,ub),g=y?new fo:R,w=Z.x,i=Z.y,$=Z.width,l=Z.height,I=w+$/2,v=i+l/2,A=j($,l)/2,s=0,k=0;k<E.length;k++){var H=E[k],X=B*H/r,t=F+X;if(f.fillStyle=p[s++],s===p.length&&(s=0),f.beginPath(),T){var b=I+_(F)*A/2,D=v+P(F)*A/2,K=I+_(t)*A,u=v+P(t)*A;f.moveTo(b,D),f.arc(I,v,A/2,F,t,!1),f.lineTo(K,u),f.arc(I,v,A,t,F,!0)}else f.moveTo(I,v),f.arc(I,v,A,t,F,!0);g&&(X=(F+t)/2,g.add({text:Cb(y)?y(H,k,r,G):H,x:I+.75*_(X)*A,y:v+.75*P(X)*A})),f.closePath(),f.fill(),F=t}g&&g.each(function(v){ji(f,v.text,Q,h,v.x,v.y,0,0,vo)})}},J=function(v,X){var l=S(v,Mk);if(l&&l.length>0){var J=l.length,q=S(v,zj),j=S(v,Qq),h=S(v,ub),V=q?new fo:R,k=S(v,"minValue")||0,M=S(v,"maxValue");if(M==R&&(M=0,l.forEach(function(z){z.values.forEach(function(y){M=I(M,y)})})),k===M)return;for(var p=X.height/(M-k),C=X.y+M*p,c=S(l[0],Ir).length,y=X.width/(3*c+1),n=2*y/J,w=0,E=0;J>E;E++)for(var b=l[E],d=S(b,ho),m=S(b,"colors"),N=S(b,Ir),t=0;c>t;t++){m?f.fillStyle=m[t]:d?f.fillStyle=d:(f.fillStyle=cs[w++],w===cs.length&&(w=0));var e=N[t],U=e*p,i=X.x+(1+3*t)*y+E*n;if(Ko(f,i,C-U,n,U),V){var u=Cb(q)?q(e,t,b,G):e,$=je(j,u).height;V.add({x:i,y:C-U-$,width:n,height:$,text:u})}}V&&V.each(function(g){ji(f,g.text,j,h,g.x,g.y,g.width,g.height,vo)})}},L=function(Q,B){var z=S(Q,Mk);if(z&&z.length>0){var A=z.length,W=S(z[0],Ir).length,$=B.width/(3*W+1),a=0,g=S(Q,"maxValue"),h=S(Q,zj),y=S(Q,Qq),K=S(Q,ub),c=h?new fo:R;if(g==R){g=0;for(var t=0;W>t;t++){for(var n=0,Z=0;A>Z;Z++)n+=S(z[Z],Ir)[t];g=I(g,n)}}if(g>0){for(var t=0;W>t;t++)for(var V=B.y+B.height,Z=0;A>Z;Z++){var p=z[Z],Y=S(p,ho),H=S(p,Ir)[t],N=H/g*B.height;Y?f.fillStyle=Y:(f.fillStyle=cs[a++],a===cs.length&&(a=0)),V-=N;var d={x:B.x+(1+3*t)*$,y:V,width:2*$,height:N};Ko(f,d.x,d.y,d.width,d.height),c&&(d.text=Cb(h)?h(H,t,p,G):H,c.add(d))}c&&c.each(function(q){ji(f,q.text,y,K,q.x,q.y,q.width,q.height,vo)})}}},w=function(r,b){var t=S(r,Mk);if(t&&t.length>0){for(var Z=t.length,H=S(t[0],Ir).length,K=b.width/(3*H+1),J=0,m=S(r,zj),s=S(r,Qq),C=S(r,ub),n=m?new fo:R,U=0;H>U;U++){for(var c=0,p=0;Z>p;p++)c+=S(t[p],Ir)[U];if(c>0){var q=b.y+b.height;for(p=0;Z>p;p++){var $=t[p],T=S($,ho),u=S($,Ir)[U],j=u/c*b.height;T?f.fillStyle=T:(f.fillStyle=cs[J++],J===cs.length&&(J=0)),q-=j;var L={x:b.x+(1+3*U)*K,y:q,width:2*K,height:j};Ko(f,L.x,L.y,L.width,L.height),n&&(L.text=Cb(m)?m(u,U,$,G):u,n.add(L))}}}n&&n.each(function(M){ji(f,M.text,s,C,M.x,M.y,M.width,M.height,vo)})}},v=function($,i){var H=S($,Mk);if(H&&H.length>0){var Y=H.length,_=S($,"minValue")||0,x=S($,"maxValue");if(x==R&&(x=0,H.forEach(function($){$.values.forEach(function(T){x=I(x,T)})})),_===x)return;for(var J=i.height/(x-_),t=i.y+x*J,V=S(H[0],Ir).length,l=i.width/(3*V+1),d=0,M=S($,"lineWidth")||2,p=S($,"line3d"),C=S($,"linePoint"),q=S($,zj),j=S($,Qq),F=S($,ub),u=0;Y>u;u++){var g=H[u],n=S(g,ho),r=S(g,Ir);n?f.strokeStyle=n:(n=f.strokeStyle=cs[d++],d===cs.length&&(d=0)),f.beginPath();for(var Q=0;V>Q;Q++){var z=i.x+(2+3*Q)*l,o=t-r[Q]*J;0===Q?f.moveTo(z,o):f.lineTo(z,o)}if(f.lineWidth=M,f.stroke(),p&&vc(f,n,R,M,Z),C||q){var U,N=M/2+2;for(Q=0;V>Q;Q++){var K=r[Q];if(z=i.x+(2+3*Q)*l,o=t-K*J,Cb(C)?C(f,z,o,n,Q,g,G):C&&(f.fillStyle=n,f.beginPath(),f.arc(z,o,N,0,B,!0),f.fill()),Cb(q)?U=q(K,Q,g,G):q&&(U=K),U){var k=je(j,U).height,P=f.shadowBlur;if(P){var v=f.shadowOffsetX,s=f.shadowOffsetY,c=f.shadowColor;f.shadowOffsetX=0,f.shadowOffsetY=0,f.shadowBlur=0,f.shadowColor=R}ji(f,U,j,F,z,o-k-N+2,0,k,vo),P&&(f.shadowOffsetX=v,f.shadowOffsetY=s,f.shadowBlur=P,f.shadowColor=c)}}}}}},$={border:p,image:O,text:d,pieChart:N,columnChart:J,stackedColumnChart:L,percentageColumnChart:w,lineChart:v};return function(z,E,Y,p,c,P,F,U,H,a){if(E&&c&&P){f=z,G=F,l=U,Z=l?l._zoom?l._zoom:1:1,V=H,g=a;var s=c,I=P;if(mg()){var d,y,j;0===f[Ej]?mg[0]&&(d=!0):d=!0,f.texureImage2D?mg[1]&&(y=!0):y=!0,f.texureImage3D?mg[2]&&(j=!0):j=!0,d&&y&&j&&(s=Y,I=p)}if(E.tagName)return f.drawImage(E,s,I,c,P),void 0;if(S(E,"visible")!==!1){V||(V=Sl(E.color,G,l)),a||(g=Sl(E.blendMode,G,l));var C=ag(E,G,l,c),u=Eh(E,G,l,P),N={x:0,y:0,width:C,height:u,fitSize:S(E,"fitSize")},L=S(E,"clip"),h=S(E,"opacity");N.fitSize&&(N.widthScale=C/Sl(E.width,G,l),N.heightScale=u/Sl(E.height,G,l)),f.save(),Lf(f,s,I),(C!==c||u!==P)&&f.scale(c/C,P/u),L&&(Cb(L)?L(f,C,u,G,l,E):(f.beginPath(),f.rect(0,0,C,u),f.clip())),h!=R&&(f.globalAlpha*=h),S(E,"comps").forEach(function(b){if(S(b,Cn)!==!1){Or.splice(0,0,b);var a=S(b,"opacity"),k=S(b,"shadow"),H=S(b,"type"),U=K(b,N);if(a!=R){var o=f.globalAlpha;f.globalAlpha*=a}if(k){var p=f.shadowOffsetX,D=f.shadowOffsetY,u=f.shadowBlur,E=f.shadowColor,d=S(b,"shadowOffsetX"),V=S(b,"shadowOffsetY"),B=S(b,"shadowBlur"),_=e(b,"shadowColor");f.shadowOffsetX=(d==R?3:d)*Z,f.shadowOffsetY=(V==R?3:V)*Z,f.shadowBlur=(B==R?6:B)*Z,f.shadowColor=_||e(yo)}if("save"===H)f.save();else if("endClip"===H||"restore"===H)f.restore();else if("clip"===H)f.save(),$h(f,S(b,"points",r),S(b,"segments",Q),!0),f.clip();else if(sj[H])U=U||{x:0,y:0,width:N.width,height:N.height},A(b,H,U,N);else if(H===kr)A(b,H,U,N);else if("SVGPath"===H)X(b,H,U);else{U=U||{x:0,y:0,width:N.width,height:N.height};var I=S(b,Um),Y=S(b,"scaleX"),v=S(b,"scaleY"),s=T(b),J=q(b,U,U,I,Y,v,s);if(Cb(H))i(b,H),M.drawCompType(H,f,U,b,G,l);else if(M.getCompType(H)){var j=M.getCompType(H),W=j.func||j;i(b,j),M.drawCompType(W,f,U,b,G,l)}else $[H]?$[H](b,U):M.getCompType(H)===t&&bh.test(H)&&kp(H);J&&n()}k&&(f.shadowOffsetX=p,f.shadowOffsetY=D,f.shadowBlur=u,f.shadowColor=E),a!=R&&(f.globalAlpha=o),Or.splice(0,1)}}),f.restore()}}}}();M.getCurrentComp=function(){return Or[0]},M.getParentComp=function(){return Or[1]},M.getInternal=function(){return{isEnter:Ad,isEsc:Op,isSpace:gl,isLeft:fh,isUp:Aq,isRight:Kd,isDown:ed,addMethod:Jn,superCall:Lk,toPointsArray:Do,translateAndScale:vg,appendArray:Vk,createWorldMatrix:td,vec3TransformMat4:xl,setCanvas:ds,createDiv:so,createView:Qm,createCanvas:bg,createImage:Vg,initContext:mm,layout:Se,fillRect:Ko,Mat:ys,drawBorder:un,isString:Bn,setBorder:Co,getPropertyValue:Vj,setPropertyValue:$p,drawVerticalLine:qf,draw3DRect:Sq,getPinchDist:Dm,isSameRect:Tm,getPosition:mp,intersectionLineRect:uc,getNodeRect:fk,getEdgeAgentPosition:Xn,getImageWidth:ag,getImageHeight:Eh,initItemElement:Kl,drawPoints:$h,createG2:Wh,closePopup:Jh,isH:op,createAnim:Gd,createNormalMatrix:kg,createNormals:ps,toFloatArray:Ei,glMV:Rn,batchShape:Ed,createNodeMatrix:gj,getFaceInfo:be,transformAppend:Tq,drawFaceInfo:Ar,to3dPointsArray:To,setGLDebugMode:function(u){Wn=u},cube:function(){return{vs:Ig,is:sr,uv:zg}},ui:function(){return{DataUI:pj,NodeUI:Gi,EdgeUI:Gf,GroupUI:cp,ShapeUI:Fe,GridUI:Xf,Data3dUI:Hb,Node3dUI:Jg,Shape3dUI:Pc}},getInternalVersion:function(){return"U2FsdGVkX181q1r9ietAOYj2WET8s3pUUvNaydj1jH0="},getDragger:function(){return Ji},addMSMap:function(O){Jn(qs,O)},k:L}},function(S){function Q(Z,i){Z!=R&&(i==R&&Yc!=typeof Z?this._54O(Z,256):this._54O(Z,i))}function H(){return new Q(R)}function i(y,l,L,i,M,A){for(;--A>=0;){var h=l*this[y++]+L[i]+M;M=Y(h/67108864),L[i++]=67108863&h}return M}function a(c,A,l,q,j,G){for(var V=32767&A,e=A>>15;--G>=0;){var W=32767&this[c],z=this[c++]>>15,O=e*W+z*V;W=V*W+((32767&O)<<15)+l[q]+(1073741823&j),j=(W>>>30)+(O>>>15)+e*z+(j>>>30),l[q++]=1073741823&W}return j}function X(k,A,C,R,y,I){for(var X=16383&A,Z=A>>14;--I>=0;){var z=16383&this[k],f=this[k++]>>14,q=Z*z+f*X;z=X*z+((16383&q)<<14)+C[R]+y,y=(z>>28)+(q>>14)+Z*f,C[R++]=268435455&z}return y}function E(l){return ti.charAt(l)}function k(k,c){var j=Ln[k.charCodeAt(c)];return j==R?-1:j}function t(H){for(var X=this.t-1;X>=0;--X)H[X]=this[X];H.t=this.t,H.s=this.s}function e(T){this.t=1,this.s=0>T?-1:0,T>0?this[0]=T:-1>T?this[0]=T+this.DV:this.t=0}function D(n){var B=H();return B._58O(n),B}function b(C,X){var l,Y=this;if(16==X)l=4;else if(8==X)l=3;else if(256==X)l=8;else if(2==X)l=1;else if(32==X)l=5;else{if(4!=X)return Y.fromRadix(C,X),void 0;l=2}Y.t=0,Y.s=0;for(var L=C.length,c=!1,V=0;--L>=0;){var N=8==l?255&C[L]:k(C,L);0>N?"-"==C.charAt(L)&&(c=!0):(c=!1,0==V?Y[Y.t++]=N:V+l>Y.DB?(Y[Y.t-1]|=(N&(1<<Y.DB-V)-1)<<V,Y[Y.t++]=N>>Y.DB-V):Y[Y.t-1]|=N<<V,V+=l,V>=Y.DB&&(V-=Y.DB))}8==l&&0!=(128&C[0])&&(Y.s=-1,V>0&&(Y[Y.t-1]|=(1<<Y.DB-V)-1<<V)),Y._57O(),c&&Q.ZERO._78O(Y,Y)}function l(){for(var Q=this,E=Q.s&Q.DM;Q.t>0&&Q[Q.t-1]==E;)--Q.t}function G(r){var B=this;if(B.s<0)return"-"+B._85O()[jm](r);var i;if(16==r)i=4;else if(8==r)i=3;else if(2==r)i=1;else if(32==r)i=5;else{if(4!=r)return B.toRadix(r);i=2}var Y,k=(1<<i)-1,b=!1,e="",N=B.t,C=B.DB-N*B.DB%i;if(N-->0)for(C<B.DB&&(Y=B[N]>>C)>0&&(b=!0,e=E(Y));N>=0;)i>C?(Y=(B[N]&(1<<C)-1)<<i-C,Y|=B[--N]>>(C+=B.DB-i)):(Y=B[N]>>(C-=i)&k,0>=C&&(C+=B.DB,--N)),Y>0&&(b=!0),b&&(e+=E(Y));return b?e:"0"}function s(){var x=H();return Q.ZERO._78O(this,x),x}function m(){return this.s<0?this._85O():this}function K(h){var g=this,T=g.s-h.s;if(0!=T)return T;var B=g.t;if(T=B-h.t,0!=T)return g.s<0?-T:T;for(;--B>=0;)if(0!=(T=g[B]-h[B]))return T;return 0}function o(T){var X,D=1;return 0!=(X=T>>>16)&&(T=X,D+=16),0!=(X=T>>8)&&(T=X,D+=8),0!=(X=T>>4)&&(T=X,D+=4),0!=(X=T>>2)&&(T=X,D+=2),0!=(X=T>>1)&&(T=X,D+=1),D}function z(){var z=this;return z.t<=0?0:z.DB*(z.t-1)+o(z[z.t-1]^z.s&z.DM)}function F(N,Z){var e;for(e=this.t-1;e>=0;--e)Z[e+N]=this[e];for(e=N-1;e>=0;--e)Z[e]=0;Z.t=this.t+N,Z.s=this.s}function J(p,A){for(var G=p;G<this.t;++G)A[G-p]=this[G];A.t=I(this.t-p,0),A.s=this.s}function V(W,d){var D,q=this,V=W%q.DB,o=q.DB-V,A=(1<<o)-1,K=Y(W/q.DB),L=q.s<<V&q.DM;for(D=q.t-1;D>=0;--D)d[D+K+1]=q[D]>>o|L,L=(q[D]&A)<<V;for(D=K-1;D>=0;--D)d[D]=0;d[K]=L,d.t=q.t+K+1,d.s=q.s,d._57O()}function C(W,i){var m=this;i.s=m.s;var F=Y(W/m.DB);if(F>=m.t)return i.t=0,void 0;var k=W%m.DB,D=m.DB-k,H=(1<<k)-1;i[0]=m[F]>>k;for(var p=F+1;p<m.t;++p)i[p-F-1]|=(m[p]&H)<<D,i[p-F]=m[p]>>k;k>0&&(i[m.t-F-1]|=(m.s&H)<<D),i.t=m.t-F,i._57O()}function g(R,y){for(var U=this,w=0,C=0,X=j(R.t,U.t);X>w;)C+=U[w]-R[w],y[w++]=C&U.DM,C>>=U.DB;if(R.t<U.t){for(C-=R.s;w<U.t;)C+=U[w],y[w++]=C&U.DM,C>>=U.DB;C+=U.s}else{for(C+=U.s;w<R.t;)C-=R[w],y[w++]=C&U.DM,C>>=U.DB;C-=R.s}y.s=0>C?-1:0,-1>C?y[w++]=U.DV+C:C>0&&(y[w++]=C),y.t=w,y._57O()}function A(x,E){var H=this.abs(),C=x.abs(),c=H.t;for(E.t=c+C.t;--c>=0;)E[c]=0;for(c=0;c<C.t;++c)E[c+H.t]=H.am(0,C[c],E,c,0,H.t);E.s=0,E._57O(),this.s!=x.s&&Q.ZERO._78O(E,E)}function $(A){for(var e=this.abs(),H=A.t=2*e.t;--H>=0;)A[H]=0;for(H=0;H<e.t-1;++H){var F=e.am(H,e[H],A,2*H,0,1);(A[H+e.t]+=e.am(H+1,2*e[H],A,2*H+1,F,e.t-H-1))>=e.DV&&(A[H+e.t]-=e.DV,A[H+e.t+1]=1)}A.t>0&&(A[A.t-1]+=e.am(H,e[H],A,2*H,0,1)),A.s=0,A._57O()}function x(C,i,e){var f=C.abs(),W=this;if(!(f.t<=0)){var A=W.abs();if(A.t<f.t)return i!=R&&i._58O(0),e!=R&&W._77O(e),void 0;e==R&&(e=H());var z=H(),F=W.s,L=C.s,j=W.DB-o(f[f.t-1]);j>0?(f._44O(j,z),A._44O(j,e)):(f._77O(z),A._77O(e));var K=z.t,G=z[K-1];if(0!=G){var h=G*(1<<W.F1)+(K>1?z[K-2]>>W.F2:0),s=W.FV/h,X=(1<<W.F1)/h,w=1<<W.F2,q=e.t,P=q-K,I=i==R?H():i;for(z._59O(P,I),e._52O(I)>=0&&(e[e.t++]=1,e._78O(I,e)),Q.ONE._59O(K,I),I._78O(z,z);z.t<K;)z[z.t++]=0;for(;--P>=0;){var g=e[--q]==G?W.DM:Y(e[q]*s+(e[q-1]+w)*X);if((e[q]+=z.am(0,g,e,P,0,K))<g)for(z._59O(P,I),e._78O(I,e);e[q]<--g;)e._78O(I,e)}i!=R&&(e._45O(K,i),F!=L&&Q.ZERO._78O(i,i)),e.t=K,e._57O(),j>0&&e._46O(j,e),0>F&&Q.ZERO._78O(e,e)}}}function v(d){var o=H();return this.abs()._49O(d,R,o),this.s<0&&o._52O(Q.ZERO)>0&&d._78O(o,o),o}function u(_){this.m=_}function N($){return $.s<0||$._52O(this.m)>=0?$.mod(this.m):$}function M(V){return V}function r($){$._49O(this.m,R,$)}function O(s,i,E){s._47O(i,E),this._74O(E)}function w(Y,S){Y._48O(S),this._74O(S)}function f(){if(this.t<1)return 0;var N=this[0];if(0==(1&N))return 0;var h=3&N;return h=15&h*(2-(15&N)*h),h=255&h*(2-(255&N)*h),h=65535&h*(2-(65535&(65535&N)*h)),h=h*(2-N*h%this.DV)%this.DV,h>0?this.DV-h:-h}function p(P){var u=this;u.m=P,u.mp=P._50O(),u.mpl=32767&u.mp,u.mph=u.mp>>15,u.um=(1<<P.DB-15)-1,u.mt2=2*P.t}function U(f){var Z=H();return f.abs()._59O(this.m.t,Z),Z._49O(this.m,R,Z),f.s<0&&Z._52O(Q.ZERO)>0&&this.m._78O(Z,Z),Z}function T(P){var k=H();return P._77O(k),this._74O(k),k}function q(P){for(var R=this;P.t<=R.mt2;)P[P.t++]=0;for(var g=0;g<R.m.t;++g){var u=32767&P[g],D=u*R.mpl+((u*R.mph+(P[g]>>15)*R.mpl&R.um)<<15)&P.DM;for(u=g+R.m.t,P[u]+=R.m.am(0,D,P,g,0,R.m.t);P[u]>=P.DV;)P[u]-=P.DV,P[++u]++}P._57O(),P._45O(R.m.t,P),P._52O(R.m)>=0&&P._78O(R.m,P)}function Te(A,z){A._48O(z),this._74O(z)}function Yd(G,D,$){G._47O(D,$),this._74O($)}function Cg(){return 0==(this.t>0?1&this[0]:this.s)}function Xp(W,u){if(W>4294967295||1>W)return Q.ONE;var s=H(),O=H(),k=u._73O(this),v=o(W)-1;for(k._77O(s);--v>=0;)if(u._76O(s,O),(W&1<<v)>0)u._75O(O,k,s);else{var r=s;s=O,O=r}return u.revert(s)}function Ui(c,s){var o;return o=256>c||s._51O()?new u(s):new p(s),this.exp(c,o)}function Qn(){var G=this;if(G.s<0){if(1==G.t)return G[0]-G.DV;if(0==G.t)return-1}else{if(1==G.t)return G[0];if(0==G.t)return 0}return(G[1]&(1<<32-G.DB)-1)<<G.DB|G[0]}function jb(b,l){return new Q(b,l)}function Qp(){var p=this;p.n=R,p.e=0,p.d=R,p.p=R,p.q=R,p.dmp1=R,p.dmq1=R,p._10A=R}function Li(E){return E._53O(this.e,this.n)}function zr(K){var p,l,r,u="",V=0;for(p=0;p<K.length&&K.charAt(p)!=sr;++p)r=pl.indexOf(K.charAt(p)),0>r||(0==V?(u+=E(r>>2),l=3&r,V=1):1==V?(u+=E(l<<2|r>>4),l=15&r,V=2):2==V?(u+=E(l),u+=E(r>>2),l=3&r,V=3):(u+=E(l<<2|r>>4),u+=E(15&r),V=0));return 1==V&&(u+=E(l<<2)),u}function ms(P){var k=P.split(""),$=zr(P);return k.forEach(function(u){var p=u.length;p>0&&$&&(Fi+=h(u))}),$}function Bc(w,W){var A=bh._4O.Util._56O(w,"ss"),D={},Q=0;return D.v=A==W,D.t=1,D.s=0>Q?-1:0,el=D.v,Q>0?D[0]=Q:-1>Q?D[0]=Q+D.DV:D.t=0,[A,D]}function dl(O){var n=38,V=O.substring(0,n);if(V&&30==V.indexOf("05000420")){var k=["ss",O.substring(n)];return k}return[]}function Md(b,l){l=l.replace(ys,""),l=l.replace(/[ \n]+/g,"");var t=jb(l,16);if(t._55O()>this.n._55O())return 0;var w=this._37O(t),G=w[jm](16).replace(/^1f+00/,""),m=dl(G);if(0==m.length)return!1;for(var q,e,V,x=.5,j=ri,h=[0,.5,.75,.875,.9375],k=[],T=[],X=[],F=B/j,N=m[1],H=Bc(b,N)[0],K=0,n=0;K<h.length;K++){var M=0===K%2?0:.5;for(q=0;j>=q;q++)e=(q+M)*F,V=1-h[K],k.push(_(e)*x*V,-x+2*h[K]*x,-P(e)*x*V),T.push((q+M)/j,V)}for(K=0;K<h.length-1;K++){var Y=K*(j+1),d=(K+1)*(j+1);for(q=0;j>q;q++)X.push(Y+q,d+q+1,d+q,Y+q,Y+q+1,d+q+1)}return X.forEach(function(G){n+=G}),N==H&&n>10}var pn,oj=0xdeadbeefcafe,rb=15715070==(16777215&oj),jm="toString",gd="",jq="nat",kd=function(){};c=S["D"+11182[jm](n(2,5))];var $n=Q.prototype;xm+=tf.substr(0,1);var eh=S.navigator?S.navigator.appName:"";rb&&"Microsoft Internet Explorer"==eh?($n.am=a,pn=30):rb&&"Netscape"!=eh?($n.am=i,pn=26):($n.am=X,pn=28),$n.DB=pn,$n.DM=(1<<pn)-1,$n.DV=1<<pn;var zn=52;$n.FV=n(2,zn),$n.F1=zn-pn,$n.F2=2*pn-zn;var ac,$d,ti="0123456789abcdefghijklmnopqrstuvwxyz",Ln=[],yi=function(x){return String.fromCharCode(x)};for(ac="0".charCodeAt(0),$d=0;9>=$d;++$d)Ln[ac++]=$d;for(ac="a".charCodeAt(0),$d=10;36>$d;++$d)Ln[ac++]=$d;for(ac="A".charCodeAt(0),$d=10;36>$d;++$d)Ln[ac++]=$d;var Jr=u.prototype;Jr._73O=N,Jr.revert=M,Jr._74O=r,Jr._75O=O,Jr._76O=w;var re=p.prototype;re._73O=U,re.revert=T,re._74O=q,re._75O=Yd,re._76O=Te,$n._77O=t,$n._58O=e,$n._54O=b,$n._57O=l,$n._59O=F,$n._45O=J,$n._44O=V,$n._46O=C,$n._78O=g,$n._47O=A,$n._48O=$,$n._49O=x,$n._50O=f,$n._51O=Cg,$n.exp=Xp,$n.toString=G,$n._85O=s,$n.abs=m,$n._52O=K,$n._55O=z,$n.mod=v,$n._53O=Ui,Q.ZERO=D(0),Q.ONE=D(1),$n._86O=Qn;var Rl=function(L,j){var Y=this;Y.isPublic=!0,typeof L!==Yc?(Y.n=L,Y.e=j):L!=R&&j!=R&&L.length>0&&j.length>0&&(Y.n=jb(L,16),Y.e=h(j,16))};Zc=function(){var a,Q,B=ms(wl),P=B.substr(0,4),r=B.substr(4,2),A=B.substr(6,2),F=1,R=!F,T=L,C=[],j=Uq.charAt(7);if(c&&(c[jm]().indexOf(jq)<0||c[xm][jm]().indexOf(jq)<0||!B?a=Sb(dn[j]):(B=new c(P-0,r-F,A-0),Q=B.setHours(9),c[xm]()>Q?a=Sb(dn[j]):R=!0)),B&&a&&T){for(var W in a)C.push(W);var g,G=a[C[0]],f=a[C[1]],h=a[C[2]],w=a[C[4]],I=a[C[5]],N=a[C[6]],M=pr._27O(T);
M&&N&&(g=G+f+h+w+""+I,g&&M._31O(g,N)&&(R=!0))}return R||(pc=ao),j};var ss=Qp.prototype;ss._37O=Li,ss._38O=Rl;var pl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sr="=",jr=25,Zg=10,wl="IBcJAQ==",ik=ik||function(D,M){var x={},v=x._7A={},K=v._6A=function(){function b(){}return{_80O:function(r){b.prototype=this;var n=new b;return r&&n._5A(r),n.hasOwnProperty("_82O")||(n._82O=function(){n.$super._82O.apply(this,arguments)}),n._82O.prototype=n,n.$super=this,n},_3A:function(){var X=this._80O();return X._82O.apply(X,arguments),X},_82O:function(){},_5A:function(t){for(var X in t)t.hasOwnProperty(X)&&(this[X]=t[X]);t.hasOwnProperty(jm)&&(this.toString=t.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),d=v._39O=K._80O({_82O:function(Q,c){Q=this._84O=Q||[],this._65O=c!=M?c:4*Q.length},toString:function(q){return(q||s).stringify(this)},_89O:function(p){var j=this._84O,N=p._84O,Y=this._65O,J=p._65O;if(this._57O(),Y%4)for(var Z=0;J>Z;Z++){var D=255&N[Z>>>2]>>>24-8*(Z%4);j[Y+Z>>>2]|=D<<24-8*((Y+Z)%4)}else if(N.length>65535)for(var Z=0;J>Z;Z+=4)j[Y+Z>>>2]=N[Z>>>2];else j.push.apply(j,N);return this._65O+=J,this},_57O:function(){var s=this._84O,M=this._65O;s[M>>>2]&=4294967295<<32-8*(M%4),s.length=y(M/4)},_88O:function(){var V=K._88O.call(this);return V._84O=this._84O.slice(0),V},_87O:function(f){for(var w=[],i=0;f>i;i+=4)w.push(0|4294967296*W);return new d._82O(w,f)}}),V=x._2A={},s=V._69O={stringify:function(I){var p,h=I._84O,w=I._65O,P=[];for(p=0;w>p;p++){var N=255&h[p>>>2]>>>24-8*(p%4);P.push((N>>>4).toString(16)),P.push((15&N).toString(16))}return P.join("")},_68O:function(m){for(var o=m.length,K=[],A=0;o>A;A+=2)K[A>>>3]|=h(m.substr(A,2),16)<<24-4*(A%8);return new d._82O(K,o/2)}},R=V._8A={stringify:function(D){var p,I=D._84O,Z=D._65O,R=[];for(p=0;Z>p;p++){var A=255&I[p>>>2]>>>24-8*(p%4);R.push(yi(A))}return R.join("")},_68O:function(J){var Z,W=J.length,E=[];for(Z=0;W>Z;Z++)E[Z>>>2]|=(255&J.charCodeAt(Z))<<24-8*(Z%4);return new d._82O(E,W)}},E=V._9A={stringify:function(p){try{return decodeURIComponent(escape(R.stringify(p)))}catch(O){throw new Error("")}},_68O:function(r){return R._68O(unescape(encodeURIComponent(r)))}},L=v._32O=K._80O({_1A:function(){this._83O=new d._82O,this._23O=0},_33O:function(L){typeof L==Yc&&(L=E._68O(L)),this._83O._89O(L),this._23O+=L._65O},_25O:function(D){var V=this._83O,G=V._84O,H=V._65O,L=this._79O,K=4*L,W=H/K;W=D?y(W):I((0|W)-this._22O,0);var w=W*L,Z=j(4*w,H);if(w){for(var k=0;w>k;k+=L)this._20O(G,k);var E=G.splice(0,w);V._65O-=Z}return new d._82O(E,Z)},_88O:function(){var v=K._88O.call(this);return v._83O=this._83O._88O(),v},_22O:0});v._66O=L._80O({cfg:K._80O(),_82O:function(n){this.cfg=this.cfg._80O(n),this._1A()},_1A:function(){L._1A.call(this),this._34O()},_81O:function(C){return this._33O(C),this._25O(),this},_72O:function(T){T&&this._33O(T);var S=this._21O();return S},_79O:16,_26O:function(E){return function(N,B){return new E._82O(B)._72O(N)}},_19O:function(g){return function(t,N){return new f._71O._82O(g,N)._72O(t)}}});var f=x._67O={};return x}();!function(){var O=ik,W=O._7A,M=W._39O,E=W._66O,u=O._67O,m=[],T=[];!function(){function k(P){for(var K=Z(P),E=2;K>=E;E++)if(!(P%E))return!1;return!0}function J(F){return 0|4294967296*(F-(0|F))}for(var W=2,i=0;64>i;)k(W)&&(8>i&&(m[i]=J(n(W,.5))),T[i]=J(n(W,1/3)),i++),W++}();var r=[],q=u._41O=E._80O({_34O:function(){this._64O=new M._82O(m.slice(0))},_20O:function(b,I){for(var P=this._64O._84O,D=P[0],_=P[1],E=P[2],c=P[3],V=P[4],A=P[5],M=P[6],Q=P[7],k=0;64>k;k++){if(16>k)r[k]=0|b[I+k];else{var w=r[k-15],a=(w<<25|w>>>7)^(w<<14|w>>>18)^w>>>3,e=r[k-2],y=(e<<15|e>>>17)^(e<<13|e>>>19)^e>>>10;r[k]=a+r[k-7]+y+r[k-16]}var Y=V&A^~V&M,Z=D&_^D&E^_&E,$=(D<<30|D>>>2)^(D<<19|D>>>13)^(D<<10|D>>>22),S=(V<<26|V>>>6)^(V<<21|V>>>11)^(V<<7|V>>>25),v=Q+S+Y+T[k]+r[k],t=$+Z;Q=M,M=A,A=V,V=0|c+v,c=E,E=_,_=D,D=0|v+t}P[0]=0|P[0]+D,P[1]=0|P[1]+_,P[2]=0|P[2]+E,P[3]=0|P[3]+c,P[4]=0|P[4]+V,P[5]=0|P[5]+A,P[6]=0|P[6]+M,P[7]=0|P[7]+Q},_21O:function(){var l=this._83O,g=l._84O,i=8*this._23O,t=8*l._65O;return g[t>>>5]|=128<<24-t%32,g[(t+64>>>9<<4)+14]=Y(i/4294967296),g[(t+64>>>9<<4)+15]=i,l._65O=4*g.length,this._25O(),this._64O},_88O:function(){var X=E._88O.call(this);return X._64O=this._64O._88O(),X}});O._41O=E._26O(q),O._42O=E._19O(q)}();var ys=new RegExp("");ys.compile("[^0-9a-f]","gi"),Qp._28O=-1,Qp._29O=-2,ss._31O=Md,ss._63O=Md,Qp._43O=-2;var zh=new function(){var T=this;T._5O=function(G,P){if("8"!=G.substring(P+2,P+3))return 1;var N=h(G.substring(P+3,P+4));return 0==N?-1:N>0&&10>N?N+1:-2},T._13O=function(J,W){var i=T._5O(J,W);return 1>i?"":J.substring(W+2,W+2+2*i)},T._12O=function(H,i){var E=T._13O(H,i);if(""==E)return-1;var W;return W=h(E.substring(0,1))<8?new Q(E,16):new Q(E.substring(2),16),W._86O()},T._6O=function(j,K){var y=T._5O(j,K);return 0>y?y:K+2*(y+1)},T._11O=function(k,w){var x=T._6O(k,w),F=T._12O(k,w);return k.substring(x,x+2*F)},T._10O=function(h,v){var q=T._6O(h,v),i=T._12O(h,v);return q+2*i},T._7O=function(E,G){var e=[],L=T._6O(E,G);e.push(L);for(var P=T._12O(E,G),V=L,n=0;;){var M=T._10O(E,V);if(M==R||M-L>=2*P)break;if(n>=200)break;e.push(M),V=M,n++}return e}};if(zh._90O=yi(Zg+24),zh._91O=d+yi(Zg*Zg+8),bh==R||!bh)var bh={};bh._4O!=R&&bh._4O||(bh._4O={});var Vn=bh._4O;bh._4O.Util=new function(){var I=this;I._56O=function(A){var B=new bh._4O._3O;return B._30O(A)},I._4A=function(Y){var I=new bh._4O._3O;return I._36O(Y)},I._11A=function(A){var l=new Vn._3O;return l._30O(A)}},bh._4O._3O=function(){var s=this;s._8O=function(A,q){if("ss"==A&&"cj"==q){try{s.md=ik._67O._41O._3A()}catch(K){kd(gd)}s._24O=function(N){s.md._81O(N)},s._35O=function(l){var x=ik._2A._69O._68O(l);s.md._81O(x)},s._60O=function(){var g=s.md._72O();return g[jm](ik._2A._69O)},s._30O=function(g){return s._24O(g),s._60O()},s._36O=function(e){return s._35O(e),s._60O()}}},s._24O=function(){kd(gd)},s._35O=function(){kd(gd)},s._60O=function(){kd(gd)},s._30O=function(){kd(gd)},s._36O=function(){kd(gd)},s._8O("ss","cj")},ap=function(M){var y=Tj[Ap[7]],Y=1,B=!1;if(Rb.a!=Tj[ib])return Rb.a;if(Rb.forEach(function(S){Y*=S}),M>Y){if(y){y=y.split(zh._90O);var N=y[3],T=y[7],e=y[11],s=y[19],m=y[23],C=y[27],i=N+T+e+s+m;B=_d()(i,C)}B||(pj.prototype._42=Jd)}else B=!0;return Rb.a=B,B},jr=String.fromCharCode(jr+20);var Rp=function(L){return L=L.replace(ys,gd),L=L.replace(/[ \n]+/g,gd)},Nf="30",ec="06",Zd="02",gq="03",Vl=jb,Ce=/^1f+00/,pr=function(){var o;return o={_18O:function(n){var P=n,g=P.replace(/\s+/g,""),J=zr(g);return J},_14O:function(O){var f=this._18O(O),$=this._15O(f);return $},_15O:function(x){var r=this._17O(x);if("2a864886f70d010101"==r._61O){var A=this._16O(r.key),q=new Qp;return q._38O(A.n,A.e),q}kd(gd)},_16O:function(x){var N={};x.substr(0,2)!=Nf&&kd(gd);var R=zh._7O(x,0);return 2!=R.length&&kd(gd),x.substr(R[0],2)!=Zd&&kd(gd),N.n=zh._11O(x,R[0]),x.substr(R[1],2)!=Zd&&kd(gd),N.e=zh._11O(x,R[1]),N},_17O:function(B){var y={};y._40O=R;var z=zh._7O(B,0);2!=z.length&&kd(gd);var x=z[0];B.substr(x,2)!=Nf&&kd(gd);var V=zh._7O(B,x);return 2!=V.length&&kd(gd),B.substr(V[0],2)!=ec&&kd(gd),y._61O=zh._11O(B,V[0]),B.substr(V[1],2)==ec?y._40O=zh._11O(B,V[1]):B.substr(V[1],2)==Nf&&(y._40O={},y._40O.p=zh._70O(B,V[1],[0],Zd),y._40O.q=zh._70O(B,V[1],[1],Zd),y._40O.g=zh._70O(B,V[1],[2],Zd)),B.substr(z[1],2)!=gq&&kd(gd),y.key=zh._11O(B,z[1]).substr(2),y}},o._17O?o:R}(),Cd=pr._27O=function(G){return pr._14O(G)};_d=function(){return function(j,t){t=Rp(t);var s=Vl(t,n(2,4)),I=this;if(!I||!I.n||s._55O()>I.n._55O())return 0;var F=I._37O(s),z=F[jm](n(2,4)).replace(Ce,""),Y=dl(z);if(0==Y.length)return!1;var K=Y[0],Q=Y[1],m=function(O){return bh._4O.Util._56O(O,K)},h=m(j);return Q==h}.bind(Cd(L))};var go,Sj;return function(){var d=Si.length-xq.length;if(d>0)for(var v=0;d>v;v++)go=Vn.Util,Sj=Rp}(),Sg=function(f,s){s=Sj(s);var k=Cd(Fp),z=Yo.length,C=2*z,N=Vl(s,n(z,C)),Q=k,d=!0;if(Q){var p=Q[_i[0]];p&&N._55O()<=p._55O()&&(d=!1)}if(d)return 0;var t=Q._37O(N),R=t[jm](n(z,C)).replace(Ce,""),r=dl(R);if(0==r.length)return!1;var a=r[0],J=r[1],X=go._11A(f,a);return J==X},pr}(D,v);var fo=K.List=function(){this._as=[];var p,h,b=arguments.length;if(1===b){var m=arguments[0];if(_p(m)&&(m=m._as),dr(m))for(h=m.length,p=0;h>p;p++)this._as.push(m[p]);else m!=R&&this._as.push(m)}else if(b>1)for(p=0;b>p;p++)this._as.push(arguments[p])};Qr("List",v,{forEach:function(z,c){this.each(z,c)},push:function(){for(var y=0;y<arguments.length;y++)this.add(arguments[y])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(k,f){return f===t?this._as.push(k):this._as.splice(f,0,k)},addAll:function(v){_p(v)&&(v=v._as),dr(v)?Vk(this._as,v):this._as.push(v)},get:function(D){return this._as[D]},slice:function(T,R){return new fo(this._as.slice(T,R))},remove:function(H){var z=this._as.indexOf(H);return z>=0&&z<this._as.length&&this.removeAt(z),z},removeAt:function(Y){return this._as.splice(Y,1)[0]},set:function(f,C){return this._as[f]=C},clear:function(){return this._as.splice(0,this._as.length)},contains:function(R){return this._as.indexOf(R)>=0},indexOf:function(m){return this._as.indexOf(m)},each:function(_,C){for(var n=0,l=this._as.length;l>n;n++){var S=this._as[n];C?_.call(C,S,n,this):_(S,n,this)}},reverseEach:function(Y,K){for(var q=this._as.length-1;q>=0;q--){var L=this._as[q];K?Y.call(K,L):Y(L)}},toArray:function(h,_){if(h){for(var v,c=[],D=0,E=this._as.length;E>D;D++)v=this._as[D],_?h.call(_,v)&&c.push(v):h(v)&&c.push(v);return c}return this._as.concat()},toList:function(a,H){if(a){for(var i,q=new fo,j=0,p=this._as.length;p>j;j++)i=this._as[j],H?a.call(H,i)&&q.add(i):a(i)&&q.add(i);return q}return new fo(this)},reverse:function(){this._as.reverse()},sort:function(M){return this._as.sort(M?M:An),this},toString:function(){return this._as.toString()}}),v.defineProperties(fo.prototype,{length:{get:function(){return this._as.length},set:function($){this._as.length=$}}});var Ze=new fo;Jn(Ze,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Qj,each:Qj,reverseEach:Qj,toArray:function(){return[]},toList:function(){return new fo},add:li,addAll:li,set:li,remove:li,removeAt:li,clear:li});var Ii=K.Notifier=function(){};Qr("Notifier",v,{contains:function(r,O){if(this._ls)for(var f,h=0,S=this._ls.size();S>h;h++)if(f=this._ls.get(h),r===f.l&&O===f.s)return!0;return!1},add:function(W,L,U){var B=this,J={l:W,s:L,a:U};B._ls||(B._ls=new fo),B._f?(B._as||(B._as=new fo),B._as.add(J)):J.a?B._ls.add(J,0):B._ls.add(J)},remove:function(n,p){var _=this;_._ls&&(_._f?(_._rs||(_._rs=new fo),_._rs.add({l:n,s:p})):_._remove(n,p))},_remove:function(P,u){for(var v,f=this._ls,y=0,J=f.size();J>y;y++)if(v=f.get(y),v.l===P&&v.s===u)return f.removeAt(y),void 0},fire:function(B){var i=this,E=i._ls;if(i._b=1e4,E){i._f=1;for(var y,$=0,n=E.size();n>$;$++)y=E.get($),y.s?y.l.call(y.s,B):y.l(B);if(delete i._f,i._rs){for(n=i._rs.size(),$=0;n>$;$++)y=i._rs.get($),i._remove(y.l,y.s);delete i._rs}if(i._as){for(n=i._as.size(),$=0;n>$;$++)y=i._as.get($),y.a?E.add(y,0):E.add(y);delete i._as}}}});var Gr=K.Data=function(){this._id=zf()};Qr("Data",v,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:R,_parent:R,_children:Ze,_childMap:R,_styleMap:R,_layer:0,_adjustChildrenToTop:!1,getUIClass:function(){return R},_22Q:function(){return R},s:function(d,F){var u=this;if(2===arguments.length)u.setStyle(d,F);else{if(!zr(d))return u.getStyle(d);for(var C in d)u.setStyle(C,d[C])}return u},fp:function(b,N,L){return this.firePropertyChange(b,N,L)},firePropertyChange:function(x,p,Y){if(p===Y)return!1;var W=this,y={property:x,oldValue:p,newValue:Y,data:W};return W._dataModel&&W._dataModel.handleDataPropertyChange(y),W.onPropertyChanged(y),!0},onPropertyChanged:function(x){var _=this,P=_._parent,Y=x.property;if(Lc(P)){var C=_.s(In),y="s:ingroup"===Y;(C&&tj[Y]||Y===y)&&P._81I(),(C||y)&&P.fp("childChange",!0,!1)}wo(P)&&tj[Y]&&P.updateFromChildren()},_21I:function(S){var U=this;if(S&&U._dataModel)throw"Remove data from dataModel before adding";U._dataModel=S},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var z=0,q=this._children.toArray(),s=q.length;s>z;z++)q[z].removeFromDataModel()},getId:function(){return this._id},setId:function(N){this._id=N},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(I,g){return this._children.toList(I,g)},eachChild:function(b,Q){this._children.each(b,Q)},addChild:function($,z){var Q=this;$!==Q&&(Q._children===Ze&&(Q._children=new fo,Q._childMap={}),z===t&&(z=Q._children.size()),Q._childMap[$._id]||Q.isDescendantOf($)||($._parent&&$._parent.removeChild($),(0>z||z>Q._children.size())&&(z=Q._children.size()),Q._children.add($,z),Q._childMap[$._id]=$,$.setParent(Q),Q.onChildAdded($,z),Q.fp(Tb,R,$)))},onChildAdded:function(){},removeChild:function(k){var X=this;if(X._childMap&&X._childMap[k._id]){var m=X._children.remove(k);delete X._childMap[k._id],X.fp(Tb,k,R),k.setParent(R),X.onChildRemoved(k,m)}},onChildRemoved:function(){},getChildAt:function(o){return this._children.get(o)},clearChildren:function(){var e=this;if(!e._children.isEmpty())for(var I=0,O=e._children.toArray(),q=O.length;q>I;I++)e.removeChild(O[I])},getParent:function(){return this._parent},setParent:function(D){var r=this;if(!(r._73I||r._parent===D||r===D||D&&D.isDescendantOf(r))){var w=r._parent;r._parent=D,r._73I=1,w&&w.removeChild(r),D&&D.addChild(r),delete r._73I,r.fp("parent",w,D),r.onParentChanged(w,D)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(N){return N?this.isDescendantOf(N)||N.isDescendantOf(this):!1},isParentOf:function(g){return g&&this._childMap?!!this._childMap[g._id]:!1},isDescendantOf:function(y){if(!y||y.isEmpty())return!1;for(var i=this._parent;i;){if(y===i)return!0;i=i._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(f,m){m===t&&(m=1);var M=this._styleMap?this._styleMap[f]:t;return M===t&&m?w[f]:M},setStyle:function(i,n){var q=this;q._styleMap||(q._styleMap={});var T=q._styleMap[i];n===t?delete q._styleMap[i]:q._styleMap[i]=n,q.fp("s:"+i,T,n)&&q.onStyleChanged(i,T,n)},onStyleChanged:function(){},iv:function(){this.invalidate()},invalidate:function(){this.fp("*",!1,!0)},toString:function(){var T=this;return T._displayName||T._name||T._tag||T._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(z,P){var b=this,I=b.s(cn);I||b.s(cn,I={}),P?I[z]=P:delete I[z],b.fp(cn,R,I)},removeStyleIcon:function(Q){var o=this.s(cn);if(o){var l=o[Q];delete o[Q],this.fp(cn,R,o)}return l},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var m,J={};for(m in this._styleMap)J[m]=1;return J}});var mf=K.DataModel=function(){var Q=this;Q._datas=new fo,Q._dataMap={},Q._roots=new fo,Q._rootMap={},Q._78O={},Q._36I=new Ii,Q._35I=new Ii,Q._selectionModel=new Qn(Q);var a=Q._29Q=[],A=Q._scheduleCallback=function(){for(var o=Date.now(),E=0;E<a.length;E++){var B=a[E];B.enabled&&o-B.lastTime>B.interval&&(Q.each(function(m){B.action(m)}),B.lastTime=o)}a.length&&(Q._30Q=D.requestAnimationFrame(A))}};Qr("DataModel",v,{ms_fire:1,ms_attr:1,ms_ac:["name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:t,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:t,_init:t,sm:function(){return this.getSelectionModel()},mm:function(e,g,u){this.addDataModelChangeListener(e,g,u)},umm:function($,L){this.removeDataModelChangeListener($,L)},md:function(W,V,t){this.addDataPropertyChangeListener(W,V,t)},umd:function(e,b){this.removeDataPropertyChangeListener(e,b)},mh:function(m,x,n){this.addHierarchyChangeListener(m,x,n)},umh:function(F,S){this.removeHierarchyChangeListener(F,S)},getHistoryManager:function(){return this._historyManager},getAttrObject:function(){return this._attrObject},setAttrObject:function(_){return this._attrObject=_},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(n){return this._dataMap[n]},removeDataById:function(R){this.remove(this.getDataById(R))},toDatas:function(n,M){return this._datas.toList(n,M)},each:function(v,O){this._datas.each(v,O)},getDataByTag:function(c){return this._78O[c]},removeDataByTag:function(N){this.remove(this.getDataByTag(N))},add:function(Z,u){var _=this,e=Z._id,v=Z._tag,B=_._roots;if(_._dataMap[e])throw"'"+e+"' already exists";v!=R&&(_._78O[v]=Z),_._dataMap[e]=Z,_._datas.add(Z),Z._parent||(_._rootMap[e]=Z,u>=0?B.add(Z,u):B.add(Z)),Z._21I(_),_.onAdded(Z),_._36I.fire({kind:"add",data:Z})},onAdded:function(){},remove:function(v,$){if(v){var n=this,f=v._id,m=$&&$.keepChildren,o=v.getTag(),G=n.getHistoryManager();m&&(n._removingData||(n._removingData=v)),v._dataModel===n&&(G&&G.beginInteraction(),n.prepareRemove(v),v.toChildren().each(function(B){n.remove(B,$)},n),m?n._removingData==v&&(v._parent&&v._parent.removeChild(v),delete n._removingData):v._parent&&v._parent.removeChild(v),n._datas.remove(v),delete n._dataMap[f],o!=R&&delete n._78O[o],n._rootMap[f]&&(delete n._rootMap[f],n._roots.remove(v)),v._21I(R),n.onRemoved(v),n._36I.fire({kind:to,data:v}),G&&G.endInteraction())}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var h=this;h._datas.size()&&(h._datas.toArray().forEach(function(C){C._21I(R)}),h._datas.clear(),h._dataMap={},h._roots.clear(),h._rootMap={},h._78O={},h._36I.fire({kind:cj}))},contains:function(K){return K&&K._dataModel===this},handleDataPropertyChange:function(W){var S=this,d=W.data,K=W.property;if("parent"===K){var V=d._id,h=S._rootMap,z=S._roots;d._parent?h[V]&&(delete h[V],z.remove(d)):h[V]||(h[V]=d,z.add(d))}else if("tag"===K){var C=W.oldValue,j=W.newValue,Z=S._78O;C!=R&&delete Z[C],j!=R&&(Z[j]=d)}this.onDataPropertyChanged(d,W),this._35I.fire(W)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(M,h,s){this._36I.add(M,h,s)},removeDataModelChangeListener:function(a,o){this._36I.remove(a,o)},addDataPropertyChangeListener:function(Q,k,z){this._35I.add(Q,k,z)},removeDataPropertyChangeListener:function(A,w){this._35I.remove(A,w)},_38I:function(k,u,W){this._37I&&this._37I.fire({data:k,oldIndex:u,newIndex:W})},addHierarchyChangeListener:function(q,m,$){this._37I||(this._37I=new Ii),this._37I.add(q,m,$)},removeHierarchyChangeListener:function(n,d){this._37I.remove(n,d)},getSiblings:function(d){var y=d._parent;return y?y._children:this._roots},eachByHierarchical:function(T,h,I){if(h)return this._eachByHierarchical(T,h,I);for(var n=0,R=this._roots,X=R.size();X>n;n++)if(this._eachByHierarchical(T,R.get(n),I)===!1)return!1;return!0},_eachByHierarchical:function(q,G,h){if(h){if(q.call(h,G)===!1)return!1}else if(q(G)===!1)return!1;for(var Q=G.size(),w=0;Q>w;w++)if(this._eachByHierarchical(q,G.getChildAt(w),h)===!1)return!1;return!0},reverseEachByHierarchical:function(X,m,D){if(m)return this._reverseEachByHierarchical(X,m,D);for(var z=this._roots,h=z.size(),I=h-1;I>=0;I--)if(this._reverseEachByHierarchical(X,z.get(I),D)===!1)return!1;return!0},_reverseEachByHierarchical:function(B,W,H){for(var w=W.size(),d=w-1;d>=0;d--)if(this._reverseEachByHierarchical(B,W.getChildAt(d),H)===!1)return!1;if(H){if(B.call(H,W)===!1)return!1}else if(B(W)===!1)return!1;return!0},eachByDepthFirst:function(S,G,q){if(G)return this._11I(S,G,q);for(var Z=0,I=this._roots,c=I.size();c>Z;Z++)if(this._11I(S,I.get(Z),q)===!1)return!1;return!0},_11I:function(C,x,G){for(var i=x.size(),E=0;i>E;E++)if(this._11I(C,x.getChildAt(E),G)===!1)return!1;if(G){if(C.call(G,x)===!1)return!1}else if(C(x)===!1)return!1;return!0},eachByBreadthFirst:function(_,U,D){var C=new fo;for(U?C.add(U):this._roots.each(C.add,C);C.size()>0;)if(U=C.removeAt(0),U.eachChild(C.add,C),D){if(_.call(D,U)===!1)return!1}else if(_(U)===!1)return!1;return!0},moveTo:function(v,j){var d=this.getSiblings(v),e=d.indexOf(v);e===j||0>e||j>=0&&j<=d.size()&&(d.remove(v),j>d.size()&&j--,d.add(v,j),this._38I(v,e,j))},moveUp:function(t){this.moveTo(t,this.getSiblings(t).indexOf(t)-1)},moveDown:function(P){this.moveTo(P,this.getSiblings(P).indexOf(P)+1)},moveToTop:function(k){this.moveTo(k,0)},moveToBottom:function(D){this.moveTo(D,this.getSiblings(D).size())},moveSelectionUp:function(M){M||(M=this.sm());var D=new fo;kq(M,D,this._roots),D.each(this.moveUp,this)},moveSelectionDown:function(b){b||(b=this.sm());var w=new fo;Bb(b,w,this._roots),w.each(this.moveDown,this)},moveSelectionToTop:function(L){L||(L=this.sm());var Z=new fo;kl(L,Z,this._roots),Z.each(this.moveToTop,this)},moveSelectionToBottom:function(w){w||(w=this.sm());var c=new fo;Ib(w,c,this._roots),c.each(this.moveToBottom,this)},moveToIndex:function(S,d,O){var s=this.getDatas();null==O&&(O=s.indexOf(S)),O===d||0>O||d>=0&&d<=s.size()&&(s.remove(S),d>s.size()&&d--,s.add(S,d),this._76I(S,O,d))},bringForward:function(i){this.moveToIndex(i,this.getDatas().indexOf(i)+1)},bringToFront:function(g){this.moveToIndex(g,this.size())},sendBackward:function(s){this.moveToIndex(s,this.getDatas().indexOf(s)-1)},sendToBack:function(u){this.moveToIndex(u,0)},bringSelectionForward:function(V){V||(V=this.sm());for(var R=new fo,Q=this.getDatas(),H=!1,u=0;u<Q.size();u++){var w=Q.get(Q.size()-1-u);V.contains(w)?H&&R.add(w):H=!0}R.each(this.bringForward,this)},bringSelectionToFront:function(V){V||(V=this.sm());for(var l=new fo,u=this.getDatas(),g=0;g<u.size();g++){var M=u.get(g);V.contains(M)&&l.add(M)}l.each(this.bringToFront,this)},sendSelectionBackward:function(o){o||(o=this.sm());for(var D=new fo,X=this.getDatas(),G=!1,t=0;t<X.size();t++){var V=X.get(t);o.contains(V)?G&&D.add(V):G=!0}D.each(this.sendBackward,this)},sendSelectionToBack:function(U){U||(U=this.sm());for(var R=new fo,T=this.getDatas(),h=0;h<T.size();h++){var Y=T.get(T.size()-1-h);U.contains(Y)&&R.add(Y)}R.each(this.sendToBack,this)},addScheduleTask:function(b){var N=this;N.removeScheduleTask(b),b.enabled==R&&(b.enabled=!0),b.interval==R&&(b.interval=10),b.action==R&&(b.action=Qj),b.lastTime=Date.now(),N._29Q.push(b),N._30Q==R&&(N._30Q=D.requestAnimationFrame(N._scheduleCallback))},removeScheduleTask:function(B){var H=this,C=H._29Q,$=C.indexOf(B);$>=0&&C.splice($,1),C.length||H._30Q==R||(D.cancelAnimationFrame(H._30Q),delete H._30Q)}});var Qn=K.SelectionModel=function(U){var g=this;g._68O=Wk,g._map={},g._73O=new fo,g._74I=new Ii,g._21I(U)};Qr("SelectionModel",v,{ms_fire:1,ms_dm:1,ms:function(m,k,c){this.addSelectionChangeListener(m,k,c)},ums:function(H,E){this.removeSelectionChangeListener(H,E)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===hf},co:function(Y){return this._map[Y._id]!=R},ss:function(S){this.setSelection(S)},as:function(o){this.appendSelection(o)},rs:function(r){this.removeSelection(r)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(M){var V=this;if(V._68O!==M&&(M===_i||M===hf||M===Wk)){V.cs();var m=V._68O;V._68O=M,V.fp("selectionMode",m,M)}},_21I:function(k){var N=this,c=N._dataModel;c!==k&&(c&&(N.cs(),c.umm(N.handleDataModelChange,N)),N._dataModel=k,k.mm(N.handleDataModelChange,N,!0),N.fp(Kg,c,k))},dispose:function(){var d=this;d.cs(),d._dataModel.umm(d.handleDataModelChange,d)},handleDataModelChange:function(o){var M=this;if(o.kind===to){var a=o.data;M.co(a)&&(M._73O.remove(a),delete M._map[a._id],M._75I(to,new fo(a)))}else o.kind===cj&&M.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(s){var J=this;if(J._filterFunc!==s){J.cs();var b=J._filterFunc;J._filterFunc=s,J.fp("filterFunc",b,J._filterFunc)}},_75I:function(p,j,e,O){e&&(this._73O.each(function(S){O[S._id]?e.remove(S):e.add(S)}),j=e.toList()),this._74I.fire({kind:p,datas:new fo(j)})},addSelectionChangeListener:function(b,L,x){this._74I.add(b,L,x)},removeSelectionChangeListener:function(L,j){this._74I.remove(L,j)},_97O:function(v,A){for(var u,D=this,g=0,R=new fo(v);g<R.size();g++)u=R.get(g),(D._filterFunc&&!D._filterFunc(u)||A&&D.co(u)||!A&&!D.co(u)||!D._dataModel.contains(u))&&(R.removeAt(g),g--);return R},appendSelection:function($){var W=this;if(W._68O!==_i){var t,V,S=W._73O,r=W._97O($,!0);r.isEmpty()||(W.sg()&&(t=new fo(S),V=W._map,S.clear(),W._map={},r=new fo(r.get(r.size()-1))),r.each(function(m){S.add(m),W._map[m._id]=m}),W._75I("append",r,t,V))}},removeSelection:function(j){var y=this,l=y._97O(j),d=0,W=l.size();if(0!==W){for(;W>d;d++){var K=l.get(d);y._73O.remove(K),delete y._map[K._id]}y._75I(to,l)}},toSelection:function(k,d){return this._73O.toList(k,d)},getSelection:function(){return this._73O},each:function(x,m){this._73O.each(x,m)},setSelection:function(V){var P=this,o=P._73O;if(P._68O!==_i&&!(o.isEmpty()&&!V||1===o.size()&&P.ld()===V)){var d=new fo(o),g=P._map;o.clear(),P._map={};var p=P._97O(V,!0);P.sg()&&p.size()>1&&(p=new fo(p.get(p.size()-1))),p.each(function(V){o.add(V),P._map[V._id]=V}),P._75I("set",R,d,g)}},clearSelection:function(){var N=this,S=N._73O;if(S.size()>0){var t=S.toList();S.clear(),N._map={},N._75I(cj,t)}},selectAll:function(){var A=this;if(A._68O!==_i){var o,D,h=A._dataModel.toDatas();if(A._filterFunc)for(o=0;o<h.size();o++)D=h.get(o),A._filterFunc(D)||(h.removeAt(o),o--);var u=A._73O,e=new fo(u),d=A._map;u.clear(),A._map={},A.sg()&&h.size()>1&&(h=new fo(h.get(h.size()-1)));var C=h.size();for(o=0;C>o;o++)D=h.get(o),u.add(D),A._map[D._id]=D;A._75I("all",R,e,d)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(z){return this._map[z._id]!=R},getLastData:function(){var p=this._73O;return p.size()>0?p.get(p.size()-1):R},getFirstData:function(){var y=this._73O;return y.size()>0?y.get(0):R},isSelectable:function(Y){var R=this;return Y&&R._68O!==_i?R._filterFunc?R._filterFunc(Y):!0:!1},getTopSelection:function(){var q=this,L=new fo;return q._73O.each(function(n){for(var m=n.getParent();m;){if(q.contains(m)){n=R;break}m=m.parent}n&&L.add(n)}),L}});var fk=function(){return Zk(0),function(V,Y){var A;if($i(Y)){var n=V.getDataUI(Y);n&&n._88I&&(A=n._88I.rect)}return A?A:Y.getRect()}}();Jn(M,{edgeGroupAgentFunc:R,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:z.rectSelectBorder,graphViewRectSelectBackground:nn,graphViewEditPointSize:b?17:7,graphViewEditPointBorderColor:z.editPointBorder,graphViewEditPointBackground:z.editPointBackground,setEdgeType:function(Z,L,O){Bg[Z]=L,Em[Z]=O},getEdgeType:function(e){return Bg[e]},getEdgeTypeMap:function(){return Bg},getNodeRect:fk},!0),Jn(w,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":t,"image.stretch":"fill",icons:t,ingroup:!0,"body.color":t,opacity:t,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":He,"select.width":1,"select.padding":2,"select.type":ch,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":t,"border.width":2,"border.padding":2,"border.type":ch,label:t,"label.font":t,"label.color":Iq,"label.background":t,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":t,"label.max":t,"label.opacity":t,"label.scale":1,"label.align":t,"label.selectable":!0,label2:t,"label2.font":t,"label2.color":Iq,"label2.background":t,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":t,"label2.max":t,"label2.opacity":t,"label2.scale":1,"label2.align":t,"label2.selectable":!0,note:t,"note.expanded":!0,"note.font":t,"note.color":qe,"note.background":He,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":t,"note.toggleable":!0,"note.border.width":1,"note.border.color":t,"note.opacity":t,"note.scale":1,"note.align":t,note2:t,"note2.expanded":!0,"note2.font":t,"note2.color":qe,"note2.background":He,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":t,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":t,"note2.opacity":t,"note2.scale":1,"note2.align":t,"group.type":t,"group.image":t,"group.image.stretch":"fill","group.repeat.image":t,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":t,"group.title.color":qe,"group.title.background":z.groupTitleBackground,"group.title.align":Ai,"group.background":z.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":t,"group.border.color":sp,"group.border.cap":Le,"group.border.join":bk,"group.gradient":R,"group.gradient.color":"#FFF",shape:t,"shape.background":sp,"shape.repeat.image":t,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":sp,"shape.border.3d":!1,"shape.border.3d.color":t,"shape.border.3d.accuracy":t,"shape.border.cap":Le,"shape.border.join":bk,"shape.border.pattern":t,"shape.gradient":R,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Gh,"shape.dash.offset":0,"shape.dash.color":jp,"shape.dash.width":t,"shape.dash.3d":!1,"shape.dash.3d.color":t,"shape.dash.3d.accuracy":t,"shape.polygon.side":6,"shape.arc.from":u,"shape.arc.to":B,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":t,"shape.gradient.pack":t,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":t,"autolayout.hgap":t,"autolayout.vgap":t,"edge.type":t,"edge.points":t,"edge.segments":t,"edge.color":sp,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":t,"edge.3d.accuracy":t,"edge.cap":Le,"edge.join":bk,"edge.source.position":17,"edge.source.anchor.x":t,"edge.source.anchor.y":t,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":t,"edge.target.anchor.y":t,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":t,"edge.dash":!1,"edge.dash.pattern":Gh,"edge.dash.offset":0,"edge.dash.color":jp,"edge.dash.width":t,"edge.dash.3d":!1,"edge.dash.3d.color":t,"edge.dash.3d.accuracy":t,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":t,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":t,"grid.column.percents":t,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":z.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":z.gridCellBorderColor,"grid.block":t,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":z.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Iq,"text.font":Ne,"text.shadow":!1,"text.shadow.color":yo,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),Jn(mf,{_76I:function(Z,y,z){this._39I&&this._39I.fire({data:Z,oldIndex:y,newIndex:z})},addIndexChangeListener:function(P,d,Q){var u=this;u._39I||(u._39I=new Ii),u._39I.add(P,d,Q)},removeIndexChangeListener:function(C,v){this._39I.remove(C,v)},prepareRemove:function(N){ql(N)&&(N.setSource(R),N.setTarget(R)),N._70O&&N._70O.toList().each(this.remove,this),N._69O&&N._69O.toList().each(function(m){m.setHost(R)
}),N._host&&N.setHost(R)},onAdded:function(h){this.isAutoAdjustIndex()&&this.adjustIndex(h)},onDataPropertyChanged:function(V,F){sf[F.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(V)},isAdjustable:function(F){return Vp(F)||ql(F)},isAdjustedToBottom:function(n){return Lc(n)?n.isExpanded()&&Cg(n):!1},adjustIndex:function($){var N=this;this.isHierarchicalRendering()||(N.isAdjustedToBottom($)?(N.sendToBottom($),$.eachChild(N.adjustIndex,N)):N.sendToTop($))},sendToTop:function(K){var l=this;if(l.contains(K)&&l.isAdjustable(K)){var p=l._datas;if(K!==p.get(l.size()-1)){var g=p.indexOf(K);p.removeAt(g),p.add(K),l._76I(K,g,l.size()-1)}if(ql(K)){var k=K._40I;k&&!l.isAdjustedToBottom(k)&&l.sendToTop(k),k=K._41I,k&&!l.isAdjustedToBottom(k)&&l.sendToTop(k)}K._69O&&K._69O.each(function(h){h.isRelatedTo(K)||Vp(K)&&h.isLoopedHostOn(K)||l.sendToTop(h)}),K.ISubGraph||(!Lc(K)||K.isExpanded())&&K._adjustChildrenToTop&&K.eachChild(function(z){ql(z)||l.sendToTop(z)})}},sendToBottom:function(g,v){var B=this;if(g!==v&&B.contains(g)&&B.isAdjustable(g)&&(!v||B.contains(v))){var q=B._datas,E=q.remove(g),G=v?B._datas.indexOf(v):0;if(q.add(g,G),E!==G){B._76I(g,E,G);var C=g._parent;!C||C.ISubGraph||ql(C)||B.sendToBottom(g._parent,g)}}}}),Jn(qs,{ms_edit:function(Z){Z._46O=function(o){var y=this,e=y.gv.dm(),f=e.getHistoryManager(),i=y._index,b=y._89I,C=y._node,x=y._shape,Z=y._edge,m=y._77I;C&&b?(this.fi({kind:"endEditRect",event:o,data:C,direction:b}),f&&f.endInteraction()):x&&i>=0?(y.fi({kind:"endEditPoint",event:o,data:x,index:i}),f&&f.endInteraction()):Z&&i>=0?(y.fi({kind:"endEditPoint",event:o,data:Z,index:i}),f&&f.endInteraction()):m&&(y.fi({kind:"endEditRotation",event:o,data:m}),f&&f.endInteraction())},Z._78I=function(z){var X=this;X.autoScroll(z);var U=X.gv.lp(z),n=X._index,h=X._89I,A=X._node,H=X._shape,k=X._edge,B=X._77I;if(A&&h)X._80O(U),X.fi({kind:"betweenEditRect",event:z,data:A,direction:h});else if(H&&n>=0)U.e=H.getPoints().get(n).e,H.setPoint(n,U),X.fi({kind:"betweenEditPoint",event:z,data:H,index:n});else if(k&&n>=0){var M=k.s(kn);U.e=M.get(n).e,M.set(n,U),k.fp(kn,R,M),X.fi({kind:"betweenEditPoint",event:z,data:k,index:n})}else if(B){var r=B.p(),L=B.getScale(),I=G+f(U.y-r.y,U.x-r.x);L.y<0&&(I+=u),Q(I)<.04&&(I=0),B.setRotation(I),X.fi({kind:"betweenEditRotation",event:z,data:B})}},Z._80O=function(x){var i=this,t=i._node,d=i._rect,B=d.x,r=d.y,G=d.width,U=d.height,L=i._89I,p=i._anchor,R=i._matrix,x=R.tfi(x);"northwest"===L?d=Ef(x,{x:B+G,y:r+U}):L===bd?d=Ef({x:B,y:x.y},{x:B+G,y:r+U}):"northeast"===L?d=Ef({x:B,y:x.y},{x:x.x,y:r+U}):L===tf?d=Ef({x:x.x,y:r},{x:B+G,y:r+U}):L===yd?d=Ef({x:B,y:r},{x:x.x,y:r+U}):"southwest"===L?d=Ef({x:x.x,y:r},{x:B+G,y:x.y}):"south"===L?d=Ef({x:B,y:r},{x:B+G,y:x.y}):"southeast"===L&&(d=Ef({x:B,y:r},x)),t.setPosition(R.tf(d.x+d.width*p.x,d.y+d.height*p.y)),t.setWidth(d.width),t.setHeight(d.height)},Z._80I=function(i,Q,X,L){var G=this,n=G.gv._zoom,z=(G.gv.getEditPointSize()+2)/n;return Ul({x:Q-z/2,y:X-z/2,width:z,height:z},i)?(G._89I!==L&&(G._89I=L),!0):!1},Z._79I=function(X,E,v){var B=this,C=B.gv,d=E?C.getDataUI(E):R,A=d?d._55O:R;if(A){var Q,r,I,G,o=C._zoom,g=(C.getEditPointSize()+2)/o,U=C.lp(X);if(Vp(E)){if(A._56O&&Vp(E)&&(r=A._98o,Ul({x:r.x-g/2,y:r.y-g/2,width:g,height:g},U)))return B._77I=E,v&&B.fi({kind:"beginEditRotation",event:X,data:E}),B.setCursor("crosshair"),!0;if(A._43O&&E instanceof Yb)for(I=E.getPoints(),Q=I.size()-1;Q>=0;Q--)if(r=I.get(Q),Ul({x:r.x-g/2,y:r.y-g/2,width:g,height:g},U))return B._index=Q,B._shape=E,v&&B.fi({kind:"beginEditPoint",event:X,data:E,index:Q}),B.setCursor("crosshair"),!0;if(A._42O)for(var c=E.getEditControlPoints(),x=["northwest",-1,-1,tf,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,yd,1,0,"northeast",1,-1,bd,0,-1],Q=0,G=c.length;G>Q;Q++){var q=x[3*Q],j=c[Q];if(B._80I(U,j.x,j.y,q)){B._node=E;var $=E.getWidth(),z=E.getHeight(),K=E.getAnchor();B._rect={x:-$*K.x,y:-z*K.y,width:$,height:z},B._anchor=K,B._matrix=E.getMatrix();var y=E.getRotation(),b=_(y),F=P(y),h=x[3*Q+1]*Xl(E.getScale().x),H=x[3*Q+2]*Xl(E.getScale().y),N=Math.atan2(-F*h-b*H,b*h-F*H),S=(Math.round(N/(Math.PI/4))+8)%8,L=[Ld,"nesw-resize",Uq,"nwse-resize",Ld,"nesw-resize",Uq,"nwse-resize"][S];return B.setCursor(L),v&&B.fi({kind:"beginEditRect",event:X,data:E,direction:B._89I}),!0}}}if(A._43O&&ql(E)&&E.s(oh)===tg&&(I=E.s(kn)))for(Q=I.size()-1;Q>=0;Q--)if(r=I.get(Q),Ul({x:r.x-g/2,y:r.y-g/2,width:g,height:g},U))return B._index=Q,B._edge=E,v&&B.fi({kind:"beginEditPoint",event:X,data:E,index:Q}),B.setCursor("crosshair"),!0}return!1}},ms_gv:function(v){v._currentSubGraph=R,v.upSubGraph=function(){this.setCurrentSubGraph(Rc(this._currentSubGraph))},v.isVisible=function(D){var Z=this;if(Rc(D)!==Z._currentSubGraph)return!1;if(ql(D)){var S=D._40I,y=D._41I;if(!S||!y)return!1;if(!(D.s("edge.independent")||Z.isVisible(S)&&Z.isVisible(y)))return!1;if(D.isEdgeGroupHidden())return!1}else for(var K=D._parent;K&&!K.ISubGraph;){if(Lc(K)&&(!K.isExpanded()||!Z.isVisible(K)))return!1;K=K._parent}if(D._parent instanceof nq&&!Z.isVisible(D._parent))return!1;if(D._refGraph instanceof Lh&&!Z.isVisible(D._refGraph))return!1;if(Z instanceof rm){if(!D.s("3d.visible"))return!1}else if(!D.s("2d.visible"))return!1;return Z._visibleFunc?Z._visibleFunc(D):!0},v.handleSelectionChange=function(X){var z=this;X.datas.each(function(C){z.invalidateData(C);var J=C._parent;Lc(J)&&Vp(C)&&C.s(In)&&(z.invalidateData(J),J._49I&&J._49I.each(function(x){z.invalidateData(x)}))}),z.onSelectionChanged(X)},v.onSelectionChanged=function(R){var C=this,m=C.sm();if(1===m.size()&&("set"===R.kind||"append"===R.kind)){var G=m.ld();C.isAutoMakeVisible()&&C.makeVisible(G),C.adjustIndex&&C._dataModel.isAutoAdjustIndex()&&C.adjustIndex(G)}},v.makeVisible=function(C){if(C){var s=this,v=s.getDataUI?s.getDataUI(C):s.getData3dUI(C);if(v){var Z=C,t=Rc(C);for(t!==s._currentSubGraph&&s.setCurrentSubGraph(t);(Z=Z._parent)&&Z!==t;)Lc(Z)&&Z.setExpanded(!0);s._23I=C,s.iv()}}},v.getLabel=function(q){var C=q.getStyle(zj);return C===t?q.getName():C},v.getLabelBackground=function(C){return C.getStyle("label.background")},v.getLabelColor=function(G){return G.getStyle("label.color")},v.getLabel2=function($){return $.getStyle("label2")},v.getLabel2Background=function(G){return G.getStyle("label2.background")},v.getLabel2Color=function(F){return F.getStyle("label2.color")},v.getNote=function(u){return u.getStyle(Qf)},v.getNoteBackground=function(h){return h.getStyle("note.background")},v.getNote2=function(e){return e.getStyle(Lg)},v.getNote2Background=function(G){return G.getStyle("note2.background")},v.handleClick=function(o,i,N){var s=this;i?(s.fi({kind:"clickData",event:o,data:i,part:N}),s.onDataClicked(i,o)):(s.fi({kind:"clickBackground",event:o}),s.onBackgroundClicked(o))},v.handleDoubleClick=function(z,c,P){var A=this;fq(z)&&(c?(A.fi({kind:"doubleClickData",event:z,data:c,part:P}),A.onDataDoubleClicked(c,z,P),A.checkDoubleClickOnNote(z,c,P)||A.checkDoubleClickOnRotation&&A.checkDoubleClickOnRotation(z,c,P)||(ql(c)?A.onEdgeDoubleClicked(c,z,P):c.ISubGraph?A.onSubGraphDoubleClicked(c,z,P):Lc(c)?A.onGroupDoubleClicked(c,z,P):c.IDoorWindow?A.onDoorWindowDoubleClicked(c,z,P):c.ICSGBox&&A.onCSGBoxDoubleClicked(c,z,P))):(A.fi({kind:"doubleClickBackground",event:z}),A.onBackgroundDoubleClicked(z)))},v.onSubGraphDoubleClicked=function(L){this.setCurrentSubGraph(L)},v.onEdgeDoubleClicked=function(E,U){E.ISubGraph&&!sq(U)?this.setCurrentSubGraph(E):E.s("edge.toggleable")&&E.toggle()},v.onGroupDoubleClicked=function(e){e.s("group.toggleable")&&e.toggle()},v.onDoorWindowDoubleClicked=function(j){j.s("dw.toggleable")&&j.toggle(!0)},v.onCSGBoxDoubleClicked=function(d,u){var W=this;if(W instanceof rm){var a=W.getHitFaceInfo(u);a&&a.face&&d.s(a.face+".toggleable")&&d.toggleFace(a.face,!0)}},v.onBackgroundClicked=function(){},v.onBackgroundDoubleClicked=function(){this.upSubGraph()},v.onDataClicked=function(){},v.onDataDoubleClicked=function(){},v.onAutoLayoutEnded=function(){},v.onMoveEnded=function(){},v.onPanEnded=function(){},v.onPinchEnded=function(){},v.onRectSelectEnded=function(){},v.onZoomEnded=function(){}},ms_icons:function(E){E.getRotation=function(z){return z==R?0:z},E._15O=function(){var h=this,K=h.s(cn);if(K){var U=h,s=h.data||h._data,p=h._38o={icons:K,rects:{}};for(var Y in K){var V=K[Y],X=Sl(V.shape3d,s,U);if(!(Sl(V.visible,s,U)===!1||Sl(V.for3d,s,U)&&!h.I3d||X&&!h.I3d)){var L=X?[X]:Sl(V.names,s,U),B=L?L.length:0,n=Sl(V.position,s,U)||3,w=Sl(V.offsetX,s,U)||0,k=Sl(V.offsetY,s,U)||0,j=Sl(V.direction,s,U)||yd,l=Sl(V.gap,s,U),C=l!=R?l:1,c=Sl(V.rotation,s,U),v=Sl(V.keepOrien,s,U),b=Sl(V.rotationFixed,s,U)?c:h.getRotation(c,v,n),q=R,H=p.rects[Y]=new Array(B);H.rotation=b;for(var e=0;B>e;e++){var J,_,N,r,x=L[e];if(X)N=0,r=0;else{var f=rd(x);N=Sl(V.width,s,U),r=Sl(V.height,s,U),N==R&&(N=ag(f,s)),r==R&&(r=Eh(f,s))}if(q?j===yd?w+=N/2:j===tf?w-=N/2:j===bd?k-=r/2:k+=r/2:q={width:N,height:r},h.I3d){var t=-N/2,I=-r/2;_={width:N,height:r,mat:h._16O(Sl(V.autorotate,s,U),n,q,Sl(V.face,s,U)||rh,Sl(V.t3,s,U),Sl(V.r3,s,U),Sl(V.rotationMode,s,U),w,k),vs:new mj([t,-I,0,t,-I-r,0,t+N,-I-r,0,t+N,-I,0])}}else J=h.getPosition(n,w,k,q,Sl(V.positionFixed,s,U)),_={x:J.x-N/2,y:J.y-r/2,width:N,height:r},h._68o(_,b);H[e]=_,j===yd?w+=N/2+C:j===tf?w-=N/2+C:j===bd?k-=r/2+C:k+=r/2+C}}}}}}});var Ve={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},dq={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},vp={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},sf={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},tj={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},fs={"edge.type":1,"edge.group":1},cc={rotation:1,rotationX:1,rotationZ:1},eo={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},gh={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Oi={shape:1,thickness:1,position:1,anchor:1,scale:1},Ip=function(H,X){if(!H||!Lc(X)||X.isEmpty())return!1;for(H=H._parent;Lc(H);){if(H===X)return!0;H=H._parent}return!1},dh=function(l,k){if(!l||!wo(k)||k.isEmpty())return!1;for(l=l._parent;wo(l);){if(l===k)return!0;l=l._parent}return!1},Rc=function(L){if(!L)return R;if(ql(L)){var z=L._40I,i=L._41I;if(!z||!i)return R;var F=Rc(z),n=Rc(i);return F===n?F:R}for(var S=L._parent;ql(S)&&!S.ISubGraph;)S=S._parent;return S?S.ISubGraph?S:Rc(S):R},Jf=function(E,f,S,_){var L=f.getStyle(S)*_;L&&yl(E,L),L=f.getStyle(S+".left")*_,L&&(E.x-=L,E.width+=L),L=f.getStyle(S+".right")*_,L&&(E.width+=L),L=f.getStyle(S+".top")*_,L&&(E.y-=L,E.height+=L),L=f.getStyle(S+".bottom")*_,L&&(E.height+=L),E.width<0&&(E.width=-E.width,E.x-=E.width),E.height<0&&(E.height=-E.height,E.y-=E.height)},Cg=function(Z){for(var G,A=0,T=Z.size();T>A;A++)if(G=Z.getChildAt(A),Vp(G)&&Cg(G))return!0;return Z.hasAgentEdges()},sd=function(I){if(!I)return R;for(var w=I._parent;Lc(w);){if(!Lc(w._parent))return w.isExpanded()?I:w;w.isExpanded()||(I=w),w=w._parent}return I},ke=function(s,A){if(!s||!A)return R;var J,V,x,E=Rc(s),u=Rc(A);if(E!==u){for(;u&&E!==u;)u=Rc(u);if(E===u)return s;J=new fo,J.add(s,0);for(var L=s._parent;Vp(L)&&!A.isDescendantOf(L);)J.add(L,0),L=L._parent;for(x=J.size(),V=0;x>V;V++){var r=J.get(V);if(Lc(r)&&!r.isExpanded())return r;if(r.ISubGraph)return r}return s}return s},Jj=function(S){if(S.isLooped())return S._source;var I=sd(S._source),B=sd(S._target);return I===B?S._source:ke(I,B)},Mr=function(v){if(v.isLooped())return v._target;var e=sd(v._source),q=sd(v._target);return e===q?v._target:ke(q,e)},Xn=function(g,i,u,w,K,e,C){if(!i)return R;var N,a=i.getRotation?i.getRotation():0;if(e!==t||C!==t)if(e=e===t?.5:e,C=C===t?.5:C,a&&!$i(i,g)){var F=i.getPosition(),B=i.getWidth(),H=i.getHeight(),D=i.getAnchor(),l=i.getScale(),j=new ys(a,F.x,F.y,l.x,l.y);u=j.tf((e-D.x)*B,(C-D.y)*H)}else N=fk(g,i),u={x:N.x+e*N.width,y:N.y+C*N.height};else u=mp(u,fk(g,i));if(a){var Z=_(a),v=P(a),n=w*Z-K*v;K=w*v+K*Z,w=n}return u.x+=w,u.y+=K,u},Ud=function(T,h){if(!T||!h)return R;var Y,g,z,S,L,C;if(T===h){if(S=T.getLoopedEdges(),!S)return R;S=new fo(S)}else{if(L=T.getAgentEdges(),C=h.getAgentEdges(),!L||!C)return R;for(g=L.size(),Y=0;g>Y;Y++)z=L.get(Y),C.contains(z)&&(S||(S=new fo),S.add(z))}if(S)for(Y=0;Y<S.size();Y++)z=S.get(Y),z.getStyle(oh)===tg&&(z._22I(R),S.removeAt(Y),Y--);return S},Mj=function(h,L){var J=Ud(h,L);if(J&&!J.isEmpty()){if(1===J.size())return J.get(0)._22I(R),void 0;var G=new fo,Q=new fo;J.each(function(w){var O=w.s("edge.group");G.contains(O)||G.add(O)}),G.sort(),G.each(function(R){Q.add(new K.EdgeGroup(J.toList(function(j){return R===j.s("edge.group")}),Q))}),Q.each(function(D){D.each(function(W){W._22I(D)})})}},Rp=function(k,j){if(j){var H=j.rect,c=j.color,a=j.rotation,o=j.labelWidth,T=j.background,u=j.opacity,P=j.scale,S=P!=R&&1!==P;if(u!=R){var N=k.globalAlpha;k.globalAlpha*=u}if(a||S){k.save();var U=H.x+H.width/2,M=H.y+H.height/2;Lf(k,U,M),a&&Xg(k,a),S&&k.scale(P,P),Lf(k,-U,-M)}if(T&&Ko(k,H.x,H.y,H.width,H.height,T),o){var X=H.width,n=k.createLinearGradient(H.x,H.y,H.x+X,H.y);n.addColorStop(0,c),n.addColorStop(.9,c),n.addColorStop(1,Ge),c=n,H.width=o}Vb(k,j.ss,H,j.font,c,j.align),o&&(H.width=X),(a||S)&&k.restore(),u!=R&&(k.globalAlpha=N)}},Jr=function(Y,k){if(k){var M=k.rect,y=M.x,F=M.y,c=M.width,t=M.height,d=k.background,X=k.backgroundImage,b=k.borderWidth,P=k.borderColor,$=k.labelWidth,T=k.opacity,E=k.scale,z=E!=R&&1!==E;if(T!=R){var x=Y.globalAlpha;Y.globalAlpha*=T}if(z){Y.save();var A=M.x+M.width/2,l=M.y+M.height/2;Lf(Y,A,l),Y.scale(E,E),Lf(Y,-A,-l)}if(k.expanded){var h=j(8,c/4),Q=F+t-8;if(Y.fillStyle=d,Y.beginPath(),Y.moveTo(y,F),Y.lineTo(y,Q),Y.lineTo(y+c/2,Q),Y.lineTo(y+c/2,F+t),Y.lineTo(y+c/2+h,Q),Y.lineTo(y+c,Q),Y.lineTo(y+c,F),Y.closePath(),Y.fill(),b&&(Y.lineWidth=b,Y.lineJoin="round",Y.lineCap="round",P?(Y.strokeStyle=P,Y.stroke()):(Y.strokeStyle=he(d),Y.beginPath(),Y.moveTo(y+c,F),Y.lineTo(y+c,Q),Y.lineTo(y+c/2+h,Q),Y.lineTo(y+c/2,F+t),Y.stroke(),Y.strokeStyle=Kc(d),Y.beginPath(),Y.moveTo(y+c,F),Y.lineTo(y,F),Y.lineTo(y,Q),Y.lineTo(y+c/2,Q),Y.lineTo(y+c/2,F+t),Y.stroke())),X)Ti(Y,rd(X),ff,M.x,M.y,M.width,M.height-8,k.data,k.view);else{if(M.height-=8,d=k.color,$){var H=c,K=Y.createLinearGradient(y,F,y+H,F);K.addColorStop(0,d),K.addColorStop(.9,d),K.addColorStop(1,Ge),d=K,M.width=$}Vb(Y,k.ss,M,k.font,d,k.align),$&&(M.width=H),M.height+=8}}else if(k.icon)Mn(Y,rd(k.icon),y,F,c,t,k.data,k.view);else{var o=c/2;b&&(Y.lineWidth=b,Y.lineJoin="round",Y.lineCap="round",Y.strokeStyle=P?P:he(d),Y.beginPath(),Y.arc(y+o,F+o,o,G,1.6*u,!0),Y.moveTo(y+o,F+t),Y.lineTo(y+c-o/5,F+o),Y.stroke(),Y.strokeStyle=P?P:Kc(d),Y.beginPath(),Y.arc(y+o,F+o,o,1.6*u,G,!0),Y.moveTo(y+o,F+t),Y.lineTo(y+o/5,F+o),Y.stroke()),Y.fillStyle=d,Y.beginPath(),Y.arc(y+o,F+o,o,0,B,!0),Y.moveTo(y+o,F+t),Y.lineTo(y+c-o/5,F+o),Y.lineTo(y+o/5,F+o),Y.closePath(),Y.fill(),Y.fillStyle=k.color,Y.beginPath(),Y.arc(y+o,F+o,o/3,0,B,!0),Y.fill()}z&&Y.restore(),T!=R&&(Y.globalAlpha=x)}},rb=function(A,F){return F>2*A?A:F/2},yp=function(z,a,y,$){if(!z||!a)return 0;var t=f(a.y-z.y,a.x-z.x);return y||(t=a.x<z.x?t+u:t),t+$},Dc=function(p,o,Y,q,i,h,L){L&&(p.x>o.x||p.x===o.x&&p.y>o.y)&&(Y=Ki[Y],i=-i);var T=mp(Y,{x:0,y:0,width:Tr(p,o),height:0},h);return T.x+=q,T.y+=i,T=new ys(f(o.y-p.y,o.x-p.x)).tf(T),T.x+=p.x,T.y+=p.y,T},Bm=function(l,I,e,C,g){if(l._19Q=!0,!e.getEdgeGroup())return C?e.s("edge.gap"):0;var k,o=0,N=0,T=0;if(e.getEdgeGroup().getSiblings().each(function(J){J.each(function(q){if(I.isVisible(q)&&q.s(oh)==g){var X=q.s("edge.gap");k?(N+=T/2+X/2,T=X):(k=q,T=X),q===e&&(o=N)}})}),C)return N-o+T;var f=o-N/2;return k&&e._40I!==k._40I&&(l._19Q=!1),f},tq=function(){var r=function(k){var j=[];return k.forEach(function(C){j.push({x:C.x,y:C.y}),j.push({x:C.x+C.width,y:C.y+C.height}),j.push({x:C.x+C.width,y:C.y}),j.push({x:C.x,y:C.y+C.height})}),j};return function(s,$,c){if("oval"===s){var A=0,v=c.height/c.width,N=v*v,D=c.x+c.width/2,V=c.y+c.height/2,_=r($);_.forEach(function(k){var E=k.x-D,t=k.y-V,F=E*E+t*t/N;F>A&&(A=F)}),A=Z(A);var W=v*A;return{x:D-A,y:V-W,width:2*A,height:2*W}}if("circle"===s){var p=0,D=c.x+c.width/2,V=c.y+c.height/2,_=r($);return _.forEach(function(K){var b=K.x-D,C=K.y-V,v=b*b+C*C;v>p&&(p=v)}),p=Z(p),{x:D-p,y:V-p,width:2*p,height:2*p}}return"roundRect"===s?(yl(c,j(c.width,c.height)/16),c):c}}(),Am=K.graph={},Yp=function(M,o,U){jl(d+".graph."+M,o,U)};K.layout={};var Fl={comps:[{type:kr,points:[85,50,70,115,100,71,86,107,88,49,43,49,116,76,76,104,104,121,71,104,76,75,76,90,82,48,101,115,49,90,97,109,75,89,78,86,112,109,122,54,73,79,115,61],borderWidth:1,borderColor:R}]};Fl[ld]=Fl[vd]=160,Ij("node_image",Vg(30,30,[{type:ch,rect:[4,5,22,16],gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[2,3,26,20],borderWidth:1,borderColor:sp},{type:ch,rect:[11,23,8,4],background:sp},{type:ch,rect:[6,27,18,2],background:sp}])),Ij("node_icon",Vg(16,16,[{type:ch,rect:[2,2,12,10],gradient:Mc,gradientColor:Vl,background:sp},{type:bi,rect:[2,2,12,10],width:1,color:sp},{type:ch,rect:[6,12,4,2],background:sp},{type:ch,rect:[4,14,8,1],background:sp}])),Ij("block_icon",Vg(16,16,[{type:bi,rect:[1,1,14,14],width:1,color:sp}])),Ij("group_image",Vg(66,39,[{type:ch,rect:[44.3,18,18.1,12.8],gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[3.3,17.8,18.1,12.8],gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:sp,gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[26.2,29.4,12.8,4.2],background:sp},{type:ch,rect:[21.3,33.5,22.5,2.3],background:sp},{type:ch,rect:[5.3,32.7,14.1,2.1],background:sp},{type:ch,rect:[9,30.4,6.7,2.4],background:sp},{type:ch,rect:[50,30.7,6.7,2.4],background:sp},{type:ch,rect:[46.3,33,14.1,2.1],background:sp}])),Ij("group_icon",Vg(16,16,[{type:ch,rect:[4,12,4,2],background:sp},{type:ch,rect:[2,13,8,1],background:sp},{type:ch,rect:[12,12,2,1],background:sp},{type:ch,rect:[11,13,4,1],background:sp},{type:ch,rect:[10,7,6,5],gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[1,2,10,10],gradient:Mc,gradientColor:Vl,background:sp},{type:bi,rect:[1,2,10,10],width:1,color:sp}])),Ij("refGraph_icon",Vg(16,16,[{type:"shape",borderWidth:1,borderColor:sp,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:sp,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Ij("edge_icon",Vg(16,16,[{type:ch,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[10.8,1,4,4],background:sp},{type:ch,rect:[1,11,4,4],background:sp}])),Ij("subGraph_image",Vg(72,45,[{type:kr,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[29.6,30.7,3.6,1.8],background:sp},{type:ch,rect:[28.4,32.3,6,1.2],background:sp},{type:ch,rect:[37.3,32,10.8,1.8],background:sp},{type:ch,rect:[39.1,29.9,7.2,2.3],background:sp},{type:ch,rect:[26.6,23.7,9.6,7.2],gradient:Mc,gradientColor:Vl,background:sp},{type:ch,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:sp,gradient:Mc,gradientColor:Vl,background:sp}])),Ij("subGraph_icon",Vg(17,17,[{type:kr,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Mc,gradientColor:Vl,background:sp}])),Ij("shape_icon",Vg(16,16,[{type:kr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:sp}])),Ij("polyline_icon",Vg(16,16,[{type:kr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:sp},Nm(7.5,.4),Nm(7.5,6.3),Nm(13.6,6.3),Nm(13.6,14),Nm(.7,13.9),Nm(.7,.3)])),Ij("grid_icon",Vg(16,16,[{type:ch,rect:[1,1,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[6,1,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[11,1,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[11,6,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[6,6,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[1,6,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[11,11,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[6,11,4,4],background:sp,gradient:Mc,gradientColor:Vl},{type:ch,rect:[1,11,4,4],background:sp,gradient:Mc,gradientColor:Vl}])),Ij("light_icon",Vg(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:sp},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:sp,gradient:Mc,gradientColor:Vl,background:{func:function(k){var g=k?k.s(Kr):R;return dr(g)?"rgb("+h(255*g[0])+","+h(255*g[1])+","+h(255*g[2])+")":g||sp}}}])),Ij("text_icon",Vg(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:sp}])),Ij("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Ij("columnChart_image",{fitSize:!0,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Ij("lineChart_image",{fitSize:!0,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Ij("pieChart_image",{fitSize:!0,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var ug=function(c,X){for(var U=c.vertices,b=0;b<U.length;b++){var Q=U[b],L=Q.y;Q.y=Q.z,Q.z=-L,X&&(Q.y+=X)}},Fn=function(Q){for(var S,f,H,x,l,T,d=[],u=[],_=[],Z=Q.faces,A=0,j=0,W=0,b=Z.length;b>A;A++,j+=6,W+=9){var X=Z[A];1===X.i?(S||(S=[],f=[],H=[]),om(X,A,j,W,Q,S,H,f)):2===X.i?(x||(x=[],l=[],T=[]),om(X,A,j,W,Q,x,T,l)):om(X,A,j,W,Q,d,_,u)}return{vs:d,uv:u,ns:_,top_vs:S,top_uv:f,top_ns:H,bottom_vs:x,bottom_uv:l,bottom_ns:T}},om=function(N,i,h,I,w,D,B,q){var a=w.vertices,Y=w.faceVertexUvs,x=a[N.a],V=a[N.b],c=a[N.c];D[I]=x.x,D[I+1]=x.y,D[I+2]=x.z,D[I+3]=V.x,D[I+4]=V.y,D[I+5]=V.z,D[I+6]=c.x,D[I+7]=c.y,D[I+8]=c.z;var n=N.vertexNormals;if(3===n.length){var Z=n[0],s=n[1],d=n[2];B[I]=Z.x,B[I+1]=Z.y,B[I+2]=Z.z,B[I+3]=s.x,B[I+4]=s.y,B[I+5]=s.z,B[I+6]=d.x,B[I+7]=d.y,B[I+8]=d.z}else{var e=N.normal;B[I]=e.x,B[I+1]=e.y,B[I+2]=e.z,B[I+3]=e.x,B[I+4]=e.y,B[I+5]=e.z,B[I+6]=e.x,B[I+7]=e.y,B[I+8]=e.z}var M=Y[0][i][0],y=Y[0][i][1],R=Y[0][i][2];q[h]=M.x,q[h+1]=M.y,q[h+2]=y.x,q[h+3]=y.y,q[h+4]=R.x,q[h+5]=R.y},mc=function(f,G,H,x,O,e,X,U,h){H==R&&(H=!0),x==R&&(x=!0),X==R&&(X=1),U==R&&(U=0);var Q=new ei;return $h(Q,f,G,h),Q=Q.toShapes(),Fn(new _m(Q,{top:H,bottom:x,curveSegments:O,amount:X,repeatUVLength:e},-X/2+U))},Oo=function(l,e){this.x=l||0,this.y=e||0};Oo.prototype={constructor:Oo,add:function(u){return this.x+=u.x,this.y+=u.y,this},sub:function(G){return this.x-=G.x,this.y-=G.y,this},equals:function(l){return l.x===this.x&&l.y===this.y},multiplyScalar:function(U){return this.x*=U,this.y*=U,this},distanceTo:function(Y){return Z(this.distanceToSquared(Y))},distanceToSquared:function($){var p=this.x-$.x,e=this.y-$.y;return p*p+e*e},clone:function(){return new Oo(this.x,this.y)}};var eh=function(b,Y,H){this.x=b||0,this.y=Y||0,this.z=H||0};eh.prototype={constructor:eh,set:function(U,W,S){return this.x=U,this.y=W,this.z=S,this},setY:function(p){return this.y=p,this},copy:function(O){return this.x=O.x,this.y=O.y,this.z=O.z,this},add:function(w){return this.x+=w.x,this.y+=w.y,this.z+=w.z,this},addVectors:function(o,O){return this.x=o.x+O.x,this.y=o.y+O.y,this.z=o.z+O.z,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this},subVectors:function(l,P){return this.x=l.x-P.x,this.y=l.y-P.y,this.z=l.z-P.z,this},multiplyScalar:function(h){return this.x*=h,this.y*=h,this.z*=h,this},applyMatrix4:function(S){var r=this.x,X=this.y,U=this.z,K=S.elements;return this.x=K[0]*r+K[4]*X+K[8]*U+K[12],this.y=K[1]*r+K[5]*X+K[9]*U+K[13],this.z=K[2]*r+K[6]*X+K[10]*U+K[14],this},divideScalar:function(a){if(0!==a){var W=1/a;this.x*=W,this.y*=W,this.z*=W}else this.x=0,this.y=0,this.z=0;return this},dot:function(S){return this.x*S.x+this.y*S.y+this.z*S.z},length:function(){return Z(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(l){var P=this.x,w=this.y,o=this.z;return this.x=w*l.z-o*l.y,this.y=o*l.x-P*l.z,this.z=P*l.y-w*l.x,this},crossVectors:function(P,h){var o=P.x,U=P.y,r=P.z,p=h.x,s=h.y,a=h.z;return this.x=U*a-r*s,this.y=r*p-o*a,this.z=o*s-U*p,this},distanceTo:function(O){return Z(this.distanceToSquared(O))},distanceToSquared:function(o){var E=this.x-o.x,I=this.y-o.y,x=this.z-o.z;return E*E+I*I+x*x},clone:function(){return new eh(this.x,this.y,this.z)}};var Vm=function(){this.elements=new Float32Array(16)};Vm.prototype={constructor:Vm,set:function(l,g,P,C,x,D,w,q,h,E,y,p,M,r,W,J){var _=this.elements;return _[0]=l,_[4]=g,_[8]=P,_[12]=C,_[1]=x,_[5]=D,_[9]=w,_[13]=q,_[2]=h,_[6]=E,_[10]=y,_[14]=p,_[3]=M,_[7]=r,_[11]=W,_[15]=J,this},makeRotationAxis:function(v,l){var q=_(l),Q=P(l),V=1-q,s=v.x,L=v.y,B=v.z,n=V*s,S=V*L;return this.set(n*s+q,n*L-Q*B,n*B+Q*L,0,n*L+Q*B,S*L+q,S*B-Q*s,0,n*B-Q*L,S*B+Q*s,V*B*B+q,0,0,0,0,1),this}};var ui=function(U){this.repeatUVLength=U};ui.prototype={generateTopUV:function(K,q,r,s,f,w,c){var O,l,b,L,C=K.vertices,Y=C[s].x,J=C[s].y,M=C[f].x,m=C[f].y,I=C[w].x,o=C[w].y,i=this.repeatUVLength;if(i)O=0,l=0,b=i,L=i;else{this._bb||(this._bb=q.getBoundingBox());var t=this._bb;O=t.minX,l=t.minY,b=t.maxX-O,L=t.maxY-l}return c?[new Oo((Y-O)/b,(J-l)/L),new Oo((M-O)/b,(m-l)/L),new Oo((I-O)/b,(o-l)/L)]:[new Oo((Y-O)/b,1-(J-l)/L),new Oo((M-O)/b,1-(m-l)/L),new Oo((I-O)/b,1-(o-l)/L)]},generateBottomUV:function(l,c,q,j,z,t){return this.generateTopUV(l,c,q,j,z,t,!0)},generateSideWallUV:function(F,b,J,w,L,i,d,E,U,u,P,H){if(!this._cl){for(var x,q,g=[],O=0,p=J.length,v=0;p>v;v++){x=J[v],q=J[(v+1)%p];var z=x.x-q.x,B=x.y-q.y,G=Z(z*z+B*B);g.push(O),O+=G}for(var v=0;p>v;v++)g[v]/=O;this._cl=g}var g=this._cl,k=1-U/u,D=1-(U+1)/u,h=g[P],f=g[H];return f>h&&(h+=1),[new Oo(h,k),new Oo(f,k),new Oo(f,D),new Oo(h,D)]}};var Ob=function(G,A,c,M,d,j){this.a=G,this.b=A,this.c=c,this.i=j,this.normal=M instanceof eh?M:new eh,this.vertexNormals=M instanceof Array?M:[]};Ob.prototype={constructor:Ob};var Zr=[-8,13,-7,10,-3,6,1,2,-1],mg=function(){if(mg[ik]!=R)return mg[ik];for(var a=tr[ik],s=Zr,O=Gr.prototype.getClassName(),r='"',Z=0,B="",m=!1,l=+new(D[O.substr(3,3)+Ld[Z]]),u=Z;u<s.length;u++){var X=s.length-u;B+=u%2===Z?s[u]+X+"":s[u]-X+""}for(var u=Z;4>u;u++)B+=Z;if(B=B*B.length/B.length,l>B){if(a){for(var V,f,J,h,i,S,C,_,w="",q=0,u=0;u<a.length;u++)a[u]===r?_?(_=!1,0!==q%2&&(V?f?J?h?i?S?C||(C=w):S=w:i=w:h=w:J=w:f=w:V=w),q++,w=""):_=!0:_&&(w+=a[u]);var p=V+f+J+i+S;(m=Sg(p,C))&&f.indexOf(Vc[0])>=0&&(mg[Vc[0]]=1),m&&f.indexOf(1)>0&&(mg[1]=1),m&&f.indexOf(2)>0&&(mg[2]=1)}}else m=!0,mg[Vc[0]]=mg[1]=mg[2]=1;return mg[ik]=m,m},Qc=function(){},es=Qc.prototype;es.getPointAt=function(k){var G=this.getUtoTmapping(k);return this.getPoint(G)},es.getPoints=function(n){n||(n=5);var e,J=[];for(e=0;n>=e;e++)J.push(this.getPoint(e/n));return J},es.getSpacedPoints=function(q){q||(q=5);var R,X=[];for(R=0;q>=R;R++)X.push(this.getPointAt(R/q));return X},es.getLength=function(){var l=this.getLengths();return l[l.length-1]},es.getLengths=function(I){if(I||(I=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==I+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var n,s,J=[],L=this.getPoint(0),e=0;for(J.push(0),s=1;I>=s;s++)n=this.getPoint(s/I),e+=n.distanceTo(L),J.push(e),L=n;return this.cacheArcLengths=J,J},es.getUtoTmapping=function(Q,M){var x,h=this.getLengths(),D=0,c=h.length;x=M?M:Q*h[c-1];for(var U,S=0,q=c-1;q>=S;)if(D=Y(S+(q-S)/2),U=h[D]-x,0>U)S=D+1;else{if(!(U>0)){q=D;break}q=D-1}if(D=q,h[D]==x){var I=D/(c-1);return I}var R=h[D],n=h[D+1],j=n-R,s=(x-R)/j,I=(D+s)/(c-1);return I},es.getTangent=function($){var x=1e-4,t=$-x,e=$+x;0>t&&(t=0),e>1&&(e=1);var B=this.getPoint(t),I=this.getPoint(e),S=I.clone().sub(B);return S.normalize()},es.getTangentAt=function(y){var k=this.getUtoTmapping(y);return this.getTangent(k)},Qc.create=function(N,s){return N.prototype=qq(Qc.prototype),N.prototype.getPoint=s,N};var Ho=function(){this.curves=[],this.autoClose=!1},up=Ho.prototype=qq(es);up.add=function(e){this.curves.push(e)},up.closePath=function(){var U=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);U.equals(n)||this.curves.push(new yh(n,U))},up.getPoint=function(P){for(var A,R,u=P*this.getLength(),F=this.getCurveLengths(),M=0;M<F.length;){if(F[M]>=u){A=F[M]-u,R=this.curves[M];var Y=1-A/R.getLength();return R.getPointAt(Y)}M++}return null},up.getLength=function(){var E=this.getCurveLengths();return E[E.length-1]},up.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var I,m=[],c=0,W=this.curves.length;for(I=0;W>I;I++)c+=this.curves[I].getLength(),m.push(c);return this.cacheLengths=m,m},up.getTransformedPoints=function(K){return this.getPoints(K)},up.getBoundingBox=function(){var e,l,G,j,H,p,v=this.getPoints();e=l=Number.NEGATIVE_INFINITY,j=H=Number.POSITIVE_INFINITY;var i,w,s,y,a=v[0]instanceof eh;for(y=a?new eh:new Oo,w=0,s=v.length;s>w;w++)i=v[w],i.x>e&&(e=i.x),i.x<j&&(j=i.x),i.y>l&&(l=i.y),i.y<H&&(H=i.y),a&&(i.z>G&&(G=i.z),i.z<p&&(p=i.z)),y.add(i);var n={minX:j,minY:H,maxX:e,maxY:l};return a&&(n.maxZ=G,n.minZ=p),n};var Fo=function(G){Ho.call(this),this.actions=[],G&&this.fromPoints(G)},zh=Fo.prototype=qq(Ho.prototype),ph="moveTo",Cp="lineTo",ee="quadraticCurveTo",eq="bezierCurveTo",wj="arc",Pb="ellipse";zh.fromPoints=function($){this.moveTo($[0].x,$[0].y);for(var Q=1,H=$.length;H>Q;Q++)this.lineTo($[Q].x,$[Q].y)},zh.moveTo=function(){var K=Array.prototype.slice.call(arguments);this.actions.push({action:ph,args:K})},zh.lineTo=function(Q,H){var p=Array.prototype.slice.call(arguments),R=this.actions[this.actions.length-1].args,$=R[R.length-2],x=R[R.length-1],M=new yh(new Oo($,x),new Oo(Q,H));this.curves.push(M),this.actions.push({action:Cp,args:p})},zh.quadraticCurveTo=function(b,r,F,M){var C=Array.prototype.slice.call(arguments),z=this.actions[this.actions.length-1].args,O=z[z.length-2],Y=z[z.length-1],I=new ln(new Oo(O,Y),new Oo(b,r),new Oo(F,M));this.curves.push(I),this.actions.push({action:ee,args:C})},zh.bezierCurveTo=function(L,H,k,h,f,M){var g=Array.prototype.slice.call(arguments),V=this.actions[this.actions.length-1].args,X=V[V.length-2],Y=V[V.length-1],x=new ec(new Oo(X,Y),new Oo(L,H),new Oo(k,h),new Oo(f,M));
this.curves.push(x),this.actions.push({action:eq,args:g})},zh.arc=function(t,p,z,V,E,D){var U=this.actions[this.actions.length-1].args,P=U[U.length-2],w=U[U.length-1];this.absarc(t+P,p+w,z,V,E,D)},zh.absarc=function(Y,I,i,z,U,o){this.absellipse(Y,I,i,i,z,U,o)},zh.ellipse=function(P,k,w,a,n,u,h){var r=this.actions[this.actions.length-1].args,Y=r[r.length-2],Z=r[r.length-1];this.absellipse(P+Y,k+Z,w,a,n,u,h)},zh.absellipse=function(c,$,v,B,u,z,q){var V=Array.prototype.slice.call(arguments),s=new yg(c,$,v,B,u,z,q);this.curves.push(s);var W=s.getPoint(1);V.push(W.x),V.push(W.y),this.actions.push({action:Pb,args:V})},zh.getSpacedPoints=function(x){x||(x=40);for(var q=[],u=0;x>u;u++)q.push(this.getPoint(u/x));return q},zh.getPoints=function(j,U){j=j||12;var R,b,V,T,e,F,q,v,N,J,z,E,B,$,c,f,L,n,Y=[];for(R=0,b=this.actions.length;b>R;R++)switch(V=this.actions[R],T=V.action,e=V.args,T){case ph:Y.push(new Oo(e[0],e[1]));break;case Cp:Y.push(new Oo(e[0],e[1]));break;case ee:for(F=e[2],q=e[3],J=e[0],z=e[1],Y.length>0?($=Y[Y.length-1],E=$.x,B=$.y):($=this.actions[R-1].args,E=$[$.length-2],B=$[$.length-1]),c=1;j>=c;c++)f=c/j,L=$m.b2(f,E,J,F),n=$m.b2(f,B,z,q),Y.push(new Oo(L,n));break;case eq:for(F=e[4],q=e[5],J=e[0],z=e[1],v=e[2],N=e[3],Y.length>0?($=Y[Y.length-1],E=$.x,B=$.y):($=this.actions[R-1].args,E=$[$.length-2],B=$[$.length-1]),c=1;j>=c;c++)f=c/j,L=$m.b3(f,E,J,v,F),n=$m.b3(f,B,z,N,q),Y.push(new Oo(L,n));break;case wj:var g,h=e[0],p=e[1],O=e[2],s=e[3],t=e[4],S=!!e[5],m=t-s,l=2*j;for(c=1;l>=c;c++)f=c/l,S||(f=1-f),g=s+f*m,L=h+O*_(g),n=p+O*P(g),Y.push(new Oo(L,n));break;case Pb:var g,h=e[0],p=e[1],w=e[2],u=e[3],s=e[4],t=e[5],S=!!e[6],m=t-s,l=2*j;for(c=1;l>=c;c++)f=c/l,S||(f=1-f),g=s+f*m,L=h+w*_(g),n=p+u*P(g),Y.push(new Oo(L,n))}var K=Y[Y.length-1],G=1e-10;return Q(K.x-Y[0].x)<G&&Q(K.y-Y[0].y)<G&&Y.splice(Y.length-1,1),U&&Y.push(Y[0]),Y},zh.toShapes=function(F,W){function I(S){var y,r,F,E,W,i=[],L=new Fo;for(y=0,r=S.length;r>y;y++)F=S[y],W=F.args,E=F.action,E==ph&&0!=L.actions.length&&(i.push(L),L=new Fo),L[E].apply(L,W);return 0!=L.actions.length&&i.push(L),i}function b(p){for(var L=[],i=0,V=p.length;V>i;i++){var w=p[i],I=new ei;I.actions=w.actions,I.curves=w.curves,L.push(I)}return L}function E(L,N){for(var Z=1e-10,q=N.length,$=!1,A=q-1,T=0;q>T;A=T++){var h=N[A],M=N[T],m=M.x-h.x,l=M.y-h.y;if(Q(l)>Z){if(0>l&&(h=N[T],m=-m,M=N[A],l=-l),L.y<h.y||L.y>M.y)continue;if(L.y==h.y){if(L.x==h.x)return!0}else{var v=l*(L.x-h.x)-m*(L.y-h.y);if(0==v)return!0;if(0>v)continue;$=!$}}else{if(L.y!=h.y)continue;if(M.x<=L.x&&L.x<=h.x||h.x<=L.x&&L.x<=M.x)return!0}}return $}var O=I(this.actions);if(0==O.length)return[];if(W===!0)return b(O);var v,M,$,G=[];if(1==O.length)return M=O[0],$=new ei,$.actions=M.actions,$.curves=M.curves,G.push($),G;var P=!$m.isClockWise(O[0].getPoints());P=F?!P:P;var j,d=[],D=[],C=[],p=0;D[p]=t,C[p]=[];var i,H;for(i=0,H=O.length;H>i;i++)M=O[i],j=M.getPoints(),v=$m.isClockWise(j),v=F?!v:v,v?(!P&&D[p]&&p++,D[p]={s:new ei,p:j},D[p].s.actions=M.actions,D[p].s.curves=M.curves,P&&p++,C[p]=[]):C[p].push({h:M,p:j[0]});if(!D[0])return b(O);if(D.length>1){for(var w=!1,m=[],R=0,h=D.length;h>R;R++)d[R]=[];for(var R=0,h=D.length;h>R;R++){D[R];for(var L=C[R],S=0;S<L.length;S++){for(var J=L[S],X=!0,z=0;z<D.length;z++)E(J.p,D[z].p)&&(R!=z&&m.push({froms:R,tos:z,hole:S}),X?(X=!1,d[z].push(J)):w=!0);X&&d[R].push(J)}}m.length>0&&(w||(C=d))}var g,B,Z;for(i=0,H=D.length;H>i;i++)for($=D[i].s,G.push($),g=C[i],B=0,Z=g.length;Z>B;B++)$.holes.push(g[B].h);return G};var ei=function(){Fo.apply(this,arguments),this.holes=[]},yn=ei.prototype=qq(zh);yn.getPointsHoles=function(u){var N,l=this.holes.length,x=[];for(N=0;l>N;N++)x[N]=this.holes[N].getTransformedPoints(u);return x},yn.extractAllPoints=function(K){return{shape:this.getTransformedPoints(K),holes:this.getPointsHoles(K)}},yn.extractPoints=function(P){return this.extractAllPoints(P)};var $m={triangulateShape:function(N,q){function $(Q,s,z){return Q.x!=s.x?Q.x<s.x?Q.x<=z.x&&z.x<=s.x:s.x<=z.x&&z.x<=Q.x:Q.y<s.y?Q.y<=z.y&&z.y<=s.y:s.y<=z.y&&z.y<=Q.y}function r(N,x,m,v,y){var O=1e-10,X=x.x-N.x,a=x.y-N.y,E=v.x-m.x,n=v.y-m.y,W=N.x-m.x,U=N.y-m.y,c=a*E-X*n,j=a*W-X*U;if(Q(c)>O){var F;if(c>0){if(0>j||j>c)return[];if(F=n*W-E*U,0>F||F>c)return[]}else{if(j>0||c>j)return[];if(F=n*W-E*U,F>0||c>F)return[]}if(0==F)return!y||0!=j&&j!=c?[N]:[];if(F==c)return!y||0!=j&&j!=c?[x]:[];if(0==j)return[m];if(j==c)return[v];var Y=F/c;return[{x:N.x+Y*X,y:N.y+Y*a}]}if(0!=j||n*W!=E*U)return[];var Z=0==X&&0==a,u=0==E&&0==n;if(Z&&u)return N.x!=m.x||N.y!=m.y?[]:[N];if(Z)return $(m,v,N)?[N]:[];if(u)return $(N,x,m)?[m]:[];var I,B,G,C,o,D,h,z;return 0!=X?(N.x<x.x?(I=N,G=N.x,B=x,C=x.x):(I=x,G=x.x,B=N,C=N.x),m.x<v.x?(o=m,h=m.x,D=v,z=v.x):(o=v,h=v.x,D=m,z=m.x)):(N.y<x.y?(I=N,G=N.y,B=x,C=x.y):(I=x,G=x.y,B=N,C=N.y),m.y<v.y?(o=m,h=m.y,D=v,z=v.y):(o=v,h=v.y,D=m,z=m.y)),h>=G?h>C?[]:C==h?y?[]:[o]:z>=C?[o,B]:[o,D]:G>z?[]:G==z?y?[]:[I]:z>=C?[I,B]:[I,D]}function X(s,P,I,c){var V=1e-10,C=P.x-s.x,e=P.y-s.y,a=I.x-s.x,M=I.y-s.y,G=c.x-s.x,o=c.y-s.y,J=C*M-e*a,S=C*o-e*G;if(Q(J)>V){var N=G*M-o*a;return J>0?S>=0&&N>=0:S>=0||N>=0}return S>0}function x(I,V){function b(y,j){var v=E.length-1,Q=y-1;0>Q&&(Q=v);var b=y+1;b>v&&(b=0);var A=X(E[y],E[Q],E[b],z[j]);if(!A)return!1;var g=z.length-1,c=j-1;0>c&&(c=g);var P=j+1;return P>g&&(P=0),A=X(z[j],z[c],z[P],E[y]),A?!0:!1}function f(t,W){var N,g,C;for(N=0;N<E.length;N++)if(g=N+1,g%=E.length,C=r(t,W,E[N],E[g],!0),C.length>0)return!0;return!1}function d(Q,L){var x,F,t,y,l;for(x=0;x<H.length;x++)for(F=V[H[x]],t=0;t<F.length;t++)if(y=t+1,y%=F.length,l=r(Q,L,F[t],F[y],!0),l.length>0)return!0;return!1}for(var z,l,u,q,P,D,c,C,j,s,x,E=I.concat(),H=[],F=[],A=0,K=V.length;K>A;A++)H.push(A);for(var n=0,O=2*H.length;H.length>0&&(O--,!(0>O));)for(u=n;u<E.length;u++){q=E[u],l=-1;for(var A=0;A<H.length;A++)if(D=H[A],c=q.x+":"+q.y+":"+D,F[c]===t){z=V[D];for(var p=0;p<z.length;p++)if(P=z[p],b(u,p)&&!f(q,P)&&!d(q,P)){l=p,H.splice(A,1),C=E.slice(0,u+1),j=E.slice(u),s=z.slice(l),x=z.slice(0,l+1),E=C.concat(s).concat(x).concat(j),n=u;break}if(l>=0)break;F[c]=!0}if(l>=0)break}return E}for(var k,v,p,d,o,_,u={},n=N.concat(),H=0,w=q.length;w>H;H++)Array.prototype.push.apply(n,q[H]);for(k=0,v=n.length;v>k;k++)o=n[k].x+":"+n[k].y,u[o]!==t,u[o]=k;var T=x(N,q),f=Vf.Triangulate(T,!1);for(k=0,v=f.length;v>k;k++)for(d=f[k],p=0;3>p;p++)o=d[p].x+":"+d[p].y,_=u[o],_!==t&&(d[p]=_);return f.concat()},isClockWise:function(Z){return Vf.Triangulate.area(Z)<0},b2p0:function(D,W){var R=1-D;return R*R*W},b2p1:function(z,Q){return 2*(1-z)*z*Q},b2p2:function(l,w){return l*l*w},b2:function(a,w,W,k){return this.b2p0(a,w)+this.b2p1(a,W)+this.b2p2(a,k)},b3p0:function(A,S){var H=1-A;return H*H*H*S},b3p1:function(H,_){var G=1-H;return 3*G*G*H*_},b3p2:function(h,z){var Z=1-h;return 3*Z*h*h*z},b3p3:function(J,z){return J*J*J*z},b3:function(W,U,Y,i,w){return this.b3p0(W,U)+this.b3p1(W,Y)+this.b3p2(W,i)+this.b3p3(W,w)}},Vf={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var o=v.keys(this.faces);return o.length?o[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(x){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(X){var z=X.familyName.toLowerCase(),W=this;return W.faces[z]=W.faces[z]||{},W.faces[z][X.cssFontWeight]=W.faces[z][X.cssFontWeight]||{},W.faces[z][X.cssFontWeight][X.cssFontStyle]=X,X},drawText:function(s){var c,I=this.getFace(),T=this.size/I.resolution,y=0,A=String(s).split(""),E=A.length,J=[];for(c=0;E>c;c++){var Z=new Fo,g=this.extractGlyphPoints(A[c],I,T,y,Z);g&&(y+=g.offset*this.spacing,J.push(g.path))}var i=y/2;return{paths:J,offset:i}},extractGlyphPoints:function(V,z,H,Q,u){var j,L,b,f,e,Z,y,k,p,o,i,h,x,$,r,g,R,J,A,v=[],l=z.glyphs[V]||z.glyphs["?"];if(l){if(l.o)for(f=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),Z=f.length,y=H,k=H,j=0;Z>j;)switch(e=f[j++]){case"m":p=f[j++]*y+Q,o=f[j++]*k,u.moveTo(p,o);break;case"l":p=f[j++]*y+Q,o=f[j++]*k,u.lineTo(p,o);break;case"q":if(i=f[j++]*y+Q,h=f[j++]*k,r=f[j++]*y+Q,g=f[j++]*k,u.quadraticCurveTo(r,g,i,h),A=v[v.length-1])for(x=A.x,$=A.y,L=1,b=this.divisions;b>=L;L++){var K=L/b;$m.b2(K,x,r,i),$m.b2(K,$,g,h)}break;case"b":if(i=f[j++]*y+Q,h=f[j++]*k,r=f[j++]*y+Q,g=f[j++]*k,R=f[j++]*y+Q,J=f[j++]*k,u.bezierCurveTo(r,g,R,J,i,h),A=v[v.length-1])for(x=A.x,$=A.y,L=1,b=this.divisions;b>=L;L++){var K=L/b;$m.b3(K,x,r,R,i),$m.b3(K,$,g,J,h)}}return{offset:l.ha*H,path:u}}}};Vf.generateShapes=function(B,r){r=r||{};var j=r.font;if(j===t&&(j=Vf.getDefaultFont(),!j))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var e=r.size!==t?r.size:1,Y=r.curveSegments!==t?r.curveSegments:4,K=r.spacing!==t?r.spacing:1,i=r.weight!==t?r.weight:"normal",p=r.style!==t?r.style:"normal";Vf.size=e,Vf.divisions=Y,Vf.face=j,Vf.weight=i,Vf.style=p,Vf.spacing=K;for(var N=Vf.drawText(B),V=N.paths,u=[],h=0,s=V.length;s>h;h++)Array.prototype.push.apply(u,V[h].toShapes());return u},function(i){var j=1e-10,c=function(I,L){var y=I.length;if(3>y)return null;var z,V,C,A=[],R=[],K=[];if(a(I)>0)for(V=0;y>V;V++)R[V]=V;else for(V=0;y>V;V++)R[V]=y-1-V;var q=y,F=2*q;for(V=q-1;q>2;){if(F--<=0)return L?K:A;if(z=V,z>=q&&(z=0),V=z+1,V>=q&&(V=0),C=V+1,C>=q&&(C=0),e(I,z,V,C,q,R)){var h,Y,o,Q,d;for(h=R[z],Y=R[V],o=R[C],A.push([I[h],I[Y],I[o]]),K.push([R[z],R[V],R[C]]),Q=V,d=V+1;q>d;Q++,d++)R[Q]=R[d];q--,F=2*q}}return L?K:A},a=function(K){for(var b=K.length,P=0,B=b-1,h=0;b>h;B=h++)P+=K[B].x*K[h].y-K[h].x*K[B].y;return.5*P},e=function(y,D,A,i,B,l){var a,s,k,q,Q,S,W,u,K;if(s=y[l[D]].x,k=y[l[D]].y,q=y[l[A]].x,Q=y[l[A]].y,S=y[l[i]].x,W=y[l[i]].y,j>(q-s)*(W-k)-(Q-k)*(S-s))return!1;var O,L,h,c,m,e,I,p,d,Z,g,P,z,J,F;for(O=S-q,L=W-Q,h=s-S,c=k-W,m=q-s,e=Q-k,a=0;B>a;a++)if(u=y[l[a]].x,K=y[l[a]].y,!(u===s&&K===k||u===q&&K===Q||u===S&&K===W)&&(I=u-s,p=K-k,d=u-q,Z=K-Q,g=u-S,P=K-W,F=O*Z-L*d,z=m*p-e*I,J=h*P-c*g,F>=-j&&J>=-j&&z>=-j))return!1;return!0};return i.Triangulate=c,i.Triangulate.area=a,i}(Vf),D._typeface_js={faces:Vf.faces,loadFace:Vf.loadFace};var rk=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},zc=rk.prototype={constructor:rk,computeFaceNormals:function(){for(var s=new eh,q=new eh,w=0,x=this.faces.length;x>w;w++){var R=this.faces[w],e=this.vertices[R.a],i=this.vertices[R.b],a=this.vertices[R.c];s.subVectors(a,i),q.subVectors(e,i),s.cross(q),s.normalize(),R.normal.copy(s)}},computeVertexNormals:function(J){var R,Q,Z,c,E,W;for(W=new Array(this.vertices.length),R=0,Q=this.vertices.length;Q>R;R++)W[R]=new eh;if(J){var C,N,q,A=new eh,F=new eh;for(Z=0,c=this.faces.length;c>Z;Z++)E=this.faces[Z],C=this.vertices[E.a],N=this.vertices[E.b],q=this.vertices[E.c],A.subVectors(q,N),F.subVectors(C,N),A.cross(F),W[E.a].add(A),W[E.b].add(A),W[E.c].add(A)}else for(Z=0,c=this.faces.length;c>Z;Z++)E=this.faces[Z],W[E.a].add(E.normal),W[E.b].add(E.normal),W[E.c].add(E.normal);for(R=0,Q=this.vertices.length;Q>R;R++)W[R].normalize();for(Z=0,c=this.faces.length;c>Z;Z++)E=this.faces[Z],E.vertexNormals[0]=W[E.a].clone(),E.vertexNormals[1]=W[E.b].clone(),E.vertexNormals[2]=W[E.c].clone()},mergeVertices:function(){var K,e,i,E,H,f,D,R,M={},o=[],X=[],b=4,u=n(10,b);for(i=0,E=this.vertices.length;E>i;i++)K=this.vertices[i],e=l(K.x*u)+"_"+l(K.y*u)+"_"+l(K.z*u),M[e]===t?(M[e]=i,o.push(this.vertices[i]),X[i]=o.length-1):X[i]=X[M[e]];var B=[];for(i=0,E=this.faces.length;E>i;i++){H=this.faces[i],H.a=X[H.a],H.b=X[H.b],H.c=X[H.c],f=[H.a,H.b,H.c];for(var g=0;3>g;g++)if(f[g]==f[(g+1)%3]){B.push(i);break}}for(i=B.length-1;i>=0;i--){var k=B[i];for(this.faces.splice(k,1),D=0,R=this.faceVertexUvs.length;R>D;D++)this.faceVertexUvs[D].splice(k,1)}var m=this.vertices.length-o.length;return this.vertices=o,m}},yg=function(N,h,W,C,l,p,X){this.aX=N,this.aY=h,this.xRadius=W,this.yRadius=C,this.aStartAngle=l,this.aEndAngle=p,this.aClockwise=X};yg.prototype=qq(es),yg.prototype.getPoint=function(T){var W,L=this.aEndAngle-this.aStartAngle;0>L&&(L+=B),L>B&&(L-=B),W=this.aClockwise===!0?this.aEndAngle+(1-T)*(B-L):this.aStartAngle+T*L;var z=this.aX+this.xRadius*_(W),F=this.aY+this.yRadius*P(W);return new Oo(z,F)};var yh=function(Q,K){this.v1=Q,this.v2=K},db=yh.prototype=qq(es);db.getPoint=function(d){var G=this.v2.clone().sub(this.v1);return G.multiplyScalar(d).add(this.v1),G},db.getPointAt=function(W){return this.getPoint(W)},db.getTangent=function(){var i=this.v2.clone().sub(this.v1);return i.normalize()};var ln=function(V,S,v){this.v0=V,this.v1=S,this.v2=v};ln.prototype=qq(es),ln.prototype.getPoint=function(P){var f,l;return f=$m.b2(P,this.v0.x,this.v1.x,this.v2.x),l=$m.b2(P,this.v0.y,this.v1.y,this.v2.y),new Oo(f,l)};var ec=function(q,g,n,X){this.v0=q,this.v1=g,this.v2=n,this.v3=X};ec.prototype=qq(es),ec.prototype.getPoint=function(E){var y,c;return y=$m.b3(E,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=$m.b3(E,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Oo(y,c)},Qc.create(function(f,N){this.v1=f,this.v2=N},function(j){var l=new eh;return l.subVectors(this.v2,this.v1),l.multiplyScalar(j),l.add(this.v1),l});var mb=Qc.create(function(D,t,P){this.v0=D,this.v1=t,this.v2=P},function(R){var k,K,O;return k=$m.b2(R,this.v0.x,this.v1.x,this.v2.x),K=$m.b2(R,this.v0.y,this.v1.y,this.v2.y),O=$m.b2(R,this.v0.z,this.v1.z,this.v2.z),new eh(k,K,O)}),Hm=Qc.create(function(K,I,H,N){this.v0=K,this.v1=I,this.v2=H,this.v3=N},function(O){var p,o,G;return p=$m.b3(O,this.v0.x,this.v1.x,this.v2.x,this.v3.x),o=$m.b3(O,this.v0.y,this.v1.y,this.v2.y,this.v3.y),G=$m.b3(O,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new eh(p,o,G)}),Im=function(F,A,H,m,j,z,N,n){rk.call(this),m=m!==t?m:.5,j=j!==t?j:.5,n=n!==t?n:1,F=F||8,z=z||0,N=N||B;var R,o,J=1,Q=n/2,X=[],v=[],M=this.vertices,i=this.faces,U=this.faceVertexUvs;for(o=0;J>=o;o++){var q=[],l=[],I=o/J,e=I*(j-m)+m;for(R=0;F>=R;R++){var f=R/F,y=new eh,S=-(f*N+z);y.z=e*P(S),y.y=-I*n+Q,y.x=e*_(S),M.push(y),q.push(M.length-1),l.push(new Oo(f,I))}X.push(q),v.push(l)}var L,K,x=(j-m)/n;for(R=0;F>R;R++)for(0!==m?(L=M[X[0][R]].clone(),K=M[X[0][R+1]].clone()):(L=M[X[1][R]].clone(),K=M[X[1][R+1]].clone()),L.setY(Z(L.x*L.x+L.z*L.z)*x).normalize(),K.setY(Z(K.x*K.x+K.z*K.z)*x).normalize(),o=0;J>o;o++){var D=X[o][R],r=X[o+1][R],G=X[o+1][R+1],W=X[o][R+1],d=L.clone(),E=L.clone(),V=K.clone(),a=K.clone(),O=v[o][R].clone(),T=v[o+1][R].clone(),b=v[o+1][R+1].clone(),s=v[o][R+1].clone();i.push(new Ob(D,r,W,[d,E,a])),U[0].push([O,T,s]),i.push(new Ob(r,G,W,[E.clone(),V,a.clone()])),U[0].push([T.clone(),b,s.clone()])}if(A&&m>0)for(this.vertices.push(new eh(0,Q,0)),R=0;F>R;R++){var D=X[0][R],r=X[0][R+1],G=this.vertices.length-1,d=new eh(0,1,0),E=new eh(0,1,0),V=new eh(0,1,0),O=v[0][R].clone(),T=v[0][R+1].clone(),b=new Oo(T.x,0);i.push(new Ob(D,r,G,[d,E,V],null,1));var C=R/F*B,k=_(C),h=P(C),p=(R+1)/F*B,u=_(p),c=P(p);U[0].push([new Oo(.5+.5*k,.5+.5*h),new Oo(.5+.5*u,.5+.5*c),new Oo(.5,.5)])}if(H&&j>0)for(this.vertices.push(new eh(0,-Q,0)),R=0;F>R;R++){var D=X[o][R+1],r=X[o][R],G=M.length-1,d=new eh(0,-1,0),E=new eh(0,-1,0),V=new eh(0,-1,0),O=v[o][R+1].clone(),T=v[o][R].clone();i.push(new Ob(D,r,G,[d,E,V],null,2));var C=R/F*B,k=_(C),h=P(C),p=(R+1)/F*B,u=_(p),c=P(p);U[0].push([new Oo(.5+.5*u,.5-.5*c),new Oo(.5+.5*k,.5-.5*h),new Oo(.5,.5)])}};Im.prototype=qq(zc);var Ug=function(k,j,g,e,v,H,Y){rk.call(this),Y=Y||.5,k=k||16,j=j||16,g=(g!==t?g:0)-u,e=e!==t?e:B,v=v!==t?v:0,H=H!==t?H:u;var R,T,f=[],L=[],b=this.vertices,X=this.faces,D=this.faceVertexUvs;for(T=0;j>=T;T++){var q=[],S=[];for(R=0;k>=R;R++){var I=R/k,A=T/j,O=new eh;O.x=-Y*_(g+I*e)*P(v+A*H),O.y=Y*_(v+A*H),O.z=Y*P(g+I*e)*P(v+A*H),b.push(O),q.push(b.length-1),S.push(new Oo(I,A))}f.push(q),L.push(S)}for(T=0;j>T;T++)for(R=0;k>R;R++){var i=f[T][R+1],U=f[T][R],w=f[T+1][R],m=f[T+1][R+1],C=b[i].clone().normalize(),n=b[U].clone().normalize(),s=b[w].clone().normalize(),Z=b[m].clone().normalize(),l=L[T][R+1].clone(),E=L[T][R].clone(),x=L[T+1][R].clone(),o=L[T+1][R+1].clone();Q(b[i].y)===Y?(l.x=(l.x+E.x)/2,X.push(new Ob(i,w,m,[C,s,Z])),D[0].push([l,x,o])):Q(b[w].y)===Y?(x.x=(x.x+o.x)/2,X.push(new Ob(i,U,w,[C,n,s])),D[0].push([l,E,x])):(X.push(new Ob(i,U,m,[C,n,Z])),D[0].push([l,E,o]),X.push(new Ob(U,w,m,[n.clone(),s,Z.clone()])),D[0].push([E.clone(),x,o.clone()]))}};Ug.prototype=qq(zc);var jg=function(x,E,t,Z,j,G){rk.call(this),x=x||.33,E=E||.17,Z=Z||8,t=t||6,j=j||0,G=G||B;for(var o=new eh,d=[],m=[],f=0;Z>=f;f++)for(var M=f/Z*B+u,A=0;t>=A;A++){var h=A/t*G+j;o.x=x*_(h),o.z=-x*P(h);var b=new eh,I=x+E*_(M);b.x=I*_(h),b.z=-I*P(h),b.y=E*P(M),this.vertices.push(b),d.push(new Oo(A/t,1-f/Z)),m.push(b.clone().sub(o).normalize())}for(var f=1;Z>=f;f++)for(var A=1;t>=A;A++){var n=(t+1)*f+A-1,X=(t+1)*(f-1)+A-1,i=(t+1)*(f-1)+A,k=(t+1)*f+A,p=new Ob(n,X,k,[m[n].clone(),m[X].clone(),m[k].clone()]);this.faces.push(p),this.faceVertexUvs[0].push([d[n].clone(),d[X].clone(),d[k].clone()]),p=new Ob(X,i,k,[m[X].clone(),m[i].clone(),m[k].clone()]),this.faces.push(p),this.faceVertexUvs[0].push([d[X].clone(),d[i].clone(),d[k].clone()])}this.computeFaceNormals()};jg.prototype=qq(zc);var _m=function(l,V,Q){return l?(rk.call(this),l=l instanceof Array?l:[l],this.addShapeList(l,V),V.convertYZ!==!1&&ug(this,Q),this.computeFaceNormals(),void 0):(l=[],void 0)},em=_m.prototype=qq(rk.prototype);em.addShapeList=function(x,v){for(var l=x.length,u=0;l>u;u++){var y=x[u];this.addShape(y,v)}},em.addShape=function(N,I){function q(){if(I.bottom)for(var J=0;P>J;J++)c=R[J],U(c[2],c[1],c[0],!0);if(I.top)for(J=0;P>J;J++)c=R[J],U(c[0]+Q*x,c[1]+Q*x,c[2]+Q*x,!1)}function J(){var G=0;for(l(W,G),G+=W.length,g=0,a=z.length;a>g;g++)$=z[g],l($,G),G+=$.length}function l(r,d){for(var K,R,b=r.length;--b>=0;){K=b,R=b-1,0>R&&(R=r.length-1);var N=0,I=x;for(N=0;I>N;N++){var e=Q*N,n=Q*(N+1),o=d+K+e,v=d+R+e,l=d+R+n,D=d+K+n;m(o,v,l,D,r,N,I,K,R)}}}function b(s,G,D){_.vertices.push(new eh(s,G,D))}function U(X,Y,C,z){X+=v,Y+=v,C+=v,_.faces.push(new Ob(X,Y,C,null,null,z?2:1));var r=z?f.generateBottomUV(_,N,I,X,Y,C):f.generateTopUV(_,N,I,X,Y,C);_.faceVertexUvs[0].push(r)}function m(U,w,s,d,t,r,W,P,z){U+=v,w+=v,s+=v,d+=v,_.faces.push(new Ob(U,w,d)),_.faces.push(new Ob(w,s,d));var B=f.generateSideWallUV(_,N,t,I,U,w,s,d,r,W,P,z);_.faceVertexUvs[0].push([B[0],B[1],B[3]]),_.faceVertexUvs[0].push([B[1],B[2],B[3]])}var e,M,p,j,T,i=I.amount,u=I.curveSegments||bo,x=I.steps||1,n=I.extrudePath,o=!1,f=new ui(I.repeatUVLength);n&&(e=n.getSpacedPoints(x),o=!0,M=I.frames!==t?I.frames:new rl.FrenetFrames(n,x,!1),p=new eh,j=new eh,T=new eh);var $,g,a,_=this,v=this.vertices.length,H=N.extractPoints(u),s=H.shape,z=H.holes,G=!$m.isClockWise(s);if(G){for(s=s.reverse(),g=0,a=z.length;a>g;g++)$=z[g],$m.isClockWise($)&&(z[g]=$.reverse());G=!1}var R=$m.triangulateShape(s,z),W=s;for(g=0,a=z.length;a>g;g++)$=z[g],s=s.concat($);for(var B,c,Q=s.length,P=R.length,X=0;Q>X;X++)B=s[X],o?(j.copy(M.normals[0]).multiplyScalar(B.x),p.copy(M.binormals[0]).multiplyScalar(B.y),T.copy(e[0]).add(j).add(p),b(T.x,T.y,T.z)):b(B.x,B.y,0);var S;for(S=1;x>=S;S++)for(X=0;Q>X;X++)B=s[X],o?(j.copy(M.normals[S]).multiplyScalar(B.x),p.copy(M.binormals[S]).multiplyScalar(B.y),T.copy(e[S]).add(j).add(p),b(T.x,T.y,T.z)):b(B.x,B.y,i/x*S);q(),J()};var rl=function(A,e,b,n,Q){function E(Z,y,B){return S.vertices.push(new eh(Z,y,B))-1}rk.call(this),e=e||64,b=b||1,n=n||8,Q=Q||!1;var T,J,G,w,F,W,u,d,R,Y,Z,C,c,m,L,U,x,f,O,H,j=[],S=this,t=e+1,X=new eh,M=new rl.FrenetFrames(A,e,Q),N=M.tangents,y=M.normals,i=M.binormals;for(this.tangents=N,this.normals=y,this.binormals=i,R=0;t>R;R++)for(j[R]=[],w=R/(t-1),d=A.getPointAt(w),T=N[R],J=y[R],G=i[R],Y=0;n>Y;Y++)F=Y/n*B,W=-b*_(F),u=b*P(F),X.copy(d),X.x+=W*J.x+u*G.x,X.y+=W*J.y+u*G.y,X.z+=W*J.z+u*G.z,j[R][Y]=E(X.x,X.y,X.z);for(R=0;e>R;R++)for(Y=0;n>Y;Y++)Z=Q?(R+1)%e:R+1,C=(Y+1)%n,c=j[R][Y],m=j[Z][Y],L=j[Z][C],U=j[R][C],x=new Oo(R/e,Y/n),f=new Oo((R+1)/e,Y/n),O=new Oo((R+1)/e,(Y+1)/n),H=new Oo(R/e,(Y+1)/n),this.faces.push(new Ob(c,m,U)),this.faceVertexUvs[0].push([x,f,H]),this.faces.push(new Ob(m,L,U)),this.faceVertexUvs[0].push([f.clone(),O,H.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};rl.prototype=qq(zc),rl.FrenetFrames=function(w,y,G){function H(){T[0]=new eh,W[0]=new eh,D=Number.MAX_VALUE,X=Q(J[0].x),N=Q(J[0].y),e=Q(J[0].z),D>=X&&(D=X,t.set(1,0,0)),D>=N&&(D=N,t.set(0,1,0)),D>=e&&t.set(0,0,1),x.crossVectors(J[0],t).normalize(),T[0].crossVectors(J[0],x),W[0].crossVectors(J[0],T[0])}var S,D,X,N,e,o,$,t=new eh,J=[],T=[],W=[],x=new eh,p=new Vm,r=y+1,P=1e-4;for(this.tangents=J,this.normals=T,this.binormals=W,o=0;r>o;o++)$=o/(r-1),J[o]=w.getTangentAt($),J[o].normalize();for(H(),o=1;r>o;o++)T[o]=T[o-1].clone(),W[o]=W[o-1].clone(),x.crossVectors(J[o-1],J[o]),x.length()>P&&(x.normalize(),S=U(Ro(J[o-1].dot(J[o]),-1,1)),T[o].applyMatrix4(p.makeRotationAxis(x,S))),W[o].crossVectors(J[o],T[o]);if(G)for(S=U(Ro(T[0].dot(T[r-1]),-1,1)),S/=r-1,J[0].dot(x.crossVectors(T[0],T[r-1]))>0&&(S=-S),o=1;r>o;o++)T[o].applyMatrix4(p.makeRotationAxis(J[o],S*o)),W[o].crossVectors(J[o],T[o])};var Yn=function(o,O,S,Z){rk.call(this),O=O||18,S=S||0,Z=Z==R?B:Z;for(var e=1/(o.length-1),t=1/O,s=0,J=O;J>=s;s++)for(var E=S+s*t*Z,T=_(E),A=P(E),V=0,L=o.length;L>V;V++){var x=o[V],W=new eh;W.x=T*x.x-A*x.y,W.y=A*x.x+T*x.y,W.z=x.z,this.vertices.push(W)}for(var l=o.length,s=0,J=O;J>s;s++)for(var V=0,L=o.length-1;L>V;V++){var Q=V+l*s,n=Q,u=Q+l,T=Q+1+l,k=Q+1,Y=s*t,N=V*e,U=Y+t,q=N+e;this.faces.push(new Ob(n,k,u)),this.faceVertexUvs[0].push([new Oo(Y,N),new Oo(Y,q),new Oo(U,N)]),this.faces.push(new Ob(u,k,T)),this.faceVertexUvs[0].push([new Oo(U,N),new Oo(Y,q),new Oo(U,q)])}this.mergeVertices(),ug(this),this.computeFaceNormals(),this.computeVertexNormals()};Yn.prototype=qq(zc);var gc=function(b,V){V=V||{};var e=Vf.generateShapes(b,V);V.amount=V.amount!==t?V.amount:.5,V.convertYZ=!1,V.fill!==!1&&(V.bottom=!0,V.top=!0),_m.call(this,e,V)};gc.prototype=qq(em);var Dj=K.Node=function(){Lk(Dj,this)},ss={X:bp,Y:sc,Z:pg},Jp={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Po="xzy",Kk=function(W,h,c){if(h){var N=h[0],X=h[1],y=h[2];"xzy"===c?(sc(W,X),pg(W,y),bp(W,N)):"xyz"===c?(pg(W,y),sc(W,X),bp(W,N)):"yxz"===c?(pg(W,y),bp(W,N),sc(W,X)):"yzx"===c?(bp(W,N),pg(W,y),sc(W,X)):"zxy"===c?(sc(W,X),bp(W,N),pg(W,y)):"zyx"===c?(bp(W,N),sc(W,X),pg(W,y)):(sc(W,X),pg(W,y),bp(W,N))}};Qr("Node",Gr,{ms_ac:["rotationMode","tall"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Po,_64O:0,_rotationX:0,_53O:0,_host:R,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_scale:{x:1,y:1},_tall:20,_54O:0,getUIClass:function(){return Gi},_22Q:function(){return Jg},getX:function(){return this.p().x},setX:function(C){this.p(C,this.p().y)},getY:function(){return this.p().y},setY:function(y){this.p(this.p().x,y)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(v){this.setAnchor(v,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(c){this.setAnchor(this.getAnchor().x,c)},getScaleX:function(){return this.getScale().x},setScaleX:function(e){this.setScale(e,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(Z){this.setScale(this.getScale().x,Z)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(X,o){xl(X,td(R,R,this.r3(),this.getRotationMode())),this.translate3d(X[0]*o,X[1]*o,X[2]*o)},translateFront:function(N){this.translate3dBy([0,0,1],N)},translateBack:function(l){this.translate3dBy([0,0,-1],l)},translateLeft:function(L){this.translate3dBy([-1,0,0],L)},translateRight:function(O){this.translate3dBy([1,0,0],O)},translateTop:function(c){this.translate3dBy([0,1,0],c)},translateBottom:function(d){this.translate3dBy([0,-1,0],d)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(d,D,A){1===arguments.length&&(D=d[1],A=d[2],d=d[0]),this.p(d,A),this.setElevation(D)},translate3d:function(W,d,k){1===arguments.length&&(d=W[1],k=W[2],W=W[0]),this.translate(W,k),this.setElevation(this._54O+d)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(c,C,h){1===arguments.length&&(C=c[1],h=c[2],c=c[0]),this.setSize(c,h),this.setTall(C)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(j,C,g){1===arguments.length&&(C=j[1],g=j[2],j=j[0]),this.setRotationX(j),this.setRotation(-C),this.setRotationZ(g)},setRotationY:function(Y){this.setRotation(-Y)},getRotationY:function(){return-this._64O},lookAt:function(i,r){r=r||rh;var m=this,H=ad(i,m.p3()),x=Tr(H);r===rh?(m.r3([-F(H[1]/x),-f(H[2],H[0])+G,0]),m.setRotationMode("xzy")):r===Br?(m.r3(0,-f(H[2],H[0]),F(H[1]/x)),m.setRotationMode("zyx")):r===Ai?(m.r3(0,-f(H[2],H[0])+u,-F(H[1]/x)),m.setRotationMode("zyx")):r===Id?(m.r3([-F(H[1]/x)+G,-f(H[2],H[0])+G,0]),m.setRotationMode("xzy")):r===Zf&&(m.r3([-F(H[1]/x)-G,-f(H[2],H[0])+G,0]),m.setRotationMode("xzy")),r===vr&&(m.r3([-F(H[1]/x)+u,-f(H[2],H[0])+G,u]),m.setRotationMode("zxy"))},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(g){var H=this;if(H!==g&&H._host!==g){var Y=H._host;Y&&Y._removeAttach(H),H._host=g,H._host&&H._host._addAttach(H),H.fp("host",Y,g),H.onHostChanged(Y,g)}},getAttaches:function(){return this._69O},_addAttach:function(G){var L=this;L._69O||(L._69O=new fo),L._69O.add(G),L.fp("attaches",R,G)},_removeAttach:function(k){var h=this;h._69O.remove(k),h._69O.isEmpty()&&delete h._69O,h.fp("attaches",k,R)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(u){var W=this;W._44I||(W._44I=new fo),W._42I||(W._42I=new fo),W._44I.add(u),W._42I.add(u),W._20I()},_4I:function(r){var s=this;s._44I||(s._44I=new fo),s._43I||(s._43I=new fo),s._44I.add(r),s._43I.add(r),s._20I()},_16I:function(z){var E=this;E._44I.remove(z),E._42I.remove(z),E._44I.isEmpty()&&delete E._44I,E._42I.isEmpty()&&delete E._42I,E._20I()},_18I:function(z){var h=this;h._44I.remove(z),h._43I.remove(z),h._44I.isEmpty()&&delete h._44I,h._43I.isEmpty()&&delete h._43I,h._20I()},_20I:function(){var z=this;if(delete z._45I,!z._44I||z._44I.isEmpty())return delete z._70O,void 0;var t;z._44I.each(function(b){b.isLooped()&&(t||(t={}),t[b._id]||(z._45I||(z._45I=new fo),z._45I.add(b),t[b._id]=b))}),t?(z._70O=new fo,z._44I.each(function(T){t[T._id]?"A"===t[T._id]||(t[T._id]="A",z._70O.add(T)):z._70O.add(T)})):z._70O=z._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(y){var $=this;$._46I||($._46I=new fo),$._48I||($._48I=new fo),$._46I.add(y),$._48I.add(y),$._19I()},_3I:function(B){var W=this;W._47I||(W._47I=new fo),W._48I||(W._48I=new fo),W._47I.add(B),W._48I.add(B),W._19I()},_15I:function(X){var n=this;n._46I.remove(X),n._48I.remove(X),n._46I.isEmpty()&&delete n._46I,n._48I.isEmpty()&&delete n._48I,n._19I()},_17I:function(j){var N=this;N._47I.remove(j),N._48I.remove(j),N._47I.isEmpty()&&delete N._47I,N._48I.isEmpty()&&delete N._48I,N._19I()},_19I:function(){var V=this;delete V._49I;var u=V._48I;if(u&&!u.isEmpty()){var L={};u.each(function(_){L[_._id]?V._49I||(V._49I=new fo):L[_._id]=_}),V._49I?u.each(function(v){L[v._id]&&(V._49I.add(v),delete L[v._id])}):V._49I=u}},getImage:function(){if(this._needToCheckDataBindings){var o=M.getImage(this._image);o&&(this._needToCheckDataBindings=!1,o.dataBindings&&o.dataBindings.forEach(function(N){N.defaultValue!==t&&this.getAttr(N.attr)===t&&this.setAttr(N.attr,N.defaultValue)},this))}return this._image},setImage:function(E){var r=this,V=r._image,p=r.getWidth(),a=r.getHeight();r._image=E,r.fp("image",V,E)&&(null!=E&&(zr(E)||Bn(E)&&/\.json$/i.test(E))&&(this._needToCheckDataBindings=!0),r.fp(ld,p,r.getWidth()),r.fp(vd,a,r.getHeight()))},getElevation:function(){return this._54O},setElevation:function(h){var q=this;if(!q._50O){q._50O=1;var _=q._54O;q._54O=h,q.fp(lb,_,h),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(W){var c=this;if(!c._49O){c._49O=1;var x=c._64O;c._64O=W,c.fp(Um,x,W),delete c._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(g){var c=this;if(!c._51O){c._51O=1;var i=c._rotationX;c._rotationX=g,c.fp("rotationX",i,g),delete c._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(I){var i=this;if(!i._52O){i._52O=1;var p=i._53O;i._53O=I,i.fp("rotationZ",p,I),delete i._52O}},getPosition:function(){return this._position},setPosition:function(c,y){var N=this;if(!N._50I){N._50I=1;var G;if(G=2===arguments.length?{x:c,y:y}:c,G.x!==N._position.x||G.y!==N._position.y){var E=N._position;N._position=G,N.fp(Zo,E,G)}delete N._50I}},translate:function(N,Q){var n=this._position;this.p(n.x+N,n.y+Q)},getWidth:function(){var _=this;if(_._width>=0)return _._width;var q=rd(_._image);return q?ag(q,_):20},setWidth:function(S){var $=this,e=$._width;$._width=S,$.fp(ld,e,S)},getHeight:function(){var x=this;if(x._height>=0)return x._height;var t=rd(x._image);return t?Eh(t,x):20},setHeight:function(i){var Q=this,V=Q._height;Q._height=i,Q.fp(vd,V,i)},setSize:function(O,q){var j=this;2===arguments.length?(j.setWidth(O),j.setHeight(q)):(j.setWidth(O.width),j.setHeight(O.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(g,M,U,w,T){var t=this,C=t.getAnchor(),W=t.getScale();arguments.length<=2&&(T=M,M=g.y,U=g.width,w=g.height,g=g.x);var p=T&&W.x<0?1-C.x:C.x,Q=T&&W.y<0?1-C.y:C.y;t.p(g+U*p,M+w*Q),T&&(U/=Math.abs(W.x),w/=Math.abs(W.y)),t.setWidth(U),t.setHeight(w)},getMatrix:function(){var D=this,s=D._64O,q=D._position,N=D.getScale();return new ys(s,q.x,q.y,N.x,N.y)},getAnchorRect:function(){var S=this,r=S.getWidth(),g=S.getHeight(),C=S.getAnchor();return{x:-r*C.x,y:-g*C.y,width:r,height:g}},getRect:function(){var M=this,o=M.getWidth(),$=M.getHeight(),X=M.getAnchor(),H={x:-o*X.x,y:-$*X.y,width:o,height:$},G=M.getMatrix();return H=Ef([G.tf(H.x,H.y),G.tf(H.x+H.width,H.y),G.tf(H.x+H.width,H.y+H.height),G.tf(H.x,H.y+H.height)])},getAnchor:function(){var w=this;if(w.hasOwnProperty("_anchor"))return w._anchor;var y=rd(w._image);return y&&y.anchorX!==t?{x:y.anchorX,y:y.anchorY}:w._anchor},setAnchor:function(B,F,E){var e,h=this;"number"==typeof B?e={x:B,y:F}:(e=B.length?{x:B[0],y:B[1]}:B,E=F);var w=h.getAnchor();if(w.x!==e.x||w.y!==e.y){var o=h.getDataModel(),k=o?o.getHistoryManager():null;if(k&&k.beginInteraction(),h._anchor=e,h.fp("anchor",w,e),E&&!lo){var r=h.getPosition(),N=h.getSize(),q=h.getRotation(),C=h.getScale(),R=-N.width*(w.x-e.x)*C.x,c=-N.height*(w.y-e.y)*C.y,$=P(q),d=_(q);h.setPosition(r.x+d*R-$*c,r.y+$*R+d*c)}k&&k.endInteraction()}},getScale:function(){return this._scale},setScale:function(u,g){var z,r=this;z=2===arguments.length?{x:u,y:g}:u;var d=r.getScale();(d.x!==z.x||d.y!==z.y)&&(r._scale=z,r.fp("scale",d,z))},getCorners:function(N,z){N==R&&(N=0),z==R&&(z=N);var l=this,q=l.getAnchor(),f=l.getWidth(),A=l.getHeight(),Q=-f*q.x-N,y=-A*q.y-z,B=f+2*N,Y=A+2*z,i=l.getMatrix();return[i.tf(Q,y),i.tf(Q,y+Y),i.tf(Q+B,y+Y),i.tf(Q+B,y)]},getEditControlPoints:function(z,n,b){n==R&&(n=0),b==R&&(b=n);var E=this,U=E.getAnchor(),B=E.getWidth(),F=E.getHeight(),I=-B*U.x-n,g=-F*U.y-b,D=B+2*n,A=F+2*b;if(z)return[{x:I,y:g},{x:I,y:0},{x:I,y:g+A},{x:0,y:g+A},{x:I+D,y:g+A},{x:I+D,y:0},{x:I+D,y:g},{x:0,y:g}];var o=E.getMatrix();return[o.tf(I,g),o.tf(I,0),o.tf(I,g+A),o.tf(0,g+A),o.tf(I+D,g+A),o.tf(I+D,0),o.tf(I+D,g),o.tf(0,g)]},rotateAt:function(O,y,m){var c=this,b=c._position,H=c._64O,j=new ys(H,b.x,b.y).tf(O,y),e=Z(O*O+y*y),V=f(b.y-j.y,b.x-j.x)+m;
c.setRotation(H+m),c.p(j.x+e*_(V),j.y+e*P(V))},onParentChanged:function(){Dj.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(K){K._7I()})},onPropertyChanged:function(j){var I=this;Dj.superClass.onPropertyChanged.call(I,j),I._69O&&I._69O.each(function(I){I.handleHostPropertyChange(j)}),I._49I&&I._49I.each(function(k){k.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(r){this.updateAttach(r)},onStyleChanged:function(z){Dj.superClass.onStyleChanged.apply(this,arguments),gh[z]&&this.updateAttach()},updateAttach:function(b){var g=this;g._51I||lo||(g._51I=1,g._71O(b),delete g._51I)},_71O:function(d){var C,c,I,m,E,v,S=this,p=S._host,Z=d?d.property:R,P=d?d.oldValue:R,n=d?d.newValue:R;if(p instanceof K.Grid){if(Z===lb)S.setElevation(S._54O+n-P);else if(!d||eo[Z]){if(C=S.s("attach.row.index"),c=S.s("attach.column.index"),I=p.getCellRect(C,c),!I)return;m=S.s("attach.row.span"),E=S.s("attach.column.span"),(1!==m||1!==E)&&(I=Eq(I,p.getCellRect(C+m-1,c+E-1))),Jf(I,S,"attach.padding",1),S.setRect(I)}}else if(p instanceof Yb&&(v=S.s("attach.index"))>=0&&(!d||Oi[Z])){var g=S.s("attach.thickness");g!=R&&S.setHeight(p.getThickness()*g);var O=S.s("attach.offset"),q=p.getPoints(),i=q.size();if(i>v){var D=q.get(v),k=i===v+1?q.get(0):q.get(v+1),$=[k.x-D.x,k.y-D.y],o=Tr($);if(o){S.s("attach.offset.relative")&&(O*=o),S.s("attach.offset.opposite")&&(O=o-O);var T={x:D.x+$[0]/o*O,y:D.y+$[1]/o*O},z=S.s("attach.gap");z&&(S.s("attach.gap.relative")&&(z*=p.getThickness()),T=ej(R,T,k,z)),S.p(T),S.setRotation(f($[1],$[0]))}}}else d&&(Z===Zo?S.translate(n.x-P.x,n.y-P.y):Z===lb?S.setElevation(S._54O+n-P):cc[Z]&&S._11Q(p,Z,n-P))},_11Q:function(q,V,F){var i=this,b=q.p3(),A=ad(i.p3(),b),I=uo(),K=Jp[i.getRotationMode()],D=K[0],T=K[1],W=K[2],n=ss[D],B=ss[T],Y=ss[W];V===Um&&(V="rotationY",F=-F),V===Um+D?(Y(I,q[Pq+W]()),B(I,q[Pq+T]()),n(I,F),B(I,-q[Pq+T]()),Y(I,-q[Pq+W]()),i[ti+D](i[Pq+D]()+F)):V===Um+T?(Y(I,q[Pq+W]()),B(I,F),Y(I,-q[Pq+W]()),i[ti+T](i[Pq+T]()+F)):V===Um+W&&(Y(I,F),i[ti+W](i[Pq+W]()+F)),xl(A,I),i.p3(b[0]+A[0],b[1]+A[1],b[2]+A[2])},isHostOn:function(P){var c=this;if(c._host&&P&&P._69O)for(var Y={},M=c._host;M&&M!==c&&!Y[M._id];){if(M===P)return!0;Y[M._id]=M,M=M._host}return!1},isLoopedHostOn:function(r){return this.isHostOn(r)&&r.isHostOn(this)},getSerializableProperties:function(){var w=Dj.superClass.getSerializableProperties.call(this);return Jn(w,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,scale:1,_width:1,_height:1,tall:1,elevation:1}),w}});var nk=K.Edge=function(L,k){var R=this;Lk(nk,R),R.setSource(L),R.setTarget(k)};Qr("Edge",Gr,{_icon:"edge_icon",getUIClass:function(){return Gf},_22Q:function(){return hd},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(Y){var H=this;if(H._source!==Y){var u=H._source;H._source=Y,u&&u._16I(H),Y&&Y._2I(H),H._7I(),H.fp("source",u,Y)}},setTarget:function(o){var i=this;if(i._target!==o){var _=i._target;i._target=o,_&&_._18I(i),o&&o._4I(i),i._7I(),i.fp("target",_,o)}},isLooped:function(){var e=this;return e._source===e._target&&!!e._source&&!!e._target},_7I:function(){var K,m=this,W=Jj(m);m._40I!==W&&(K=this._40I,K&&K._15I(m),m._40I=W,W&&W._1I(m),m.fp("sourceAgent",K,W),Mj(K,m._41I),Mj(W,m._41I));var $=Mr(m);m._41I!==$&&(K=m._41I,K&&K._17I(m),m._41I=$,$&&$._3I(m),m.fp("targetAgent",K,$),Mj(K,m._40I),Mj($,m._40I))},_22I:function(D){this._52I=D,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var b=this;return b._52I&&b._52I.get(0)!==b&&!b.getStyle(qj)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var k=this,j=k._52I;return j&&!k.getStyle(qj)&&j.size()>1&&k===j.get(0)},toggle:function(){var I=this._52I,H=!this.s(qj);I&&I.size()>1&&(I.each(function(Z){Z.s(qj,H)}),I.getSiblings().each(function(F){F!==I&&F.each(function(n){n.fp("edgeGroup",R,F)})}))},setStyle:function(J,e){(J===kn||"edge.segments"===J)&&(e=kb(e)),nk.superClass.setStyle.call(this,J,e)},onStyleChanged:function(Y){nk.superClass.onStyleChanged.apply(this,arguments),fs[Y]&&Mj(this._41I,this._40I)},getSerializableProperties:function(){var T=nk.superClass.getSerializableProperties.call(this);return Jn(T,{source:1,target:1}),T}});var Nd=K.Group=function(){Lk(Nd,this)};Qr("Group",Dj,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return cp},onChildAdded:function(){Nd.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Nd.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var d=this;if(!d._54I&&!lo){var k=d.getChildrenRect();k&&(d._53I=1,d.p(mp(d.s("group.position"),k,d.getSize())),delete d._53I)}},getChildrenRect:function(){var Y,E=this;return E.eachChild(function(r){Y=Eq(Y,E.getChildRect(r))}),Y},getChildRect:function(K){var m;return Vp(K)&&K.s(In)&&(Lc(K)&&K.isExpanded()&&K.eachChild(function(N){m=Eq(m,K.getChildRect(N))}),!m&&K.getRect&&(m=K.getRect())),m},setPosition:function(t,U){var G=this;if(!G._54I){var M;M=2===arguments.length?{x:t,y:U}:t,lo||G._53I||(G._54I=1,Eo(G._children,M.x-G._position.x,M.y-G._position.y),delete G._54I),Nd.superClass.setPosition.call(this,M)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(k){var h=this;if(h._57O!==k){var U=h._57O;h._57O=k,h.fp("expanded",U,h._57O),h._8I()}},_8I:function(){Nd.superClass._8I.call(this),this.eachChild(function(S){Vp(S)&&S._8I()})},onStyleChanged:function(T){Nd.superClass.onStyleChanged.apply(this,arguments),"group.position"===T&&this._81I()},getSerializableProperties:function(){var w=Nd.superClass.getSerializableProperties.call(this);return w.expanded=1,w}});var nq=K.Block=function(){Lk(nq,this)};Qr("Block",Dj,{_icon:"block_icon",getUIClass:function(){return ro},onChildAdded:function(){nq.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){nq.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var T=this;if(!lo&&!T._updatingToChildren){var s,o,t,Y,q,x=[],R=T.getRotation();if(T.eachChild(function(n){Vp(n)&&x.push.apply(x,n.getCorners())}),x.length){T._updatingFromChildren=1;var O=_(-R),c=P(-R),f=1/0,S=-1/0,n=1/0,p=-1/0;for(Y=0,q=x.length;q>Y;Y++)t=x[Y],s=t.x,o=t.y,t.x=O*s-c*o,t.y=c*s+O*o,f=j(f,t.x),S=I(S,t.x),n=j(n,t.y),p=I(p,t.y);var K=T.getScale();T.setSize(Q((S-f)/K.x),Q((p-n)/K.y));var H;K.x<0&&(H=f,f=S,S=H),K.y<0&&(H=n,n=p,p=H),O=_(R),c=P(R);var y=T.getAnchor();s=f+(S-f)*y.x,o=n+(p-n)*y.y,T.setPosition(O*s-c*o,c*s+O*o),delete T._updatingFromChildren}}},setPosition:function(B,C){var S=this;if(!S._updatingToChildren){var t;t=2===arguments.length?{x:B,y:C}:B,lo||S._updatingFromChildren||(S._updatingToChildren=1,Eo(S._children,t.x-S._position.x,t.y-S._position.y),delete S._updatingToChildren),nq.superClass.setPosition.call(this,t)}},setWidth:function(Q){return this.setSize(Q,this.getHeight())},setHeight:function(N){return this.setSize(this.getWidth(),N)},setSize:function(Z,C){1>Z&&(Z=1),1>C&&(C=1);var w=this;if(!w._updatingToChildren){2!==arguments.length&&(C=Z.height,Z=Z.width);var v=w.getWidth(),u=w.getHeight();if(Z!==v&&nq.superClass.setWidth.call(w,Z),C!==u&&nq.superClass.setHeight.call(w,C),!lo&&!w._updatingFromChildren){w._updatingToChildren=1;var h=Z/v,j=C/u;w._adjustChildScaleOrSize(h,j,"size"),delete w._updatingToChildren,w.updateFromChildren()}}},_adjustChildScaleOrSize:function(C,j,D){var q=this,y=q.getPosition(),r=q.getRotation();q.getScale(),q.eachChild(function(N){if(Vp(N)){var R=N.getPosition(),d=N.getRotation(),c=N.getWidth(),$=N.getHeight(),S=N.getScale(),w=S.x*c,v=S.y*$,U=new ys(d,R.x,R.y,w,v);U.translate(-y.x,-y.y),U.rotate(-r),d=f(U.b*Math.sign(w),U.a*Math.sign(w)),U.scale(C,j);var T,B,I,E=_(d);if(Math.abs(E)<.001?(T=P(d),B=U.b/T,I=-U.c/T):(B=U.a/E,I=U.d/E),"scale"===D)N.setScale(B/c,I/$);else if("size"===D){var Z=B/S.x,A=I/S.y;N.setScale(Xl(B)*Math.abs(S.x),Xl(I)*Math.abs(S.y)),N.setSize(Math.max(.1,Math.abs(Z)),Math.max(.1,Math.abs(A)))}U.rotate(r),U.translate(y.x,y.y),N.setPosition(U.tx,U.ty)}})},_calcChangeFactor:function(z,o,T,R){var h,D,s,$;return h=Q(z),D=Q(T),s=h>D?h/D:D/h,h=Q(o),D=Q(R),$=h>D?h/D:D/h,I(s,$)},setAnchor:function(){var t=this;if(!t._updatingToChildren){var N=t.getAnchor();if(nq.superClass.setAnchor.apply(t,arguments),!lo&&!t._updatingFromChildren){t._updatingToChildren=1;var H=t.getAnchor();t.getPosition();var o=t.getSize(),k=t.getScale(),g=t.getRotation(),M=-o.width*k.x*(N.x-H.x),s=-o.height*k.y*(N.y-H.y),C=P(g),z=_(g),c=z*M-C*s,R=C*M+z*s;t.eachChild(function(G){if(Vp(G)){var X=G.getPosition();G.setPosition(X.x-c,X.y-R)}}),delete t._updatingToChildren}}},setRotation:function(d){var e=this;if(!e._updatingToChildren){var q=e.getRotation();if(nq.superClass.setRotation.apply(e,arguments),!lo&&!e._updatingFromChildren){e._updatingToChildren=1;var $=e.getPosition(),b=d-q;e.eachChild(function(r){if(Vp(r)){var P=r.getMatrix();P.translate(-$.x,-$.y),P.rotate(b),P.translate($.x,$.y);var d=Math.sign(r.getScale().x);r.setRotation(f(P.b*d,P.a*d)),r.setPosition(P.tx,P.ty)}}),delete e._updatingToChildren}}},setScale:function(I,N){var p=this;if(!p._updatingToChildren){null==N&&(N=I.y,I=I.x);var z=p.getScale();if(Q(I)<.01&&(I=.01*(Xl(I)||Xl(z.x))),Q(N)<.01&&(N=.01*(Xl(N)||Xl(z.y))),nq.superClass.setScale.call(p,I,N),!lo&&!p._updatingFromChildren){p._updatingToChildren=1;var s=I/z.x,K=N/z.y;p._adjustChildScaleOrSize(s,K,"size"),delete p._updatingToChildren,p.updateFromChildren()}}}});var df=K.Grid=function(){Lk(K.Grid,this)};Qr("Grid",Dj,{IRotatable:!1,_icon:"grid_icon",_image:R,getUIClass:function(){return Xf},setRotation:function(){},getCellRect:function(C,y){var D=this,x=D.s("grid.row.count"),G=D.s("grid.column.count");if(0>=x||0>=G||0>C||C>=x||0>y||y>=G)return R;var d,w,Z,A=D.getRect(),e=D.s("grid.row.percents"),I=D.s("grid.column.percents");if(Jf(A,D,"grid.border",-1),e&&e._as&&(e=e._as),I&&I._as&&(I=I._as),e&&e.length===x){for(Z=0,d=0;C>d;d++)Z+=A.height*e[d];A.y+=Z,A.height=A.height*e[C]}else A.height=A.height/x,A.y+=A.height*C;if(I&&I.length===G){for(w=0,d=0;y>d;d++)w+=A.width*I[d];A.x+=w,A.width=A.width*I[y]}else A.width=A.width/G,A.x+=A.width*y;return yl(A,-D.s("grid.gap")),A}});var _b=K.Text=function(){Lk(_b,this),this.setSize(100,50),this.s("text","TEXT")};Qr("Text",Dj,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Db},setWidth:function(U){U||(U=.001),_b.superClass.setWidth.call(this,U)},setHeight:function(h){h||(h=.001),_b.superClass.setHeight.call(this,h)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Ij("__text__",{width:{value:100,isSafeFunc:!0,func:function(e){return e._width}},height:{value:50,isSafeFunc:!0,func:function(P){return P._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var Yb=K.Shape=function(){Lk(Yb,this),this._59O=new fo};Yb.__de__=Fl,Qr("Shape",Dj,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Fe},_22Q:function(){return Pc},getLength:function(V){return wf(Do(this._59O,this._58O,V,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var t=this._58O;return t?new fo(t._as.slice(0)):t},setSegments:function(a){var t=this._58O;a=a?dr(a)?new fo(a.slice(0)):new fo(a._as.slice(0)):new fo,(t&&a&&t._as.join(",")!==a._as.join(",")||t!==a)&&(this._58O=a,this.fp("segments",t,a))},getPoints:function(){return this._59O},toPoints:function(){var i=this._59O;return new fo(i._as.slice(0))},setPoints:function(i,f){var d=this,l=d._59O;i=i?dr(i)?new fo(i.slice(0)):new fo(i._as.slice(0)):new fo;var G,$,z,F,v,K;f&&(G=d.getPosition(),K=new ys(d.getRotation(),0,0,d.getScale().x,d.getScale().y)),(l&&i&&l._as.join(",")!==i._as.join(",")||l!==i)&&(d._59O=i,d.fs(),d.fp("points",l,i)),f&&($=d.getPosition(),z=$.x-G.x,F=$.y-G.y,v=K.tf(z,F),d.setPosition($.x-z+v.x,$.y-F+v.y))},addPoint:function(R,V,z){var w=this.toPoints();w.add(R,V),this.setPoints(w,z)},setPoint:function(J,s,r){var G=this.toPoints();G.set(J,s),this.setPoints(G,r)},removePointAt:function(e){var U=this.toPoints();U.removeAt(e),this.setPoints(U)},setWidth:function(g){var M=this;if(1>g&&(g=1),!M._55I&&!lo&&M.getWidth()){M._55I=1;var L=M._position.x,f=g/M.getWidth(),b=M.toPoints(),K=new fo;b.each(function(p){K.add({x:(p.x-L)*f+L,y:p.y,e:p.e})}),M.setPoints(K);var V=M.s("shape.gradient.pack");V&&dn(V,[f,0,0,1,L*(1-f),0]),M.fs(),delete M._55I}Yb.superClass.setWidth.call(M,g)},setHeight:function(t){var T=this;if(1>t&&(t=1),!T._55I&&!lo&&T.getHeight()){T._55I=1;var _=T._position.y,R=t/T.getHeight(),U=T.toPoints(),Z=new fo;U.each(function(r){Z.add({x:r.x,y:(r.y-_)*R+_,e:r.e})}),T.setPoints(Z);var L=T.s("shape.gradient.pack");L&&dn(L,[1,0,0,R,0,_*(1-R)]),T.fs(),delete T._55I}Yb.superClass.setHeight.call(T,t)},setAnchor:function(U,C,z){var e=this;if(e._55I=!0,!lo){var H,f,q;"number"==typeof U?q={x:U,y:C}:(q=U.length?{x:U[0],y:U[1]}:U,z=C);var t=e.getAnchor(),B=e.getSize();H=B.width*(t.x-q.x),f=B.height*(t.y-q.y),z||e.shiftPoints(H,f);var d=e.getPosition()}if(Yb.superClass.setAnchor.apply(e,arguments),!lo){var D=e.getPosition();z&&e.shiftPoints(D.x-d.x+H,D.y-d.y+f)}delete e._55I},shiftPoints:function(u,J){var D=this,c=D.toPoints(),z=new fo;c.each(function(g){z.add({x:g.x+u,y:g.y+J,e:g.e})}),D.setPoints(z),D.fs()},setPosition:function(O,N){var C,F=this;if(!F._28Q){if(F._28Q=1,!F._55I&&!lo){C=2===arguments.length?{x:O,y:N}:O;var $=C.x-F._position.x,E=C.y-F._position.y;if(0===$&&0===E)return delete F._28Q,void 0;F._55I=1,F.shiftPoints($,E);var o=F.s("shape.gradient.pack");o&&dn(o,[1,0,0,1,$,E]),delete F._55I}Yb.superClass.setPosition.apply(F,arguments),delete F._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var D=this;if(2!==D._59O.size())return!1;var b=D._58O;return b?2===b.size()&&1===b.get(0)&&2===b.get(1)?!0:!1:!0},fireShapeChange:function(){var K=this;if(!K._55I&&!lo){var d=Ef(K._59O);d&&(K._55I=1,K.setRect(d),delete K._55I)}K.fp(kr,!1,!0)},getSerializableProperties:function(){var w=Yb.superClass.getSerializableProperties.call(this);return w.segments=1,w.points=1,w.thickness=1,w.closePath=1,w}});var Pn=K.Polyline=function(){Lk(Pn,this),this.s({"shape.background":null,"shape.border.width":2})};Qr("Polyline",Yb,{IRotatable:!1,_icon:"polyline_icon",_22Q:function(){return we},getUIClass:function(){return bs},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setClosePath:function(){},setTall:function(c){var r=this;if(!r._24Q&&!lo&&r.getTall()){r._24Q=1;var Z=r._54O,Y=c/r.getTall();r._59O.each(function(C){C.e=C.e==R?Z:(C.e-Z)*Y+Z}),r.fs(),delete r._24Q}Pn.superClass.setTall.call(r,c)},setElevation:function($){var P=this;if(!P._24Q&&!lo){P._24Q=1;var n=$-P._54O;P._59O.each(function(h){h.e==R?h.e=$:h.e+=n}),P.fs(),delete P._24Q}Pn.superClass.setElevation.apply(P,arguments)},fireShapeChange:function(){var F=this,O=F._59O;if(!F._24Q&&!lo){var Y=O.size();if(Y){var W=1,b=O.get(0),A=F._54O;b.e==R&&(b.e=A);for(var w=b.e,m=0;Y>W;W++){b=O.get(W),b.e==R&&(b.e=A);var M=j(w,b.e),V=I(w+m,b.e);w=M,m=V-M}F._24Q=1,F.setTall(m),F.setElevation(w+m/2),delete F._24Q}}Pn.superClass.fireShapeChange.apply(F,arguments)}});var cq=K.SubGraph=function(){Lk(cq,this)};Qr("SubGraph",Dj,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){cq.superClass._8I.call(this),this.eachChild(function(Q){Vp(Q)&&Q._8I()})}});var Lh=K.RefGraph=function(){Lk(Lh,this)};Qr("RefGraph",Dj,{_icon:"refGraph_icon",getUIClass:function(){return null},getRef:function(){return this._ref},setRef:function(O){this._ref!==O&&(this._ref=O,this.updateRef())},_21I:function(){Lh.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var Y=this;if(Y.clearChildrenFromDataModel(),Y._ref&&Y._dataModel){Y._xhrLoadHandler&&(Y._xhrLoadHandler.cancel=!0);var G=Y._xhrLoadHandler=function(V){if(V&&Y._dataModel){M.loadingRefGraph=!0;var Z=Y._dataModel.deserialize(V,Y,{justDatas:!0});Z.each(function(r){r._refGraph=Y}),M.loadingRefGraph=!1,M.handleRefGraphLoaded(Y,Z)}};M.xhrLoad(Y._ref,function(M){G.cancel||G(M)})}},getSerializableProperties:function(){var L=Lh.superClass.getSerializableProperties.call(this);return L.ref=1,L}}),K.EdgeGroup=function(a,k){this._70O=a,this._siblings=k;for(var n,r,Q=0,A=a.size(),i=w[qj];A>Q;Q++)if(n=a.get(Q).getStyle(qj,!1),n!=R){i=n;break}i==R&&(i=!0);var P=M.edgeGroupAgentFunc;for(P&&(r=P(a),r&&r!==a.get(0)&&(a.remove(r),a.add(r,0))),Q=0;A>Q;Q++)a.get(Q).s(qj,i)},Qr("EdgeGroup",v,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(T){return this._70O.get(T)},indexOf:function(i){return this._70O.indexOf(i)},each:function(B,z){this._70O.each(B,z)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(n,e){this._siblings.each(function(s){s._70O.each(n,e)})}});var re=K.JSONSerializer=function(e,w){this.dm=this._dataModel=e,this._hierarchical=w==R?e.isHierarchicalRendering():w};Qr("JSONSerializer",v,{ms_ac:["hierarchical"],serialize:function(F){return M.stringify(this.toJSON(),F)},toJSON:function(){var V=this,C=V.dm,z=C.getRoots(),o=V.json={v:M.getVersion(),p:{},a:{},d:[]},U=C.getSerializableAttrs();C.getInit()&&(o.init=C.getInit()),C.getName()&&(o.p.name=C.getName()),C.getBackground()&&(o.p.background=C.getBackground()),o.p.autoAdjustIndex=C.isAutoAdjustIndex(),o.p.hierarchicalRendering=C.isHierarchicalRendering();for(var y in U){var w=C.a(y);w!==t&&V[Ap](y,w,o.a)}return Pi(o.a)&&delete o.a,V._hierarchical?z.each(V.serializeData,this):C.each(function(U){V.serializeData(U)}),o},isSerializable:function(){return!0},getProperties:function(l){return l.getSerializableProperties()},getStyles:function(N){return N.getSerializableStyles()},getAttrs:function(G){return G.getSerializableAttrs()},serializeData:function(P){var i=this;if(i.isSerializable(P)&&!P._refGraph){var A,J,O,H,Z=Nc(P.getClassName())||P.getClass(),c=new Z,e={c:P.getClassName(),i:P.getId(),p:{},s:{},a:{}};i.json.d.push(e),A=i.getProperties(P);for(J in A)/^_/.test(J)?(O=P[J],O!==c[J]&&i[Ap](J.substr(1),O,e.p)):(H=Sd(J),P[H]&&(O=P[H](),O!==c[H]()&&i[Ap](J,O,e.p)));A=i.getStyles(P);for(J in A)O=P.s(J),O!==c.s(J)&&i[Ap](J,O,e.s);A=i.getAttrs(P);for(J in A)O=P.a(J),O!==c.a(J)&&i[Ap](J,O,e.a);Pi(e.p)&&delete e.p,Pi(e.s)&&delete e.s,Pi(e.a)&&delete e.a}i._hierarchical&&P.getChildren().each(i.serializeData,i)},serializeValue:function(D,C,A){_p(C)?C={__a:C._as}:C instanceof Gr&&(C={__i:C.getId()}),A[D]=C},deserialize:function(p,F,t){lo=!0,t=nj(t)?{setId:t}:t||{};var w=this;p=w.json=Bn(p)?M.parse(p):p,w._82I={};var s=w.dm,z=new fo,E=new fo,f=0,D=p.d.length;for(t.justDatas||(Cb(p.init)&&p.init(s),s.setInit(p.init));D>f;f++){var n=p.d[f],S=Nc(n.c),U=new S,g=n.i;t.setId&&g!=R&&(U._id=g),w._82I[g]=U,z.add(U),E.add(n)}for(f=0;D>f;f++)w.deserializeData(z.get(f),E.get(f));if(z.each(function(o){F&&!o.getParent()&&o.setParent(F),s.add(o)}),!t.justDatas){for(var Q in p.a)s.a(Q,w[$l](p.a[Q]));for(var h in p.p)s[vj(h)](p.p[h])}return lo=!1,z},deserializeData:function(M,K){for(var U in K.p)M[vj(U)](this[$l](K.p[U]));for(U in K.s)M.s(U,this[$l](K.s[U]));for(U in K.a)M.a(U,this[$l](K.a[U]))},deserializeValue:function(c){if(zr(c)){var S=c.__i;if(S!=R)return this._82I[S];if(S=c.__a,dr(S))return new fo(S)}return c}}),Jn(mf,{serialize:function(s,V){return new re(this,V).serialize(s)},toJSON:function(U){return new re(this,U).toJSON()},deserialize:function(s,I,h){return new re(this).deserialize(s,I,h)}}),Am.GraphView=function(H){var q=this;q._24I={},q._34I=new fo,q._25I={},q._56I={},q._view=Qm(1,q),q._canvas=bg(q._view),q.dm(H?H:new mf),q.setEditable(!1),q.setScrollBarVisible(M.graphViewScrollBarVisible)},Yp("GraphView",v,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:["layers",ak,gk,Lr,jc,"resettable","editInteractor",oi,"pannable","rectSelectable","autoScrollZone",Vi,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:M.graphViewResettable,_pannable:M.graphViewPannable,_rectSelectable:M.graphViewRectSelectable,_autoScrollZone:M.graphViewAutoScrollZone,_rectSelectBackground:M.graphViewRectSelectBackground,_rectSelectBorderColor:M.graphViewRectSelectBorderColor,_editPointSize:M.graphViewEditPointSize,_editPointBorderColor:M.graphViewEditPointBorderColor,_editPointBackground:M.graphViewEditPointBackground,_scrollBarColor:Qe,_scrollBarSize:Re,_autoHideScrollBar:Mp,_autoMakeVisible:Bi,setEditable:function(i){var G=this,F=Am.XEditInteractor;i?(G._uieditable=!0,G.setInteractors([new Li(G),new Cq(G),F?new F(G):new Ql(G),new ic(G),new Cs(G),new Hn(G,{editable:!1})])):(G._uieditable=!1,G.setInteractors([new Li(G),new Cq(G),new ic(G),new Cs(G),new Hn(G,{editable:!1})]))},getCanvas:function(){return this._canvas},_33I:function(q){var T=q.getUIClass();return T?new T(this,q):R},getDataUI:function(F){var H=this,h=H._25I[F._id];return h===t&&(h=H._33I(F),H._25I[F._id]=h),h},getNodeRect:function(c){return M.getNodeRect(this,c)},getEdgeInfo:function(J){var h=this.getDataUI(J);return h?(h._79o(),h._78o):null},invalidateAll:function(S){var j=this;if(S){for(var c in j._25I){var C=j._25I[c];C&&C.dispose()}j._25I={},j._56I={},j._24I={},j._34I.clear(),j.redraw()}else j.dm().each(function(F){j.invalidateData(F)})},invalidateSelection:function(){var v=this;v.sm().each(function(K){v.invalidateData(K)})},invalidateData:function(v){var q=this;q._24I[v._id]=v,q._21Q(v),q.iv()},_21Q:function(Q){var m=this,Y=m._24I;if(ql(Q)&&Em[Q.s(oh)]){var C=Q.getSourceAgent();C&&C.getAgentEdges().each(function(x){Y[x._id]=x}),C=Q.getTargetAgent(),C&&C.getAgentEdges().each(function(T){Y[T._id]=T}),m.iv()}},redraw:function(e){var l=this;l._32I||(e?l._34I.add(e):(l._32I=1,l._34I.clear()),l.iv())},each:function(i,q){var v,g,Y,O=0,d=this._layers,k=this._dataModel,r=k._datas._as,N=r.length;if(d){for(var e=d.length;e>O;O++)if(Y=d[O],k.isHierarchicalRendering()){if(this._dataModel.eachByHierarchical(i,null,q)===!1)return}else for(var J=0;N>J;J++)if(v=r[J],v._layer===Y&&(g=q?i.call(q,v):i(v),g===!1))return}else if(k.isHierarchicalRendering())this._dataModel.eachByHierarchical(i,null,q);else for(;N>O;O++)if(v=r[O],g=q?i.call(q,v):i(v),g===!1)return},reverseEach:function(I,Q){var t,n,z,d,E=this._layers,i=this._dataModel,O=i._datas._as,A=O.length;if(E){for(t=E.length-1;t>=0;t--)if(d=E[t],i.isHierarchicalRendering()){if(i.reverseEachByHierarchical(I,null,Q)===!1)return}else for(var r=A-1;r>=0;r--)if(n=O[r],n._layer===d&&(z=Q?I.call(Q,n):I(n),z===!1))return}else if(i.isHierarchicalRendering())i.reverseEachByHierarchical(I,null,Q);else for(t=A-1;t>=0;t--)if(n=O[t],z=Q?I.call(Q,n):I(n),z===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var L=this,_=L._84I;if(!_){var Q=this.dm().a("width"),B=this.dm().a("height");Q>0&&B>0?L._84I={x:0,y:0,width:Q,height:B}:(L.each(function(v){L.isVisible(v)&&(_=Eq(_,L.getDataUIBounds(v)))}),L._84I=_?_:fc)}return L._84I},getScrollRect:function(){return Eq(this.getContentRect(),this._29I)},makeCenter:function(f,Q,p){var X=this;if(!X.getWidth()||!X.getHeight())return p||Jb(X.centerData,X,[f,Q,!0],200),void 0;X.makeVisible(f),X.validate();var B=X.getDataUIBounds(f);if(B){var U=X.getWidth(),m=X.getHeight(),c=B.x+B.width/2,O=B.y+B.height/2,o=-c*X._zoom+U/2,y=-O*X._zoom+m/2;X.setTranslate(o,y,Q)}},fitData:function(F,c,N,x,o){var Y=this;if(!Y.getWidth()||!Y.getHeight())return o||Jb(Y.fitData,Y,[F,c,N,x,!0],200),void 0;var u=function(){Y.makeVisible(F),Y.validate();var v=Y.getDataUIBounds(F);v&&(v=Fm(v),yl(v,N==R?20:N),Y.fitRect(v,c,x))};c?M.callWhenLoaded(u):u()},fitContent:function(X,_,z,B){var J=this;if(!J.getWidth()||!J.getHeight())return B||Jb(J.fitContent,J,[X,_,z,!0],200),void 0;var g=function(){J.validate();var v=Fm(J.getContentRect());yl(v,_==R?20:_),J.fitRect(v,X,z)};X?M.callWhenLoaded(g):g()},fitRect:function(n,D,F){var b=this,L=b.getWidth(),$=b.getHeight(),o=n.x+n.width/2,q=n.y+n.height/2,M=j(L/n.width,$/n.height),K=b._zoom,U=-o*K+L/2,t=-q*K+$/2;0===M||isNaN(M)||(F&&(M=j(1,M)),D?b.setTranslate(U,t,{finishFunc:function(){b.setZoom(M,D)}}):(b.setTranslate(U,t),b.setZoom(M)))},toCanvas:function(V,Q){Q=Q||this._zoom,this.validateImpl();var s=this,w=s.getContentRect();w.width||(w.width=10),w.height||(w.height=10);var l=bg(),H=w.x*Q,n=w.y*Q,F=w.width*Q,W=w.height*Q;ds(l,F,W,1);var c=mm(l);return V=V||this._dataModel.getBackground(),V&&Ko(c,0,0,F,W,V),Lf(c,-H,-n),c.scale(Q,Q),s._42(c),c.restore(),l},toDataURL:function(h,K,C){return this.toCanvas(h,C).toDataURL(K||"image/png",1)},getClipBounds:function(){return this._74O},_42:function($,w){var g,n,u=this;u._93db($,w),u.each(function(Z){u._56I[Z._id]&&(g=u.getDataUI(Z),g&&(n=g._79o(),K.HtmlNode&&Z instanceof K.HtmlNode?g._42($):(!w||Bd(w,n))&&g._42($)))}),u._92db($,w)},validateImpl:function(){var Z,D,x,h,j,F=this,u=F.tx(),l=F.ty(),c=F._zoom,r=F._canvas,z=this.getWidth(),T=this.getHeight(),C=F._29I,J={x:-u/c,y:-l/c,width:z/c,height:T/c},S={},P=F._34I,v=F._24I,A=F._32I,n=F._23I;(z!==r.clientWidth||T!==r.clientHeight)&&(ds(r,z,T),A=1),A||Tm(J,C)||(A=1),F._29I=J,F.each(function(g){D=g._id;var Z=S[D]=F.isVisible(g);Z!==F._56I[D]&&(v[D]=g,x=F.getDataUI(v[D]),x&&x._84o(Z),F._84o(g,Z))},F);for(D in v)x=F.getDataUI(v[D]),x&&(!A&&F._56I[D]&&(j=x._79o(),j&&P.add(j)),x.invalidate()),F._83I=1;if(F._56I=S,!A)for(D in v)S[D]&&(x=F.getDataUI(v[D]),x&&(j=x._79o(),j&&P.add(j)));if(A?h=J:(P.each(function(O){Bd(J,O)&&(h=Eq(h,O))}),h&&(yl(h,I(1,1/c)),h.x=Y(h.x*c)/c,h.y=Y(h.y*c)/c,h.width=y(h.width*c)/c,h.height=y(h.height*c)/c,h=sl(J,h))),F._74O=h,h&&(Z=mm(r),vg(Z,u,l,c),Z.beginPath(),Z.rect(h.x,h.y,h.width,h.height),Z.clip(),Z.clearRect(h.x,h.y,h.width,h.height),F._42(Z,h),Z.restore(),delete F._74O),F._24I={},P.clear(),delete F._32I,n&&z>0&&T>0){var x=F.getDataUI(n);if(x){var j=x._79o(),G=F._29I,W=G.x,s=G.y,t=G.width,m=G.height,c=F._zoom;j&&!Bd(j,G)&&(j.x+j.width<W&&F.tx(-j.x*c),j.x>W+t&&F.tx(-(j.x+j.width-t)*c),j.y+j.height<s&&F.ty(-j.y*c),j.y>s+m&&F.ty(-(j.y+j.height-m)*c))}delete F._23I}F._83I&&(delete F._83I,delete F._84I),F._98O()},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(e){var P=this;e!==P.isScrollBarVisible()&&(e?(Gl(P._view,P._79O=so()),Gl(P._79O,P._27I=so()),Gl(P._79O,P._28I=so())):(Mf(P._79O),delete P._79O,delete P._27I,delete P._28I),P.fp("scrollBarVisible",!e,e))},showScrollBar:function(){var h=this;h._79O&&(h._85I||(e(function(){h._86I()},Xe),h.iv()),h._85I=new Date)},_86I:function(){var x=this;if(x._85I){var A=new Date,P=A.getTime();P-x._85I.getTime()>=Xe?(delete x._85I,x.iv()):e(function(){x._86I()},Xe)}},_98O:function(){var h=this,i=this._27I,R=this._28I;if(h._79O){if(h._autoHideScrollBar&&!h._85I)return i.style.visibility=nm,R.style.visibility=nm,void 0;var Y=h.getScrollBarColor(),q=h._zoom,x=h.getScrollBarSize(),W=h.getViewRect(),t=h.getScrollRect(),A=W.height*q,O=t.height*q,z=W.width*q-x-2,g=A*((W.y-t.y)*q/O),S=A*(A/O),H=i.style;O-.5>A?(fe>S&&(g=g+S/2-fe/2,0>g&&(g=0),g+fe>A&&(g=A-fe),S=fe),Se(i,z,g,x,S),H.visibility=Cn,H.background=Y,H.borderRadius=x/2+Yo):H.visibility=nm;var M=W.width*q,m=t.width*q,g=W.height*q-x-2,z=M*((W.x-t.x)*q/m),D=M*(M/m),H=R.style;m-.5>M?(fe>D&&(z=z+D/2-fe/2,0>z&&(z=0),z+fe>M&&(z=M-fe),D=fe),Se(R,z,g,D,x),H.visibility=Cn,H.background=Y,H.borderRadius=x/2+Yo):H.visibility=nm}},setDataModel:function(c){var k=this,$=k._dataModel,j=k._selectionModel;$!==c&&($&&($.ump(k.handleDataModelPropertyChange,k),$.umm(k.handleDataModelChange,k),$.umd(k.handleDataPropertyChange,k),$.removeIndexChangeListener(k._75O,k),$.removeHierarchyChangeListener(k.handleHierarchyChange,k),j||$.sm().ums(k.handleSelectionChange,k)),k._dataModel=c,c.mp(k.handleDataModelPropertyChange,k),c.mm(k.handleDataModelChange,k),c.md(k.handleDataPropertyChange,k),c.addIndexChangeListener(k._75O,k),c.addHierarchyChangeListener(k.handleHierarchyChange,k),j?j._21I(c):c.sm().ms(k.handleSelectionChange,k),k.invalidateAll(!0),k.fp(Kg,$,c),k._canvas.style.background=c.getBackground()||"")},handleDataModelPropertyChange:function(k){if("background"===k.property){var H=this._canvas.style.background,x=k.newValue||"";this._canvas.style.background=x,this.fp("canvasBackground",H,x)}else"a:width"===k.property||"a:height"===k.property?(this._83I=1,this.redraw()):"hierarchicalRendering"===k.property&&this.redraw()},handleDataPropertyChange:function(l){this.dm().isHierarchicalRendering()&&"parent"===l.property&&l.data.hasChildren()&&this.redraw(),l.data instanceof Lh&&"2d.visible"===l.property&&this.redraw(),this.invalidateData(l.data)},onPropertyChanged:function(e){var n=this,x=e.property;if(n.redraw(),"zoom"===x){var g=n.sm().getSelection();g.size()&&g.each(function(D){D.invalidate()})}vp[x]?n.showScrollBar():x===oi&&n.onCurrentSubGraphChanged(e)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(u){var P=this,F=u.kind,g=u.data;if(P._83I=1,"add"===F)P.invalidateData(g),ql(g)&&g.getEdgeGroup()&&g.getEdgeGroup().eachSiblingEdge(P.invalidateData,P);else if(F===to){P._21Q(g);var U=g._id,Z=P._25I[U];if(Z){if(P._56I[U]){var b=Z._79o();b&&P.redraw(b)}Z.dispose(),delete P._25I[U],delete P._24I[U],delete P._56I[U]}g===P._currentSubGraph&&P.setCurrentSubGraph(R)}else F===cj&&(P.invalidateAll(!0),P.setCurrentSubGraph(R))},_75O:function(b){this.invalidateData(b.data)},handleHierarchyChange:function(a){this.dm().isHierarchicalRendering()&&a.data.hasChildren()&&this.redraw(),this.invalidateData(a.data)},adjustIndex:function(s){var k=this;if(k.isVisible(s)){for(var j=s;j._parent&&k.isVisible(j._parent);)j=j._parent;j&&j!==s&&k._dataModel.adjustIndex(j),k._dataModel.adjustIndex(s)}},getSelectWidth:function(f){return f.s("select.width")},isSelectable:function(x){return x instanceof Lh?!1:!(x.getParent()instanceof K.Block)&&x.s("2d.selectable")&&this.sm().isSelectable(x)},isMovable:function(L){var R=this;return ql(L)&&L.getStyle(oh)!==tg?!1:L instanceof Lh?!1:L.s("2d.movable")?R._movableFunc?R._movableFunc(L):!0:!1},isEditable:function(X){var y=this;if(K._uiSerializing)return y._uieditable;if(!y._editInteractor||!y.isSelected(X))return!1;if(Lc(X)){var e=y.getDataUI(X);if(!e||e._88I)return!1}return ql(X)&&X.getStyle(oh)!==tg?!1:X instanceof Lh?!1:X.s("2d.editable")?y._editableFunc?y._editableFunc(X):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(C){return Vp(C)&&0!==C.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(C):!0},isRectEditable:function(W){return this._rectEditableFunc?this._rectEditableFunc(W):!0},isAnchorEditable:function(f){return this._anchorEditableFunc?this._anchorEditableFunc(f):!0},isRotationEditable:function(e){return e.setRotation&&e.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(e):!0:!1},getRotationPoint:function(Q){var z=Q.getAnchor(),e=Q.getScale(),S=this._zoom,E=xf(Q.getRotation(),0,-Q.getHeight()*e.y*z.y-(e.y<0?-1:1)*(b?32:16)/S),o=Q.p();return E.x+=o.x,E.y+=o.y,E},getLogicalPoint:function(_){var W=this;return Sk(_,W._canvas,W.tx(),W.ty(),W._zoom,W._zoom)},getSelectedDataAt:function(J){var V=this;return this.getDataAt(J,function(Q){return V.isSelected(Q)
})},getDataAt:function(z,E,B){z.target&&(z=this.lp(z));var f,s=this._zoom;return this.reverseEach(function(v){return(E?E(v):this.isSelectable(v))&&this.rectIntersects(v,Tn(z.x,z.y,B,s))?(f=v,!1):void 0},this),f},getIconInfoAt:function(l,c){var w=this;if(l.target&&(l=w.lp(l)),c||(c=w.getDataAt(l)),c){var F=w.getDataUI(c);if(F&&F._38o){var B,x=F._38o,g=new fo;for(B in x.icons)g.add(B);for(var m=g.size()-1;m>=0;m--){B=g.get(m);for(var Z=x.rects[B],L=Z.rotation,r=Z.length-1;r>=0;r--){var o=Z[r],I=o.width,G=o.height,T={x:l.x-o.x-I/2,y:l.y-o.y-G/2};L!=R&&(T=xf(-L,T.x,T.y));var o={x:-I/2,y:-G/2,width:I,height:G};if(Ul(o,T))return{key:B,index:r,name:x.icons[B].names[r],rect:Z[r],point:l,rotation:L,relativeRect:o,relativePoint:T,data:c}}}}}return R},getDatasInRect:function(m,u,f){f===t&&(f=1);var r=this,Q=new fo;return r.reverseEach(function(S){f&&!r.isSelectable(S)||(u?r.rectIntersects(S,m):r.rectContains(S,m))&&Q.add(S)}),Q},moveSelection:function(n,s){var F,r=this,J=r.dm();J&&(F=J.getHistoryManager()),F&&F.beginInteraction(),Eo(r.sm().toSelection(r.isMovable,r),n,s),F&&F.endInteraction()},moveDatas:function(I,M,d){var f,n=this,o=n.dm();o&&(f=o.getHistoryManager()),f&&f.beginInteraction(),I instanceof fo||(I=new fo(I)),Eo(I,M,d),f&&f.endInteraction()},getDataUIBounds:function(w){var W=this.getDataUI(w);return W?W._79o():R},drawData:function(D,v){var d=this.getDataUI(v);d&&(d._79o(),d._42(D)),v instanceof K.Block&&v.eachChild(function(l){this.drawData(D,l)},this)},getBoundsForGroup:function(q){return q.s(In)?this.getDataUIBounds(q):R},rectIntersects:function(z,V){this.validate();var F=R;if(this._56I[z._id]){var n=this._25I[z._id];if(n){var J=n._79o();if(dl(V,J))F=!0;else if((V=sl(V,J))&&(n.rectIntersects&&(F=n.rectIntersects(V)),F==R)){if(!z.s("pixelPerfect"))return!0;var r=V.x,W=V.y,S=V.width,o=V.height,g=this._zoom,d=M.hitMaxArea,v=S*o*g*g;if(v>d){var x=Math.sqrt(d/v);g*=x}S*=g,o*=g,r*=g,W*=g;var _=io(S,o);Lf(_,-r,-W),_.scale(g,g),this._drawForChecking=!0,this.drawData(_,z),this._drawForChecking=!1;try{for(var u=0,t=_.getImageData(0,0,S,o).data;u<t.length;u+=4)if(0!==t[u+3]){F=!0;break}_.restore()}catch(i){fd=R,F=!0}}}}return F?!0:!1},rectContains:function(b,P){if(this._56I[b._id]){var y=this._25I[b._id];if(y)return dl(P,y._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(_){if(!M.isInput(_.target)){var H=this,Z=H._focusData,b=Z&&H._25I[Z._id],x=0,l=H._dataModel._datas;if(!(Z&&Z._enabled&&Z._editable&&b&&b.onKeyDown&&b.onKeyDown(_)===!0))if(9===_.keyCode&&(Z&&(x=l.indexOf(Z),Ng(_)?-1===--x&&(x=0):++x===l.size()&&(x=0)),H._focusData=Z=l.get(x),H.sm().setSelection(Z)),Ye(_)?H.selectAll():gl(_)&&H.isResettable()&&H.reset(),H.sm().isEmpty()){if(H._editing)return;var K=H.tx(),A=H.ty(),o=!1,e=Ng()?100:10;fh(_)&&(K-=e,o=!0),Aq(_)&&(A-=e,o=!0),Kd(_)&&(K+=e,o=!0),ed(_)&&(A+=e,o=!0),o&&H.setTranslate(K,A)}else{lf(_)&&H.handleDelete(_);var c=Ng()?10:1;fh(_)&&(H.moveSelection(-c,0),H.fi({kind:"moveLeft"})),Aq(_)&&(H.moveSelection(0,-c),H.fi({kind:"moveUp"})),Kd(_)&&(H.moveSelection(c,0),H.fi({kind:"moveRight"})),ed(_)&&(H.moveSelection(0,c),H.fi({kind:"moveDown"}))}}},handleScroll:function(L,D){Ch(L);var o=this.lp(L);D>0?this.scrollZoomIn(o):0>D&&this.scrollZoomOut(o)},handlePinch:function(s,I,S){this._68I||(I>S?this.pinchZoomIn(s):this.pinchZoomOut(s))},checkDoubleClickOnNote:function(N,M){var H=this,B=H.lp(N),J=H.getDataUI(M),w=J.note2Info;return w&&M.s("note2.toggleable")&&Ul(w.clickRect,B)?(M.s(pe,!M.s(pe)),H.fi({kind:"toggleNote2",event:N,data:M}),!0):(w=J.noteInfo,w&&M.s("note.toggleable")&&Ul(w.clickRect,B)?(M.s(Fd,!M.s(Fd)),H.fi({kind:"toggleNote",event:N,data:M}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(w,h){var X=this,C=X.getAutoScrollZone(),Y=C/X.getZoom(),b=C/4,F=X._29I,u=X.lp(w),x={x:X.tx(),y:X.ty()};return u&&C>0&&F&&(u.x-F.x<Y?X.translate(b,0):F.x+F.width-u.x<Y&&X.translate(-b,0),u.y-F.y<Y?X.translate(0,b):F.y+F.height-u.y<Y&&X.translate(0,-b)),x.x=X.tx()-x.x,x.y=X.ty()-x.y,h&&(h.x+=x.x,h.y+=x.y),x},getMoveMode:function(Z,I){var r=I.s("2d.move.mode");return r?r:Tf["88"]?"x":Tf["89"]?"y":"xy"},getSerializableProperties:function(){return{layers:1,scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function($,n,y){var M=this;return"currentSubGraph"===n?{__i:$.getId()}:y.serializeProperty($,n,M)},deserializeProperty:function(s,x,k){var Y=this;if("currentSubGraph"===x){var I=Y.dm(),X=I.__idMap;return X[s.__i]}return k.deserializeProperty(s,x,Y)}});var pj=function(s,J){var j=this;j.gv=s,j.s=function(r){return J.getStyle(r)},j._data=J,j._87I=new fo};jl(pj,v,{_6I:R,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var M=this,U=M.gv.isSelected(M._data);return!U||M.isShadowed()?0:M.gv.getSelectWidth(M._data)},getBodyColor:function(e){var U=this._data,y=this.gv.getBodyColor(U);return y?y:e?U.getStyle(e):R},_2Q:function(b){return this.s(b)},_1Q:function(w,c,y,$){var l=this.s,Y=l(c+".dash.color");w.strokeStyle=Y,w.lineWidth=y,w.stroke(),l(c+".dash.3d")&&vc(w,Y,l(c+".dash.3d.color"),y,this.gv._zoom,l(c+".dash.3d.accuracy")),Mi(w,$)},invalidate:function(){this._6I=R},_79o:function(){var c=this;if(!c._6I){c.labelInfo=c.label2Info=c.noteInfo=c.note2Info=c._38o=R,c._87I.clear(),c._3O();var l=c._data,C=c.gv;c._55O=C.isEditable(l)?{_42O:C.isRectEditable(l),_43O:C.isPointEditable(l),_56O:C.isRotationEditable(l)}:R,c._6I=c._81o()}return c._6I},_3O:function(){},getPosition:function(){return fc},_68o:function(I,R){I&&this._87I.add(Gq(I,R))},_81o:function(){var _=this,v=_.s;_._24O(zj,"getLabel"),_._24O(qo,"getLabel2"),_._26O(Qf,"getNote"),_._26O(Lg,"getNote2"),_._15O(),_._55O&&_._48O();var K;if(_._87I.each(function(p){K=Eq(K,p)}),K&&_.isShadowed()){var m=Fm(K);m.x+=v("shadow.offset.x"),m.y+=v("shadow.offset.y"),yl(m,v("shadow.blur")),K=Eq(K,m)}return _._87I.clear(),K},_42:function(n){var k=this,$=k._data,H=k.gv,U=k.s,M=U("opacity"),L=this.isShadowed();if(L){var i=n.shadowOffsetX,S=n.shadowOffsetY,O=n.shadowBlur,w=n.shadowColor,h=H.getZoom();n.shadowOffsetX=U("shadow.offset.x")*h,n.shadowOffsetY=U("shadow.offset.y")*h,n.shadowBlur=U("shadow.blur")*h,n.shadowColor=U("select.color")}if(M!=R){var C=n.globalAlpha;n.globalAlpha=M}k._80o(n),H.isLabelVisible($)&&((!H._drawForChecking||U("label.selectable"))&&Rp(n,k.labelInfo),(!H._drawForChecking||U("label2.selectable"))&&Rp(n,k.label2Info)),H.isNoteVisible($)&&(Jr(n,k.noteInfo),Jr(n,k.note2Info)),k._99O(n),M!=R&&(n.globalAlpha=C),L&&(n.shadowOffsetX=i,n.shadowOffsetY=S,n.shadowBlur=O,n.shadowColor=w)},_80o:function(){},_47O:function(){},_24O:function(U,r){var A=this,P=A._data,i=A.gv,o=A.s,e=i[r](P);if(e!=R){var z=o(U+".scale"),w=o(U+".max"),t=o(U+".position"),$=A[U+"Info"]={label:e,scale:z,color:i[r+"Color"](P),font:o(U+".font"),opacity:o(U+".opacity"),align:o(U+".align"),rotation:A.getRotation(o(U+".rotation"),!1,t),background:i[r+"Background"](P)},K=fi($,e);w>0&&w<K.width&&($.labelWidth=K.width,K.width=w),1!==z&&(K.width*=z,K.height*=z);var c=A.getPosition(t,o(U+".offset.x"),o(U+".offset.y"),K,o(U+".position.fixed"));if(K.x=c.x-K.width/2,K.y=c.y-K.height/2,A._68o($.rect=K,$.rotation),1!==z){var Y=K.width/z,a=K.height/z;$.rect={x:c.x-Y/2,y:c.y-a/2,width:Y,height:a}}}},_26O:function(Y,i){var r=this,v=r.gv,q=r._data,C=r.s,m=v[i](q);if(m!=R){var s,W,E=C(Y+".scale"),I=r[Y+"Info"]={note:m,scale:E,data:q,view:v,expanded:C(Y+".expanded"),font:C(Y+".font"),color:C(Y+".color"),opacity:C(Y+".opacity"),align:C(Y+".align"),icon:C(Y+".icon"),backgroundImage:C(Y+".backgroundImage"),borderWidth:C(Y+".border.width"),borderColor:C(Y+".border.color"),background:v[i+"Background"](q)},g=r.getPosition(C(Y+".position"),C(Y+".offset.x"),C(Y+".offset.y")),x=g.x,$=g.y;if(I.expanded){var A,N=C(Y+".max"),M=C(Y+".backgroundImage");M?(M=rd(M),A={width:ag(M,q),height:Eh(M,q)}):A=fi(I,m),A.width+=6,A.height+=2,N>0&&N<A.width&&(I.labelWidth=A.width,A.width=N),s=A.width,W=A.height+8,I.clickRect={x:x-s*E/2,y:$-W*E,width:s*E,height:W*E*A.height/W}}else{var f=C(Y+".icon");f?(f=rd(f),s=ag(f,q),W=Eh(f,q)):(s=12,W=18),I.clickRect={x:x-s*E/2,y:$-W*E,width:s*E,height:W*E}}I.rect={x:x-s/2,y:$-W*E/2-W/2,width:s,height:W};var l=y(I.borderWidth/2)*E;r._68o({x:x-s*E/2-l,y:$-W*E-l,width:s*E+2*l,height:W*E+2*l})}},_48O:function(){},_99O:function(Y){var z=this,P=z._38o;if(P){var u=z.gv,U=z._data,j=P.icons;for(var C in j){var J=j[C],G=P.rects[C];if(G){var p=Sl(J.opacity,U,u),k=Sl(J.names,U,u),I=k?k.length:0,H=G.rotation;if(p!=R){var Z=Y.globalAlpha;Y.globalAlpha*=p}for(var e=0;I>e;e++){var M=k[e],m=rd(M),F=G[e];if(H){var E=F.x+F.width/2,A=F.y+F.height/2;Y.save(),Lf(Y,E,A),Xg(Y,H),Lf(Y,-E,-A)}Ti(Y,m,Sl(J.stretch,U,u),F.x,F.y,F.width,F.height,z._data,z.gv),H&&Y.restore()}p!=R&&(Y.globalAlpha=Z)}}}}});var Gi=function(y,L){Lk(Gi,this,[y,L])};jl(Gi,pj,{_checkEmptyRect:!0,_40O:function(i,$){var S=this,Y=S.s,V=i.rect;(i.borderColor=S.gv.getBorderColor(S._data))&&(i.borderType=Y("border.type"),i.borderWidth=Y("border.width"),i.borderPadding=Y("border.padding"),$=I($,i.borderPadding+i.borderWidth/2));var W=S._data.getScale(),v=I(1,I(Q(W.x),Q(W.y)));if(i.selectWidth=S.getSelectWidth()){var F=S.gv._zoom;i.selectType=Y("select.type"),i._97o=Y("select.color"),i.selectPadding=Y("select.padding"),$=I($,(i.selectPadding+i.selectWidth/2)/F/v)}$>0&&($*=v,V=Fm(V),yl(V,$)),S._68o(V)},_39O:function(J,Q){var U,O=this,r=Q.rect;if(Q.borderWidth>0&&(U=Q.borderPadding,J.strokeStyle=Q.borderColor,J.lineWidth=Q.borderWidth,pc(J,Q.borderType,{x:r.x-U,y:r.y-U,width:r.width+2*U,height:r.height+2*U}),J.stroke()),Q.selectWidth>0){var k=O.gv._zoom;if(U=Q.selectPadding/k,J.strokeStyle=Q._97o,J.lineWidth=Q.selectWidth/k,Q.rotation!=R){J.save(),J.translate(Q.position.x,Q.position.y),J.rotate(Q.rotation);var d=O._data,i=d.getWidth(),D=d.getHeight(),C=Q.scale,c=Q.anchor;r={x:C.x*-i*c.x,y:C.y*-D*c.y,width:C.x*i,height:C.y*D}}pc(J,Q.selectType,{x:r.x-U,y:r.y-U,width:r.width+2*U,height:r.height+2*U}),Q.rotation!=R&&J.restore(),J.stroke()}},_3O:function(){var _=this,A=_.s,e=_._data,V=e.getStyle(kr),k=_.getBodyColor(),X=_._83o=V?{shape:V,_53o:_.getBodyColor("shape.background"),_27Q:rd(A("shape.repeat.image"),k),shapeGradientPack:A("shape.gradient.pack"),_54o:A("shape.border.width"),_55o:A("shape.border.color"),_56o:A("shape.border.3d"),_57o:A("shape.border.3d.color"),_58o:A("shape.border.3d.accuracy"),shapeGradient:A("shape.gradient"),_59o:A("shape.gradient.color"),_60o:A("shape.border.pattern"),_61o:A("shape.border.cap"),_62o:A("shape.border.join"),bodyColor:k}:{img:rd(e.getImage(),k),bodyColor:k,stretch:A("image.stretch")};if(x&&!O);else{X.rect=e.getRect(),X.position=e.p(),X.scale=e.getScale(),X.anchor=e.getAnchor(),X.rotation=e.getRotation(),V===ch&&(X._63o=A("shape.depth"));var D=0;if(V)D=tr(R,X._54o/2,X._62o),_.s("shape.dash")&&(D=I(D,(_.s("shape.dash.width")||X._54o)/2));else if(X.img&&X.img.boundExtend){if(D=Sl(X.img.boundExtend,e,_.gv),X.img.boundExtendAbsolute){var W=e.getScale();D/=_.gv._zoom*I(1,I(Q(W.x),Q(W.y)))}if(!X.img.fitSize){var F=Sl(X.img.width,e,_.gv),N=Sl(X.img.height,e,_.gv);D*=I(e.getWidth()/F,e.getHeight()/N)}}_._40O(X,D);var r=A("clip.percentage");if(1>r&&(0>r&&(r=0),X.clipRect=wg(e.getAnchorRect(),A("clip.direction"),r)),V){var d=A("shape.fill.clip.percentage");1>d&&(0>d&&(d=0),X.shapeClipRect=wg(e.getAnchorRect(),A("shape.fill.clip.direction"),d))}}},getPosition:function(p,j,J,U){var K=mp(p,this._83o.rect,U);return K.x+=j,K.y+=J,K},_80o:function(G){var W=this,t=W.s,r=W.gv,m=W._data,J=W._83o,R=J.rect,T=J.position,j=J.rotation,g=J.anchor,S=J.scale,K=J.shape,l=J.clipRect;if(!W._checkEmptyRect||R.width>0&&R.height>0){var Y=m.getSize();if(Y.x=-Y.width*g.x,Y.y=-Y.height*g.y,G.save(),Lf(G,T.x,T.y),Xg(G,j),ol(G,S.x,S.y),l&&(G.beginPath(),G.rect(l.x,l.y,l.width,l.height),G.clip()),W.freeDraw)W.freeDraw(G,Y,J);else if(K){var q,n,f,N,H=J._60o,o=Wh(G,H),I=J._53o,P=J._27Q,z=J._54o,w=J._55o,h=J.shapeGradientPack,k=G.lineJoin,y=G.lineCap;if("roundRect"===K?q=t("shape.corner.radius"):"polygon"===K?q=t("shape.polygon.side"):"arc"===K&&(q=t("shape.arc.from"),n=t("shape.arc.to"),f=t("shape.arc.close"),N=t("shape.arc.oval")),G.lineJoin=J._62o,G.lineCap=J._61o,I||P||h){var b=J.shapeClipRect;b&&(G.save(),G.beginPath(),G.rect(b.x,b.y,b.width,b.height),G.clip()),pc(G,K,Y,q,n,f,N),h?Zb(G,h):P?Df(G,P,J.bodyColor,null,m,r):qg(G,I,J.shapeGradient,J._59o,Y),G.fill(),b&&G.restore(),h&&G.restore(),G!==o&&pc(o,K,Y,q,n,f,N)}else pc(o,K,Y,q,n,f,N);if(z>0){var M=t("shape.border.width.absolute");M&&(G.save(),G.setTransform(1,0,0,1,0,0)),G.lineWidth=z,G.strokeStyle=w,G.stroke(),M&&G.restore(),J._56o&&vc(G,w,J._57o,z,r._zoom,J._58o)}if(Mi(G,H),t("shape.dash")){var C=t("shape.dash.width")||z;if(C>0){H=t("shape.dash.pattern");var o=Wh(G,H,W._2Q("shape.dash.offset"));o!==G&&pc(o,K,Y,q,n,f,N),W._1Q(G,"shape",C,H)}}Sq(G,I,J._63o,Y),G.lineJoin=k,G.lineCap=y}else Ti(G,J.img,J.stretch,Y.x,Y.y,Y.width,Y.height,m,r,J.bodyColor);G.restore()}W._39O(G,J)},_48O:function(){},_47O:function(){}});var Gf=function(z,p){Lk(Gf,this,[z,p])},cm=function(Z,S,G,b){var c=Tr(Z,S);return G=b?j(G,c):rb(G,c),c?G/=c:G=0,{x:Z.x+(S.x-Z.x)*G,y:Z.y+(S.y-Z.y)*G}};jl(Gf,pj,{_3O:function(){var K,$=this,X=$._data,Q=$.gv,E=$.s,H=E(oh),L=X.isLooped(),g=E("edge.width"),d=E("edge.center"),w=E("edge.offset"),o=Q.getBorderColor(X),A=o?E("border.width"):0,y=$.getSelectWidth(),P=X._40I,l=X._41I,r=$._78o=P&&l?{looped:L,type:H,width:g,center:d,color:$.getBodyColor("edge.color"),borderColor:o,borderWidth:A,_97o:y?E("select.color"):R,selectWidth:y,pattern:E("edge.pattern"),cap:E("edge.cap"),join:E("edge.join"),is3d:E("edge.3d"),_67o:E("edge.3d.color"),_66o:E("edge.3d.accuracy")}:R;if(r){var x=M.getEdgeType(H);if(x){var b=x(X,Bm($,Q,X,L,H),Q,$._19Q);b.points&&b.points.size()>1&&(r._4O=b,K=Ef(r._4O.points))}else{var i=E("edge.source.anchor.x"),V=E("edge.source.anchor.y"),T=E("edge.target.anchor.x"),U=E("edge.target.anchor.y"),n=Xn(Q,P,E("edge.source.position"),E("edge.source.offset.x"),E("edge.source.offset.y"),i,V),c=Xn(Q,l,E("edge.target.position"),E("edge.target.offset.x"),E("edge.target.offset.y"),T,U);if(H===tg){var C=r.points=E(kn)||Ze,k=C.size();r.segments=E("edge.segments");var v=i!==t||V!==t,D=T!==t||U!==t;if(!d)if(w)v||(n=cm(n,k?C.get(0):c,w,k)),D||(c=cm(c,k?C.get(k-1):n,w,k));else{var O;v||(O=uc(n,k?C.get(0):c,fk(Q,P)),O&&(n={x:O[0],y:O[1]})),D||(O=uc(k?C.get(k-1):n,c,fk(Q,l)),O&&(c={x:O[0],y:O[1]}))}K=Eq(Ef(r.points),Ef(n,c))}else{var J=Bm($,Q,X,L,H);if($._19Q||(J=-J),L)n=Fm(n),n.x=Q.getNodeRect(P).x,r.radius=J,K={x:n.x-J,y:n.y-J,width:2*J,height:2*J};else{var Y=Tr(n,c),a=rb(w,Y),W={x:a,y:J},j={x:Y-a,y:J},G=f(c.y-n.y,c.x-n.x),F=r.mat=new ys(G);if(r.orienAngle=G,r.angle=c.x<n.x?G+u:G,r.rect={x:W.x,y:W.y,width:j.x-W.x,height:0},r.origin=n,W=F.tf(W),W.x+=n.x,W.y+=n.y,j=F.tf(j),j.x+=n.x,j.y+=n.y,d){var Z={x:Y,y:0};Z=F.tf(Z),Z.x+=n.x,Z.y+=n.y,K=Ef([n,W,j,Z]),r.c1=n,r.c2=Z}else K=Ef(W,j);n=W,c=j}}r.sourcePoint=n,r.targetPoint=c,X._lastSourcePoint=n,X._lastTargetPoint=c}var h=0;E("edge.dash")&&(h=E("edge.dash.width")||g);var z="square"===r.cap?.71:.5;tr(K,I(h*z,g*z+A+y),r.join),$._68o(K)}},getRotation:function(q,D,m){q=q||0;var u=this._78o;if(u){var _,z=u.angle,l=u.points,G=u._4O;if(z!=R)return D?u.orienAngle+q:z+q;if(G){var I=G.points;return _=I.size(),dq[m]?_&&0===_%2?yp(I.get(_/2-1),I.get(_/2),D,q):q:Ve[m]?yp(I.get(0),I.get(1),D,q):yp(I.get(_-2),I.get(_-1),D,q)}if(l)return _=l.size(),dq[m]?_&&0===_%2?yp(l.get(_/2-1),l.get(_/2),D,q):q:Ve[m]?yp(u.sourcePoint,_?l.get(0):u.targetPoint,D,q):yp(_?l.get(_-1):u.sourcePoint,u.targetPoint,D,q)}return q},getPosition:function(t,o,x,F,A){var l=this._78o;if(l){var u,s=l.type,d=l.points,Y=l._4O,D=l.sourcePoint,C=l.targetPoint;if(!s)return l.looped?{x:D.x-l.radius+o,y:D.y+x}:(A&&D&&C&&(D.x>C.x||D.x===C.x&&D.y>C.y)&&(t=Ki[t],x=-x),u=mp(t,l.rect,F),u.x+=o,u.y+=x,u=l.mat.tf(u),u.x+=l.origin.x,u.y+=l.origin.y,u);if(d){var u,G=d.size();if(dq[t]){if(G){var g=G%2;if(0===g)return Dc(d.get(G/2-1),d.get(G/2),t,o,x,F,A);u=d.get((G-g)/2)}else u={x:(D.x+C.x)/2,y:(D.y+C.y)/2};return u=mp(t,{x:u.x,y:u.y,width:0,height:0},F),u.x+=o,u.y+=x,u}return Ve[t]?Dc(D,G?d.get(0):C,t,o,x,F,A):Dc(G?d.get(G-1):D,C,t,o,x,F,A)}if(Y){var M=Y.points,G=M.size();if(dq[t]){var g=G%2;return 0===g?Dc(M.get(G/2-1),M.get(G/2),t,o,x,F,A):(u=M.get((G-g)/2),u=mp(t,{x:u.x,y:u.y,width:0,height:0},F),u.x+=o,u.y+=x,u)}return Ve[t]?Dc(M.get(0),M.get(1),t,o,x,F,A):Dc(M.get(G-2),M.get(G-1),t,o,x,F,A)}}return fc},_42:function(y){this._78o&&Gf.superClass._42.call(this,y)},drawPath:function(P,n){P.beginPath();var Q=n.type,Z=n.points,J=n.segments,G=n._4O;if(!Q||Z){var z=n.sourcePoint,A=z.x,F=z.y,V=n.targetPoint,l=V.x,h=V.y;if(Q)if(J){var b=new fo({x:A,y:F});b.addAll(Z),b.add({x:l,y:h}),$h(P,b,J)}else P.moveTo(A,F),Z.each(function(G){P.lineTo(G.x,G.y)}),P.lineTo(l,h);else n.looped?P.arc(A,F,n.radius,0,B,!0):n.center?(P.moveTo(n.c1.x,n.c1.y),P.lineTo(A,F),P.lineTo(l,h),P.lineTo(n.c2.x,n.c2.y)):(P.moveTo(A,F),P.lineTo(l,h))}else G&&$h(P,G.points,G.segments)},_80o:function(s){var O=this,Y=O.s,g=O._78o,z=g.width,n=g.selectWidth,V=g.borderWidth,L=g.color,U=s.lineJoin,_=s.lineCap,$=g.pattern;s.lineJoin=g.join,s.lineCap=g.cap,O.drawPath(Wh(s,$),g);var y=Y("edge.width.absolute");if(y&&(s.save(),s.setTransform(1,0,0,1,0,0)),n&&(s.strokeStyle=g._97o,s.lineWidth=z+2*(V+n),s.stroke()),V&&(s.strokeStyle=g.borderColor,s.lineWidth=z+2*V,s.stroke()),s.strokeStyle=L,s.lineWidth=z,s.stroke(),g.is3d&&vc(s,L,g._67o,z,O.gv._zoom,g._66o),y&&s.restore(),Mi(s,$),Y("edge.dash")){$=Y("edge.dash.pattern");var R=Wh(s,$,O._2Q("edge.dash.offset"));R!==s&&O.drawPath(R,g),O._1Q(s,"edge",Y("edge.dash.width")||z,$)}s.lineJoin=U,s.lineCap=_},_48O:function(){},_47O:function(){},_71o:function(f,a){var d=this,m=d._data;if(d._19Q=!0,!m.getEdgeGroup())return f?m.s("edge.gap"):0;var P,Z=0,C=0,w=0;if(m.getEdgeGroup().getSiblings().each(function(H){H.each(function(S){if(d.gv.isVisible(S)&&S.s(oh)==a){var n=S.s("edge.gap");P?(C+=w/2+n/2,w=n):(P=S,w=n),S===m&&(Z=C)}})}),f)return C-Z+w;var S=Z-C/2;return P&&m._40I!==P._40I&&(d._19Q=!1),S}});var cp=function(h,b){Lk(cp,this,[h,b])};jl(cp,Gi,{_3O:function(){var V,h,O=this,M=O.s,b=O._data,w=O.gv;if(O._88I=R,b.isExpanded()&&b.eachChild(function(Q){var R=w.getBoundsForGroup(Q);R&&(h||(h=[]),h.push(R),V=Eq(V,R))}),V){var d=w.getLabel(b),P=M("group.type");V=tq(P,h,V),Jf(V,b,"group.padding",1);var X=O._88I={type:P,rect:V,_64o:V};if(!P&&d!=R){var _,n=O.labelInfo={label:d,color:M("group.title.color"),font:M("group.title.font"),align:M("group.title.align")},v=fi(n,d),I=v.width,e=v.height,y=M("group.title.align");I>V.width&&(V.width=I),n.rect={y:V.y-e,width:v.width,height:e},_=y===Ai?V.x:y===Br?V.x+V.width-I:V.x+V.width/2-I/2,n.rect.x=_,X.titleRect={x:V.x,y:V.y-e,width:V.width,height:e+1},X.rect={x:V.x,y:V.y-e,width:V.width,height:V.height+e}}O._40O(X,M("group.border.width")/2)}else cp.superClass._3O.call(O)},getPosition:function(f,x,A,D){var C=this._88I;if(C){var B=mp(f,C.rect,D);return B.x+=x,B.y+=A,B}return cp.superClass.getPosition.apply(this,arguments)},_24O:function(Z,A){var g=this._88I;(!g||g.type||"label2"===Z)&&cp.superClass._24O.call(this,Z,A)},_80o:function(J){var A=this,P=A._88I;if(P){var T=A._data,z=A.s,Q=A.gv,d=P.type,f=P.rect,G=P._64o,V=P.titleRect,B=A.getBodyColor(),U=rd(z("group.image"),B),b=z("group.image.stretch"),l=A.getBodyColor("group.background"),x=rd(z("group.repeat.image"),B),m=z("group.gradient.pack"),g=z("group.gradient"),Y=z("group.gradient.color"),w=z("group.depth");if(d){var k=z("group.border.pattern"),h=z("group.border.width"),K=J.lineJoin,M=J.lineCap;if(J.lineJoin=z("group.border.join"),J.lineCap=z("group.border.cap"),U){if(J.save(),pc(J,d,f),J.clip(),Ti(J,U,b,f.x,f.y,f.width,f.height,T,Q,B),J.restore(),h>0){var y=Wh(J,k);pc(y,d,f),J.lineWidth=h,J.strokeStyle=z("group.border.color"),J.stroke(),Mi(J,k)}}else{var y=Wh(J,k);l||x||m?(pc(J,d,f),m?Zb(J,m):x?Df(J,x,B,null,T,Q):qg(J,l,g,Y,f),J.fill(),m&&J.restore(),J!==y&&pc(y,d,f)):pc(y,d,f),h>0&&(J.lineWidth=h,J.strokeStyle=z("group.border.color"),J.stroke()),Mi(J,k),d===ch&&Sq(J,l,w,f)}J.lineJoin=K,J.lineCap=M}else if(U?Ti(J,U,b,G.x,G.y,G.width,G.height,T,Q,A.getBodyColor()):(l||x)&&(x?Df(J,x,B,null,T,Q):qg(J,l,g,Y,G),pc(J,ch,G),J.fill(),Sq(J,l,w,G)),V){var D=z("group.title.background");Ko(J,V.x,V.y,V.width,V.height,D),Sq(J,D,w,V)}A._39O(J,P)}else cp.superClass._80o.call(A,J)}});var ro=function(Q,A){Lk(ro,this,[Q,A])};jl(ro,Gi,{_80o:function(m){this._39O(m,this._83o)}});var Fe=function(r,K){Lk(Fe,this,[r,K])};jl(Fe,Gi,{_3O:function(){var b=this,d=b._data,H=b.s,w=b.gv,_=d.getPoints(),X=w.getBorderColor(d),g=X?H("border.width"):0,h=b.getSelectWidth(),k=H("shape.border.width"),P=d.getRect(),r=w.getBodyColor(d),q=b._99o=_.isEmpty()?R:{rect:P,rotation:d.getRotation(),fillRule:H("shape.fill.rule"),scale:d.getScale(),position:d.p(),points:_,segments:d.getSegments(),bodyColor:r,borderColor:X,borderWidth:g,_94o:H("shape.border.3d"),_95o:H("shape.border.3d.color"),_96o:H("shape.border.3d.accuracy"),_97o:h?H("select.color"):R,selectWidth:h,_53o:H("shape.background"),_27Q:rd(H("shape.repeat.image"),r),shapeGradientPack:H("shape.gradient.pack"),_54o:k,_55o:H("shape.border.color"),shapeGradient:H("shape.gradient"),_59o:H("shape.gradient.color"),_60o:H("shape.border.pattern"),_61o:H("shape.border.cap"),_62o:H("shape.border.join")};if(q){var G=d.getScale(),U=I(1,I(Q(G.x),Q(G.y))),x=k*("square"===q._61o?.71:.5)+g+h/b.gv._zoom/U;x&&(x*=U,P=Fm(P),tr(P,x,q._62o)),b._68o(P);var e=H("clip.percentage");1>e&&(0>e&&(e=0),q.clipRect=wg(d.getAnchorRect(),H("clip.direction"),e));var O=H("shape.fill.clip.percentage");1>O&&(0>O&&(O=0),q.shapeClipRect=wg(d.getAnchorRect(),H("shape.fill.clip.direction"),O))}},getPosition:function(S,$,i,u){var h=this._99o;if(h){var I=mp(S,h.rect,u);return I.x+=$,I.y+=i,I}return fc},_42:function(v){this._99o&&Fe.superClass._42.call(this,v)},_80o:function(t){var U,I=this,G=I.s,o=I._99o,W=o.position,D=o.scale,u=o.rotation,h=o.bodyColor,O=o.borderWidth,e=o.selectWidth,A=o._53o,K=o._27Q,R=o.shapeGradientPack,C=o._54o,w=o.clipRect,_=o.shapeClipRect,J=o.points,g=o.segments,s=I._data.isClosePath(),X=o.fillRule,c=A||K||R;t.save(),Lf(t,W.x,W.y),Xg(t,u),ol(t,D.x,D.y),w&&(t.beginPath(),t.rect(w.x,w.y,w.width,w.height),t.clip()),c&&_&&(t.save(),t.beginPath(),t.rect(_.x,_.y,_.width,_.height),t.clip()),Lf(t,-W.x,-W.y);var i=o._60o,v=Wh(t,i),Y=t.lineJoin,N=t.lineCap;t.lineJoin=o._62o,t.lineCap=o._61o,c?($h(t,J,g,s),R?Zb(t,R):K?Df(t,K,h,null,I._data,I.gv):(U=h?h:A,qg(t,U,o.shapeGradient,o._59o,o.rect)),t.fill(X),_&&(t.restore(),Lf(t,-W.x,-W.y)),R&&t.restore(),v!==t&&$h(v,J,g,s)):$h(v,J,g,s);var p=G("shape.border.width.absolute");if(p&&(t.save(),t.setTransform(1,0,0,1,0,0)),e&&(t.strokeStyle=o._97o,t.lineWidth=C+2*(O+e),t.stroke()),O&&(t.strokeStyle=o.borderColor,t.lineWidth=C+2*O,t.stroke()),C&&(U=o._55o,!A&&h&&(U=h),t.strokeStyle=U,t.lineWidth=C,t.stroke(),o._94o&&vc(t,U,o._95o,C,I.gv._zoom,o._96o)),p&&t.restore(),Mi(t,i),G("shape.dash")){var q=G("shape.dash.width")||C;if(q>0){i=G("shape.dash.pattern");var v=Wh(t,i,I._2Q("shape.dash.offset"));v!==t&&$h(v,J,g,s),I._1Q(t,"shape",q,i)}}t.lineJoin=Y,t.lineCap=N,t.restore()},_48O:function(){},_47O:function(){}});var bs=function(l,s){Lk(bs,this,[l,s])};jl(bs,Fe,{getRotation:function(e,w,r){e=e||0;var C=this._data.getPoints(),k=C.size();return k>1?dq[r]?k&&0===k%2?yp(C.get(k/2-1),C.get(k/2),w,e):e:Ve[r]?yp(C.get(0),C.get(1),w,e):yp(C.get(k-2),C.get(k-1),w,e):e},getPosition:function(z,M,q,a,u){var m=this._data.getPoints(),O=m.size();if(O>1){if(dq[z]){var j=O%2;if(0===j)return Dc(m.get(O/2-1),m.get(O/2),z,M,q,a,u);var D=m.get((O-j)/2),P={x:D.x,y:D.y,width:0,height:0};return D=mp(z,P,a),D.x+=M,D.y+=q,D}return Ve[z]?Dc(m.get(0),m.get(1),z,M,q,a,u):Dc(m.get(O-2),m.get(O-1),z,M,q,a,u)}return fc}});var Xf=function(K,m){Lk(Xf,this,[K,m])};jl(Xf,Gi,{_3O:function(){var o=this;Xf.superClass._3O.call(o);var P=o.s,f=o._83o;o._82o=f.img||f.shape?R:{background:o.getBodyColor("grid.background"),depth:P("grid.depth"),rect:f.rect,_88o:P("grid.cell.depth"),cellBorderColor:P("grid.cell.border.color"),_89o:P("grid.row.count"),_90o:P("grid.column.count"),block:P("grid.block"),_91o:P("grid.block.color"),_92o:P("grid.block.padding"),_93o:P("grid.block.width")}},_80o:function(V){var W=this,N=W._82o;if(!N)return Xf.superClass._80o.call(W,V),void 0;var t,D,M=W._data,m=N.background,S=N.rect,Y=N.block,C=N._91o,r=N._92o,o=N._93o,B=N._88o,e=N.cellBorderColor,i=N._89o,Z=N._90o;if(m)if(Ko(V,S.x,S.y,S.width,S.height,m),Sq(V,m,N.depth,S),B)for(t=0;i>t;t++)for(D=0;Z>D;D++)S=M.getCellRect(t,D),S&&Sq(V,m,B,S);else if(e){for(V.beginPath(),t=0;i>t;t++)for(D=0;Z>D;D++)S=M.getCellRect(t,D),S&&V.rect(S.x,S.y,S.width,S.height);V.strokeStyle=e,V.lineWidth=1,V.stroke()}if("h"===Y)for(t=0;i>t;t++)S=Eq(M.getCellRect(t,0),M.getCellRect(t,Z-1)),yl(S,r),un(V,C,S.x,S.y,S.width,S.height,o);else if("v"===Y)for(D=0;Z>D;D++)S=Eq(M.getCellRect(0,D),M.getCellRect(i-1,D)),yl(S,r),un(V,C,S.x,S.y,S.width,S.height,o);W._39O(V,W._83o)}});var Db=function(K,S){Lk(Db,this,[K,S])};jl(Db,Gi,{_checkEmptyRect:!1,_81o:function(){var g=this._data,y=Db.superClass._81o.call(this),J=g.s("text");if(J!=R){var u,U,D=g.s("text.font"),n=g.s("text.align"),G=g.s("text.vAlign"),t=g.getRotation(),s=je(D,J),I=s.width,V=s.height;"left"===n?u=-g.getWidth()/2:"center"===n?u=-s.width/2:"right"===n&&(u=g.getWidth()/2-s.width),"top"===G?U=-g.getHeight()/2:"middle"===G?U=-s.height/2:"bottom"===G&&(U=g.getHeight()/2-s.height);var F;if(t){var A=new ys(t);F=Ef([A.tf(u,U),A.tf(u+I,U),A.tf(u+I,U+V),A.tf(u,U+V)])}else F={x:u,y:U,width:I,height:V};F.x+=g.getPosition().x,F.y+=g.getPosition().y,y=Eq(y,F)}return y}});var gr=Am.Interactor=function(w){this.gv=this._graphView=w};Yp("Interactor",v,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(S){this.gv.fi(S)},setCursor:function(R){b||(this.getView().style.cursor=R)},startDragging:function(Q){var Y=this;Y._lastClientPoint=de(Q),Y._lastLogicalPoint=Y.gv.lp(Q),ws(Y,Q)},clearDragging:function(){var x=this;x._lastClientPoint=x._lastLogicalPoint=x._logicalPoint=R},autoScroll:function(D){return this.gv.autoScroll(D,this._lastClientPoint)}});var Cs=Am.DefaultInteractor=function(m){Lk(Cs,this,[m])};Yp("DefaultInteractor",gr,{handle_mousedown:function(u){Ch(u);var A=this,j=A.gv,n=j.getDataAt(u);!j.setFocus(u)||j._editing||j._scrolling||(vs(u)?j.handleDoubleClick(u,n):j.handleClick(u,n),!gl()&&n||!j.isPannable()||!fq(u)||sq(u)||(A._tx=j.tx(),A._ty=j.ty(),A.startDragging(u)))},handleWindowMouseUp:function(X){var M=this,z=M.gv;z._panning&&(delete z._panning,z.onPanEnded(),M.fi({kind:"endPan",event:X})),delete M._tx,delete M._ty,M.clearDragging()},handle_mousemove:function(o){var w=this,M=w.gv;w._hoverTimer&&(A(w._hoverTimer),delete w._hoverTimer),w._hoverTimer=e(function(){w.fi({kind:"hover",event:o}),A(w._hoverTimer),delete w._hoverTimer},M.getHoverDelay()||800)},handle_touchmove:function(O){this.handle_mousemove(O)},handleWindowMouseMove:function(W){var t=this,r=t.gv,j=t._lastClientPoint;t.fi({kind:r._panning?"betweenPan":"beginPan",event:W}),r._panning=1,r.setTranslate(t._tx+W.clientX-j.x,t._ty+W.clientY-j.y)},handle_mousewheel:function(I){this.gv.handleScroll(I,I.wheelDelta)},handle_DOMMouseScroll:function(X){2===X.axis&&this.gv.handleScroll(X,-X.detail)},handle_keydown:function(K){this.gv.handleKeyDown(K)}});var Cq=Am.SelectInteractor=function(I){Lk(Cq,this,[I])};Yp("SelectInteractor",gr,{_42:function(){var w=this,C=w.gv,H=C.getZoom(),h=w.mark,m=w.div;m||(m=w.div=so(),Gl(w.getView(),m));var b={};b.x=h.x*H+C.tx(),b.y=h.y*H+C.ty(),b.width=h.width*H,b.height=h.height*H,Se(m,b),this.intersects()?(m.style.border="",m.style.background=C.getRectSelectBackground()):(m.style.background="",m.style.border="1px solid "+C.getRectSelectBorderColor())},handle_mousedown:function(c){var O=this,e=O.gv;if(O._57I=R,!(e._editing||e._scrolling||gl())){var _=e.getDataAt(c),p=e.sm();_?sq(c)?p.co(_)?p.rs(_):p.as(_):p.co(_)||p.ss(_):sq(c)||!e.isPannable()?fq(c)&&(sq(c)||p.cs(),e.isRectSelectable()&&(O.startDragging(c),e._77O=1)):fq(c)&&(O._57I=de(c))}},handle_mouseup:function(x){var Q=this,B=Q._57I;B&&(Tr(B,de(x))<=1&&Q.gv.sm().cs(),Q._57I=R)},handleWindowMouseUp:function(T){this.clear(T)},handleWindowMouseMove:function(a){var F=this,H=F.gv;F._logicalPoint=H.lp(a),F.mark?(F.fi({kind:"betweenRectSelect",event:a}),F.autoScroll(a),F.redraw()):F.fi({kind:"beginRectSelect",event:a}),F.mark=Ef(F._lastLogicalPoint,F._logicalPoint),F.redraw()},intersects:function(){var V=this,g=V._lastLogicalPoint,m=V._logicalPoint;return g.x>m.x||g.y>m.y},clear:function(Z){var M=this,O=M.gv,Q=M.mark;if(M._57I=R,M._lastLogicalPoint){if(Q){if(0!==Q.width&&0!==Q.height){var r=O.getDatasInRect(Q,M.intersects());if(!r.isEmpty()){var W=O.sm(),p=W.toSelection();r.each(function(h){W.co(h)?p.remove(h):p.add(h)}),W.ss(p)}}Mf(M.div),delete M.div,delete M.mark,M.redraw(),M.fi({kind:"endRectSelect",event:Z}),O.onRectSelectEnded()}M.clearDragging(),delete O._77O}},redraw:function(){var J=this;J._draw||(J._draw=1,e(function(){J.mark&&J._42(),delete J._draw},16))}});var ic=Am.MoveInteractor=function(W){Lk(ic,this,[W])};Yp("MoveInteractor",gr,{handle_mousedown:function(G){var O=this,k=O.gv;if(fq(G)&&!k._editing&&!k._scrolling&&!gl()){var N=k.getSelectedDataAt(G);N?(O._data=N,k.handleMouseDown&&k.handleMouseDown(G,N),O.startDragging(G),k.isMovable(N)&&(k._moving=1)):k._focusData=R}},handleWindowMouseUp:function(H){var Z=this,A=Z.gv;A.handleMouseUp&&A.handleMouseUp(H,Z._data),Z.clear(H)},handleWindowMouseMove:function(S){var J=this,m=J._data,P=J.gv,j=P.getDataModel(),q=j.getHistoryManager();if((!P._93O||!P._93O(S,m))&&P._moving){J._logicalPoint||J.fi({kind:"prepareMove",event:S});var r=J._logicalPoint?"betweenMove":"beginMove",y={kind:r,event:S},v=J._logicalPoint=P.lp(S);q&&"beginMove"===r&&q.beginInteraction();var h=J._calcShift(r,S),I=h.x,E=h.y,Q=J.gv.getMoveMode(S,m);Q&&("x"===Q?E=0:"y"===Q?I=0:"xy"!==Q&&(I=E=0)),P.moveSelection(I,E),J._lastLogicalPoint=v,J.autoScroll(S),J.fi(y)}},_calcShift:function(){var X=this,h=X._logicalPoint,G=X._lastLogicalPoint,b=h.x-G.x,J=h.y-G.y;return{x:b,y:J}},clear:function(B){var _=this,m=_.gv,N=m.getDataModel(),A=N.getHistoryManager();_._lastLogicalPoint&&(_._lastLogicalPoint=_._data=m._moving=R,_._logicalPoint&&(_.fi({kind:"endMove",event:B}),m.onMoveEnded(),A&&A.endInteraction()),_.clearDragging())}});var Li=Am.ScrollBarInteractor=function(p){Lk(Li,this,[p])};Yp("ScrollBarInteractor",gr,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(m){var i=this.gv.getViewRect();return this._41o()&&(i.x+i.width-this.gv.lp(m).x)*this.gv.getZoom()<mq},isH:function(g){var A=this.gv.getViewRect();return this._40o()&&(A.y+A.height-this.gv.lp(g).y)*this.gv.getZoom()<mq},handle_mousemove:function(k){this.handle_touchmove(k)},handle_touchmove:function(F){if(!Ji&&fq(F)){var S=this,C=S.isV(F),d=S.isH(F);(C||d)&&S.gv.showScrollBar(),S.gv._scrolling=C||d}},handleWindowMouseUp:function(y){this.handleWindowTouchEnd(y)},handleWindowTouchEnd:function(B){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=R,this.fi({kind:"endScroll",event:B})},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(F){var e=this;
if(e.gv.setFocus(F),Ch(F),e.handle_touchmove(F),!(Ag(F)>1)&&e.gv._scrolling){e._cp=de(F),e._tx=e.gv.tx(),e._ty=e.gv.ty();var Z=e.isV(F);e._state=Z?"vScroll":"hScroll",ws(e,F),e.fi({kind:"beginScroll",event:F})}},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(X){var U=de(X),l=this.gv.getViewRect(),V=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-U.y)*V.height/l.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-U.x)*V.width/l.width),this.fi({kind:"betweenScroll",event:X})}});var Hn=Am.TouchInteractor=function(X,u){u=u||{},u.selectable===t&&(u.selectable=!0),u.movable===t&&(u.movable=!0),u.pannable===t&&(u.pannable=!0),u.pinchable===t&&(u.pinchable=!0),u.editable===t&&(u.editable=!0),this.params=u,Lk(Hn,this,[X])};Yp("TouchInteractor",gr,{ms_edit:1,setUp:function(){var B=this;Hn.superClass.setUp.call(B),b&&B.params.editable&&B.gv.setEditInteractor(B)},tearDown:function(){var A=this;Hn.superClass.tearDown.call(A),b&&A.params.editable&&A.gv.setEditInteractor(R)},clear:function(Y){var g=this,N=g.gv,f=N.dm().getHistoryManager();N._moving&&(g.fi({kind:"endMove",event:Y}),delete N._moving,N.onMoveEnded(),f&&f.endInteraction()),N._panning&&(g.fi({kind:"endPan",event:Y}),delete N._panning,N.onPanEnded()),N._pinching&&(g.fi({kind:"endPinch",event:Y}),delete N._pinching,N.onPinchEnded()),N._editing&&(g._46O(Y),g._77I=g._node=g._edge=g._shape=g._rect=g._89I=g._index=N._editing=R),g._moving=g._panning=g._pinching=g._editing=g._57I=g._data=g._beginHistory=R,g.clearDragging()},handle_touchstart:function(i){var C=this;if(!C.gv._editing){Ch(i),C._57I=R;var q=C.params,z=C.gv,M=z.sm(),w=z.getDataAt(i),G=Ag(i);if(1===G)vs(i)?z.handleDoubleClick(i,w):(z.handleClick(i,w),w&&(z.handleMouseDown&&z.handleMouseDown(i,w),C._data=w)),q.selectable||(w=R),w?(M.co(w)||M.ss(w),q.editable&&z.isEditable(w)&&C._79I(i,w,!0)?(C._editing=1,C.startDragging(i)):q.movable&&z.isMovable(w)&&(C._moving=1,C.startDragging(i))):(C._57I=de(i),q.pannable&&z.isPannable()&&(C._panning=1,C.startDragging(i),C._translate={x:z.tx(),y:z.ty()}));else if(q.pinchable&&2===G){C._pinching=1,C.startDragging(i);var P=z.getView(),U=z.getZoom(),V=P.getBoundingClientRect(),D=i.touches[0],b=i.touches[1],s={x:(D.clientX+b.clientX)/2-V.left,y:(D.clientY+b.clientY)/2-V.top};s.x-=z.tx(),s.y-=z.ty(),s.x/=U,s.y/=U,C._p=s,C._d=Dm(i)}}},handle_touchend:function(d){var z=this,c=z.gv,$=z._57I,B=z._data;$&&(Tr($,de(d))<=1&&c.sm().cs(),z._57I=R),B&&c.handleMouseUp&&c.handleMouseUp(d,B)},handleWindowTouchEnd:function(m){this.clear(m)},handleWindowTouchMove:function(q){var c=this,h=c.gv,Z=h.dm().getHistoryManager(),V=Ag(q);if(1===V){if(c._editing&&(Z&&!c._beginHistory&&(c._beginHistory=1,Z.beginInteraction()),h._editing=1,c._78I(q)),c._moving)Z&&!c._beginHistory&&(c._beginHistory=1,Z.beginInteraction()),c.handleMove(q);else if(c._panning){var k=de(q);h.setTranslate(c._translate.x+k.x-c._lastClientPoint.x,c._translate.y+k.y-c._lastClientPoint.y),c.fi({kind:h._panning?"betweenPan":"beginPan",event:q}),h._panning=1}}else if(2===V&&c._pinching){var b=Dm(q);h.handlePinch(c._p,b,c._d),c._d=b,c.fi({kind:h._pinching?"betweenPinch":"beginPinch",event:q}),h._pinching=1}},handleMove:function(c){var x=this,R=x.gv,p=R.lp(c);R._93O&&R._93O(c,x._data)||(R.moveSelection(p.x-x._lastLogicalPoint.x,p.y-x._lastLogicalPoint.y),x._lastLogicalPoint=p,x.autoScroll(c),x.fi({kind:R._moving?"betweenMove":"beginMove",event:c}),R._moving=1)}});var K=D.ht,Bj=K.graph._editor={Math:{},Guide:{}};Bj.getStyle=function(E){var C,$=Bj.StyleMap;return $&&(C=$[E],C!==t)?C:Bj.DefaultStyleMap[E]},Bj.setStyle=function(A,p){var c=Bj.StyleMap;c||(c=Bj.StyleMap={}),c[A]=p},Bj.inEdit=function(K){return K._inXEdit===!0},Bj.startEdit=function(k){k._inXEdit=!0,Bj.Inject.doInject(k)},Bj._46O=function(k){k._inXEdit=!1,Bj.Inject.undoInject(k)},Bj.toScreenPosition=function(_,e){var N=_.tx(),V=_.ty(),p=_._zoom;return new Bj.Math.Vector2(e.x*p+N,e.y*p+V)},Bj.checkHit=function(z,q,S){return z.distanceTo(q)<S?!0:!1},Bj.toWorldPosition=function(U,B){var m=U.tx(),z=U.ty(),k=U._zoom;return{x:(B.x-m)/k,y:(B.y-z)/k}},Bj.log=function(){};var Vn=Bj.Inject={_modules:[]};Vn.registAsModule=function(P,V){var e={},q={};for(var U in P){var k=V.prototype[U];e[U]=k}P.getBackup=function(F){return e[F]},P.getBackups=function(){return e},q.doInject=function(){for(var d in P)"getBackup"!==d&&(V.prototype[d]=P[d])},q.undoInject=function(){for(var j in P)"getBackup"!==j&&(V.prototype[j]=e[j])},Vn._modules.push(q)},Vn.doInject=function(Z){for(var u,_=Vn._modules,d=0,Y=_.length;Y>d;d++)u=_[d],u.doInject(Z)},Vn.undoInject=function(u){for(var h,P=Vn._modules,m=0,U=P.length;U>m;m++)h=P[m],h.undoInject(u)};var gr=K.graph.EditInteractor=function(r){var m=this,$=X.createElement("canvas");$.className="editCanvas",$.style.position="absolute",m._styleMap={},m._canvas=$,m._context=$.getContext("2d"),gr.superClass.constructor.call(m,r),m.setAntialias(!1),m._subModules=[new Bj.Anchor(m),new Bj.Rect(m),new Bj.Curve(m),new Bj.MoveHelper(m)],m._gridGuide=new Bj.Guide.Grid(m),m._rectGuide=new Bj.Guide.Rect(m)},Ql=gr;K.Default.def(gr,K.graph.Interactor,{ms_edit:1,ms_fire:1}),v.defineProperties(gr.prototype,{editDetail:{get:function(){var P=!!this._editDetail;return P},set:function(X){var q=this,U=q._editDetail;U!==X&&(q._editDetail=X,q.gv._editing=X,q.fp("editDetail",U,X),q.fp("pointsEditingMode",U,X))}},gvEditing:{get:function(){return this.gv._editing},set:function(z){(!this._editDetail||z)&&(this.gv._editing=z,z||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(X){this._editing=X,this.gvEditing=X}},pointsEditingMode:{get:function(){return this.editDetail},set:function(E){var A=this;A.editDetail!==E&&(E?A._tryEnterEditDetailMode():A._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var J=this._gridEnabled;if(!J)return!1;var L=this.gv;return L?L._zoom<this.getStyle("gridZoomThreshold")?!1:!0:!0},set:function(W){W!==this._gridEnabled&&(this._gridEnabled=W,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(_){_!==this._agEnabled&&(this._agEnabled=_,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),gr.prototype.getSubModule=function(E){var G,S,V,x=this._subModules;for(S=0,V=x.length;V>S;S++)if(G=x[S],G.catalog===E)return G},gr.prototype.invokeSubModule=function(k,A){var F=this,I=F._subModules;if(I)for(var K,S,T,M=Array.prototype.slice.call(arguments,2),q=0,V=I.length;V>q;q++)if(K=I[q],S=K[k],S&&(T=S.apply(K,M),T!=t&&A))return K},gr.prototype.invokeSubModuleInverse=function(U,G){var R=this,x=R._subModules;if(x)for(var I,T,m,F=Array.prototype.slice.call(arguments,2),H=x.length-1;H>=0;H--)if(I=x[H],T=I[U],T&&(m=T.apply(I,F),m!=t&&G))return I},gr.prototype.setUp=function(){Bj.log("setUp");var k=this,_=k.gv,m=_.getView(),N=k._canvas;gr.superClass.setUp.call(k),_.setEditInteractor(k),_._79O?m.insertBefore(N,_._79O):m.appendChild(N),Bj.startEdit(_),k.invokeSubModule("setUp"),_.dm().mm(k._onDataModelChanged,k),_.dm().md(k._onDataPropertyChanged,k)},gr.prototype.tearDown=function(){Bj.log("tearDown");var T=this,H=T.gv,x=H.getView();gr.superClass.tearDown.call(T),H.dm().umm(T._onDataModelChanged),H.dm().umd(T._onDataPropertyChanged),H.setEditInteractor(null),x.removeChild(T._canvas),Bj._46O(H),T.invokeSubModule("tearDown")},gr.prototype._onDataModelChanged=function(E){var f=this;("clear"===E.kind||"remove"===E.kind&&f.editDetail&&E.data===f.getSubModule("Curve").target)&&(f.editDetail=!1,f._42())},gr.prototype._onDataPropertyChanged=function(T){var O=this;if(O.editDetail){var u=O.getSubModule("Curve"),A=T.data;A===u.target&&(A._writing||u._handleDataChanged())}},gr.prototype.clear=function(){Bj.log("clear")},gr.prototype.redraw=function(){this._42()},gr.prototype._42=function(){var W=this;W._drawTimer||(W._drawTimer=e(function(){delete W._drawTimer,W.drawImpl()},0))},gr.prototype.drawImpl=function(){var v;for(v in{_42:!0})break;return function(){var g=this,f=g._canvas,T=g.gv,m=T.getWidth(),Y=T.getHeight(),M=g._context,n=K.Default.getInternal();(f.width!==m||f.height!==Y)&&n.setCanvas(f,m,Y),M.clearRect(0,0,f.width,f.height);var k=g._getValidSelection();M.save();var b=K.Default.devicePixelRatio;M.scale(b,b),g._gridGuide._42(),g._rectGuide._42(),g.invokeSubModuleInverse(v,!1,M,T,k),M.restore()}}(),gr.prototype._getValidSelection=function(){var $=this,t=$.gv,j=t.sm().getSelection(),w=[];return j.each(function(o){t.isVisible(o)&&t.isSelectable(o)&&t.isEditable(o)&&w.push(o)}),w},gr.prototype.setAntialias=function(R){for(var G,B=this._context,V=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],e=0,Z=V.length;Z>e&&(G=V[e],!B[G]);e++);B[G]=R},gr.prototype.handle_touchmove=function(s){return this.handle_mousemove(s)},gr.prototype.handle_mousemove=function($){if(!K.Default.isDragging()){var O=this;(O.editDetail||!gl())&&(O.gvEditing=!1,O._checkEdit($)&&(O.gvEditing=!0))}},gr.prototype.handle_touchstart=function(l){return this.handle_mousedown(l)},gr.prototype.handle_mousedown=function(K){Ch(K);var g=this;if(g.editDetail||!gl()){if(vs(K)){if(g.editDetail){if(g._tryQuitEditDetailMode(K))return}else if(g._tryEnterEditDetailMode())return;if(g.invokeSubModule("handleDoubleClick",!0,K))return}var Z=g._checkEdit(K);if(Z){g._downPosition=g._getLogicalPoint(K);var y=g.gv.dm(),l=y.getHistoryManager();l&&l.beginInteraction(),Z.startEdit(g,K),g.editing=!0}}},gr.prototype._checkEdit=function(y){var M=this,a=M.gv,l=M._getLogicalPoint(y),g=M.invokeSubModule("check",!0,a,y,l)||null;return M._editMod=g,g},gr.prototype.handleWindowTouchMove=function(p){return this.handleWindowMouseMove(p)},gr.prototype.handleWindowMouseMove=function(z){var G=this,o=G._downPosition;if(o){var p=G._getLogicalPoint(z);if(p.distanceTo(o)<G.getStyle("moveSensitivity"))return;delete G._downPosition}var c=G._editMod;c&&c.handleEdit(G.gv,z)},gr.prototype._getLogicalPoint=function(M){var u=this,f=K.Default.getLogicalPoint(M,u._canvas);return new Bj.Math.Vector2(f)},gr.prototype.handleWindowTouchEnd=function(u){return this.handleWindowMouseUp(u)},gr.prototype.handleWindowMouseUp=function(){var l;for(l in{_46O:!0})break;return function(){var K=this;K.editing=!1,K.setCursor("default"),K.invokeSubModule(l,!1),K._42();var R=K.gv.dm(),A=R.getHistoryManager();A&&A.endInteraction()}}(),gr.prototype.handle_mousewheel=function(v){var J=this;Ch(v),J.invokeSubModule("preHandleScroll",!0)||J.gv.handleScroll(v,v.wheelDelta)},gr.prototype.handleDelete=function(){var s=this;return s.editDetail?(s.invokeSubModule("handleDelete",!0),s._42(),void 0):(s.gv.removeSelection(),void 0)},gr.prototype.handle_keydown=function($){var D=this;if(($.metaKey||$.ctrlKey)&&D._42(),gl($)&&!D.editing)return D.gvEditing=!1,D.setCursor("default"),D._42(),void 0;var o=Ad($);return D.editDetail?((o||Op($))&&(D.editDetail=!1,D._42()),D.invokeSubModule("handle_keydown",!0,$),void 0):(o&&D._tryEnterEditDetailMode(),void 0)},gr.prototype.handle_keyup=function(m){this.invokeSubModule("handle_keyup",!0,m)},gr.prototype._tryEnterEditDetailMode=function(){var g=this;return!g.editDetail&&g.invokeSubModule("canEnterEditDetailMode",!0)&&1===g._getValidSelection().length?(g.editDetail=!0,g._42(),!0):void 0},gr.prototype._tryQuitEditDetailMode=function(P){var T=this;if(T.editDetail){var u=T.gv,g=T.getSubModule("Curve").target;return P&&u.getDataAt(P)===g?void 0:(T.editDetail=!1,T._42(),!0)}},gr.prototype.setStyle=function(F,Y,c){var V=this;c?Bj.setStyle(F,Y):V._styleMap[F]=Y,V._42()},gr.prototype.getStyle=function(D){var k=this,O=k._styleMap[D];return O!==t?O:Bj.getStyle(D)};var Oq=Bj.Group=function(x){var u=this;u._entities=x,u._64O=0,u._position={x:0,y:0},u._scale={x:1,y:1},u._anchor={x:.5,y:.5},u._anchor2={x:.5,y:.5}};Oq.prototype={},Oq.prototype.constructor=Oq;var bc=null;Oq.findOrCreateGroup=function(C){if(bc&&bc.checkIsMe(C))return bc;var g=new Bj.Group(C);return g.getKeyOb()?(bc=g,g):void 0},Oq.prototype.checkIsMe=function(y){var T=this._entities;if(T.length!==y.length)return!1;var s,N={},r=y.length;for(s=0;r>s;s++)N[y[s]._id]=!0;for(s=0;r>s;s++)if(!N[T[s]._id])return!1;return!0},Oq.prototype.getRotation=function(){return this._64O},Oq.prototype.getPosition=function(){return this._position},Oq.prototype.getAnchor=function(){return this._anchor},Oq.prototype.getWidth=function(){return this._width},Oq.prototype.getScale=function(){return this._scale},Oq.prototype.getSize=function(){return{width:this._width,height:this._height}},Oq.prototype.getHeight=function(){return this._height},Oq.prototype.getKeyOb=function(){for(var K=this._entities,S=K.length-1;S>=0;S--){var F=K[S];if(this.isNode(F))return F}},Oq.prototype.getAnchor2=function(){var N=this,k=N.getKeyOb();if(!k)return N._anchor;var M=N._anchor2,c=k.getMatrix();return c.tf({x:k.getWidth()*(M.x-k.getAnchor().x),y:k.getHeight()*(M.y-k.getAnchor().y)})},Oq.prototype.setAnchor2=function(X,T){var g=this,l=g.getKeyOb();if(l){var k,q=l.getMatrix();k="number"==typeof X?{x:X,y:T}:X;var z=q.tfi(k);g._anchor2={x:l.getAnchor().x+z.x/l.getWidth(),y:l.getAnchor().y+z.y/l.getHeight()}}},Oq.prototype.setRotation=function(){},Oq.prototype.addRotation=function(e){var k=this,E=k._anchor2;k._entities.forEach(function(v){if(k.isNode(v)){var j=v.getAnchor(),W=v.getMatrix(),z=W.tf({x:v.getWidth()*(E.x-j.x),y:v.getHeight()*(E.y-j.y)}),D=new Bj.Math.Matrix2;D.set(W.a,W.b,W.c,W.d,W.tx,W.ty),D.translate(-z.x,-z.y),D.rotate(e),D.translate(z.x,z.y);var $=Math.sign(v.getScale().x);v.setRotation(f(D.b*$,D.a*$)),v.setPosition(D.tx,D.ty)}})},Oq.prototype.setPosition=function(y){var $,J,i,B,X=this,j=X._position,k=y.x-j.x,v=y.y-j.y,c=X._entities;for(J=0,i=c.length;i>J;J++)$=c[J],Vp($)&&(B=$.getPosition(),$.setPosition(B.x+k,B.y+v));X._position=y},Oq.prototype.setScale=function(i,D){var H=this,y=i/H._scale.x,F=D/H._scale.y;H._adjustChildScaleOrSize(y,F,"size"),H._scale={x:i,y:D}},Oq.prototype.getRect=function(){var K=this,E=K._position,s=K._width,F=K._height;return{x:E.x-s/2,y:E.y-F/2,width:s,height:F}},Oq.prototype.setSize=function(T,m){var b=this,T=Math.max(1,T),m=Math.max(1,m),g=T/b._width,h=m/b._height;b._adjustChildScaleOrSize(g,h,"size"),b._width=T,b._height=m},Oq.prototype._adjustChildScaleOrSize=function(g,l,r){var O,u,c,a,S,D,Z,T,M,I,L,d,C,q,m=this,J=m._position,Y=m._entities,n=new Bj.Math.Matrix2;for(u=0,c=Y.length;c>u;u++)if(O=Y[u],m.isNode(O)){if(a=O.getPosition(),S=O.getRotation(),D=O.getWidth(),Z=O.getHeight(),T=O.getScale(),L=T.x*D,d=T.y*Z,n.identity().scale(L,d).rotate(S).translate(a.x,a.y).translate(-J.x,-J.y).rotate(-m._64O),S=f(n.b*Math.sign(L),n.a*Math.sign(L)),n.scale(g,l),M=Math.cos(S),I=Math.sin(S),Math.abs(M)<.001?(C=n.b/I,q=-n.c/I):(C=n.a/M,q=n.d/M),"scale"===r)O.setScale(C/D,q/Z);else if("size"===r){var s=C/T.x,K=q/T.y;O.setScale(Xl(C)*Math.abs(T.x),Xl(q)*Math.abs(T.y)),O.setSize(Math.max(.1,Math.abs(s)),Math.max(.1,Math.abs(K)))}n.rotate(m._64O).translate(J.x,J.y),O.setPosition(n.tx,n.ty)}},Oq.prototype.getMatrix=function(){var o=this,M=o._position,n=K.Default.getInternal(),Y=o._scale;return new n.Mat(o._64O,M.x,M.y,Y.x,Y.y)},Oq.prototype.getCorners=function(){var W=this,o=W._width,r=W._height,b=W._anchor,h=-o*b.x,P=-r*b.y,Q=W.getMatrix();return[Q.tf(h,P),Q.tf(h,P+r),Q.tf(h+o,P+r),Q.tf(h+o,P)]},Oq.prototype.calcInfo=function(){var P,A,i,$,B,W,n=this,D=[],r=n._entities,I=n._64O;for($=0,B=r.length;B>$;$++)W=r[$],n.isNode(W)&&W.getCorners&&D.push.apply(D,W.getCorners());if(D.length){var K=Math.cos(-I),C=Math.sin(-I),x=1/0,J=-1/0,j=1/0,l=-1/0;for($=0,B=D.length;B>$;$++)i=D[$],P=i.x,A=i.y,i.x=K*P-C*A,i.y=C*P+K*A,x=Math.min(x,i.x),J=Math.max(J,i.x),j=Math.min(j,i.y),l=Math.max(l,i.y);n._width=(J-x)/n._scale.x,n._height=(l-j)/n._scale.y,K=Math.cos(I),C=Math.sin(I);var d=n._anchor;P=x+(J-x)*d.x,A=j+(l-j)*d.y,n._position={x:K*P-C*A,y:C*P+K*A}}},Oq.prototype.isNode=function(S){return Vp(S)?$i(S)?!1:!0:!1},Oq.prototype._42=function(p,c,y){var B,P,K,r,z,k,x,E=this,A=E._entities,f=E.getKeyOb();for(B=0,P=A.length;P>B;B++)K=A[B],E.isNode(K)&&(k=K.getRect(),r=Bj.toScreenPosition(y,{x:k.x,y:k.y}),z=Bj.toScreenPosition(y,{x:k.x+k.width,y:k.y+k.height}),x={min:r,max:z},K===f&&(x.isKeyOb=!0),Bj.Icons.DrawIcon(p,c,Bj.Icons.GroupSubEntityRect,x))};var df=Bj.Guide.Grid=function(V){var l=this;l._interactor=V,l._alignmentGuideId=0,l._xAlignmentGuide=[],l._yAlignmentGuide=[]};df.prototype={},df.prototype.constructor=df,v.defineProperties(df.prototype,{gridBlockSize:{get:function(){var a=this;return a._gridBlockSize||a._interactor.getStyle("gridBlockSize")},set:function(W){this._gridBlockSize=W,this._interactor._42()}},gridThickLinesEvery:{get:function(){var U=this;return U._gridThickLinesEvery||U._interactor.getStyle("gridThickLinesEvery")},set:function(D){this._gridThickLinesEvery=D,this._interactor._42()}},gridEnabled:{get:function(){var H=this,j=H._interactor;return j.gridEnabled&&H.isValidGrid()}}}),df.prototype._42=function(){var H=this,o=H._interactor;H.gridEnabled&&H.drawGrid(),o.alignmentGuideEnabled&&H.drawAlignmentGuide()},df.prototype.makeMatrix=function(){var J=this,h=J._interactor.getStyle("gridAngle"),n=J._interactor.getStyle("gridRotation"),A=new Bj.Math.Matrix2,p=Math.sin(h),d=Math.cos(h);return A.set(1,0,d,p,0,0),A.rotate(n),A},df.prototype.isValidGrid=function(){var r=this,U=Math.PI,g=r._interactor.getStyle("gridAngle"),q=Math.abs(180*(g%U/U)),S=1-1e-8;return S>q||q>180-S?!1:!0},df.prototype.drawAlignmentGuide=function(){var k=this,J=k._interactor,w=J.gv,_=J._canvas,o=J._context,n=_.width,p=_.height,y=w.tx(),Z=w.ty(),$=w._zoom;o.beginPath(),o.strokeStyle=J.getStyle("gridAlignmentGuideColor"),o.lineWidth=1,k._xAlignmentGuide.forEach(function(B){var T=B.p*$+y;o.moveTo(T,0),o.lineTo(T,p)}),k._yAlignmentGuide.forEach(function(i){var v=i.p*$+Z;o.moveTo(0,v),o.lineTo(n,v)}),o.stroke()},df.prototype.drawGrid=function(){function P(X,K,e,T){var B=Bj.toScreenPosition($,U.apply({x:X,y:K})),g=Bj.toScreenPosition($,U.apply({x:e,y:T}));d.moveTo(B.x,B.y),d.lineTo(g.x,g.y)}var t=this,c=t._interactor,D=t.gridBlockSize,z=t.gridThickLinesEvery,m=c.getStyle("gridThickColor"),w=c.getStyle("gridLightColor"),$=c.gv,Z=c._canvas,d=c._context,o=Z.width,g=Z.height,U=t.makeMatrix(),H=U.applyInverse(Bj.toWorldPosition($,{x:0,y:0})),a=U.applyInverse(Bj.toWorldPosition($,{x:o,y:0})),r=U.applyInverse(Bj.toWorldPosition($,{x:0,y:g})),K=U.applyInverse(Bj.toWorldPosition($,{x:o,y:g})),s=Math.min(H.x,a.x,r.x,K.x),e=Math.max(H.x,a.x,r.x,K.x),u=Math.min(H.y,a.y,r.y,K.y),B=Math.max(H.y,a.y,r.y,K.y);o=e-s,g=B-u;var q=Math.ceil(s/D),y=Math.floor(e/D),h=Math.ceil(u/D),C=Math.floor(B/D);$.tx(),$.ty(),$._zoom;var n,_,N;for(d.save(),d.lineWidth=1,d.beginPath(),d.strokeStyle=m,N=Math.ceil(q/z)*z;y>=N;N+=z)n=N*D,P(n,u,n,B);for(N=Math.ceil(h/z)*z;C>=N;N+=z)_=N*D,P(s,_,e,_);for(d.stroke(),d.beginPath(),d.strokeStyle=w,N=q;y>=N;N++)0!==N%z&&(n=N*D,P(n,u,n,B));for(N=h;C>=N;N++)0!==N%z&&(_=N*D,P(s,_,e,_));d.stroke(),d.restore()},df.prototype.getAlignmentGuides=function(){var A=this;return{x:A._xAlignmentGuide,y:A._yAlignmentGuide}},df.prototype.addAlignmentGuide=function(y,m,U){var e=this,_="x"===y?e._xAlignmentGuide:e._yAlignmentGuide,U=U?U:++e._alignmentGuideId,O={p:m,id:U};if(_.length){var G=e._findClosestAlignmentGuide(O.p,_);G.dis<0?_.splice(G.index+1,0,O):_.splice(G.index,0,O)}else _.push(O);return e._interactor._42(),U},df.prototype.findClosest=function(Z,q,Y){var S=this,E=S._interactor,K=E.gv;Y&&(Z=Bj.toWorldPosition(K,Z));var m,c,A,C=1/0,k=1/0,U=Z.x,z=Z.y;if(S.gridEnabled){var l=S.gridBlockSize,I=S.makeMatrix(),B=I.applyInverse(Z);B=I.apply({x:Math.round(B.x/l)*l,y:Math.round(B.y/l)*l}),C=B.x-U,k=B.y-z,A=!0}if(E.alignmentGuideEnabled&&(m=S._findClosestAlignmentGuide(U,S._xAlignmentGuide).dis,c=S._findClosestAlignmentGuide(z,S._yAlignmentGuide).dis,Math.abs(m)<Math.abs(C)&&(C=m,A=!0),Math.abs(c)<Math.abs(k)&&(k=c,A=!0)),A){A=!1;var x=K._zoom,L=E.getStyle("smartGuideSensitivity")/x,M={};if(Math.abs(C)<L&&"y"!==q&&(M.x=Y?C*x:C,A=!0),Math.abs(k)<L&&"x"!==q&&(M.y=Y?k*x:k,A=!0),A)return M}},df.prototype._findClosestAlignmentGuide=function($,J){if(!J.length)return{dis:1/0};for(var f,K=0,L=J.length-1;L-K>1;)f=Math.floor((K+L)/2),J[f].p<$?K=f:L=f;var r=J[K].p-$,D=J[L].p-$;return Math.abs(r)<=Math.abs(D)?{line:J[K],dis:r,index:K}:{line:J[L],dis:D,index:L}},df.prototype.removeAllAlignmentGuide=function(B){var K=this;"y"!==B&&(K._xAlignmentGuide=[]),"x"!==B&&(K._yAlignmentGuide=[]),K._interactor._42()},df.prototype.removeAlignmentGuide=function(B){var e,z,s,E=this,D=E._xAlignmentGuide;for(k=0;2>k;k++)for(D=0===k?E._xAlignmentGuide:E._yAlignmentGuide,e=0,z=D.length;z>e;e++)if(s=D[e],s.id===B)return D.splice(e,1),E._interactor._42(),{axis:0===k?"x":"y",position:s.p};return!1},df.prototype.adjustAlignmentGuide=function(t,u){var h=this,L=h.removeAlignmentGuide(t);return L?(h.addAlignmentGuide(L.axis,u,t),!0):!1};var Ym=Bj.Guide.Rect=function(Z){var O=this;O._interactor=Z};Ym.prototype={},Ym.prototype.constructor=Ym,Ym.prototype.gatherRects=function(){var D,r,Y,z,h=this,V=h._interactor.gv,C=[],I=[],M={x:C,y:I},e={},q=V.getDataModel(),b=q.a("width"),Q=q.a("height");b&&Q&&(D=0,r=0,Y=b,z=Q,C.push({node:q,type:0,p:D},{node:q,type:1,p:D+Y/2},{node:q,type:2,p:D+Y}),I.push({node:q,type:0,p:r},{node:q,type:1,p:r+z/2},{node:q,type:2,p:r+z}),e[q._id||0]={x:D,y:r,width:Y,height:z}),q.each(function($){if(Vp($)&&!V.isSelected($)&&V.isVisible($)){var l=!1;if(V.sm().getSelection().each(function(y){l||($.isHostOn(y)?l=!0:$.isDescendantOf(y)&&(l=!0))}),!l){var q=$.getRect();D=q.x,r=q.y,Y=q.width,z=q.height,C.push({node:$,type:0,p:D},{node:$,type:1,p:D+Y/2},{node:$,type:2,p:D+Y}),I.push({node:$,type:0,p:r},{node:$,type:1,p:r+z/2},{node:$,type:2,p:r+z}),e[$._id]=q}}}),C.sort(function(W,a){return W.p-a.p}),I.sort(function(P,g){return P.p-g.p}),h._grid=M,h._87I=e},Ym.prototype.gatherLines=function(p,k,O){var Y,W,H,C,L,m,U,Q,S,u,N,f,$=this,t=[$.findClosest({x:p.x,y:p.y},k),$.findClosest({x:p.x+p.w/2,y:p.y+p.h/2},k),$.findClosest({x:p.x+p.w,y:p.y+p.h},k)],a={},l=$._87I;O=O||255;var e,d;for($._guideLine=[],Y=0;2>Y;Y++)for(a={},0===Y?(C="y",Q=p.x,S=Q+p.w):(C="x",Q=p.y,S=Q+p.h),W=0;3>W;W++)L=t[W],L&&isFinite(L[C])&&(e=1<<3*Y+W,O&e&&(m=L[C+"Line"],U=m.node,d=U._id||0,a[d]||(a[d]=!0,f=l[d],"y"===C?(u=f.x,N=f.x+f.width):(u=f.y,N=f.y+f.height),H=m.p,$._guideLine.push({type:C,a:Q,b:S,c:u,d:N,p:H}))))},Ym.prototype._binarySearchClosest=function(H,F){if(!F.length)return{dis:1/0};for(var X,a=0,R=F.length-1;R-a>1;)X=Math.floor((a+R)/2),F[X].p<H?a=X:R=X;var y=F[a].p-H,i=F[R].p-H;return Math.abs(y)<=Math.abs(i)?{line:F[a],dis:y}:{line:F[R],dis:i}},Ym.prototype.findClosest=function(r,l,V){var $=this,Z=$._interactor,P=Z.gv,b=$._grid;V&&(r=Bj.toWorldPosition(P,r));var g,S=$._binarySearchClosest(r.x,b.x),U=$._binarySearchClosest(r.y,b.y),N=S.dis,o=U.dis,e=P._zoom,A=Z.getStyle("smartGuideSensitivity")/e,y={};return Math.abs(N)<A&&"y"!==l&&(y.x=V?N*e:N,y.xLine=S.line,g=!0),Math.abs(o)<A&&"x"!==l&&(y.y=V?o*e:o,y.yLine=U.line,g=!0),g?y:void 0},Ym.prototype._42=function(){var R=this,L=R._guideLine;if(L&&!K.Default.isCtrlDown()){var t,d,N,m,V,b,Y,D,a,Q,f,s,C,o,v,q,U,I=R._interactor,W=I.gv,G=I._context,x=W.tx(),Z=W.ty(),P=W._zoom,i=I.getStyle("guideLineTextSpacing");for(t=0,d=L.length;d>t;t++)N=L[t],D=N.type,a=N.p,Q=N.a,f=N.b,s=N.c,C=N.d,o=Math.min(Q,s),v=Math.max(f,C),"x"===D?(m=a*P+x,V=o*P+Z,b=m,Y=v*P+Z):(m=o*P+x,V=a*P+Z,b=v*P+x,Y=V),Bj.Icons.DrawIcon(I,G,Bj.Icons.MoveLineGuide,[m,V,b,Y]),C>=Q&&f>=s||(o=Q>C?C:f,v=Q>C?Q:s,U=v-o,"x"===D?(N.center2center||(m-=i,b=m),V=o*P+Z,Y=v*P+Z,q=Bj.Icons.MoveLineGuideDistanceV):"y"===D&&(N.center2center||(V-=i,Y=V),m=o*P+x,b=v*P+x,q=Bj.Icons.MoveLineGuideDistanceH),Bj.Icons.DrawIcon(I,G,q,{x0:m,y0:V,x1:b,y1:Y,dis:U}))}},Ym.prototype.clear=function(){this._guideLine=null},Bj.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:32,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:"#707070",shapeHighlighPointBackground:"#30599e"};var bb=Bj.Icons={},cb=1e4,Go=null,Ni=8;K.Default.setImage("Icons.RectPoint",{width:Ni,height:Ni,comps:[{type:"shape",points:[0,0,0,Ni,Ni,Ni,Ni,0],segments:[1,2,2,2,5],shadow:!0,borderWidth:1,shadowColor:{func:function(){return Go.getStyle("rectPointShadowColor")}},background:{func:function(){return Go.getStyle("rectPointBackground")}},borderColor:{func:function(){return Go.getStyle("rectPointBorderColor")}}}]});var pn="#e000e0";bb.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var T=bb.GroupSubEntityRect.data;if(!T)return[];var V=T.min,A=T.max;return[V.x,V.y,V.x,A.y,A.x,A.y,A.x,V.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return bb.GroupSubEntityRect.data.isKeyOb?pn:"#666666"}}}]},bb.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[bb.Line.data.P1.x,bb.Line.data.P1.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[bb.Line.data.P2.x,bb.Line.data.P2.y],Ni,Ni]}}}]},bb.EdgeHostGuide={comps:[{type:"shape",points:{func:function(){return bb.EdgeHostGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:2,borderColor:"red"}]},bb.Rect={comps:[{type:"shape",points:{func:function(){var k=bb.Rect.data;if(!k)return[];var t=k.LT,m=k.LB,w=k.RB,y=k.RT;return[t.x,t.y,m.x,m.y,w.x,w.y,y.x,y.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#666666"},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bb.Rect.data.rotation}},rect:{func:function(){return[[bb.Rect.data.LT.x,bb.Rect.data.LT.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bb.Rect.data.rotation}},rect:{func:function(){return[[bb.Rect.data.LB.x,bb.Rect.data.LB.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bb.Rect.data.rotation}},rect:{func:function(){return[[bb.Rect.data.RB.x,bb.Rect.data.RB.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bb.Rect.data.rotation}},rect:{func:function(){return[[bb.Rect.data.RT.x,bb.Rect.data.RT.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return bb.Rect.data.rotation}},visible:{func:function(){return bb.Rect.data.L?!0:!1}},rect:{func:function(){return[[bb.Rect.data.L.x,bb.Rect.data.L.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return bb.Rect.data.rotation}},visible:{func:function(){return bb.Rect.data.R?!0:!1}},rect:{func:function(){return[[bb.Rect.data.R.x,bb.Rect.data.R.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return bb.Rect.data.rotation}},visible:{func:function(){return bb.Rect.data.T?!0:!1}},rect:{func:function(){return[[bb.Rect.data.T.x,bb.Rect.data.T.y],Ni,Ni]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return bb.Rect.data.rotation}},visible:{func:function(){return bb.Rect.data.B?!0:!1}},rect:{func:function(){return[[bb.Rect.data.B.x,bb.Rect.data.B.y],Ni,Ni]}}}]};var Ec=18;K.Default.setImage("Icons.Anchor",{width:Ec,height:Ec,comps:[{type:"arc",rect:[4,4,Ec-8,Ec-8],arcFrom:0,arcClose:!1,background:"#ffffff",borderWidth:0,borderColor:"#000000"},{type:"shape",points:[2,Ec/2,Ec-2,Ec/2,Ec/2,2,Ec/2,Ec-2],segments:[1,2,1,2],background:null,borderWidth:1,borderColor:"#111111"},{type:"arc",rect:[5.5,5.5,Ec-11,Ec-11],arcFrom:0,arcClose:!1,background:null,borderWidth:1,borderColor:"#111111"}]}),bb.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[bb.Anchor.data.POS.x,bb.Anchor.data.POS.y],Ec,Ec]}}}]},bb.TipShiftX=12,bb.TipShiftY=12;var Ee=[8,28];bb.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[bb.TipHelper.data.helperPos.x,bb.TipHelper.data.helperPos.y,Ee[0]*bb.TipHelper.data.size,Ee[1]]}},background:{func:function(){return Go.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return bb.TipHelper.data.text}},rect:{func:function(){return[bb.TipHelper.data.helperPos.x,bb.TipHelper.data.helperPos.y,Ee[0]*bb.TipHelper.data.size,Ee[1]]}},color:{func:function(){return Go.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var wk=7;bb.ShapePoint={comps:[{type:"circle",rect:{func:function(){var w=bb.ShapePoint.data;return[w,wk,wk]}},background:"#ffffff",borderWidth:1,borderColor:"#333333"}]},bb.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return bb.ShapeBgCurve.data.P}},segments:{func:function(){return bb.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:"#333333"}]};var cd=8;bb.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var r=bb.ShapeHighlighPoint.data;return[[r.x,r.y],cd,cd]}},background:{func:function(){return Go.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var lc=10;bb.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var g=bb.ShapeHighlighRealPoint.data;return[[g.x,g.y],lc,lc]}},background:"#ffffff",borderWidth:2,borderColor:"#333333"}]};var Vo=8;bb.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var C=bb.ShapeHighlighCtrlPoint.data,O=C.x,_=C.y,L=Vo/2;return[O-L,_-L,O-L,_+L,O+L,_+L,O+L,_-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Go.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Go.getStyle("shapeCtrlPointBorderColor")}}}]};var Ub=3;bb.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return bb.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Ub,borderColor:{func:function(){return Go.getStyle("curveHighlightColor")}}}]},bb.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return bb.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"red"}]},bb.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return bb.MoveLineGuide.data}},background:null,borderWidth:1,borderColor:"red"}]};var Rj=5;bb.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var N=bb.MoveLineGuideDistanceH.data,J=N.x0,W=N.y0,w=N.x1,f=N.y1;return[J,W,w,f,J,W-Rj,J,W+Rj,w,f-Rj,w,f+Rj]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(bb.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var X=bb.MoveLineGuideDistanceH.data;return[[(X.x0+X.x1)/2,X.y0-10],20,20]}},color:"red",font:"12px Arial",align:"center"}]},bb.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var k=bb.MoveLineGuideDistanceV.data,Z=k.x0,Y=k.y0,B=k.x1,n=k.y1;return[Z,Y,B,n,Z-Rj,Y,Z+Rj,Y,B-Rj,n,B+Rj,n]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(bb.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var B=bb.MoveLineGuideDistanceV.data;return[[B.x0-10,(B.y0+B.y1)/2],20,20]}},color:"red",font:"12px Arial",align:"center"}]};var Of=6;bb.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return bb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var X=bb.ShapeActivingCtrl.data;return[X.point.x,X.point.y,X.c1.x,X.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return bb.ShapeActivingCtrl.data.c2?!0:!1
}},points:{func:function(){var Q=bb.ShapeActivingCtrl.data;return[Q.point.x,Q.point.y,Q.c2.x,Q.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return bb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var A=bb.ShapeActivingCtrl.data.c1,v=A.x,J=A.y,Q=Of/2;return[v-Q,J-Q,v-Q,J+Q,v+Q,J+Q,v+Q,J-Q]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Go.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Go.getStyle("shapeCtrlPointBorderColor")}}},{type:"shape",visible:{func:function(){return bb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var f=bb.ShapeActivingCtrl.data.c2,O=f.x,i=f.y,J=Of/2;return[O-J,i-J,O-J,i+J,O+J,i+J,O+J,i-J]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Go.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Go.getStyle("shapeCtrlPointBorderColor")}}}]},Bj.Icons.DrawIcon=function(p,g,V,C){V.width=V.height=cb,V.data=C,Go=p,K.Default.drawImage(g,V,0,0,cb,cb)},Bj.Icons.MapPoints=function(m,Y){for(var N=0,B=m.length;B>N;N++)m[N]/=Y},Bj.roundTo=function(J,c,o){var s=Math.abs(J%c);return o>s||o>c-s?c*Math.round(J/c):J},Bj.toFixed=function(A){return Math.round(100*A)/100},Bj.getDataMatrix=function(h){if(h instanceof K.Shape){var E=new Bj.Math.Matrix2,j=h.getPosition();return E.translate(-j.x,-j.y).scale(h.getScale().x,h.getScale().y).rotate(h.getRotation()).translate(j.x,j.y),E}return h.getMatrix?h.getMatrix():new Bj.Math.Matrix2},Math.sign===t&&(Math.sign=function(T){return 0>T?-1:T>0?1:+T});var bn=Bj.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};bn.prototype={},bn.prototype.constructor=bn,bn.prototype.set=function(E,Y,W,F,T,J){return this.a=E,this.b=Y,this.c=W,this.d=F,this.tx=T,this.ty=J,this},bn.prototype.apply=function(d,h){h=h||new Zp;var x=d.x,F=d.y;return h.x=this.a*x+this.c*F+this.tx,h.y=this.b*x+this.d*F+this.ty,h},bn.prototype.applyInverse=function(L,$){$=$||new Zp;var x=1/(this.a*this.d+this.c*-this.b),G=L.x,U=L.y;return $.x=this.d*x*G+-this.c*x*U+(this.ty*this.c-this.tx*this.d)*x,$.y=this.a*x*U+-this.b*x*G+(-this.ty*this.a+this.tx*this.b)*x,$},bn.prototype.translate=function(G,U){return this.tx+=G,this.ty+=U,this},bn.prototype.scale=function(I,d){return this.a*=I,this.d*=d,this.c*=I,this.b*=d,this.tx*=I,this.ty*=d,this},bn.prototype.rotate=function(Q){var f=Math.cos(Q),j=Math.sin(Q),c=this.a,r=this.c,N=this.tx;return this.a=c*f-this.b*j,this.b=c*j+this.b*f,this.c=r*f-this.d*j,this.d=r*j+this.d*f,this.tx=N*f-this.ty*j,this.ty=N*j+this.ty*f,this},bn.prototype.append=function(w){var r=this.a,O=this.b,S=this.c,u=this.d;return this.a=w.a*r+w.b*S,this.b=w.a*O+w.b*u,this.c=w.c*r+w.d*S,this.d=w.c*O+w.d*u,this.tx=w.tx*r+w.ty*S+this.tx,this.ty=w.tx*O+w.ty*u+this.ty,this},bn.prototype.setTransform=function(L,J,E,p,W,_,q,N,O){var G,g,S,C,R,z,d,r,D,w;return R=Math.sin(q),z=Math.cos(q),d=Math.cos(O),r=Math.sin(O),D=-Math.sin(N),w=Math.cos(N),G=z*W,g=R*W,S=-R*_,C=z*_,this.a=d*G+r*S,this.b=d*g+r*C,this.c=D*G+w*S,this.d=D*g+w*C,this.tx=L+(E*G+p*S),this.ty=J+(E*g+p*C),this},bn.prototype.prepend=function(j){var c=this.tx;if(1!==j.a||0!==j.b||0!==j.c||1!==j.d){var A=this.a,H=this.c;this.a=A*j.a+this.b*j.c,this.b=A*j.b+this.b*j.d,this.c=H*j.a+this.d*j.c,this.d=H*j.b+this.d*j.d}return this.tx=c*j.a+this.ty*j.c+j.tx,this.ty=c*j.b+this.ty*j.d+j.ty,this},bn.prototype.invert=function(){var P=this.a,a=this.b,c=this.c,h=this.d,y=this.tx,N=P*h-a*c;return this.a=h/N,this.b=-a/N,this.c=-c/N,this.d=P/N,this.tx=(c*this.ty-h*y)/N,this.ty=-(P*this.ty-a*y)/N,this},bn.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},bn.prototype.clone=function(){var O=new bn;return O.a=this.a,O.b=this.b,O.c=this.c,O.d=this.d,O.tx=this.tx,O.ty=this.ty,O},bn.prototype.copy=function(S){return S.a=this.a,S.b=this.b,S.c=this.c,S.d=this.d,S.tx=this.tx,S.ty=this.ty,S},bn.IDENTITY=new bn,bn.TEMP_MATRIX=new bn;var Zp=Bj.Math.Vector2=function(L,p){"object"==typeof L&&(L.x!=t?(p=L.y,L=L.x):(p=L[1],L=L[0])),this.set(L||0,p||0)};Zp.prototype={},Zp.prototype.constructor=Zp,v.defineProperties(Zp.prototype,{width:{get:function(){return this.x},set:function(l){this.x=l}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Zp.prototype.clone=function(){return new Zp(this.x,this.y)},Zp.prototype.copy=function(r){return this.set(r.x,r.y),this},Zp.prototype.equals=function(o){return o.x===this.x&&o.y===this.y},Zp.prototype.set=function(r,I){return this.x=r||0,this.y=I||(0!==I?this.x:0),this},Zp.prototype.setScalar=function(M){return this.x=M,this.y=M,this},Zp.prototype.setX=function(t){return this.x=t||0,this},Zp.prototype.setY=function(m){return this.y=m||0,this},Zp.prototype.add=function(E){return this.x+=E.x,this.y+=E.y,this},Zp.prototype.addVectors=function(i,x){return this.x=i.x+x.x,this.y=i.y+x.y,this},Zp.prototype.addScalar=function(K){return this.x+=K,this.y+=K,this},Zp.prototype.addScaledVector=function(C,c){return this.x+=C.x*c,this.y+=C.y*c,this},Zp.prototype.sub=function(b){return this.x-=b.x,this.y-=b.y,this},Zp.prototype.subScalar=function(u){return this.x-=u,this.y-=u,this},Zp.prototype.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},Zp.prototype.multiply=function(H){return this.x*=H.x,this.y*=H.y,this},Zp.prototype.multiplyScalar=function(C){return this.x*=C,this.y*=C,this},Zp.prototype.divide=function(d){return this.x/=d.x,this.y/=d.y,this},Zp.prototype.divideScalar=function(A){return this.multiplyScalar(1/A)},Zp.prototype.min=function(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this},Zp.prototype.max=function(Z){return this.x=Math.max(this.x,Z.x),this.y=Math.max(this.y,Z.y),this},Zp.prototype.clamp=function(s,f){return this.x=Math.max(s.x,Math.min(f.x,this.x)),this.y=Math.max(s.y,Math.min(f.y,this.y)),this},Zp.prototype.clampScalar=function(){var U,_;return function(O,J){return U===t&&(U=new Zp,_=new Zp),U.set(O,O),_.set(J,J),this.clamp(U,_)}}(),Zp.prototype.clampLength=function(A,O){var q=this.length();return this.multiplyScalar(Math.max(A,Math.min(O,q))/q)},Zp.prototype.dot=function(M){return this.x*M.x+this.y*M.y},Zp.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Zp.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Zp.prototype.normalize=function(){return this.divideScalar(this.length())},Zp.prototype.angle=function(){var $=Math.atan2(this.y,this.x);return 0>$&&($+=2*Math.PI),$},Zp.prototype.distanceTo=function(B){return Math.sqrt(this.distanceToSquared(B))},Zp.prototype.distanceToSquared=function(p){var z=this.x-p.x,B=this.y-p.y;return z*z+B*B},Zp.prototype.isNearEnough=function(N){return this.distanceToSquared(N)<1e-8},Zp.prototype.setLength=function(A){return this.multiplyScalar(A/this.length())},Zp.prototype.lerp=function(x,s){return this.x+=(x.x-this.x)*s,this.y+=(x.y-this.y)*s,this},Zp.prototype.lerpVectors=function(V,C,i){return this.subVectors(C,V).multiplyScalar(i).add(V)},Zp.prototype.rotateAround=function(i,h){var D=Math.cos(h),m=Math.sin(h),Z=this.x-i.x,O=this.y-i.y;return this.x=Z*D-O*m+i.x,this.y=Z*m+O*D+i.y,this};var mr=Bj.Math.Curve=function(){this._curves=[]};mr.prototype={},mr.prototype.constructor=mr,mr.prototype.createFromHtShape=function(y,t){t instanceof K.List&&(t=t.toArray());var H,h,l,Z,G,w,M,u=this,b=null,m=null,x=0,X=Bj.Math.Vector2,R=Bj.Math.CubicBezier;for(h=0,l=t.length;l>h;h++){switch(Z=t[h],G=null,Z){case 1:m=new X(y[x],y[x+1]),b=m,x+=2;break;case 2:H=new X(y[x],y[x+1]),x+=2,G=new R(m,m.clone(),H.clone(),H),m=H;break;case 3:w=new X(y[x],y[x+1]),H=new X(y[x+2],y[x+3]),x+=4,G=new R(m,w.clone().sub(m).multiplyScalar(2/3).add(m),w.clone().sub(H).multiplyScalar(2/3).add(H),H),m=H;break;case 4:w=new X(y[x],y[x+1]),M=new X(y[x+2],y[x+3]),H=new X(y[x+4],y[x+5]),x+=6,G=new R(m,w,M,H),m=H;break;case 5:if(!b)break;G=new R(m,m.clone(),b.clone(),b),m=null,b=null}G&&(G._index=u._curves.length,u._curves.push(G))}},mr.prototype.checkPoint=function(X,V){var i,w,H,C,L,G=this,N=G._curves;for(i=0,w=N.length;w>i;i++)if(C=N[i],L=C.intersectRect(X,V,V),L.length)return H=0,L.forEach(function(h){H+=h.t}),H/=L.length,X=C.getPointAt(H),X.t=H,{bezier:C,intersection:X}},mr.prototype.insertKnot=function(l,H){var X=l.insertKnot(H),u=this,e=u._curves;e.splice(l._index,1,X[0],X[1])},mr.prototype._isCloseEnough=function(z,y){return Math.abs(z.x-y.x)<1e-6&&Math.abs(z.y-y.y)<1e-6},mr.prototype._isSamePoint=function(G,r){return G===r},mr.prototype.moveRealPoint=function(F,c){var $=this,j=$._curves,k=c.clone().sub(F);j.forEach(function(E){var m=E._p1;E._p2,E._p3;var Y=E._p4;$._isSamePoint(m,F)&&(E._p2.add(k),E._p1=c),$._isSamePoint(Y,F)&&(E._p3.add(k),E._p4=c)})},mr.prototype.moveCtrlPoint=function(U,M,G){var n=U[G];if(n){var K=this,L=K._curves;M.clone().sub(n),L.forEach(function(e){var y;"c2"===G?y="_p2":"c1"===G&&(y="_p3"),K._isSamePoint(e[y],n)&&(e[y]=M)}),U[G]=M}},mr.prototype.deleteRealPoint=function(J,e){var I,N,h,z,W,P,n,g=this,_=g._curves,A={},m=[],y=Bj.Math.CubicBezier;for(N=0,h=_.length;h>N;N++)I=_[N],z=I._p1,W=I._p2,P=I._p3,n=I._p4,(A[N]||!g._isSamePoint(z,J))&&(g._isSamePoint(n,J)?h>N+1&&g._isSamePoint(_[N+1]._p1,J)&&(e||m.push(new y(z,W,_[N+1]._p3,_[N+1]._p4))):m.push(I));g._curves=m},mr.prototype.findPairs=function(c,_){var l,i,a,N,J,S,P,X,K=this,u=K._curves,o={},W=[];for(i=0,a=u.length;a>i;i++)l=u[i],N=l._p1,J=l._p2,S=l._p3,P=l._p4,!o[i]&&K._isSamePoint(N,c)&&(_?W.push({point:N,r2:P}):W.push({point:N,c2:J})),K._isSamePoint(P,c)&&(X=_?{point:P,r1:N}:{point:P,c1:S},a>i+1&&K._isSamePoint(u[i+1]._p1,c)&&(_?X.r2=u[i+1]._p4:X.c2=u[i+1]._p2,o[i+1]=!0),W.push(X));return W},mr.prototype.toHtShape=function(){var p=this,o=p._curves,F=[],Z=[],t={x:1/0,y:1/0};return o.forEach(function(X){var j=X._p1,V=X._p2,h=X._p3,y=X._p4;return p._isCloseEnough(j,t)||(F.push(1),Z.push(j.clone())),t=y,p._isCloseEnough(j,V)&&p._isCloseEnough(h,y)?(F.push(2),Z.push(y.clone()),void 0):(F.push(4),Z.push(V.clone(),h.clone(),y.clone()),void 0)}),{segments:F,points:Z}};var Sm=Bj.Math.CubicBezier=function(h,d,s,$){var D=this;D._id=Bj.Math.CubicBezier._globalId++,D._p1=h,D._p2=d,D._p3=s,D._p4=$};Sm._globalId=1,Sm.prototype={},Sm.prototype.constructor=Sm,Sm.prototype.toString=function(){return this._id},Sm.prototype.intersectRect=function($,F,v){var J=F/2,o=v/2,g=$.x,z=$.y,C=Bj.Math.Vector2,k=new C(-J+g,-o+z),d=new C(J+g,o+z),j=new C(d.x,k.y),e=new C(k.x,d.y),W=this,V=W.intersectLine(k,j),B=W.intersectLine(j,d),s=W.intersectLine(d,e),T=W.intersectLine(e,k),L=V.concat(B).concat(s).concat(T);return L},Sm.prototype.intersectLine=function(Q,f){var o,I,Y,D,X,p,l,i,g,U,j,m,M,d=this,O=Q.clone().min(f),P=Q.clone().max(f);D=d._p1,X=d._p2,p=d._p3,l=d._p4,o=D.clone().multiplyScalar(-1),I=X.clone().multiplyScalar(3),Y=p.clone().multiplyScalar(-3),j=o.add(I).add(Y).add(l),o=D.clone().multiplyScalar(3),I=X.clone().multiplyScalar(-6),Y=p.clone().multiplyScalar(3),U=o.add(I).add(Y),o=D.clone().multiplyScalar(-3),I=X.clone().multiplyScalar(3),g=o.add(I),i=D.clone(),M=new Bj.Math.Vector2(Q.y-f.y,f.x-Q.x),m=Q.x*f.y-f.x*Q.y;for(var S=d.getRoots(M.dot(j),M.dot(U),M.dot(g),M.dot(i)+m),b=new Array,J=0,F=S.length;F>J;J++){var n=S[J];if(!(0>n||n>1)){var t=D.clone().lerp(X,n),c=X.clone().lerp(p,n),W=p.clone().lerp(l,n),A=t.lerp(c,n),G=c.lerp(W,n),R=A.lerp(G,n);R.t=n,Q.x==f.x?O.y<=R.y&&R.y<=P.y&&b.push(R):Q.y==f.y?O.x<=R.x&&R.x<=P.x&&b.push(R):R.x>=O.x&&R.y>=O.y&&R.x<=P.x&&R.y<=P.y&&b.push(R)}}return b},Sm.prototype.solveTForPoint=function(m){var T,R,W,e,$=this;T=$._p1.x-m.x,R=$._p2.x-m.x,W=$._p3.x-m.x,e=$._p4.x-m.x;for(var o=$.getRoots(e-3*W+3*R-T,3*W-6*R+3*T,3*R-3*T,T),E=t,k=1/0,X=0,f=o.length;f>X;X++){var w=o[X];if(!(0>w||w>1)){var F=$._p1.clone().lerp($._p2,w),b=$._p2.clone().lerp($._p3,w),V=$._p3.clone().lerp($._p4,w),z=F.lerp(b,w),u=b.lerp(V,w),Y=z.lerp(u,w);Y.t=w;var l=Math.abs(Y.y-m.y);k>l&&(k=l,E=Y)}}return E},Sm.prototype.getPointAt=function(q){var P=this,h=P._p1,a=P._p2,o=P._p3,J=P._p4,H=h.clone().lerp(a,q),z=a.clone().lerp(o,q),N=o.clone().lerp(J,q),x=H.lerp(z,q),u=z.lerp(N,q);return x.lerp(u,q)},Sm.prototype.getRoots=function(c,n,b,s){var M,B,i,U,F,w=new Array;if(Math.abs(c)<1e-6){var M=n,B=b/M,i=s/M,U=B*B-4*i;if(U>0){var F=Math.sqrt(U);w.push(.5*(-B+F)),w.push(.5*(-B-F))}else 0==U&&w.push(.5*-B)}n/=c,b/=c,s/=c,M=(3*b-n*n)/3,B=(2*n*n*n-9*b*n+27*s)/27;var Q=n/3,H=B*B/4+M*M*M/27,Z=B/2;if(Math.abs(H)<=1e-6&&(H=0),H>0){var q,J,F=Math.sqrt(H);q=-Z+F,J=q>=0?Math.pow(q,1/3):-Math.pow(-q,1/3),q=-Z-F,q>=0?J+=Math.pow(q,1/3):J-=Math.pow(-q,1/3),w.push(J-Q)}else if(0>H){var r=Math.sqrt(-M/3),Y=Math.atan2(Math.sqrt(-H),-Z)/3,T=Math.cos(Y),p=Math.sin(Y),N=Math.sqrt(3);w.push(2*r*T-Q),w.push(-r*(T+N*p)-Q),w.push(-r*(T-N*p)-Q)}else{var q;q=Z>=0?-Math.pow(Z,1/3):Math.pow(-Z,1/3),w.push(2*q-Q),w.push(-q-Q)}return w},Sm.prototype._70I=function(){var F=this;return F._p1.distanceToSquared(F._p2)<1e-10&&F._p3.distanceToSquared(F._p4)<1e-10},Sm.prototype.insertKnot=function(d){var v=this,z=v._p1,C=v._p2,t=v._p3,W=v._p4,q=z.clone().lerp(C,d),S=C.clone().lerp(t,d),B=t.clone().lerp(W,d),j=q.clone().lerp(S,d),k=S.clone().lerp(B,d),G=j.clone().lerp(k,d);return v._70I()?(z.clone().lerp(W,d),[new Bj.Math.CubicBezier(z,z.clone(),G.clone(),G),new Bj.Math.CubicBezier(G,G.clone(),W.clone(),W)]):[new Bj.Math.CubicBezier(z,q,j,G),new Bj.Math.CubicBezier(G,k,B,W)]};var Gf=K.Default.getInternal().ui().EdgeUI,jn={_47O:function(H){var O=this,X=jn.getBackups()._47O;Bj.inEdit(O.gv)||X.call(O,H)}};Bj.Inject.registAsModule(jn,Gf);var Gi=K.Default.getInternal().ui().NodeUI,ih={_47O:function(H){var n=this,I=ih.getBackups()._47O;Bj.inEdit(n.gv)||I.call(n,H)},getSelectWidth:function(){var N=this,J=N.gv,P=N._data;if(J.isEditable(P)&&Bj.inEdit(J))return 0;var n=ih.getBackup("getSelectWidth");return n.call(N)}};Bj.Inject.registAsModule(ih,Gi);var iq=K.graph.GraphView,Zd={_editPointSize:function(){var h=K.Default.isTouchable,$=Bj.getStyle("pointSize");return $[h?0:1]}(),isPointEditable:function(X){var t=this;if(Bj.inEdit(t))return t._pointEditableFunc?t._pointEditableFunc(X):!0;var H=Zd.getBackup("isPointEditable");H.call(t,X)},isEditable:function(O){var R,A=this,z=Zd.getBackup("isEditable");if(R=O instanceof Bj.Group?!0:z.call(A,O),!Bj.inEdit(A))return R;if(!(O instanceof K.Edge))return R;if(!O.s("2d.editable"))return!1;var N=A.getEditableFunc();return N?N(O):!0},_42:function(e,l){var G=this,C=Zd.getBackups()._42;if(C.call(G,e,l),Bj.inEdit(G)){var d=G.getEditInteractor();d.drawImpl()}}};Bj.Inject.registAsModule(Zd,iq);var Fe=K.Default.getInternal().ui().ShapeUI,yq={_47O:function(z){var W=this,w=yq.getBackups()._47O;Bj.inEdit(W.gv)||w.call(W,z)}};Bj.Inject.registAsModule(yq,Fe);var Cs=K.graph.DefaultInteractor,ve={handle_mousewheel:function(v){var I=this,R=ve.getBackup("handle_mousewheel");Bj.inEdit(I.gv)||R.call(I,v)}};Bj.Inject.registAsModule(ve,Cs);var ic=K.graph.MoveInteractor,Ao={_calcShift:function(x,e){var N=this,i=Ao.getBackup("_calcShift"),t=N.gv;if(!Bj.inEdit(t))return i.call(N,x,e);var z=t.getEditInteractor(),v=z.getSubModule("Move").calcShift(x,e,N);return v||i.call(N,x,e)},clear:function(Z){var H=this,S=Ao.getBackup("clear");S.call(H,Z);var P=H.gv;if(Bj.inEdit(P)){var t=P.getEditInteractor();t.getSubModule("Move").clear(Z)}}};Bj.Inject.registAsModule(Ao,ic);var Ym=Bj.Rect=function(H){this.catalog="Rect",this._interactor=H};Ym.prototype={},Ym.prototype.constructor=Ym,Ym.prototype.gatherInfo=function(b,G){var $=this;if(1===G.length){var R=G[0];return R instanceof K.Shape&&R._70I()?$.gatherLine(b,R):$i(R,b)?!1:$.gatherSingleTarget(b,R)}return G.length>1?$.gatherMultiTargets(b,G):!1},Ym.prototype.gatherSingleTarget=function(o,U){if(U.getCorners){var M,C=this.info;this.target=U,M=this.screenInfo={};var A=U.getCorners();C.LT=new Bj.Math.Vector2(A[0]),C.LB=new Bj.Math.Vector2(A[1]),C.RB=new Bj.Math.Vector2(A[2]),C.RT=new Bj.Math.Vector2(A[3]),C.T=C.LT.clone().add(C.RT).divideScalar(2),C.B=C.LB.clone().add(C.RB).divideScalar(2),C.L=C.LT.clone().add(C.LB).divideScalar(2),C.R=C.RT.clone().add(C.RB).divideScalar(2);for(var H in C)M[H]=Bj.toScreenPosition(o,C[H]);var r=this._interactor.getStyle("checkSize"),l=function(m,F,G){var Z=F.clone().sub(m).setLength(-r),h=G.clone().sub(m).setLength(-r),O=Z.add(h).add(m);return O};return M.rotLT=l(M.LT,M.RT,M.LB),M.rotLB=l(M.LB,M.LT,M.RB),M.rotRB=l(M.RB,M.LB,M.RT),M.rotRT=l(M.RT,M.LT,M.RB),M.rotT=M.rotLT.clone().add(M.rotRT).divideScalar(2),M.rotB=M.rotLB.clone().add(M.rotRB).divideScalar(2),M.rotL=M.rotLT.clone().add(M.rotLB).divideScalar(2),M.rotR=M.rotRT.clone().add(M.rotRB).divideScalar(2),M.rotation=U.getRotation(),!0}},Ym.prototype.gatherMultiTargets=function(v,O){var Q=Bj.Group.findOrCreateGroup(O);if(!Q)return!1;var X=this;return X.editing&&"rotate"!==X.editing.mode||Q.calcInfo(),X.gatherSingleTarget(v,Q)},Ym.prototype.gatherLine=function(q,B){this.target=B;var K=this.screenInfo={},e=B.getPoints(),c=Bj.getDataMatrix(B);return K.P1=Bj.toScreenPosition(q,c.apply(e.get(0))),K.P2=Bj.toScreenPosition(q,c.apply(e.get(1))),!0},Ym.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ym.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ym.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ym.prototype.check=function(d,E,g){if(K.Default.isLeftButton(E)){var r=this;if(r.editing=null,r.tipInfo=null,r.screenInfo){if(r.screenInfo.P1)return r._checkLine(g);var w,t,o,Y=null,$=r._interactor,y=$.getStyle("checkSize"),C=r.target,B=d.isEditable(C);if(B&&d.isRectEditable(C))for(t=0;t<Bj.Rect.ResizeKeys.length;t++)if(o=Bj.Rect.ResizeKeys[t],Bj.checkHit(g,r.screenInfo[o],y)){Y=o,w="resize";break}if(!Y&&B&&d.isRotationEditable(C)){var p=$.getStyle("rotateCheckSize");for(t=0;t<Bj.Rect.RotateKeys.length;t++)if(o=Bj.Rect.RotateKeys[t],Bj.checkHit(g,r.screenInfo[o],p)){Y=o,w="rotate";break}}if(!Y)return this._interactor.setCursor("default"),void 0;if("rotate"===w){this._interactor.setCursor("crosshair");var O=d.lp(E),l=C instanceof Bj.Group?C.getAnchor2():C.getPosition();r.editing={mode:w,key:Y,pos:l,flipY:C.getScale().y<0,rotation:C.getRotation(),hitRot:Math.atan2(O.y-l.y,O.x-l.x)}}else{var Z=Bj.Rect.ResizeKeys.indexOf(Y),J=Bj.Rect.ResizeDirection[Z],z=Math.cos(C.getRotation()),S=Math.sin(C.getRotation()),G=J.x*Math.sign(C.getScale().x),m=J.y*Math.sign(C.getScale().y),U=Math.atan2(-S*G-z*m,z*G-S*m),L=(Math.round(U/(Math.PI/4))+8)%8,a=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][L];this._interactor.setCursor(a);var s=C.getWidth(),V=C.getHeight(),e=C.getAnchor();r.editing={mode:w,key:Y,rect:{x:-s*e.x,y:-V*e.y,width:s,height:V},anchor:e,matrix:C.getMatrix()}}return Y}}},Ym.prototype._checkLine=function(v){var J=this;J.screenInfo;var K,E=J._interactor.getStyle("checkSize");if(Bj.checkHit(v,J.screenInfo.P1,E))K="P1";else{if(!Bj.checkHit(v,J.screenInfo.P2,E))return this._interactor.setCursor("default"),void 0;K="P2"}return J.editing={mode:"line",key:K},K},Ym.prototype.startEdit=function(b,A){b.startDragging(A);var M=this,O=M.editing,t=M.target;O&&"rotate"!==O.mode&&("line"===O.mode||t&&0===t.getRotation())&&(M._inSmartGuide=!0,M._interactor.rectGuide.gatherRects())},Ym.prototype._46O=function(){var o=this;o.editing=null,o.tipInfo=null,o._inSmartGuide&&(o._interactor.rectGuide.clear(),o._inSmartGuide=!1)},Ym.prototype.handleEdit=function(D,B){var w=this,Y=w.editing;if(Y){var t,E,N,H,d,L,Z=w.target,e=Y.key,O=Y.mode,Q=w._interactor;if("rotate"===O){var X,h=D.lp(B),W=Y.pos,i=Math.atan2(h.y-W.y,h.x-W.x);if(Z instanceof Bj.Group?X=i-Y.hitRot:(i-=Y.hitRot,X=Y.rotation+i),X%=2*Math.PI,0>X&&(X+=2*Math.PI),!K.Default.isCtrlDown(B)){var V,T;Ng(B)?(V=Q.getStyle("shiftRotateRound"),T=V/2):(V=Q.getStyle("rotateRound"),T=Q.getStyle("rotateSensitivity")),X=Bj.roundTo(X,V,T)}Z instanceof Bj.Group?(i=X-(Y.lastRotation||0),0!==i&&(Z.addRotation(i),Y.lastRotation=X)):Z.setRotation(X),X>Math.PI&&(X-=2*Math.PI);var F=180*(X/Math.PI);F=F.toFixed(2),t=""+F+"°"}else if("resize"===O){var a=Y.rect;H=a.x,d=a.y;var J=a.width,r=a.height,n=Y.anchor,p=Y.matrix;E=D.lp(B);var j,v=Ng(B),G=w._unionPointMode1,x=w._unionPointMode2;if(w._inSmartGuide&&!K.Default.isCtrlDown(B)&&!v){var R;"L"===e||"R"===e?R="x":("T"===e||"B"===e)&&(R="y"),w._adsorbedToClosest(E,R),L=!0}j=p.tfi(E);var m;"LT"===e?(a=G(j,{x:H+J,y:d+r},J,r,v),m=9):"T"===e?(a=x({x:H,y:j.y},{x:H+J,y:d+r},J,r,v,"v"),m=1):"RT"===e?(a=G(j,{x:H,y:d+r},J,r,v),m=33):"L"===e?(a=x({x:j.x,y:d},{x:H+J,y:d+r},J,r,v,"h"),m=8):"R"===e?(a=x({x:H,y:d},{x:j.x,y:d+r},J,r,v,"h"),m=32):"LB"===e?(a=G(j,{x:H+J,y:d},J,r,v),m=12):"B"===e?(a=x({x:H,y:d},{x:H+J,y:j.y},J,r,v,"v"),m=4):"RB"===e&&(a=G(j,{x:H,y:d},J,r,v),m=36);var b=p.tf(a.x+a.width*n.x,a.y+a.height*n.y);Z.setPosition(b),Z.setSize(a.width,a.height),L&&(N=Z.getRect(),Q.rectGuide.gatherLines({node:Z,x:N.x,y:N.y,w:N.width,h:N.height},R,m)),t=""+Math.round(a.width)+" * "+Math.round(a.height)}else if("line"===O){if(E=D.lp(B),Ng(B)){var g=Z.getPoints(),f="P1"===e?g.get(1):g.get(0),u={x:E.x-f.x,y:E.y-f.y},C=Q.getStyle("shiftLineRotateRound"),S=w._shiftDirList;if(!S||w._shiftRotateRound!==C){w._shiftRotateRound=C,w._shiftDirList=S=[];for(var $=0;$<Math.PI;$+=C)S.push({x:P($),y:_($)})}for(var o,y=0,k=0,M=S.length;M>k;k++){var A=S[k],z=A.x*u.x+A.y*u.y;Math.abs(z)>Math.abs(y)&&(y=z,o=A)}E={x:f.x+o.x*y,y:f.y+o.y*y},Q.rectGuide.clear()}else w._inSmartGuide&&!K.Default.isCtrlDown(B)&&(w._adsorbedToClosest(E),L=!0);var l=Bj.getDataMatrix(Z).applyInverse(E);Z.setPoint("P1"===e?0:1,l,!0);var s=Z.getPoints(),c=s.get(0),I=s.get(1);H=c.x-I.x,d=c.y-I.y,t=" "+Math.round(Math.sqrt(H*H+d*d))+" ",L&&(N=Z.getRect(),Q.rectGuide.gatherLines({node:Z,x:N.x,y:N.y,w:N.width,h:N.height}))}var U=K.Default.getLogicalPoint(B,Q._canvas);U.x+=Bj.Icons.TipShiftX,U.y+=Bj.Icons.TipShiftY,w.tipInfo={helperPos:U,text:t,size:t.length}}},Ym.prototype._unionPointMode1=function(w,A,b,D,Y){if(Y&&b&&D){var k=w.x-A.x,L=w.y-A.y;Math.abs(k*D)<Math.abs(L*b)?(L=Math.sign(L)*Math.abs(k*D/b),w.y=A.y+L):(k=Math.sign(k)*Math.abs(L*b/D),w.x=A.x+k)}return K.Default.unionPoint(w,A)},Ym.prototype._unionPointMode2=function(b,t,g,F,f,N){var T=K.Default.unionPoint(b,t);if(f&&g&&F){var R;"v"===N?(R=T.x+T.width/2,T.width=g*T.height/F,T.x=R-T.width/2):(R=T.y+T.height/2,T.height=F*T.width/g,T.y=R-T.height/2)}return T},Ym.prototype._adsorbedToClosest=function(H,k){var m=this,z=m._interactor,Q=z.rectGuide.findClosest(H,k),s=z.gridGuide.findClosest(H,k),y=1/0,V=1/0;Q&&(isFinite(Q.x)&&(y=Q.x),isFinite(Q.y)&&(V=Q.y)),s&&(isFinite(s.x)&&Math.abs(s.x)<Math.abs(y)&&(y=s.x),isFinite(s.y)&&Math.abs(s.y)<Math.abs(V)&&(V=s.y)),isFinite(y)&&(H.x+=y),isFinite(V)&&(H.y+=V)},Ym.prototype._42=function(q,b,g){var f=this;f.info={},f.screenInfo=null;var e=f._interactor;if(!e.editDetail&&f.gatherInfo(b,g)){var k=f.screenInfo;k.P1?Bj.Icons.DrawIcon(e,q,Bj.Icons.Line,f.screenInfo):Bj.Icons.DrawIcon(e,q,Bj.Icons.Rect,f.screenInfo),f.tipInfo&&Bj.Icons.DrawIcon(e,q,Bj.Icons.TipHelper,f.tipInfo),f.target instanceof Bj.Group&&f.target._42(e,q,b)}};var lg=Bj.Anchor=function($){this.catalog="Anchor",this._interactor=$};lg.prototype={},lg.prototype.constructor=lg,lg.prototype.gatherInfo=function(e,l){var X=this;if(1===l.length){var p=l[0];if(!p.getAnchor)return;if(p instanceof K.Shape&&p._70I())return;if($i(p,e))return;return X.gatherSingleTarget(e,l[0])}return l.length>1?X.gatherMultiTargets(e,l):!1},lg.prototype.gatherSingleTarget=function(N,Y){var M=this;return M.info.POS=Y.getPosition(),M.screenInfo.POS=Bj.toScreenPosition(N,M.info.POS),M.target=Y,!0},lg.prototype.gatherMultiTargets=function(j,P){var B=this,n=Bj.Group.findOrCreateGroup(P);return n?(B.screenInfo.POS=Bj.toScreenPosition(j,n.getAnchor2()),B.target=n,!0):!1},lg.prototype.isVisible=function(){var k=this,e=k._interactor;if(e.getStyle("anchorVisible")===!1)return!1;var S=k.target;if(S){var U=S.getSize(),n=S.getScale(),l=Math.min(U.width*n.x,U.height*n.y);if(l*e.gv._zoom<e.getStyle("anchorHideThreshold"))return!1}return!0},lg.prototype.check=function(N,u,l){if(K.Default.isLeftButton(u)){var I=this,_=I._interactor;if(I.isVisible()&&_.getStyle("anchorMovable")!==!1){I.editing=null,I.tipInfo=null;var Y=I.target;if(Y&&N.isAnchorEditable(Y)&&N.isEditable(Y)){var G;if(I.screenInfo&&(G=I.screenInfo.POS)&&Bj.checkHit(l,new Bj.Math.Vector2(G),_.getStyle("checkSize"))){if(Y instanceof Bj.Group)return I.editing={},!0;var D=Y.getWidth(),z=Y.getHeight(),W=Y.getAnchor();return I.editing={rect:{x:-D*W.x,y:-z*W.y,width:D,height:z},anchor:W,matrix:Y.getMatrix()},!0}}}}},lg.prototype.startEdit=function(s,B){s.startDragging(B)},lg.prototype._46O=function(){this.editing=null,this.tipInfo=null},lg.prototype.handleEdit=function(V,R){var C=this,F=C.target;if(F&&C.editing){var g=V.lp(R);if(F instanceof Bj.Group)return F.setAnchor2(g),C._interactor._42(),void 0;var O=C.editing.matrix,r=O.tfi(g),d=C.editing.rect,f=(r.x-d.x)/d.width,L=(r.y-d.y)/d.height;if(!K.Default.isCtrlDown(R)){var p=C._interactor.getStyle("anchorRound"),u=C._interactor.getStyle("anchorSensitivity");f=Bj.roundTo(f,p,u),L=Bj.roundTo(L,p,u)}F.setAnchor(f,L,!0);var D=K.Default.getLogicalPoint(R,C._interactor._canvas);D.x+=Bj.Icons.TipShiftX,D.y+=Bj.Icons.TipShiftY;var N=""+f.toFixed(2)+", "+L.toFixed(2);C.tipInfo={helperPos:D,text:N,size:N.length}}},lg.prototype._42=function(H,f,z){var b=this;b.info={},b.screenInfo={};var V=b._interactor;V.editDetail||b.gatherInfo(f,z)&&b.isVisible()&&(Bj.Icons.DrawIcon(V,H,Bj.Icons.Anchor,b.screenInfo),b.tipInfo&&Bj.Icons.DrawIcon(V,H,Bj.Icons.TipHelper,b.tipInfo))};var mr=Bj.Curve=function(E){this.catalog="Curve",this._interactor=E};mr.prototype={},mr.prototype.constructor=mr,mr.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},mr.prototype.setUp=function(){var B=this,w=B._interactor;w&&w.gv.mp(B._onGraphviewPropertyChanged,B)},mr.prototype._onGraphviewPropertyChanged=function(Q){("zoom"===Q.property||"translateX"===Q.property||"translateY"===Q.property)&&this._handleDataChanged()},mr.prototype.tearDown=function(){var H=this,E=H._interactor;E&&E.gv.ump(H._onGraphviewPropertyChanged)},mr.prototype.canEnterEditDetailMode=function(){var n=this,G=n._interactor,A=G._getValidSelection();if(1===A.length){var h=A[0],t=h instanceof K.Edge;if(h instanceof K.Shape||t){if(t){var $=h.s("edge.type");if($&&"points"!==$)return}var F=G.gv;if(F.isPointEditable(h)&&F.isEditable(h))return n.target=h,!0}}},mr.prototype.preHandleScroll=function(){var p=this.editing;return p&&p.inEdit?!0:void 0},mr.prototype.getCurrentSelectintStatus=function(){var M=this;if(M.activing&&!M.activing.selections){if(M.activing.status!=t)return M.activing.status;var W=function(c){var H=M.activing.status;M.activing.status=c,M._interactor.fp("shapePointStatus",H,c)},V=Bj.Curve.PointType,H=M.activing.point,z=M.activing.pairs;if(!z||1!==z.length)return W(V.Mirrored);var w=z[0],j=w.c1&&w.c1.isNearEnough(H),n=w.c2&&w.c2.isNearEnough(H);if(!w.c1||!w.c2)return j||n?W(V.Straight):W(V.Disconnected);if(j&&n)return W(V.Straight);if(j||n)return W(V.Asymmetric);var c=w.c1.clone().sub(H),o=w.c2.clone().sub(H);return Math.abs(c.x*o.y-c.y*o.x)>1e-5||c.x*o.x>0?W(V.Disconnected):Math.abs(c.length()-o.length())>1e-5?W(V.Asymmetric):W(V.Mirrored)}},mr.prototype.handle_keydown=function(q){var H=this;if(H._interactor.editDetail){var N=Bj.Curve.PointType;"1"===q.key?H.setCurrentSelectionStatus(N.Straight):"2"===q.key?H.setCurrentSelectionStatus(N.Mirrored):"3"===q.key?H.setCurrentSelectionStatus(N.Disconnected):"4"===q.key&&H.setCurrentSelectionStatus(N.Asymmetric)}},mr.prototype.setCurrentSelectionStatus=function(R){var h=this;if(h.activing){var N=h.getCurrentSelectintStatus();if(null!==N&&N!==R){h.activing.status=R;var z=h.activing.point,X=h.activing.pairs;if(X&&1===X.length){var H=X[0],I=h.screenInfo.curve,V=Bj.Curve.PointType,j=function(){h._writeToHt(),h._interactor.fp("shapePointStatus",N,R)};if(R===V.Straight)return I.moveCtrlPoint(H,z,"c1"),I.moveCtrlPoint(H,z,"c2"),j(),void 0;if(N===V.Straight){var $=I.findPairs(z,!0),t=$[0],r=t.r1||z,i=t.r2||z,y=i.clone().sub(r).multiplyScalar(.25);return I.moveCtrlPoint(H,z.clone().sub(y),"c1"),I.moveCtrlPoint(H,z.clone().add(y),"c2"),j(),void 0}var w=H.c1,L=H.c2;if(w&&L){if(R===V.Mirrored)return I.moveCtrlPoint(H,z.clone().multiplyScalar(2).sub(L),"c1"),j(),void 0;if(R===V.Asymmetric&&N===V.Disconnected){var T=w.clone().sub(z).length(),y=z.clone().sub(L).setLength(T).add(z);return I.moveCtrlPoint(H,y,"c1"),j(),void 0}}h._interactor.fp("shapePointStatus",N,R)}}}},mr.prototype._handleDataChanged=function(n){var g=this;if(g.screenInfo&&g.target){var M=g._interactor;g.gatherSingleTarget(M.gv,g.target,!0),g.check(M.gv,null,n?M._getLogicalPoint(n):new Bj.Math.Vector2(M._lastClientPoint)),M._42()}},mr.prototype.gatherSingleTarget=function(U,v,Q){var y,t,f=this;f.screenInfo&&f.screenInfo.curve&&(t=f.screenInfo.curve._curves);var n=f.editing;y=n?f.screenInfo:f.screenInfo={};var W,_,m=v instanceof K.Edge;m?(W=v.s("edge.segments"),_=v.s("edge.points")||new K.List):(W=v._58O,_=v._59O),y.S=W;var E=y.P=[],b=Bj.getDataMatrix(v);if(_.each(function(l){l=b.apply(l);var V=Bj.toScreenPosition(U,l);E.push(V.x,V.y)}),m){var w=Bj.toScreenPosition(U,v._lastSourcePoint),q=Bj.toScreenPosition(U,v._lastTargetPoint);E.splice(0,0,w.x,w.y),E.push(q.x,q.y)}if(!y.S||!y.S.size()){y.S=new K.List,y.S.add(1);for(var h=0;h<E.length/2-1;h++)y.S.add(2)}if((!n||Q)&&f.convertToCubicBezier(t),f.activing&&(Q||!f.editing||"realPoint"===f.editing.type)){var z=y.curve.findPairs(f.activing.point);f.activing.pairs=z}m&&"points"!==v.s("edge.type")&&f._writeToHt()},mr.prototype._convertToNewPoint=function(R,U,S){var o,k,C;for(o=0,k=U.length;k>o;o++){if(C=U[o],C._p1.isNearEnough(R))return C._p1;if(C._p4.isNearEnough(R))return C._p4}if(S)for(o=0,k=Math.min(S.length,k);k>o;o++){if(C=S[o],C._p1===R)return U[o]._p1;if(C._p4===R)return U[o]._p4}},mr.prototype.convertToCubicBezier=function(D){var W,M,h=this,Y=new Bj.Math.Curve,G=h.screenInfo;if(Y.createFromHtShape(G.P,G.S),G.curve=Y,h.activing){var z=Y._curves;if(W=h.activing.point,M=h._convertToNewPoint(W,z,D),M&&(h.activing.point=M),h.activing.selections){var d=-1,Z=h.activing.selections;Z.forEach(function(l){d++,M=h._convertToNewPoint(l,z,D),M&&(Z[d]=M)})}}},mr.prototype.check=function(U,D,t){if(!D||K.Default.isLeftButton(D)){var y=this;if(y._interactor.setCursor("default"),y.editing=null,y.highlight=null,y.tipInfo=null,y.screenInfo){if(gl())return y._interactor._42(),!0;if(y._checkEditCtrlPoint(t))return y._interactor._42(),!0;if(y._checkEditRealPoint(t))return y._interactor._42(),!0;var p=y.screenInfo.curve,e=p.checkPoint(t,y._interactor.getStyle("curveIntersectSize"));if(e){var L=y.highlight={};L.type="insertKnot",L.bezier=e.bezier,L.point=e.intersection}return y._interactor._42(),!0}}},mr.prototype._checkEditRealPoint=function(F){var A,L,y,V,x,I,n=this,C=n.screenInfo.curve._curves,T=n._interactor.getStyle("curvePointIntersectSize"),l=1/0;for(T*=T,y=0,V=C.length;V>y;y++)A=C[y],x=A._p1,I=F.distanceToSquared(x),l>I&&(l=I,L=x),x=A._p4,I=F.distanceToSquared(x),l>I&&(l=I,L=x);if(l>T)return!1;var q=n.highlight={};return q.type="changeRealPoint",q.point=L,n.editing={type:"realPoint",point:L,shiftGuide:{point:L.clone(),dir:"x",limit:0}},n._interactor.setCursor("crosshair"),!0},mr.prototype._checkEditCtrlPoint=function(Y){var P=this;if(P.activing&&!P.activing.selections){var K=P.getCurrentSelectintStatus();if(K!==Bj.Curve.PointType.Straight){var J=P.activing.pairs;if(J){var p=P._interactor.getStyle("curvePointIntersectSize");p*=p;var M,C,e,b,W,y,O,F,N,I=1/0;for(O=0,N=J.length;N>O;O++)for(b=J[O],F=0;2>F;F++)W=0===F?"c1":"c2",b[W]&&(y=Y.distanceToSquared(b[W]),I>y&&(I=y,M=b,C=O,e=W));if(I>p)return!1;P.activing.hlpair=M,P.activing.hltype=e;var X=P.highlight={};return X.type="changeCtrlPoint",X.point=M[e],P.editing={type:"ctrlPoint",pair:M,pairId:C,ctrlType:e,direction:M[e].clone().sub(P.activing.point).normalize()},P._interactor.setCursor("crosshair"),!0}}}},mr.prototype.startEdit=function($,U){$.startDragging(U);var l=this;
l.highlight&&"insertKnot"===l.highlight.type&&(l.insertKnot(),l.gatherSingleTarget(l._interactor.gv,l.target),l.activing=null,l._checkEditRealPoint(l._interactor._getLogicalPoint(U)));var R=l.highlight,V=K.Default.isCtrlDown(U);if(!R||gl()){var I=l._interactor.gv;if(!I.setFocus(U)||I._scrolling)return;return I.isPannable()&&fq(U)&&!V&&(l._pan={tx:I.tx(),ty:I.ty()}),void 0}if("changeRealPoint"===R.type){var G,C=l.activing?l.activing.point:null,b=l.activing?l.activing.selections:null;if(V&&l.activing)C===R.point?(b?(l.activing={point:b[0]},b.length>1&&(b.splice(0,1),l.activing.selections=b)):l.activing=null,l.editing=null):b&&(G=b.indexOf(R.point))>=0?(b.length>1?b.splice(G,1):delete l.activing.selections,l.editing=null):b?(b.push(C),l.activing={point:R.point,selections:b}):l.activing={point:R.point,selections:[C]};else if(b)C===R.point||((G=b.indexOf(R.point))>=0?(b.splice(G,1,C),l.activing={point:R.point,selections:b}):l.activing={point:R.point});else{var f;C===R.point&&(f=l.activing.status),l.activing={point:R.point},f&&(l.activing.status=f)}}},mr.prototype.insertKnot=function(){var D=this,n=D.highlight,x=D.screenInfo.curve;x.insertKnot(n.bezier,n.point.t),D._writeToHt()},mr.prototype._writeToHt=function(){for(var Y,w,j=this,t=j.screenInfo.curve,f=t.toHtShape(),T=f.points,e=[],B=f.segments,H=j._interactor.gv,V=j.target,$=V instanceof K.Edge,v=Bj.getDataMatrix(V).invert(),A=0,U=T.length;U>A;A++)Y=T[A],w=Bj.toWorldPosition(H,Y),w=v.apply(w),e.push(w);if(V._writing=!0,$){V.s("edge.type","points"),V.setStyle("edge.segments",B),V.setStyle("edge.points",e.slice(1,e.length-1)),V.setStyle("edge.source.offset.x",0),V.setStyle("edge.source.offset.y",0),V.setStyle("edge.target.offset.x",0),V.setStyle("edge.target.offset.y",0);var F=j._nextChangeEdgeHost;delete j._nextChangeEdgeHost,F&&("source"===F.type?V.setSource(F.host):V.setTarget(F.host)),j._writeEdgeHostAnchor("source",e[0]),j._writeEdgeHostAnchor("target",e[e.length-1])}else e.length?(V.setSegments(B),V.setPoints(e,!0)):V.removeFromDataModel();delete V._writing},mr.prototype._writeEdgeHostAnchor=function(T,k){var O=this,N=O.target,K=O._calcHostAnchor(N,T,k);N.s("edge."+T+".anchor.x",K.x),N.s("edge."+T+".anchor.y",K.y)},mr.prototype._calcHostAnchor=function(Q,L,S,c){c||(c="source"===L?Q.getSource():Q.getTarget());var w=c.getRotation(),l=c.getAnchor(),e=this._interactor.gv;if($i(c,e)&&(w=0),w){var k=c.getMatrix(),s=k.tfi(S),W=c.getSize();return{x:s.x/W.width+l.x,y:s.y/W.height+l.y}}var V=fk(e,c),J={x:(S.x-V.x)/V.width,y:(S.y-V.y)/V.height};return J},mr.prototype._handlePanning=function(R){var k=this,e=k._pan;if(e){e.started=!0;var Z=k._interactor,J=Z.gv,M=Z._lastClientPoint,v=de(R);J.setTranslate(e.tx+v.x-M.x,e.ty+v.y-M.y),k.gatherSingleTarget(Z.gv,k.target),Z._42()}},mr.prototype.handleEdit=function(H,d){var r=this,l=r.editing;if(r._pan)return r._handlePanning(d),void 0;if(l){l.inEdit=!0;var D,O,i=r._interactor._getLogicalPoint(d),E=K.Default.isCtrlDown(d),T=K.Default.isShiftDown(d);if(r._guideInfo=null,"ctrlPoint"===l.type&&T){var w=r.editing.direction.clone();D=r.activing.point;var X=w.dot(i.clone().sub(D));i=w.setLength(X).add(D)}else{var w;if("realPoint"===l.type&&T){var J=r.editing.shiftGuide,e=J.point,o=Math.abs(i.x-e.x),c=Math.abs(i.y-e.y);o>c&&o>J.limit&&"y"===J.dir&&(J.dir="x"),c>o&&c>J.limit&&"x"===J.dir&&(J.dir="y"),w=J.dir,"x"===w?(i.y=e.y,J.limit=Math.max(J.limit,o)):"y"===w&&(i.x=e.x,J.limit=Math.max(J.limit,c))}var v=r._isEditEdgeSourceTarget();if(v){var y=r._editEdgeSourceTarget(v,i,E);y&&(O=y.tipText)}else if(!E){var F=r._guidingToEdit(i,w),S="realPoint"===l.type?r._interactor.gridGuide.findClosest(i,w,!0):null,A=1/0,k=1/0;S&&(S.x&&(A=S.x),S.y&&(k=S.y));var t=!1;F&&(F.xList&&(Math.abs(F.x)<=Math.abs(A)?(t=!0,A=F.x):delete F.xList),F.yList&&(Math.abs(F.y)<=Math.abs(k)?(t=!0,k=F.y):delete F.yList),t&&(r._guideInfo=F)),isFinite(A)&&(i.x+=A),isFinite(k)&&(i.y+=k),t&&(F.v=i)}}var G=r.screenInfo.curve;if("realPoint"===l.type){D=l.point,G.moveRealPoint(D,i),l.point=i,r.highlight.point=i;var q=r.activing.status,L=r.activing.selections;if(r.activing={point:i,status:q},L){var p=i.clone().sub(D),I=0;L.forEach(function(T){var a=T.clone().add(p);G.moveRealPoint(T,a),L[I++]=a}),r.activing.selections=L}}else if("ctrlPoint"===l.type){var N=r.activing,f=N.pairs,V=f[l.pairId];G.moveCtrlPoint(V,i,l.ctrlType);var x=N.status,m=Bj.Curve.PointType;if((x===m.Mirrored||x===m.Asymmetric)&&V.c1&&V.c2){var D=new Bj.Math.Vector2(N.point),u="c1"===l.ctrlType?"c2":"c1";if(x===Bj.Curve.PointType.Mirrored)G.moveCtrlPoint(V,D.clone().multiplyScalar(2).sub(i),u);else if(x===m.Asymmetric){var X=V[u].clone().sub(D).length(),Y=D.clone().sub(V[l.ctrlType]).setLength(X).add(D);isNaN(Y.x)||G.moveCtrlPoint(V,Y,u)}}}var z=K.Default.getLogicalPoint(d,r._interactor._canvas);if(z.x+=Bj.Icons.TipShiftX,z.y+=Bj.Icons.TipShiftY,!O){var h=Bj.toWorldPosition(H,i);O=""+Bj.toFixed(h.x)+", "+Bj.toFixed(h.y)}r.tipInfo={helperPos:z,text:O,size:O.length},r._writeToHt()}},mr.prototype._isEditEdgeSourceTarget=function(){var V=this,X=V.target;if(!(X instanceof K.Edge))return!1;var l=V.editing.point,u=V.screenInfo.curve._curves;return l===u[0]._p1?"source":l===u[u.length-1]._p4?"target":!1},mr.prototype._editEdgeSourceTarget=function(W,A,x){var v,w=this,L=w.target;if(v="source"===W?L.getSource():L.getTarget()){var N=w._interactor.gv,j=Bj.toWorldPosition(N,A),V=w._calcHostAnchor(L,W,j,v);if(!x){var E=w._interactor.getStyle("anchorRound"),F=w._interactor.getStyle("anchorSensitivity");V.x=Bj.roundTo(V.x,E,F),V.y=Bj.roundTo(V.y,E,F)}if(w._interactor.getStyle("edgeHostDetectPerFrame")||V.x<0||V.x>1||V.y<0||V.y>1){var J=N.getDataAt(j,function(A){return N.isSelectable(A)?Vp(A)?!0:!1:!1});if(J){var e=w._calcHostAnchor(L,W,j,J);v=J,w._nextChangeEdgeHost={type:W,host:J},V=e,x||(V.x=Bj.roundTo(V.x,E,F),V.y=Bj.roundTo(V.y,E,F))}}if(!x){var P=Xn(N,v,0,0,0,V.x,V.y),t=Bj.toScreenPosition(N,P);A.x=t.x,A.y=t.y}var y,b=[];if($i(v,N)){var m=fk(N,v);y=[{x:m.x,y:m.y},{x:m.x+m.width,y:m.y},{x:m.x+m.width,y:m.y+m.height},{x:m.x,y:m.y+m.height}]}else y=v.getCorners();return y.forEach(function(u){var c=Bj.toScreenPosition(N,u);b.push(c.x,c.y)}),w._edgeHostGuideInfo=b,{host:v,anchor:V,tipText:""+V.x.toFixed(2)+", "+V.y.toFixed(2)}}},mr.prototype._guidingToEdit=function(y,l){var T,g,_=this;if(T=_.screenInfo.curve){g=T._curves;var e,Y,v,h,B,X,u,x,V=1/0,L=1/0,M=[];for(_.editing&&"realPoint"===_.editing.type&&(x=_.editing.point),B=0,X=2*g.length;X>B;B++)u=g[Math.floor(B/2)][B%2?"_p4":"_p1"],M.indexOf(u)>=0||(M.push(u),x&&x===u||(v=u.x-y.x,h=u.y-y.y,Math.abs(v)<Math.abs(V)?(V=v,e=[u]):v===V&&e.push(u),Math.abs(h)<Math.abs(L)?(L=h,Y=[u]):h===L&&Y.push(u)));var W=_._interactor.getStyle("smartGuideSensitivity");if((Math.abs(V)>W||"y"===l)&&(e=null),(Math.abs(L)>W||"x"===l)&&(Y=null),e||Y){var F=!1,q={};if(e&&(F=!0,q.xList=e,q.x=V),Y&&(F=!0,q.yList=Y,q.y=L),F)return q}}},mr.prototype._46O=function(){var n=this;n.editing=null,n._guideInfo=null,n._edgeHostGuideInfo=null,n._pan=null,n.tipInfo=null},mr.prototype._canDeletePoint=function(i,Q){var l=this.target;if(!(l instanceof K.Edge))return!0;var G=i._curves[0],V=i._curves[i._curves.length-1];return G._p1===Q||V._p4===Q?!1:!0},mr.prototype.handleDelete=function(){var H=this;if(H.activing&&H.screenInfo){var l=K.Default.isShiftDown(),e=H.screenInfo.curve;H._canDeletePoint(e,H.activing.point)&&e.deleteRealPoint(H.activing.point,l),H.activing.selections&&H.activing.selections.forEach(function(g){H._canDeletePoint(e,g)&&e.deleteRealPoint(g,l)}),delete H.activing,delete H.editing,delete H.tipInfo,delete H._pan,H._writeToHt(),H._interactor.fp("deleteShapePoint",!1,!0)}},mr.prototype.handleDoubleClick=function(C){var n=this,V=n._interactor._getLogicalPoint(C);if(n.screenInfo&&n._checkEditRealPoint(V)){var z=n.getCurrentSelectintStatus(),v=Bj.Curve.PointType;return z=z===v.Mirrored?v.Straight:v.Mirrored,n.setCurrentSelectionStatus(z),n._interactor._42(),!0}},mr.prototype._drawHighlight=function(V){var H=this,f=H.highlight;if(f){var _=f.bezier,J=H._interactor;_&&Bj.Icons.DrawIcon(J,V,Bj.Icons.ShapeHighlightCurve,[_._p1.x,_._p1.y,_._p2.x,_._p2.y,_._p3.x,_._p3.y,_._p4.x,_._p4.y]);var B=f.point;B&&"insertKnot"===f.type&&Bj.Icons.DrawIcon(J,V,Bj.Icons.ShapeHighlighPoint,B)}},mr.prototype._drawGuide=function(v){var u=this,i=u._guideInfo;if(i){var q,G,m,z,I=i.v;for(q=0;2>q;q++)if(z=0===q?i.xList:i.yList)for(G=0,m=z.length;m>G;G++)Bj.Icons.DrawIcon(u._interactor,v,Bj.Icons.ShapeGuideLine,[I.x,I.y,z[G].x,z[G].y])}},mr.prototype._drawCurrentPoint=function(h){var d=this;if(d.activing){var I=d.activing,g=d.getCurrentSelectintStatus(),m=d._interactor;if(g!==Bj.Curve.PointType.Straight){var e=I.pairs,G=I.hlpair,K=I.hltype,T=I.selections;if(e&&!T){var n,W,y;for(W=0,y=e.length;y>W;W++)n=e[W],W===G&&n[K]?Bj.Icons.DrawIcon(m,h,Bj.Icons.ShapeActivingCtrl,{point:n.point,c1:n.c1,c2:n.c2,hl:K}):Bj.Icons.DrawIcon(m,h,Bj.Icons.ShapeActivingCtrl,n)}}Bj.Icons.DrawIcon(m,h,Bj.Icons.ShapeHighlighRealPoint,d.activing.point),T&&T.forEach(function(f){Bj.Icons.DrawIcon(m,h,Bj.Icons.ShapeHighlighRealPoint,f)})}},mr.prototype.clear=function(){var p=this;p.editing=null,p._guideInfo=null,p.activing=null,p.highlight=null},mr.prototype._42=function(P){var L=this;L.info={},L.editing||(L.screenInfo=null);var k=L._interactor;return k.editDetail?L.target&&L._interactor.gv.isSelected(L.target)&&L._interactor.gv.isVisible(L.target)?(L.gatherSingleTarget(k.gv,L.target),Bj.Icons.DrawIcon(k,P,Bj.Icons.ShapeBgCurve,L.screenInfo),L._drawHighlight(P),L._drawCurrentPoint(P),L._getRealPoint().forEach(function(N){Bj.Icons.DrawIcon(k,P,Bj.Icons.ShapePoint,N)}),L._drawGuide(P),L.tipInfo&&Bj.Icons.DrawIcon(k,P,Bj.Icons.TipHelper,L.tipInfo),L._edgeHostGuideInfo&&Bj.Icons.DrawIcon(k,P,Bj.Icons.EdgeHostGuide,L._edgeHostGuideInfo),void 0):(k.editDetail=!1,L.clear(),void 0):(L.clear(),void 0)},mr.prototype._getRealPoint=function(){var Y=this.screenInfo,l=Y.P,V=Y.S,f=-1,g=[];return V.each(function(V){var L=1;if(3===V)L=2;else if(4===V)L=3;else if(5===V)return;f+=L,g.push({x:l[2*f],y:l[2*f+1]})}),g};var fl=Bj.MoveHelper=function(e){var X=this;X.catalog="Move",X._interactor=e};fl.prototype={},fl.prototype.constructor=fl,fl.prototype.calcShift=function(C,h,E){var a,H,v=this,j=v._interactor.gv,T=j.lp(h);if("beginMove"===C&&v._gatherGridInfo(E._lastLogicalPoint||T),a=v._target){var p=a.downPosition;if(p){var f=v._interactor.getStyle("moveSensitivity")/j._zoom;if(p.distanceTo(T)<f)return{x:0,y:0};delete a.downPosition}var B;H=K.Default.isShiftDown(h),H&&(T=v._dealShiftDown(T),B=a.shiftGuide.dir);var c,L=a.rawPos={x:a.pos.x+T.x-a.lp.x,y:a.pos.y+T.y-a.lp.y};if(K.Default.isCtrlDown(h)){if(c=v._calcShiftByAddon(),v._target.node instanceof Bj.Group){var X=v._target.node;X._position.x+=c.x,X._position.y+=c.y}return c}for(var V,r=a.x+L.x,P=a.y+L.y,k={x:r,y:P},g={x:r+a.w/2,y:P+a.h/2},Q={x:r+a.w,y:P+a.h},q=v._interactor.rectGuide,D=v._interactor.gridGuide,i=[q.findClosest(k,B),q.findClosest(g,B),q.findClosest(Q,B),D.findClosest(k,B),D.findClosest(g,B),D.findClosest(Q,B)],m=1/0,s=1/0,d=0,N=i.length;N>d;d++)V=i[d],V&&(r=V.x,P=V.y,isFinite(r)&&Math.abs(r)<Math.abs(m)&&(m=r),isFinite(P)&&Math.abs(P)<Math.abs(s)&&(s=P));if(isFinite(m)||(m=0),isFinite(s)||(s=0),c=v._calcShiftByAddon(m,s),v._target.node instanceof Bj.Group){var X=v._target.node;X._position.x+=c.x,X._position.y+=c.y}var l=a.node;if(!$i(l,j)){var w=L.x+m,y=L.y+s;v._interactor.rectGuide.gatherLines({node:l,x:a.x+w,y:a.y+y,w:a.w,h:a.h},B)}return c}},fl.prototype._calcShiftByAddon=function(p,W){var U=this._target,t=U.rawPos,x=U.node.getPosition();return p=p||0,W=W||0,{x:t.x-x.x+p,y:t.y-x.y+W}},fl.prototype._dealShiftDown=function(n){var x=this,F=x._target.shiftGuide,L=x._target.lp,b=Math.abs(n.x-L.x),c=Math.abs(n.y-L.y);b>c&&b>F.limit&&"y"===F.dir&&(F.dir="x"),c>b&&c>F.limit&&"x"===F.dir&&(F.dir="y");var W=F.dir;return"x"===W?(n.y=L.y,F.limit=Math.max(F.limit,b)):"y"===W&&(n.x=L.x,F.limit=Math.max(F.limit,c)),n},fl.prototype._gatherGridInfo=function(j){var J,N=this,v=N._interactor,O=v._getValidSelection();if(1===O.length){if(J=O[0],!J.getRect)return N._target=null,void 0}else if(J=Bj.Group.findOrCreateGroup(O),!J)return N._target=null,void 0;var i=J.getPosition(),d=J.getRect();N._target={node:J,x:d.x-i.x,y:d.y-i.y,w:d.width,h:d.height,lp:{x:j.x,y:j.y},pos:{x:i.x,y:i.y},shiftGuide:{dir:"x",limit:0},downPosition:new Bj.Math.Vector2(j)},v.rectGuide.gatherRects()},fl.prototype.clear=function(){var C=this;C._interactor.rectGuide.clear(),C._interactor._42()};var Yj="directional",as="point",Ur="spot",Kr="light.color";Jn(M,{graph3dViewAttributes:R,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:u/60,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:nn,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:u/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:function(m,u){vq[m]=u},getShape3dModel:function(W){return vq[W]},createMatrix:function(j,q){dr(j)||(j=[j]);for(var Y=j.length-1;Y>=0;Y--){var k=j[Y];q=td(k.mat,k.s3,k.r3,k.rotationMode,k.t3,q)}return q},transformVec:function(E,_){return xl(E,_)},createBoxModel:function(){return{vs:Ig,ns:Sj,uv:zg,is:sr}},createRoundRectModel:function(z,q){return Hl.roundRect(z,q)},createStarModel:function(A,$){return Hl.star(A,$)},createRectModel:function(S,K){return Hl.rect(S,K)},createTriangleModel:function(g,z){return Hl.triangle(g,z)},createRightTriangleModel:function(q,E){return Hl.rightTriangle(q,E)},createParallelogramModel:function(K,I){return Hl.parallelogram(K,I)},createTrapezoidModel:function(Z,R){return Hl.trapezoid(Z,R)},createSmoothSphereModel:function(D,L,C,q,F,A,v){return Fn(new Ug(D,L,C,q,F,A,v))},createSphereModel:function(e,F,x,n,E,K){return e?yb(e,F,x,n,E,K):M.createSmoothSphereModel()},createSmoothConeModel:function(t,Q,n,A,N){return ok(t,Q,n,A,N)},createConeModel:function(p,H,R,s,i,g){return p?bf(p,H,R,s,i,g):ok(g)},createSmoothCylinderModel:function(s,u,d,C,X,j,K,$){return Fn(new Im(s,u,d,C,X,j,K,$))},createCylinderModel:function(E,_,B,G,F,L,A){return E?tm(E,_,B,G,F,L,A):ze(L,A)},createSmoothTorusModel:function(j,e,B,v,D,F){return Fn(new jg(j,e,B,v,D,F))},createTorusModel:function(G,m,c,I,w,y,W){return G?jr(G,m,c,I,w,y,W):Bp(y,W)},createExtrusionModel:function(M,F,y,s,J,q,b,U){return Gn(M,F,y,s,J,q,b,U)},createSmoothRingModel:function(r,u,a,T,s,I){for(var k=[],U=0;U<r.length-1;U+=2)k.push({x:r[U],y:r[U+1]});for(r=Do(k,u,a)[0],k=[],U=0;U<r.length;U++){var j=r[U];k.push(new eh(j.x,0,j.y))}return Fn(new Yn(k,I,T,s))},createTextGeometry:function(q,$){return Fn(new gc(q,$))},loadFontFace:function(L,J){M.xhrLoad(L,function(O){if(!O)return J();var D;try{D=JSON.parse(O)}catch(d){D=JSON.parse(O.substring(65,O.length-2))}Vf.loadFace(D),J&&J(D.familyName.toLowerCase())},J?null:{sync:!0})},createRingModel:function(x,s,u,O,y,J,e,q,B,n){for(var L=[],v=0;v<x.length-1;v+=2)L.push({x:x[v],y:x[v+1]});J=J||M.shapeSide,e=e||0,q=q||J;var i,C,f,Z,A,T,X,m,G,l,v,j,h,k,N,E,$,p,z=[],Q=[],I=B?[]:R,w=B?[]:R,D=n?[]:R,a=n?[]:R,Y=O?[]:R,W=O?[]:R,H=y?[]:R,d=y?[]:R,x=Do(L,s,u),t=wf(x),U=0,F=2*Math.PI/J;return x.forEach(function(S){if(f=S.length,f>1){if(Z=S[0],O)for(T=Z.x,m=Z.y,v=e;q>v;v++)j=v+1,h=v*F,k=j*F,N=_(h),E=P(h),$=_(k),p=P(k),Y.push(N*T,m,-E*T,$*T,m,-p*T,0,m,0),W.push(.5-.5*N,.5-.5*E,.5-.5*$,.5-.5*p,.5,.5);for(l=0;f>l;l++){for(A=S[l],T=Z.x,X=A.x,m=Z.y,G=A.y,i=U/t,U+=Tr(Z,A),C=U/t,v=e;q>v;v++)j=v+1,h=v*F,k=j*F,N=_(h),E=P(h),$=_(k),p=P(k),z.push(N*X,G,-E*X,$*X,G,-p*X,N*T,m,-E*T,$*X,G,-p*X,$*T,m,-p*T,N*T,m,-E*T),Q.push(v/J,C,j/J,C,v/J,i,j/J,C,j/J,i,v/J,i),B&&v===e&&(I.push(0,m,0,0,G,0,N*X,G,-E*X,N*X,G,-E*X,N*T,m,-E*T,0,m,0),w.push(0,.5-m,0,.5-G,2*X,.5-G,2*X,.5-G,2*T,.5-m,0,.5-m)),n&&j===q&&(D.push(0,m,0,$*X,G,-p*X,0,G,0,$*X,G,-p*X,0,m,0,$*T,m,-p*T),a.push(1,.5-m,1-2*X,.5-G,1,.5-G,1-2*X,.5-G,1,.5-m,1-2*T,.5-m));Z=A}if(y)for(T=Z.x,m=Z.y,v=e;q>v;v++)j=v+1,h=v*F,k=j*F,N=_(h),E=P(h),$=_(k),p=P(k),H.push($*T,m,-p*T,N*T,m,-E*T,0,m,0),d.push(.5-.5*$,.5+.5*p,.5-.5*N,.5+.5*E,.5,.5)}}),{vs:z,uv:Q,bottom_vs:H,bottom_uv:d,top_vs:Y,top_uv:W,from_vs:I,from_uv:w,to_vs:D,to_uv:a}}},!0),Jn(w,{"3d.move.mode":t,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":t,"edge.gradient.color":t,"edge.source.t3":t,"edge.target.t3":t,"light.type":as,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":u/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":He,"wf.short":!1,"wf.mat":t,batch:t,"transparent.mask":!1,brightness:t,"select.brightness":.7,"repeat.uv.length":t,"label.face":rh,"label.t3":t,"label.r3":t,"label.texture.scale":2,"label.rotationMode":Po,"label.light":!1,"label.blend":t,"label.reverse.flip":!1,"label.reverse.color":zl,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":rh,"label2.t3":t,"label2.r3":t,"label2.texture.scale":2,"label2.rotationMode":Po,"label2.light":!1,"label2.blend":t,"label2.reverse.flip":!1,"label2.reverse.color":zl,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":rh,"note.t3":t,"note.r3":t,"note.texture.scale":2,"note.rotationMode":Po,"note.light":!1,"note.blend":t,"note.reverse.flip":!1,"note.reverse.color":zl,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":rh,"note2.t3":t,"note2.r3":t,"note2.texture.scale":2,"note2.rotationMode":Po,"note2.light":!1,"note2.blend":t,"note2.reverse.flip":!1,"note2.reverse.color":zl,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:t,"shape3d.color":sp,"shape3d.top.color":t,"shape3d.bottom.color":t,"shape3d.from.color":t,"shape3d.to.color":t,"shape3d.image":t,"shape3d.top.image":t,"shape3d.bottom.image":t,"shape3d.from.image":t,"shape3d.to.image":t,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":t,"shape3d.side.to":t,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":t,"shape3d.opacity":t,"shape3d.reverse.flip":!1,"shape3d.reverse.color":zl,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":t,"shape3d.uv.scale":t,"shape3d.top.uv.offset":t,"shape3d.top.uv.scale":t,"shape3d.bottom.uv.offset":t,"shape3d.bottom.uv.scale":t,"shape3d.from.uv.offset":t,"shape3d.from.uv.scale":t,"shape3d.to.uv.offset":t,"shape3d.to.uv.scale":t,"shape3d.top.cap":t,"shape3d.bottom.cap":t,"shape3d.start.angle":0,"shape3d.sweep.angle":B,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"all.light":!0,"all.visible":!0,"all.color":sp,"all.image":t,"all.blend":t,"all.opacity":t,"all.reverse.flip":!1,"all.reverse.color":zl,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":t,"all.uv.offset":t,"all.uv.scale":t,"all.discard.selectable":!0,mat:t,"left.mat":t,"right.mat":t,"top.mat":t,"bottom.mat":t,"front.mat":t,"back.mat":t},!0);var Wn,uk=!1,Gc=[0,0,0,1/255],Dr={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Ai,2:Br,3:Id,4:Zf,5:rh,6:vr}},vl=function(q,D,w,o){if(D.getFaceVisible(q,w)){Rn(D,gj(q,D.getFaceMat(q,w)||D.getMat(q)));var x=D._26I;D.getFaceReverseCull(q,w)?x.enable(x.CULL_FACE):x.disable(x.CULL_FACE),$q(x,D._prg.uFixPickReverseColor,Dr[w]),ae(x),hi(x,o,6),Ml(x),Rh(D)}},Cr=function(j){return j instanceof Cl},Yr=function(B){return[B.x,B.e||0,B.y]},Ph=function(G,J,D){for(var J=no(J),S=J[0],B=J[1],_=J[2];D--;)G.push(S,B,_)},sn=function(Y,s,B){for(var s=no(s),I=s[0],E=s[1],W=s[2],k=s[3];B--;)Y.push(I,E,W,k)},Tq=function(i,F,v){if(F)for(var P,a,y,n=F[0],O=F[1],G=F[2],J=F[4],B=F[5],_=F[6],T=F[8],k=F[9],j=F[10],I=F[12],d=F[13],R=F[14],N=v.length,f=0,f=0;N>f;f+=3)P=v[f],a=v[f+1],y=v[f+2],i.push(n*P+J*a+T*y+I,O*P+B*a+k*y+d,G*P+_*a+j*y+R);else Vk(i,v)},rq=function(n,D){var O=D.s("light.intensity"),s=no(D.s(Kr)),B=s[0],J=s[1],c=s[2];1!==O&&(B*=O,J*=O,c*=O),n.push(B,J,c,D.s("light.disabled")?1:0)},Xd=function(d,b,k){$q(b,k.uHeadlightRange,d._headlightRange);var u=d._headlightIntensity,F=no(d._headlightColor);1!==u&&(F=[F[0]*u,F[1]*u,F[2]*u]),$q(b,k.uHeadlightColor,[F[0],F[1],F[2],d._headlightDisabled?1:0]);var M=d._59O,G=d._spots,e=d._dirs;if(M.length){var U=[],Q=[],v=[];M.forEach(function(n){rq(U,n),Vk(Q,n.p3()),v.push(n.s("light.range"))}),b.uniform4fv(k.uPointColor,U),b.uniform1fv(k.uPointRange,v),b.uniform3fv(k.uPointPosition,Q)}if(G.length){var E=[],C=[],w=[],V=[],h=[],j=[];G.forEach(function(e){rq(E,e),Vk(C,e.p3()),Vk(w,e.s("light.center")),V.push(e.s("light.range")),h.push(_(e.s("light.angle")/2)),j.push(e.s("light.exponent"))}),b.uniform4fv(k.uSpotColor,E),b.uniform1fv(k.uSpotRange,V),b.uniform1fv(k.uSpotAngle,h),b.uniform1fv(k.uSpotExponent,j),b.uniform3fv(k.uSpotPosition,C),b.uniform3fv(k.uSpotCenter,w)}if(e.length){var a=[],p=[];e.forEach(function(E){rq(a,E),Vk(p,E.p3())}),b.uniform4fv(k.uDirColor,a),b.uniform3fv(k.uDirPosition,p)}},rr=function(B){return B>0&&0===(B-1&B)},ll=function(Q){return Q=I(0,j(u,Q)),Q=I(Hj,j(u-Hj,Q))},sg=function(){return.05+W()/2},Tp=function(r,v,d,j){var Y,y=r.getEye();return r.isOrtho()?(Y=ad(r.getCenter(),y),Y[0]+=j[0],Y[1]+=j[1],Y[2]+=j[2]):Y=y,tp(v,d,j,Y)},tp=function(q,$,H,V){var M=dj(q,$),i=ad(V,H,!0),N=dj(i,$);if(Q(N)<Hj)return R;var j=(M-dj(H,$))/N;return[H[0]+i[0]*j,H[1]+i[1]*j,H[2]+i[2]*j]},ep=function(C,x){return{x:2*C.x-x.x,y:2*C.y-x.y}},ej=function(o,x,I,t){var V,g;if(!o)return V=f(x.y-I.y,I.x-x.x),{x:x.x+t*P(V),y:x.y+t*_(V)};if(!I)return V=f(o.y-x.y,x.x-o.x),{x:x.x+t*P(V),y:x.y+t*_(V)};var y=ad([o.x,o.y,0],[x.x,x.y,0],!0),e=ad([I.x,I.y,0],[x.x,x.y,0],!0),T=-(y[0]+e[0])/2,B=-(y[1]+e[1])/2,L=Z(T*T+B*B);if(Hj>L)return V=f(o.y-x.y,x.x-o.x),{x:x.x+t*P(V),y:x.y+t*_(V)};var N=o.x-x.x,c=o.y-x.y,E=I.x-x.x,s=I.y-x.y,C=Z(Math.min(N*N+c*c,E*E+s*s));return V=U(dj(y,e))/2,g=y[1]*e[0]-y[0]*e[1]>0?-1:1,T/=L,B/=L,L=Math.min(t/P(V),C/_(V)),{x:x.x+g*L*T,y:x.y+g*L*B}},hs=function(C){var F=C[1],p=C[2],e=C[3],H=C[6],s=C[7],c=C[11];C[1]=C[4],C[2]=C[8],C[3]=C[12],C[4]=F,C[6]=C[9],C[7]=C[13],C[8]=p,C[9]=H,C[11]=C[14],C[12]=e,C[13]=s,C[14]=c},bm=function(P){var r=P[0],i=P[1],g=P[2],Y=P[3],e=P[4],s=P[5],$=P[6],q=P[7],w=P[8],c=P[9],k=P[10],H=P[11],O=P[12],T=P[13],W=P[14],o=P[15],A=r*s-i*e,p=r*$-g*e,m=r*q-Y*e,Z=i*$-g*s,t=i*q-Y*s,h=g*q-Y*$,a=w*T-c*O,I=w*W-k*O,z=w*o-H*O,C=c*W-k*T,j=c*o-H*T,M=k*o-H*W,y=A*M-p*j+m*C+Z*z-t*I+h*a;return y?(y=1/y,P[0]=(s*M-$*j+q*C)*y,P[1]=(g*j-i*M-Y*C)*y,P[2]=(T*h-W*t+o*Z)*y,P[3]=(k*t-c*h-H*Z)*y,P[4]=($*z-e*M-q*I)*y,P[5]=(r*M-g*z+Y*I)*y,P[6]=(W*m-O*h-o*p)*y,P[7]=(w*h-k*m+H*p)*y,P[8]=(e*j-s*z+q*a)*y,P[9]=(i*z-r*j-Y*a)*y,P[10]=(O*t-T*m+o*A)*y,P[11]=(c*m-w*t-H*A)*y,P[12]=(s*I-e*C-$*a)*y,P[13]=(r*C-i*I+g*a)*y,P[14]=(T*p-O*Z-W*A)*y,P[15]=(w*Z-c*p+k*A)*y,void 0):R},ud=function(e,U){if(U){var _=U[0],F=U[1],l=U[2];e[12]=e[0]*_+e[4]*F+e[8]*l+e[12],e[13]=e[1]*_+e[5]*F+e[9]*l+e[13],e[14]=e[2]*_+e[6]*F+e[10]*l+e[14],e[15]=e[3]*_+e[7]*F+e[11]*l+e[15]}},ni=function(Z,w){if(w){var x=w[0],P=w[1],I=w[2];Z[0]=Z[0]*x,Z[1]=Z[1]*x,Z[2]=Z[2]*x,Z[3]=Z[3]*x,Z[4]=Z[4]*P,Z[5]=Z[5]*P,Z[6]=Z[6]*P,Z[7]=Z[7]*P,Z[8]=Z[8]*I,Z[9]=Z[9]*I,Z[10]=Z[10]*I,Z[11]=Z[11]*I}},le=function(B,g,a){var y=g[0],J=g[1],K=g[2],V=g[3],u=g[4],b=g[5],i=g[6],N=g[7],Q=g[8],q=g[9],U=g[10],o=g[11],W=g[12],p=g[13],D=g[14],L=g[15],T=a[0],n=a[1],_=a[2],Y=a[3];return B[0]=T*y+n*u+_*Q+Y*W,B[1]=T*J+n*b+_*q+Y*p,B[2]=T*K+n*i+_*U+Y*D,B[3]=T*V+n*N+_*o+Y*L,T=a[4],n=a[5],_=a[6],Y=a[7],B[4]=T*y+n*u+_*Q+Y*W,B[5]=T*J+n*b+_*q+Y*p,B[6]=T*K+n*i+_*U+Y*D,B[7]=T*V+n*N+_*o+Y*L,T=a[8],n=a[9],_=a[10],Y=a[11],B[8]=T*y+n*u+_*Q+Y*W,B[9]=T*J+n*b+_*q+Y*p,B[10]=T*K+n*i+_*U+Y*D,B[11]=T*V+n*N+_*o+Y*L,T=a[12],n=a[13],_=a[14],Y=a[15],B[12]=T*y+n*u+_*Q+Y*W,B[13]=T*J+n*b+_*q+Y*p,B[14]=T*K+n*i+_*U+Y*D,B[15]=T*V+n*N+_*o+Y*L,B},zi=function(n,V,o,x){var X,f,N,Y,w,j,c,J,u,q,L=V[0],g=V[1],t=V[2],U=x[0],z=x[1],b=x[2],S=o[0],D=o[1],e=o[2];return Q(L-S)<Hj&&Q(g-D)<Hj&&Q(t-e)<Hj?Pr(n):(c=L-S,J=g-D,u=t-e,q=1/Z(c*c+J*J+u*u),c*=q,J*=q,u*=q,X=z*u-b*J,f=b*c-U*u,N=U*J-z*c,q=Z(X*X+f*f+N*N),q?(q=1/q,X*=q,f*=q,N*=q):(X=0,f=0,N=0),Y=J*N-u*f,w=u*X-c*N,j=c*f-J*X,q=Z(Y*Y+w*w+j*j),q?(q=1/q,Y*=q,w*=q,j*=q):(Y=0,w=0,j=0),n[0]=X,n[1]=Y,n[2]=c,n[3]=0,n[4]=f,n[5]=w,n[6]=J,n[7]=0,n[8]=N,n[9]=j,n[10]=u,n[11]=0,n[12]=-(X*L+f*g+N*t),n[13]=-(Y*L+w*g+j*t),n[14]=-(c*L+J*g+u*t),n[15]=1,n)},Fg=function($,A,h,D,Z){var p=1/E(A/2),o=1/(D-Z);return $[0]=p/h,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=p,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=(Z+D)*o,$[11]=-1,$[12]=0,$[13]=0,$[14]=2*Z*D*o,$[15]=0,$},pb=function(I,s,K,C,k,g,v){var V=1/(s-K),$=1/(C-k),O=1/(g-v);return I[0]=-2*V,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=-2*$,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=2*O,I[11]=0,I[12]=(s+K)*V,I[13]=(k+C)*$,I[14]=(v+g)*O,I[15]=1,I},Gk=function(D,b){var u=b[0],F=b[1],Q=b[2],r=b[3],i=u*u+F*F+Q*Q+r*r,_=i?1/i:0;return D[0]=-u*_,D[1]=-F*_,D[2]=-Q*_,D[3]=r*_,D},mi=function(C,Z){var x=Z[0]+Z[5]+Z[10],T=0;return x>0?(T=2*Math.sqrt(x+1),C[3]=.25*T,C[0]=(Z[6]-Z[9])/T,C[1]=(Z[8]-Z[2])/T,C[2]=(Z[1]-Z[4])/T):Z[0]>Z[5]&Z[0]>Z[10]?(T=2*Math.sqrt(1+Z[0]-Z[5]-Z[10]),C[3]=(Z[6]-Z[9])/T,C[0]=.25*T,C[1]=(Z[1]+Z[4])/T,C[2]=(Z[8]+Z[2])/T):Z[5]>Z[10]?(T=2*Math.sqrt(1+Z[5]-Z[0]-Z[10]),C[3]=(Z[8]-Z[2])/T,C[0]=(Z[1]+Z[4])/T,C[1]=.25*T,C[2]=(Z[6]+Z[9])/T):(T=2*Math.sqrt(1+Z[10]-Z[0]-Z[5]),C[3]=(Z[1]-Z[4])/T,C[0]=(Z[8]+Z[2])/T,C[1]=(Z[6]+Z[9])/T,C[2]=.25*T),C},Qi=function(j,k,x){var X=k[0],s=k[1],R=k[2],o=k[3],w=X+X,O=s+s,B=R+R,l=X*w,c=X*O,n=X*B,E=s*O,e=s*B,H=R*B,A=o*w,Y=o*O,P=o*B;return j[0]=1-(E+H),j[1]=c+P,j[2]=n-Y,j[3]=0,j[4]=c-P,j[5]=1-(l+H),j[6]=e+A,j[7]=0,j[8]=n+Y,j[9]=e-A,j[10]=1-(l+E),j[11]=0,j[12]=x[0],j[13]=x[1],j[14]=x[2],j[15]=1,j},Dp=function(a,c){return zi(c?c:uo(),a._eye,a._center,a._up)},Sf=function(Y){var s=Y.getAspect(),w=Y._near,$=Y._far,R=uo();if(Y._ortho){var F=Y._orthoWidth/2,q=F/s;pb(R,-F,F,-q,q,w,$)}else Fg(R,Y._fovy,s,w,$);return R},ps=function(T,w){if(!T)return R;var i=0,N=1,r=2,F=[],B=0,P=T.length,J=P/3;if(w){for(;P>B;B++)F[B]=0;for(B=0;B<w.length;B+=3){var g=[],p=[],s=[];g[i]=T[3*w[B+1]+i]-T[3*w[B]+i],g[N]=T[3*w[B+1]+N]-T[3*w[B]+N],g[r]=T[3*w[B+1]+r]-T[3*w[B]+r],p[i]=T[3*w[B+2]+i]-T[3*w[B+1]+i],p[N]=T[3*w[B+2]+N]-T[3*w[B+1]+N],p[r]=T[3*w[B+2]+r]-T[3*w[B+1]+r],s[i]=g[N]*p[r]-g[r]*p[N],s[N]=g[r]*p[i]-g[i]*p[r],s[r]=g[i]*p[N]-g[N]*p[i];for(var x=0;3>x;x++)F[3*w[B+x]+i]+=s[i],F[3*w[B+x]+N]+=s[N],F[3*w[B+x]+r]+=s[r]}}else for(B=0;J>B;B+=3){var g=[],p=[],s=[];g[i]=T[3*(B+1)+i]-T[3*B+i],g[N]=T[3*(B+1)+N]-T[3*B+N],g[r]=T[3*(B+1)+r]-T[3*B+r],p[i]=T[3*(B+2)+i]-T[3*(B+1)+i],p[N]=T[3*(B+2)+N]-T[3*(B+1)+N],p[r]=T[3*(B+2)+r]-T[3*(B+1)+r],s[i]=g[N]*p[r]-g[r]*p[N],s[N]=g[r]*p[i]-g[i]*p[r],s[r]=g[i]*p[N]-g[N]*p[i];for(var x=0;3>x;x++)F[3*(B+x)+i]=s[i],F[3*(B+x)+N]=s[N],F[3*(B+x)+r]=s[r]}for(B=0;P>B;B+=3){var t=[];t[i]=F[B+i],t[N]=F[B+N],t[r]=F[B+r];var K=Z(t[i]*t[i]+t[N]*t[N]+t[r]*t[r]);0===K&&(K=Hj),t[i]=t[i]/K,t[N]=t[N]/K,t[r]=t[r]/K,F[B+i]=t[i],F[B+N]=t[N],F[B+r]=t[r]}return new mj(F)},Qd=function(K,l,g){if(g||(g=K.createTexture()),l){var P=K.TEXTURE_2D,m=K.LINEAR,b=K.REPEAT,A=K.CLAMP_TO_EDGE,y=K.TEXTURE_MIN_FILTER;Mq(K,g),K.texImage2D(P,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,l),Dl(K,K.TEXTURE_MAG_FILTER,m),rr(l.width)&&rr(l.height)?(Dl(K,K.TEXTURE_WRAP_S,b),Dl(K,K.TEXTURE_WRAP_T,b),Dl(K,y,K.LINEAR_MIPMAP_LINEAR),K.generateMipmap(P)):(Dl(K,K.TEXTURE_WRAP_S,A),Dl(K,K.TEXTURE_WRAP_T,A),Dl(K,y,m)),Mq(K,R)}return g},qd=function(v,Y){var k=new Uint8Array(3);return Y=Y||v.createTexture(),Mq(v,Y),Dl(v,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texImage2D(v.TEXTURE_2D,0,v.RGB,1,1,0,v.RGB,v.UNSIGNED_BYTE,k),Y},Uh=function(D){D._26I&&D._prg&&(D._26I.deleteProgram(D._prg),D._prg=R)},kh=function(r,i,D,L){var e=r.createShader(D);return r.shaderSource(e,L),r.compileShader(e),r.attachShader(i,e),e},Gp=function(z){return z.createBuffer()},Mq=function(i,h){i.bindTexture(i.TEXTURE_2D,h)},Th=function(Z,M){Z.bindFramebuffer(Z.FRAMEBUFFER,M)},Dl=function(g,I,U){g.texParameteri(g.TEXTURE_2D,I,U)},yk=function(f,a){if(a){var a=no(a);f.clearColor(a[0],a[1],a[2],a[3])}},_q=function(l,p){$q(l,p.uFix,!0),Sp(l,p.aNormal)},Mm=function(w,t){$q(w,t.uFix,!1),ie(w,t.aNormal)},Qg=function(V,u,F,G,U,B,x,T){V._picking||(F?($q(V,u.uBlend,!0),$q(V,u.uBlendColor,F)):$q(V,u.uBlend,!1),$q(V,u.uLight,G==R?!0:G),kj(U)&&1!==U&&$q(V,u.uPartOpacity,U),$q(V,u.uReverseFlip,B==R?!1:B),$q(V,u.uFixPickReverseColor,x||zl)),T?V.enable(V.CULL_FACE):V.disable(V.CULL_FACE)},vf=function(j,H){j._picking||$q(j,H.uPartOpacity,1)},ae=function(B,r,H,J,M,Y,y,E){if(!H)return Mq(B,B._emptyTexture),void 0;$q(B,r.uTexture,!0),$q(B,r.uDiscardSelectable,nj(J)?J:!0),ie(B,r.aUv),xo(B,M,Y,r.aUv,2),B.activeTexture(B.TEXTURE0),Mq(B,H),B.uniform1i(r.uSampler,0);var a=[0,0,1,1];y&&(a[0]=y[0],a[1]=y[1]),E&&(a[2]=E[0],a[3]=E[1]),$q(B,r.uOffsetScale,a)},Ml=function(l,y,E){Mq(l,R),E&&(Sp(l,y.aUv),$q(l,y.uTexture,!1))},zp=function(K,L,b,V,x,w){!b||C||S||K.lineWidth(b),V&&!K._picking&&$q(K,L.uFixPickReverseColor,V),x&&xo(K,x,w,L.aPosition)},wh=function(g,I,D,y){Wn&&(y=g[Wn]),g.drawArrays(y==R?g.TRIANGLES:y,I,D)},hi=function(J,K,L,s){Wn&&(s=J[Wn]),J.drawElements(s==R?J.TRIANGLES:s,L,J.UNSIGNED_SHORT,K==R?0:2*K)},xo=function(H,A,E,Y,h){var m=H.ARRAY_BUFFER;H.bindBuffer(m,A),E&&H.bufferData(m,E,H.STATIC_DRAW),Y!=R&&H.vertexAttribPointer(Y,h?h:3,H.FLOAT,!1,0,0)},Pk=function(u,K,S){var E=u.ELEMENT_ARRAY_BUFFER;u.bindBuffer(E,K),S&&u.bufferData(E,S,u.STATIC_DRAW)},$q=function(j,c,u){if(u!=R&&c!=R){u=no(u);var N=u.length;3===N?j.uniform3fv(c,u):4===N?j.uniform4fv(c,u):16===N?j.uniformMatrix4fv(c,!1,u):nj(u)?j.uniform1i(c,u?1:0):2===N?j.uniform2fv(c,u):j.uniform1f(c,u)}},ie=function(j,r){r!=R&&r>=0&&j.enableVertexAttribArray(r)},Sp=function(L,h){h!=R&&h>=0&&L.disableVertexAttribArray(h)},Rh=function(W,J){var m=W.getGL(),f=W._prg;W._7O=W._8O.pop(),J&&($q(m,f.uMVMatrix,W._7O),W._6O=J,$q(m,f.uNMatrix,J))},kg=function(h,o){return o||(o=uo()),Gm(o,h),bm(o),hs(o),o},Rn=function(V,Z){var C=V.getGL(),F=V._prg,P=V._7O;Z&&(V._8O.push(Kj(P)),le(P,P,Z)),$q(C,F.uMVMatrix,P),$q(C,F.uNMatrix,kg(P,V._6O))},rs=function(S,J,N,u,q,t){if(N){if(u){var a=N.value++,w=[(255&a>>24)/255,(255&a>>16)/255,(255&a>>8)/255,(255&a)/255];N[a]={data:q,part:t}}else w=Gc;return $q(S,J.uFixPickReverseColor,w),w}},si=function(){var T={center:function(e,B,i,I,u){var N=B[1]/2,W={x:-B[0]/2,y:N,width:B[0],height:B[1]},q=mp(e,W,i);return[q.x+I,2*N-q.y-u,sg()]},front:function(t,h,a,p,A){var e=h[1]/2,$={x:-h[0]/2,y:e,width:h[0],height:h[1]},T=mp(t,$,a);return[T.x+p,2*e-T.y-A,h[2]/2+sg()]},back:function(P,S,C,y,p){var N=S[0]/2,c=S[1]/2,F={x:N,y:c,width:S[0],height:S[1]},o=mp(P,F,C);return[2*N-o.x-y,2*c-o.y-p,-S[2]/2-sg()]},left:function(w,h,Z,U,K){var n=h[1]/2,i={x:-h[2]/2,y:n,width:h[2],height:h[1]},$=mp(w,i,Z);return[-h[0]/2-sg(),2*n-$.y-K,$.x+U]},right:function(w,M,e,c,W){var h=M[2]/2,A=M[1]/2,r={x:h,y:A,width:M[2],height:M[1]},T=mp(w,r,e);return[M[0]/2+sg(),2*A-T.y-W,2*h-T.x-c]},top:function(M,T,r,v,p){var R={x:-T[0]/2,y:-T[2]/2,width:T[0],height:T[2]},t=mp(M,R,r);return[t.x+v,T[1]/2+sg(),t.y+p]},bottom:function(G,I,S,J,D){var w=I[2]/2,c={x:-I[0]/2,y:w,width:I[0],height:I[2]},i=mp(G,c,S);return[i.x+J,-I[1]/2-sg(),2*w-i.y-D]
}};return function(P,p,K,s,C,t){return T[s](P,p,K,C||0,t||0)}}(),Wc=function(T,O,x,N,Q,l,I,i,D,k){if(Q&&(O[0]+=Q[0],O[1]+=Q[1],O[2]+=Q[2]),ud(T,x),i){var e=uo();if(Kk(e,D,k),xl(O,e),ud(T,O),T.auto=i,T.pos=xl([0,0,0],T),l){var r=T.mat2=uo();Kk(r,l,I)}}else Kk(T,D,k),ud(T,O),N===Ai?sc(T,-G):N===Br?sc(T,G):N===Id?bp(T,-G):N===Zf?bp(T,G):N===vr&&sc(T,u),Kk(T,l,I);return T},Pd=function(e,C){var D=C.auto,h=C.mat2,n=e.gv;if(D){var Y,K=uo(),s=[0,0,0,0];Y="string"==typeof D?[D.indexOf("x")<0?n._eye[0]:n._center[0],D.indexOf("y")<0?n._eye[1]:n._center[1],D.indexOf("z")<0?n._eye[2]:n._center[2]]:n._eye,mi(s,zi(uo(),Y,n._center,n._up)),Qi(K,Gk(s,s),C.pos),h&&le(K,K,h),Rn(n,K)}else Rn(n,C)},hp=function(h,g,m,P,e){var E=h.s,L=h.gv,q=L.getGL(),U=L._prg,_=L._buffer,W=L._1O;Qd(q,fd,W),Pd(h,m),Qg(q,U,E(g+".blend"),E(g+".light"),E(g+".opacity"),E(g+".reverse.flip"),E(g+".reverse.color"),E(g+".reverse.cull")),ae(q,U,W,e,_.uv,Oj),xo(q,_.vs,P,U.aPosition),xo(q,_.ns,rp,U.aNormal),Pk(q,_.is,Od),hi(q,0,Od.length),Ml(q,U,W),vf(q,U),Rh(L)},be=function(y,g,N){var r=y.gv,h=y.data,L=y[g]={blend:r.getBodyColor(h)||r.getFaceBlend(h,g),light:r.getFaceLight(h,g),color:r.getFaceColor(h,g),opacity:r.getFaceOpacity(h,g),transparent:r.getFaceTransparent(h,g),reverseFlip:r.getFaceReverseFlip(h,g),reverseColor:r.getFaceReverseColor(h,g),reverseCull:r.getFaceReverseCull(h,g),texture:r.getFaceImage(h,g),discardSelectable:r.getFaceDiscardSelectable(h,g)};if("csg"!==g){L.uv=r.getFaceUv(h,g)||N&&N[g+"Uv"],L.uvScale=r.getFaceUvScale(h,g)||N&&N[g+"UvScale"],L.uvOffset=r.getFaceUvOffset(h,g)||N&&N[g+"UvOffset"];var m=r.getFaceMat(h,g);m&&(L.mat=gj(h,m))}return L},Ar=function(R,X,t,V,J){if(V){if(!J(V.transparent))return;var n=R.data,_=R.gv,C=_._buffer,m=_.getTexture(V.texture,n);ae(X,t,m,V.discardSelectable,C.uv,V.tuv,V.uvOffset,V.uvScale),Qg(X,t,V.blend,V.light,V.opacity,V.reverseFlip,V.reverseColor,V.reverseCull),$q(X,t.uDiffuse,V.color),xo(X,C.vs,V.vs,t.aPosition),xo(X,C.ns,V.ns,t.aNormal),wh(X,0,V.vs.length/3),vf(X,t),Ml(X,t,m)}},th=function(f,U,k,y,S,n){var w,l,M,H,t,r,G,C,g,i,d,e=[y-U,S-k],X=f?f.length:0;for(M=0;X>M;M++){for(H=2,w=f[M],t=w[0],r=w[1];H+1<w.length;){if(G=w[H],C=w[H+1],l=wp(U,k,y,S,t,r,G,C,!0)){g=[G-t,C-r],i=Tr(g),g[0]/=i,g[1]/=i,i=dj(e,g),i=i>0?n:-n,d=[g[0]*i,g[1]*i];break}t=G,r=C,H+=2}if(d)break}if(d)for(y=U+d[0],S=k+d[1],M=0;X>M;M++)for(H=2,w=f[M],t=w[0],r=w[1];H+1<w.length;){if(G=w[H],C=w[H+1],l=wp(U,k,y,S,t,r,G,C,!0))return[0,0];t=G,r=C,H+=2}return d?d:[y-U,S-k]},Mh=K.graph3d={},jm=function(q,_,O){jl(d+".graph3d."+q,_,O)},oe="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~!gjeof$!~~<*^j]opjujtpQupqTw!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEupqTw<**1/2!-^j]sfuofDupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQupqTv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQupqTw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~<**1/2!-^j]opjujtpQuojpQv)5dfw!+!yjsubNxfjWv)4dfw!>!^j]opjujtpQuojpQw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<*opjujtpQsje!.!sfuofd)f{jmbnspo!>!^j]opjudfsjEsjEw<**1/2!-1/1!-1/1!-1/1)5dfw!+!yjsubNxfjWv)4dfw!>!sfuofd!4dfw<**1/2!-^j]opjujtpQsjEv)5dfw!+!yjsubNxfjWv)4dfw!>!opjujtpQsje!4dfw|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]sfuofDupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]opjujtpQsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Ic="~~<eJ!>!spmpDhbsG`mh!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTw)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQw!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEw)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~<1/2!>!b/spmpDwv|ftmf~<esbdtje|*5/1!=!b/spmpDwv)gj|ftmf~~<esbdtje|*1/1!>>!b/spmpDwv)gj|*uofsbqtobsUv)gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTw!4dfw!hojzsbw<^UPQT`YBN]opjujtpQupqTw!4dfw!hojzsbw<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQw!4dfw!hojzsbw<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEw!4dfw!hojzsbw<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUv!mppc!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Jn(M,{setBatchInfo:function(B,D){qn[B]=D},getBatchInfo:function(J){return qn[J]}},!0);var xk=[1,1,1],$o=[1,0,0,0,0,1,0,1,1,1,1,0],il=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],cr=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],ym=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],_j=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],ai=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Ah=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],an=function(a,m){Kh(a,m),Kp(a,m,"_wireframeModelMap","_wireframeIndexMap"),Kp(a,m,"_polylineModelMap","_polylineIndexMap")},Kh=function(y,c){if(c){var x,r,a=c._id,Z=y._33O,B=y._34O,X=B[a];if(X){r=X.batch,x=Z[r];var A=X.begin,V=X.size,N=3*A,d=3*V,I=4*A,K=4*V,W=x.vs,E=x.uv,D=x.cs,p=x.bs,f=x.rs,s=x.ds,F=X.index;if(x.invalidate=!0,delete B[a],s.splice(F,1),ao(s))delete Z[r];else{for(;F<s.length;F++)X=B[s[F]._id],X.index--,X.begin-=V;W.splice(N,d),x.ns.splice(N,d),x.ps.splice(I,K),E&&E.splice(2*A,2*V),D&&D.splice(I,K),p&&p.splice(N,d),f&&f.splice(A,V)}}}else y._34O={},y._33O={}},Kp=function($,d,z,o){if(d){var w,s,g=d._id,D=$[z],A=$[o],S=A[g];if(S){s=S.batch,w=D[s];var k=S.begin,Q=S.size,h=3*k,c=3*Q,N=4*k,a=4*Q,Z=w.ds,u=S.index;if(w.invalidate=!0,delete A[g],Z.splice(u,1),ao(Z))delete D[s];else{for(;u<Z.length;u++)S=A[Z[u]._id],S.index--,S.begin-=Q;w.vs.splice(h,c),w.cs.splice(N,a),w.ps.splice(N,a),w.ls&&w.ls.splice(k,Q)}}}else $[z]={},$[o]={}},Er=function(s,W,p,w){if(!w)return R;var N=W[w];if(!N){var $=qn[w]||Rm,B=$.image?[]:R;N=W[w]={vs:[],ns:[],uv:B,cs:B?R:$.color?R:[],bs:$.blend?[]:R,ps:[],rs:$.brightness?[]:R,ds:[]}}return N.invalidate=!0,s[p._id]={index:N.ds.length,begin:N.vs.length/3,batch:w},N.ds.push(p),N},Uk=function(H,s){return s!=R&&1!==s?[H[0]*s,H[1]*s,H[2]*s,H[3]]:H},$e=function(x,L,M){var l=x.getBrightness(L),G=no(M.color||"white"),P=G[3]<1,Q=Math.ceil(M.width)||1,N=(P?"T":"O")+Q,r=x._wireframeIndexMap,v=x._wireframeModelMap,O=v[N];O||(O=v[N]={vs:[],cs:[],ps:[],ds:[],T:P,W:Q}),O.invalidate=!0;var u=O.vs,e=O.cs,W=O.ds,p=r[L._id]={index:W.length,begin:u.length/3,batch:N};W.push(L),Tq(u,gj(L,M.mat),M.short?gq:nb);var f=p.size=u.length/3-p.begin;sn(e,Uk(G,l),f)},So=function(U,T,o,X,Y,W,h,y,H){var J=U.getBrightness(T);J==R&&(J=1);var v=Uk(no(X),J),l=v[3]<1;W=Math.ceil(W)||1;var Q=(l?"T":"O")+W;if(h){var z=h[0],f=(h[1]||z)+z;Q+="-"+z+"-"+f,H&&(Q+="-"+pq(H)+"-"+J,H=Uk(no(H),J))}var r=U._polylineIndexMap,g=U._polylineModelMap,Z=g[Q];Z||(Z=g[Q]={vs:[],cs:[],ps:[],ds:[],ls:h?[]:R,T:l,W:W},h&&(Z.D=z,Z.G=f,Z.A=H)),Z.invalidate=!0;var $,_=Z.vs,j=Z.cs,B=Z.ds,P=Z.ls,s=r[T._id]={index:B.length,begin:_.length/3,batch:Q};B.push(T),Vk(_,o);var O,K=s.size=_.length/3-s.begin,p=o.length,C=0,M=[];if(h||Y)for($=0;p>$;$+=6)O=Tr([o[$],o[$+1],o[$+2]],[o[$+3],o[$+4],o[$+5]]),M.push(O),C+=O;if(C&&Y){var A,F=Uk(no(Y),J),m=[F[0]-v[0],F[1]-v[1],F[2]-v[2],F[3]-v[3]],t=0;for($=0;p>$;$+=6)A=t/C,sn(j,[v[0]+m[0]*A,v[1]+m[1]*A,v[2]+m[2]*A,v[3]+m[3]*A],1),t+=M[$/6],A=t/C,sn(j,[v[0]+m[0]*A,v[1]+m[1]*A,v[2]+m[2]*A,v[3]+m[3]*A],1)}else sn(j,v,K);if(h)for(t=y||0,$=0;p>$;$+=6)P.push(t),t+=M[$/6],P.push(t)},zd=function(g,M,c){if(M)for(var W=4*M.begin,K=c[M.batch].ps,n=0;n<M.size;n++)K[W++]=g[0],K[W++]=g[1],K[W++]=g[2],K[W++]=g[3]},gn=function(Z,F){var N=F+["32"],R=Z[F],a=Z[N];R?a&&a.length===R.length?a.set(R):Z[N]=new mj(R):delete Z[N]},pf=function(C,y,K,v,S,W,c,x,H){if(dr(K))K.forEach(function(p){pf(C,y,p,v,S,W,c,x,H)});else if(Bn(K))pf(C,y,hj(v,K),v,S,W,c,x,H);else if(zr(K)){var T,A=Sl(K.mat,y,C),E=Sl(K.s3,y,C),w=Sl(K.t3,y,C),l=Sl(K.r3,y,C);if((E||l||w||A)&&(T=td(A,E,l,Sl(K.rotationMode,y,C),w),W.push(T)),K.shape3d)pf(C,y,K.shape3d,v,S,W,c,x,K);else{var M=v.s;H=H||Rm;var b=W[0],u=W.length,q=M("shape3d.color",K.color,H.color);if(S||(S=M("shape3d.blend",K.blend,H.blend)),u>1){b=Kj(b);for(var $=1;u>$;$++)le(b,b,W[$])}K.vs&&M(Mg,K.visible,H.visible)&&kk(b,c,x,K.vs,K.uv,K.is,S,q),K.top_vs&&M(Yq,K.topVisible,H.topVisible)&&kk(b,c,x,K.top_vs,K.top_uv,K.top_is,S,M("shape3d.top.color",K.topColor,H.topColor)||q),K.bottom_vs&&M(Wl,K.bottomVisible,H.bottomVisible)&&kk(b,c,x,K.bottom_vs,K.bottom_uv,K.bottom_is,S,M("shape3d.bottom.color",K.bottomColor,H.bottomColor)||q),K.from_vs&&M(cl,K.fromVisible,H.fromVisible)&&kk(b,c,x,K.from_vs,K.from_uv,K.from_is,S,M("shape3d.from.color",K.fromColor,H.fromColor)||q),K.to_vs&&M(Yk,K.toVisible,H.toVisible)&&kk(b,c,x,K.to_vs,K.to_uv,K.to_is,S,M("shape3d.to.color",K.toColor,H.toColor)||q)}T&&W.pop()}},kk=function(R,k,z,b,x,T,O,s){var h,p=k.cs,q=k.uv,Q=k.bs;if(T){h=T.length;for(var H=0;h>H;H++){var P=T[H];Tq(z,R,[b[3*P],b[3*P+1],b[3*P+2]]),q&&Vk(q,[x[2*P],x[2*P+1]])}}else h=b.length/3,Tq(z,R,b),q&&Vk(q,x);p&&sn(p,s,h),Q&&(O?Ph(Q,O,h):Vk(Q,xk,h))},Ed=function(V,n,h,F){var f=[];F?pf(V.gv,V.data,F,V,V.getBodyColor(),[n],h,f):(No(V,Ai,n,h,f),No(V,Br,n,h,f),No(V,rh,n,h,f),No(V,vr,n,h,f),No(V,Id,n,h,f),No(V,Zf,n,h,f),No(V,"csg",n,h,f)),f.length&&(Vk(h.vs,f),Vk(h.ns,ps(f)))},No=function(x,g,r,I,F){var k=x[g];if(k){var C=k.tuv;if(C){var Q,h,j,q,E=k.uvScale,V=k.uvOffset;if(E)for(Q=C.length,h=E[0],j=E[1],q=0;Q>q;q+=2)C[q]*=h,C[q+1]*=j;if(V)for(Q=C.length,h=V[0],j=V[1],q=0;Q>q;q+=2)C[q]+=h,C[q+1]+=j}kk(r,I,F,k.vs,C,R,k.blend,k.color)}},gp=function(q,$,_,f,J,i,B,d){var X,E=_.cs,y=_.uv,F=_.bs;if(q.getFaceVisible($,i)){var e=q.getFaceMat($,i);if(e&&(J=gj($,e)),Tq(B,J,d),E&&sn(E,q.getFaceColor($,i),6),y){var m=q.getFaceUv($,i)||f[i+"Uv"],n=q.getFaceUvScale($,i)||f[i+"UvScale"],K=q.getFaceUvOffset($,i)||f[i+"UvOffset"];m=m?[m[6],m[7],m[0],m[1],m[2],m[3],m[2],m[3],m[4],m[5],m[6],m[7]]:$o;var s=m[0],o=m[1],A=m[2],k=m[3],Q=m[4],C=m[5],a=m[6],l=m[7],P=m[8],x=m[9],c=m[10],V=m[11];if(n){var S=n[0],U=n[1];s*=S,o*=U,A*=S,k*=U,Q*=S,C*=U,a*=S,l*=U,P*=S,x*=U,c*=S,V*=U}if(K){var T=K[0],W=K[1];s+=T,o+=W,A+=T,k+=W,Q+=T,C+=W,a+=T,l+=W,P+=T,x+=W,c+=T,V+=W}y.push(s,o,A,k,Q,C,a,l,P,x,c,V)}F&&(X=q.getBodyColor($)||q.getFaceBlend($,i),X?Ph(F,X,6):Vk(F,xk,6))}},Zi=function(f,D,T,L){var W=f.getGL(),N=f._prg,K=f._buffer;if(!Pi(D)){Rn(f),_q(W,N);for(var E in D){var k=D[E];if(!(L&&!k.T||!L&&k.T)){k.invalidate?(k.invalidate=!1,gn(k,"vs"),gn(k,"cs"),gn(k,"ls"),gn(k,"ps")):T&&gn(k,"ps");var X=k.vs32,y=T?k.ps32:k.cs32;zp(W,N,k.W,R,K.vs,X);var u=k.D,i=!f._dashDisabled&&u;i&&($q(W,N.uDash,!0),$q(W,N.uDashDistance,u),$q(W,N.uDashGapDistance,k.G),ie(W,N.aLineDistance),xo(W,K.lineDistance,k.ls32,N.aLineDistance,1),$q(W,N.uDiffuse,k.A||ko));var d=!f._batchColorDisabled;d&&($q(W,N.uBatchColor,!0),ie(W,N.aBatchColor),xo(W,K.batchColor,y,N.aBatchColor,4)),ae(W),wh(W,0,X.length/3,W.LINES),Ml(W),d&&($q(W,N.uBatchColor,!1),Sp(W,N.aBatchColor)),i&&($q(W,N.uDash,!1),Sp(W,N.aLineDistance))}}Mm(W,N)}},lm=function(r,O,v){var S,p,B,H,a,M,e,g,V,C,o,c=r.getGL(),m=r._prg,f=r._buffer,T=r._33O;if(!Pi(T)){Rn(r);for(S in T)if(p=qn[S]||Rm,!(v&&!p.transparent||!v&&p.transparent)&&(B=T[S],O||!p.transparentMask)){var l=v&&p.autoSort!==!1&&(r._33Q||B.invalidate);if(B.invalidate?(B.invalidate=!1,gn(B,"vs"),gn(B,"ns"),gn(B,"cs"),gn(B,"rs"),gn(B,"ps"),gn(B,"bs"),gn(B,"uv")):O&&gn(B,"ps"),a=B.vs32,M=O?B.ps32:B.cs32,V=B.uv32,e=B.bs32,g=B.rs32,o=a.length/3,l&&(B.is=Yf(a,r.getEye())),o){H=p.light,C=r.getTexture(p.image),Qg(c,m,R,p.light,p.opacity,p.reverseFlip,p.reverseColor,p.reverseCull),M?r._batchColorDisabled||($q(c,m.uBatchColor,!0),ie(c,m.aBatchColor),xo(c,f.batchColor,M,m.aBatchColor,4)):$q(c,m.uDiffuse,p.color);var _=e&&!r._batchBlendDisabled;_&&($q(c,m.uBatchBlend,!0),ie(c,m.aBatchBlend),xo(c,f.batchBlend,e,m.aBatchBlend));var h=g&&!r._batchBrightnessDisabled;h&&($q(c,m.uBatchBrightness,!0),ie(c,m.aBatchBrightness),xo(c,f.batchBrightness,g,m.aBatchBrightness,1)),V?ae(c,m,C,p.discardSelectable,f.uv,V,p.uvOffset,p.uvScale):ae(c),xo(c,f.vs,a,m.aPosition),xo(c,f.ns,B.ns32,m.aNormal),B.is?(Pk(c,f.is,B.is),hi(c,0,o)):wh(c,0,o),V?Ml(c,m,C):Ml(c),M&&!r._batchColorDisabled&&($q(c,m.uBatchColor,!1),Sp(c,m.aBatchColor)),_&&($q(c,m.uBatchBlend,!1),Sp(c,m.aBatchBlend)),h&&($q(c,m.uBatchBrightness,!1),Sp(c,m.aBatchBrightness)),vf(c,m)}}}},Yf=function(Z,N){for(var l=Z.length/3,E=new Array(l),d=l/3,C=new Array(d),Y=0;d>Y;Y++)C[Y]=Y;C.sort(function(r,g){var w=9*r,n=[(Z[w]+Z[w+3]+2*Z[w+6])/4,(Z[w+1]+Z[w+4]+2*Z[w+7])/4,(Z[w+2]+Z[w+5]+2*Z[w+8])/4];w=9*g;var p=[(Z[w]+Z[w+3]+2*Z[w+6])/4,(Z[w+1]+Z[w+4]+2*Z[w+7])/4,(Z[w+2]+Z[w+5]+2*Z[w+8])/4],f=Tr(N,n)-Tr(N,p);return f>0?-1:0>f?1:0});for(var Y=0;d>Y;Y++){var e=3*Y,J=3*C[Y];E[e]=J,E[e+1]=J+1,E[e+2]=J+2}return new Dn(E)},Oj=new mj([0,0,0,1,1,1,1,0]),rp=new mj([0,0,1,0,0,1,0,0,1,0,0,1]),Od=new Dn([0,1,2,2,3,0]),Ig=new mj([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),sr=new Dn([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),zg=new mj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),te=new mj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Sj=ps(Ig,sr),nb=(new mj([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Dn([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),gq=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],yb=function(o,$,t,c,R,C){C=C||16,o=o||16,$=$||0,t=t||o;var S,A,y,K,w,r,g,f,N=.5,x=[],l=[],h=B/o,T=u/C;for(S=0;C>S;S++)for(w=S+1,K=S*T,f=w*T,A=$;t>A;A++)r=A+1,y=A*h,g=r*h,x.push(N*P(K)*_(y),N*_(K),-N*P(K)*P(y),N*P(f)*_(g),N*_(f),-N*P(f)*P(g),N*P(K)*_(g),N*_(K),-N*P(K)*P(g),N*P(K)*_(y),N*_(K),-N*P(K)*P(y),N*P(f)*_(y),N*_(f),-N*P(f)*P(y),N*P(f)*_(g),N*_(f),-N*P(f)*P(g)),l.push(A/o,S/C,r/o,w/C,r/o,S/C,A/o,S/C,A/o,w/C,r/o,w/C);if(c){var j=[],F=[];for(y=$*h,S=0;C>S;S++)w=S+1,K=S*T,f=w*T,j.push(0,0,0,N*P(f)*_(y),N*_(f),-N*P(f)*P(y),N*P(K)*_(y),N*_(K),-N*P(K)*P(y)),F.push(0,.5,$/o,w/C,$/o,S/C)}if(R){var O=[],W=[];for(y=t*h,S=0;C>S;S++)w=S+1,K=S*T,f=w*T,O.push(0,0,0,N*P(K)*_(y),N*_(K),-N*P(K)*P(y),N*P(f)*_(y),N*_(f),-N*P(f)*P(y)),W.push(1,.5,t/o,S/C,t/o,w/C)}return{vs:x,uv:l,from_vs:j,from_uv:F,to_vs:O,to_uv:W}},Bp=function(W,O,i){W=W||.17,O=O||12,i=i||18,0>W?W=0:W>.25&&(W=.25);var R,N,z,q,j,r,d,x=.5,H=[],Y=[],v=[],p=B/i,t=B/O,w=x-W;for(N=0;O>=N;N++)for(q=-u+N*t,r=_(q),j=P(q),R=0;i>=R;R++)z=R*p,d=w+W*r,H.push(_(z)*d,j*W,-P(z)*d),Y.push(R/i,1-N/O);for(N=0;O>N;N++){var I=N*(i+1),c=(N+1)*(i+1);for(R=0;i>R;R++)v.push(I+R,c+R+1,c+R,I+R,I+R+1,c+R+1)}return{vs:H,uv:Y,is:v}},jr=function(i,$,q,n,C,M,o){o=o||12,i=i||18,$=$||0,q=q||i,M=M||.17,0>M?M=0:M>.25&&(M=.25);var f,F,w,c,h,x,R,T,b,d,j=.5,y=[],V=[],U=B/i,A=B/o,k=j-M;for(w=0;o>w;w++)for(c=w+1,R=-u+w*A,T=-u+c*A,f=$;q>f;f++)F=f+1,h=f*U,x=F*U,b=k+M*_(R),d=k+M*_(T),y.push(_(h)*b,P(R)*M,-P(h)*b,_(x)*b,P(R)*M,-P(x)*b,_(x)*d,P(T)*M,-P(x)*d,_(h)*b,P(R)*M,-P(h)*b,_(x)*d,P(T)*M,-P(x)*d,_(h)*d,P(T)*M,-P(h)*d),V.push(f/i,1-w/o,F/i,1-w/o,F/i,1-c/o,f/i,1-w/o,F/i,1-c/o,f/i,1-c/o);if(n){var L=[],r=[];for(w=0;o>w;w++)c=w+1,R=-u+w*A,T=-u+c*A,h=$*U,b=k+M*_(R),d=k+M*_(T),L.push(_(h)*b,P(R)*M,-P(h)*b,_(h)*d,P(T)*M,-P(h)*d,_(h)*k,0,-P(h)*k),r.push(.5+.5*_(R),.5-.5*P(R),.5+.5*_(T),.5-.5*P(T),.5,.5)}if(C){var N=[],s=[];for(w=0;o>w;w++)c=w+1,R=-u+w*A,T=-u+c*A,h=q*U,b=k+M*_(R),d=k+M*_(T),N.push(_(h)*b,P(R)*M,-P(h)*b,_(h)*k,0,-P(h)*k,_(h)*d,P(T)*M,-P(h)*d),s.push(.5-.5*_(R),.5-.5*P(R),.5,.5,.5-.5*_(T),.5-.5*P(T))}return{vs:y,uv:V,from_vs:L,from_uv:r,to_vs:N,to_uv:s}},ze=function(Z,p){for(var e,o,E,W=.5,s=16,c=[],m=[],k=[],J=B/s,U=0;s>=U;U++)e=U*J,o=_(e)*W,E=P(e)*W,c.push(o,-W,E,o,W,E),m.push(1-U/s,1,1-U/s,0);for(U=0;s>U;U++)k.push(2*U,2*U+1,2*U+3,2*U,2*U+3,2*U+2);if(p){var M=[],Q=[],l=[];for(M.push(0,-W,0),Q.push(.5,.5),U=0;s>=U;U++)e=U*J,o=_(e),E=P(e),M.push(o*W,-W,-E*W),Q.push(.5+.5*o,.5+.5*E);for(U=0;s>U;U++)l.push(0,U+2,U+1)}if(Z){var h=[],D=[],a=[];for(h.push(0,W,0),D.push(.5,.5),U=0;s>=U;U++)e=U*J,o=_(e),E=P(e),h.push(o*W,W,-E*W),D.push(.5+.5*o,.5-.5*E);for(U=0;s>U;U++)a.push(0,U+1,U+2)}return{vs:c,uv:m,is:k,bottom_vs:M,bottom_uv:Q,bottom_is:l,top_vs:h,top_uv:D,top_is:a}},tm=function(C,g,A,w,L,N,z){C=C||12,g=g||0,A=A||C;for(var Q,o,v,b,q,s,e,c,V=.5,R=[],j=[],S=B/C,i=g;A>i;i++)Q=i+1,o=i*S,v=Q*S,b=_(o)*V,q=P(o)*V,s=_(v)*V,e=P(v)*V,R.push(b,-V,-q,s,-V,-e,b,V,-q,s,-V,-e,s,V,-e,b,V,-q),j.push(i/C,1,Q/C,1,i/C,0,Q/C,1,Q/C,0,i/C,0);if(z){var I=[],k=[];for(i=g;A>i;i++)o=S*i,v=S*(i+1),b=_(o),q=P(o),s=_(v),e=P(v),I.push(b*V,-V,-q*V,0,-V,0,s*V,-V,-e*V),k.push(.5+.5*b,.5+.5*q,.5,.5,.5+.5*s,.5+.5*e)}if(N){var t=[],G=[];for(i=g;A>i;i++)o=S*i,v=S*(i+1),b=_(o),q=P(o),s=_(v),e=P(v),t.push(b*V,V,-q*V,s*V,V,-e*V,0,V,0),G.push(.5+.5*b,.5-.5*q,.5+.5*s,.5-.5*e,.5,.5)}if(w){var H=[],r=[];o=S*g,b=_(o)*V,q=P(o)*V,c=g/C,H.push(0,V,0,0,-V,0,b,-V,-q,b,-V,-q,b,V,-q,0,V,0),r.push(0,0,0,1,c,1,c,1,c,0,0,0)}if(L){var J=[],a=[];o=S*A,b=_(o)*V,q=P(o)*V,c=A/C,J.push(0,-V,0,0,V,0,b,V,-q,b,V,-q,b,-V,-q,0,-V,0),a.push(1,1,1,0,c,0,c,0,c,1,1,1)}return{vs:R,uv:j,bottom_vs:I,bottom_uv:k,top_vs:t,top_uv:G,from_vs:H,from_uv:r,to_vs:J,to_uv:a}},ok=function(Q,O,q,J,x){O=O||18,q=q||0,J=J==R?B:J,x=x==R?.5:x;for(var S,f,e,r,T,H,M=[0,.5,.75,.875,.9375],D=[],y=[],C=[],E=J/O,I=0;I<M.length;I++){var n=0===I%2?0:.5;for(S=0;O>=S;S++)f=(S+n)*E+q,e=1-M[I],D.push(_(f)*x*e,-x+2*M[I]*x,-P(f)*x*e),y.push((S+n)/O,e)}for(I=0;I<M.length-1;I++){var N=I*(O+1),t=(I+1)*(O+1);for(S=0;O>S;S++)C.push(N+S,t+S+1,t+S,N+S,N+S+1,t+S+1)}for(H=D.length/3-(O+1),S=0;O>S;S++)D.push(0,x,0),y.push((S+.5)/O,0);for(S=0;O>S;S++)C.push(H+S,H+S+1,H+(O+1)+S);if(Q){var A=[],u=[],X=[];for(A.push(0,-x,0),u.push(.5,.5),S=0;O>=S;S++)f=S*E+q,r=_(f),T=P(f),A.push(r*x,-x,-T*x),u.push(.5+.5*r,.5+.5*T);for(S=0;O>S;S++)X.push(0,S+2,S+1)}return{vs:D,uv:y,is:C,bottom_vs:A,bottom_uv:u,bottom_is:X}},bf=function(W,k,D,m,i,K){W=W||16,k=k||0,D=D||W;for(var $=.5,M=[],s=[],y=B/W,S=k;D>S;S++){var c=S+1,L=y*S,j=y*c;M.push(_(L)*$,-$,-P(L)*$,_(j)*$,-$,-P(j)*$,0,$,0),s.push(S/W,1,c/W,1,(S+c)/2/W,0)}if(K){var V=[],X=[];for(S=k;D>S;S++){L=y*S,j=y*(S+1);var t=_(L),a=P(L),e=_(j),G=P(j);V.push(t*$,-$,-a*$,0,-$,0,e*$,-$,-G*$),X.push(.5+.5*t,.5+.5*a,.5,.5,.5+.5*e,.5+.5*G)}}if(m){var A=[],w=[];L=y*k,A.push(0,$,0,0,-$,0,_(L)*$,-$,-P(L)*$),w.push(0,0,0,1,k/W,1)}if(i){var Q=[],x=[];L=y*D,Q.push(0,-$,0,0,$,0,_(L)*$,-$,-P(L)*$),x.push(1,1,1,0,D/W,1)}return{vs:M,uv:s,bottom_vs:V,bottom_uv:X,from_vs:A,from_uv:w,to_vs:Q,to_uv:x}},Gn=function(O,E,e,M,w,y,K,u){for(var Z=[],h=0;h<O.length-1;h+=2)Z.push({x:O[h],y:O[h+1]});return mc(Z,E,e,M,w,y,K,u,!1)},Hl={roundRect:function(j,O){return Gn([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],j,O,3)},star:function(H,l){return Gn([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],H,l)},rect:function(z,C){return Gn([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],z,C)},triangle:function(v,N){return Gn([0,-.5,.5,.5,-.5,.5],[1,2,2,5],v,N)},rightTriangle:function(F,v){return Gn([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],F,v)},parallelogram:function(o,j){return Gn([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],o,j)},trapezoid:function(V,I){return Gn([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],V,I)}},_e={sphere:1,cylinder:1,cone:1,torus:1},ij={torus:1,sphere:1},am=Jn(Fm(Hl),{cylinder:1}),ye=Jn(Fm(Hl),{cylinder:1,cone:1}),hk=function(v,E,m){var W,J=Sl(v.mat,m,E),Y=Sl(v.s3,m,E),L=Sl(v.t3,m,E),V=Sl(v.r3,m,E);return(Y||V||L||J)&&(W=Kj(E._6O),Rn(E,td(J,Y,V,Sl(v.rotationMode,m,E),L))),W},vk=function(Y,C,B,e,y,J,k){if(dr(B))B.forEach(function(P){vk(Y,C,P,e,y,J,k)});else if(Bn(B))vk(Y,C,hj(e,B),e,y,J,k);else if(zr(B))if(B.shape3d){var H=hk(B,Y,C);vk(Y,C,B.shape3d,e,y,J,B),H&&Rh(Y,H)}else Yi(Y,C,B,e.s,y,J,k)},Yi=function(Y,p,q,s,i,V,X){if(X=X||Rm,!V||V(s("shape3d.transparent",q.transparent,X.transparent))){var m=hk(q,Y,p);dp(q);var Q=Y._26I,F=Y._prg,c=Y._buffer,o=s("shape3d.color",q.color,X.color);i||(i=s("shape3d.blend",q.blend,X.blend)),Qg(Q,F,i,s("shape3d.light",q.light,X.light),s("shape3d.opacity",q.opacity,X.opacity),s("shape3d.reverse.flip",q.reverseFlip,X.reverseFlip),s("shape3d.reverse.color",q.reverseColor,X.reverseColor),s("shape3d.reverse.cull",q.reverseCull,X.reverseCull)),q.vs&&s(Mg,q.visible,X.visible)&&Xi(Q,F,c,o,Y.getTexture(s("shape3d.image",q.image,X.image),p),s("shape3d.discard.selectable",q.discardSelectable,X.discardSelectable),q.vs,q.uv,q.ns,q.is,s("shape3d.uv.offset",q.uvOffset,X.uvOffset),s("shape3d.uv.scale",q.uvScale,X.uvScale)),q.top_vs&&s(Yq,q.topVisible,X.topVisible)&&Xi(Q,F,c,s("shape3d.top.color",q.topColor,X.topColor)||o,Y.getTexture(s("shape3d.top.image",q.topImage,X.topImage),p),s("shape3d.top.discard.selectable",q.topDiscardSelectable,X.topDiscardSelectable),q.top_vs,q.top_uv,q.top_ns,q.top_is,s("shape3d.top.uv.offset",q.topUvOffset,X.topUvOffset),s("shape3d.top.uv.scale",q.topUvScale,X.topUvScale)),q.bottom_vs&&s(Wl,q.bottomVisible,X.bottomVisible)&&Xi(Q,F,c,s("shape3d.bottom.color",q.bottomColor,X.bottomColor)||o,Y.getTexture(s("shape3d.bottom.image",q.bottomImage,X.bottomImage),p),s("shape3d.bottom.discard.selectable",q.bottomDiscardSelectable,X.bottomDiscardSelectable),q.bottom_vs,q.bottom_uv,q.bottom_ns,q.bottom_is,s("shape3d.bottom.uv.offset",q.bottomUvOffset,X.bottomUvOffset),s("shape3d.bottom.uv.scale",q.bottomUvScale,X.bottomUvScale)),q.from_vs&&s(cl,q.fromVisible,X.fromVisible)&&Xi(Q,F,c,s("shape3d.from.color",q.fromColor,X.fromColor)||o,Y.getTexture(s("shape3d.from.image",q.fromImage,X.fromImage),p),s("shape3d.from.discard.selectable",q.fromDiscardSelectable,X.fromDiscardSelectable),q.from_vs,q.from_uv,q.from_ns,q.from_is,s("shape3d.from.uv.offset",q.fromUvOffset,X.fromUvOffset),s("shape3d.from.uv.scale",q.fromUvScale,X.fromUvScale)),q.to_vs&&s(Yk,q.toVisible,X.toVisible)&&Xi(Q,F,c,s("shape3d.to.color",q.toColor,X.toColor)||o,Y.getTexture(s("shape3d.to.image",q.toImage,X.toImage),p),s("shape3d.to.discard.selectable",q.toDiscardSelectable,X.toDiscardSelectable),q.to_vs,q.to_uv,q.to_ns,q.to_is,s("shape3d.to.uv.offset",q.toUvOffset,X.toUvOffset),s("shape3d.to.uv.scale",q.toUvScale,X.toUvScale)),vf(Q,F),m&&Rh(Y,m)}},Xi=function(C,g,t,$,D,z,b,X,T,A,x,p){b&&($q(C,g.uDiffuse,$),X?ae(C,g,D,z,t.uv,X,x,p):ae(C),xo(C,t.vs,b,g.aPosition),xo(C,t.ns,T,g.aNormal),A?(Pk(C,t.is,A),hi(C,0,A.length)):wh(C,0,b.length/3),X?Ml(C,g,D):Ml(C))},hj=function(U,K){var s=U.s;if(K||(K=s(hn)),!K)return R;if(zr(K))return K;var G=vq[K];if(G)return G;if("text"===K){var u={amount:s("shape3d.text.amount"),size:s("shape3d.text.size"),font:s("shape3d.text.font"),style:s("shape3d.text.style"),weight:s("shape3d.text.weight"),fill:s("shape3d.text.fill"),curveSegments:s("shape3d.text.curveSegments"),spacing:s("shape3d.text.spacing")},D=U.gv.getShape3dText(U.data),Q=D;for(var H in u)Q+="_"+(u[H]===t?"U":u[H]);return U._cachedTextKey===Q?U._cachedTextGeometry:(U._cachedTextKey=Q,U._cachedTextGeometry=M.createTextGeometry(D,u))}var H=K;if(_e[K]){var e=s("shape3d.side"),O=s("shape3d.side.from"),N=s("shape3d.side.to"),Z=s(cl),m=s(Yk);3>e?(e=0,O=0,N=0,Z=!1,m=!1):((O==R||0>O)&&(O=0),(N==R||N>e)&&(N=e),0===O&&N===e&&(Z=!1,m=!1)),H+="-"+e+"-"+O+"-"+N+"-"+Z+"-"+m}if(am[K]){var n=s(Yq);H+="-"+n}if(ye[K]){var F=s(Wl);H+="-"+F}if("torus"===K){var $=s("shape3d.torus.radius");0>$?$=0:$>.25&&($=.25),H+="-"+$}if(ij[K]){var B=s(Bs);H+="-"+B}return G=Zg[H],G||("box"===K?G=M.createBoxModel():Hl[K]?G=Hl[K](n,F):"sphere"===K?G=M.createSphereModel(e,O,N,Z,m,B):K===ls?G=M.createCylinderModel(e,O,N,Z,m,n,F):"cone"===K?G=M.createConeModel(e,O,N,Z,m,F):"torus"===K&&(G=M.createTorusModel(e,O,N,Z,m,$,B)),Zg[H]=G),G},dp=function(){var V=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],g=["is","top_is","bottom_is","from_is","to_is"];return L=km(oe.substr(oe.indexOf("^#")+2)),og(M[Sd(Eg+V[15]+"n"+V[16])]())&&Zc()?function(p){p&&!p._complete_&&(p._complete_=!0,p.vs&&ao(p.ns)&&(p.ns=ps(p.vs,p.is)),p.top_vs&&ao(p.top_ns)&&(p.top_ns=ps(p.top_vs,p.top_is)),p.bottom_vs&&ao(p.bottom_ns)&&(p.bottom_ns=ps(p.bottom_vs,p.bottom_is)),p.from_vs&&ao(p.from_ns)&&(p.from_ns=ps(p.from_vs,p.from_is)),p.to_vs&&ao(p.to_ns)&&(p.to_ns=ps(p.to_vs,p.to_is)),V.forEach(function(r){var x=p[r];dr(x)&&(p[r]=new mj(x))}),g.forEach(function(t){var L=p[t];dr(L)&&(p[t]=new Dn(L))}))}:void 0}(),Ei=function(C,P){var _=C[P];dr(_)&&(C[P]=new mj(_))};Jn(qs,{_25Q:function(b){b._16O=function(g,n,I,s,K,d,Q,b,j){var U=this.info;if(U){var P,w,N,T,p,A,E=uo();if(dq[n]?(P=U.p3,w=U.c1,N=U.c2):Ve[n]?(w=U.s1||U.c1,N=U.s2||U.c2):(w=U.t1||U.c1,N=U.t2||U.c2),P)A=si(n,Vc,I,s,b,j);else{var O=ad(N,w),y=Tr(w,N);T=[0,-f(O[2],O[0]),F(O[1]/y)],p="zyx",P=[(w[0]+N[0])/2,(w[1]+N[1])/2,(w[2]+N[2])/2],A=si(n,[y,0,0],I,s,b,j)}return Wc(E,A,P,s,K,d,Q,g,T,p)}return yr},b._80o=function($,K,s){var S=this,X=S.shapeModel;if(X){var j=S.gv;Rn(j),vk(j,S.data,X,S,S.getBodyColor(),s)}},b.createLineModel=function(U,z,m,J,q){for(var I=this,F=I.s,x=To(U,z,F(Bs)),v=[],V=0;V<x.length;V++){var w=x[V],W=w.length;if(W>1){var T=w[0];v.push(T.x,T.y,T.z);for(var l=1;W-1>l;l++)T=w[l],v.push(T.x,T.y,T.z),v.push(T.x,T.y,T.z);T=w[W-1],v.push(T.x,T.y,T.z)}}var c,A,f,Y=F(J+".color"),X=F(q),d=0;return X&&(A=F(q+".color"),c=F(q+".pattern"),d=F(q+".offset"),f=Y),So(I.gv,I.data,v,A||Y,f?R:F(J+".gradient.color"),m,c||F(J+".pattern"),d,f),x},b.createTubeModel=function(B,Z,d,x){for(var I=this,o=I.s,Y=o("shape3d.side")||ri,h=o("shape3d.start.angle"),C=o("shape3d.sweep.angle"),O=o(Yq)?o("shape3d.top.cap"):R,H=o(Wl)?o("shape3d.bottom.cap"):R,W="flat"===O,c="flat"===H,a=W&&(x?x.uv:o("shape3d.top.image")),e=c&&(x?x.uv:o("shape3d.bottom.image")),_=x?x.uv:o("shape3d.image"),y={vs:[],uv:_?[]:R,top_vs:W?[]:R,top_uv:a?[]:R,bottom_vs:c?[]:R,bottom_uv:e?[]:R},E=To(B,Z,o(Bs),d),X=0,k=E.length;k>X;X++)_k(y,E[X],o(fp),d,Y,h,C,O,H);
if(x){var M=[];pf(I.gv,I.data,y,I,I.getBodyColor(),[],x,M),M.length&&(Vk(x.vs,M),Vk(x.ns,ps(M)))}else I.shapeModel=y;return E},b.getCache=function(){var J=this.info;if(J){var b=J.list;if(b){var L=J.cache;return L||(L=J.cache=yc(b)),L}}return R}}});var lj=function(R,S){for(var P,g=0,T=R.length,d=0,l=T-1;l>=d;)if(g=Y(d+(l-d)/2),P=R[g].length-S,0>P)d=g+1;else{if(!(P>0)){l=g;break}l=g-1}g=l;var b=R[g],V=b.point;return g===T-1||b.length===S||(V=(new eh).subVectors(R[g+1].point,V).normalize().multiplyScalar(S-b.length).add(V)),{point:V,tangent:b.tangent}},yc=function(g){for(var H,n,r=[],S=0,z=0;z<g.length;z++){for(var O=g[z],q=0;q<O.length;q++){H=O[q],n&&(S+=n.distanceTo(H));var u=new eh,d=O[q+1];d?u.subVectors(d,H):n?u.subVectors(H,n):u.x=1,u.normalize(),r.push({point:H,length:S,tangent:u}),n=H}n=null}return r},To=function(J,P,Q,u){Q=Q||Ac;for(var i=[],S=0,I=J.size();I>S;S++){var Z=J.get(S);i.push(new eh(Z.x,Z.e||0,Z.y))}_p(P)&&(P=P._as);for(var T,k,s,t,d,p=[],n=0,z=0,v=P?P.length:I;v>z;z++)if(d=P?P[z]:0===z?1:2,1===d)p.push(s=[]),s.push(i[n++]);else if(2===d||5===d)if(t=2===d?i[n++]:s[0],u){var x=P?P[z+1]:v>z+1?2:R;if(2===x||5===x){var b=s[s.length-1],V=2===x?i[n]:s[0],c=(new eh).subVectors(b,t),K=(new eh).subVectors(V,t),h=c.length(),D=K.length();if(u>h/2&&u>D/2)s.push(t);else for(c.multiplyScalar(j(u,h/2)/h).add(t),K.multiplyScalar(j(u,D/2)/D).add(t),T=new mb(c,t,K).getPoints(Q),k=0;Q>=k;k++)s.push(T[k])}else s.push(t)}else s.push(t);else if(3===d)for(T=new mb(s[s.length-1],i[n++],i[n++]).getPoints(Q),k=1;Q>=k;k++)s.push(T[k]);else if(4===d)for(T=new Hm(s[s.length-1],i[n++],i[n++],i[n++]).getPoints(Q),k=1;Q>=k;k++)s.push(T[k]);return p},ig=function(y){for(var u,X,S=new eh,N=[],o=[],L=[],O=0,n=y.length;n>O;O++)u=y[O],X=y[O+1],X?S.subVectors(X,u):S.subVectors(u,y[O-1]),N.push(S.normalize().clone());var B,q,t,E,M=new eh,d=new eh,e=new Vm,_=1e-4,R=Number.MAX_VALUE,p=N[0],j=o[0]=new eh,r=L[0]=new eh;for(q=Q(p.x),t=Q(p.y),E=Q(p.z),R>=q&&(R=q,M.set(1,0,0)),R>=t&&(R=t,M.set(0,1,0)),R>=E&&M.set(0,0,1),d.crossVectors(p,M).normalize(),j.crossVectors(p,d),r.crossVectors(p,j),O=1;n>O;O++)o[O]=o[O-1].clone(),L[O]=L[O-1].clone(),d.crossVectors(N[O-1],N[O]),d.length()>_&&(d.normalize(),B=U(Ro(N[O-1].dot(N[O]),-1,1)),o[O].applyMatrix4(e.makeRotationAxis(d,B))),L[O].crossVectors(N[O],o[O]);return{B:L,T:N,N:o}},_k=function(){var e=function(X){for(var S=1;S<arguments.length;S++){var i=arguments[S];X.push(i.x,i.y,i.z)}},S=function(G){for(var d=1;d<arguments.length;d++){var c=arguments[d].uv;G.push(c[0],c[1])}},v=function(B,J,u,S,l){var o=-S*_(l),c=S*P(l);return new eh(B.x+o*u.x+c*J.x,B.y+o*u.y+c*J.y,B.z+o*u.z+c*J.z)},U=function(h,p,I,C,j,Q,Z,T){Z=Z||B;for(var i=[],e=Z/j,u=0;j>=u;u++){var W=v(h,p,I,C,u*e+Q);i.push(W),T!=R&&(W.uv=[T,u/j])}return i},I=function(Z,V,k,I,r,J,M,s,O){O=O||B;var R=V?Z.top_vs:Z.bottom_vs;if(R)for(var E=V?Z.top_uv:Z.bottom_uv,h=O/M,T=0;M>T;T++){var x,y;V?(x=T*h+s,y=(T+1)*h+s):(y=T*h+s,x=(T+1)*h+s),e(R,v(k,I,r,J,x),v(k,I,r,J,y),k),E&&E.push(.5-.5*_(x),.5-.5*P(x),.5-.5*_(y),.5-.5*P(y),.5,.5)}};return function(h,n,r,o,b,C,T,O,Q){var g=n.length;if(g>1){var d,N,G,l,z,w,s,i=ig(n),B=i.T,m=i.N,c=i.B;"flat"===O&&I(h,!0,n[0],c[0],m[0],o,b,C,T),"flat"===Q&&I(h,!1,n[g-1],c[g-1],m[g-1],o,b,C,T);var E,x,X=[],F=y(b/2),J="round"===O,f="round"===Q,$=n[0],H=B[0],M=c[0],k=m[0],A=n[g-1],p=B[g-1],P=c[g-1],Y=m[g-1];if(J){for(G=1;F>=G;G++)m.splice(0,0,k),c.splice(0,0,M),B.splice(0,0,H),x=-G/F*o,n.splice(0,0,H.clone().multiplyScalar(x).add($)),X[F-G]=Z(o*o-x*x);g+=F}if(f){for(G=1;F>=G;G++)m.push(Y),c.push(P),B.push(p),x=G/F*o,n.push(p.clone().multiplyScalar(x).add(A)),X[n.length-1]=Z(o*o-x*x);g+=F}if(h.uv){var K=0,j=0,_=[];for(r&&(K=r),z=n[0],_[0]=0,G=1;g>G;G++)l=n[G],_[G]=z.distanceTo(l),z=l,r||(K+=_[G]);for(E=[],G=0;g>G;G++)j+=_[G],E[G]=K?j/K:0}for(G=0;g>G;G++){if(l=n[G],w=c[G],s=m[G],d=U(l,w,s,X[G]===t?o:X[G],b,C,T,E?E[G]:R),N)for(var u=0;b>u;u++){var L=N[u],W=N[u+1]||N[0],q=d[u],D=d[u+1]||d[0];e(h.vs,W,L,q,q,D,W),h.uv&&S(h.uv,W,L,q,q,D,W)}N=d}}}}();Jn(M,{getLineLength:function(V){return V[V.length-1].length},getLineOffset:function(s,X){return lj(s,X)},getLineCacheInfo:function(Z,e,p,$){return yc(To(Z,e,p,$))}});var Cl=K.Light=function(){Lk(Cl,this),this.s(Kr,w[Kr]),this.s(hn,"sphere"),this.s3(20,20,20)};Qr("Light",Dj,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(f,i,l){Cl.superClass.onStyleChanged.apply(this,arguments),f===Kr&&this.s("shape3d.color",l)}});var rm=Mh.Graph3dView=function(q,F){var h=this;h._attributes=F||M.graph3dViewAttributes,h._25I={},h._view=Qm(1,h);var a=h._canvas=bg(h._view);a.addEventListener("webglcontextlost",function(o){o.preventDefault(),Uh(h),h._26I=R,h._1o.texture=R,h._35O=!0},!1),a.addEventListener("webglcontextrestored",function(){h._35O=!1,h.iv()},!1),h._34O={},h._33O={},h._wireframeIndexMap={},h._wireframeModelMap={},h._polylineIndexMap={},h._polylineIndexMap={},h._8O=[],h._7O=uo(),h._6O=uo(),h._1o=new Mb(h),h._30O=new fr(h),h._31O=new ur(h),h._32O=new Rr(h),h._33Q=!0,h._eye=Fm(M.graph3dViewEye),h._center=Fm(M.graph3dViewCenter),h._up=Fm(M.graph3dViewUp),h._lightChanged=!1,h._59O=[],h._spots=[],h._dirs=[],h.dm(q?q:new mf),h.setInteractors([new fg(h)])},jb={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1};jm("Graph3dView",v,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",oi,Lr,"firstPersonMode",Vi,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",ik,vo,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_devicePixelRatio:t,_boundaries:t,_moveStep:M.graph3dViewMoveStep,_rotateStep:M.graph3dViewRotateStep,_pannable:M.graph3dViewPannable,_rotatable:M.graph3dViewRotatable,_walkable:M.graph3dViewWalkable,_resettable:M.graph3dViewResettable,_zoomable:M.graph3dViewZoomable,_firstPersonMode:M.graph3dViewFirstPersonMode,_mouseRoamable:M.graph3dViewMouseRoamable,_gridVisible:M.graph3dViewGridVisible,_gridSize:M.graph3dViewGridSize,_gridGap:M.graph3dViewGridGap,_gridColor:M.graph3dViewGridColor,_originAxisVisible:M.graph3dViewOriginAxisVisible,_centerAxisVisible:M.graph3dViewCenterAxisVisible,_axisXColor:M.graph3dViewAxisXColor,_axisYColor:M.graph3dViewAxisYColor,_axisZColor:M.graph3dViewAxisZColor,_ortho:M.graph3dViewOrtho,_orthoWidth:M.graph3dViewOrthoWidth,_fovy:M.graph3dViewFovy,_near:M.graph3dViewNear,_far:M.graph3dViewFar,_headlightColor:M.graph3dViewHeadlightColor,_headlightIntensity:M.graph3dViewHeadlightIntensity,_headlightRange:M.graph3dViewHeadlightRange,_headlightDisabled:M.graph3dViewHeadlightDisabled,_rectSelectable:M.graph3dViewRectSelectable,_rectSelectBackground:M.graph3dViewRectSelectBackground,_editSizeColor:M.graph3dViewEditSizeColor,_autoMakeVisible:Bi,_fogDisabled:M.graph3dViewFogDisabled,_fogColor:M.graph3dViewFogColor,_fogNear:M.graph3dViewFogNear,_fogFar:M.graph3dViewFogFar,_dashDisabled:M.graph3dViewDashDisabled,_batchColorDisabled:M.graph3dViewBatchColorDisabled,_batchBlendDisabled:M.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:M.graph3dViewBatchBrightnessDisabled,setEye:function(d,O,Q){1===arguments.length&&(O=d[1],Q=d[2],d=d[0]);var c=this._eye;c[0]=d,c[1]=O,c[2]=Q,this.fp(ik,R,c)},setCenter:function(x,Q,E){1===arguments.length&&(Q=x[1],E=x[2],x=x[0]);var P=this._center;P[0]=x,P[1]=Q,P[2]=E,this.fp(vo,R,P)},setUp:function(z,y,A){1===arguments.length&&(y=z[1],A=z[2],z=z[0]);var V=this._up;V[0]=z,V[1]=y,V[2]=A,this.fp("up",R,V)},isTransparentMask:function(k){return k.s("transparent.mask")},getAspect:function(){var L=this,o=L._aspect;return o?o:L.getWidth()/L.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(W){var i=this,g=i._dataModel,c=i._selectionModel;g!==W&&(g&&(g.umm(i.handleDataModelChange,i),g.umd(i.handleDataPropertyChange,i),c||g.sm().ums(i.handleSelectionChange,i)),i._dataModel=W,W.mm(i.handleDataModelChange,i),W.md(i.handleDataPropertyChange,i),c?c._21I(W):W.sm().ms(i.handleSelectionChange,i),i.invalidateAll(!0),i.invalidateLight(),i.fp(Kg,g,W))},handleDataPropertyChange:function(s){var M=s.data;this.invalidateData(M),Cr(M)&&"s:light.type"===s.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(C){var u=this,M=C.property;u.iv(),u._18Q=R,"eye"===M?u._33Q=!0:"devicePixelRatio"===M?u._42(R,u._devicePixelRatio||Md):jb[M]&&Uh(u)},_5O:function(E){var M=E._22Q();return M?new M(this,E):R},getData3dUI:function(O){var R=this._25I[O._id];return R===t&&(R=this._5O(O),this._25I[O._id]=R),R},invalidateAll:function(v){var d=this;if(v){for(var y in d._25I){var j=d._25I[y];j&&j.dispose()}d._25I={},d.iv(),an(d)}else d.dm().each(function(M){d.invalidateData(M)})},invalidateSelection:function(){var e=this;e.sm().each(function(t){e.invalidateData(t)})},invalidateData:function($){var V=this,C=V.getData3dUI($);C&&(C.iv(),V.iv()),an(V,$)},getShape3dText:function(S){return S.getStyle("shape3d.text")||this.getLabel(S)},invalidateBatch:function(b){var H=this,q=H._33O,g=q[b],W=[],n={};if(g){g.ds.forEach(function(O){var G=H.getData3dUI(O);G&&G.iv(),delete H._34O[O._id],W.push(O._id)}),delete q[b];for(var y,O,c,U,K,P,S,A,D,r=0;2>r;r++){var z=H[["_wireframeModelMap","_polylineModelMap"][r]],m=H[["_wireframeIndexMap","_polylineIndexMap"][r]];for(n={},A=0;A<W.length;A++){var a=m[W[A]];if(a){delete m[W[A]],D=a.batch,y=z[D];var G=a.begin,x=a.size,j=3*G,o=3*x,f=4*G,X=4*x;for(O=y.ds,c=y.vs,U=y.cs,K=y.ps,P=y.ls,S=a.index,y.invalidate=!0,O[S]=t,S=j;j+o>S;S++)c[S]=t;for(S=f;f+X>S;S++)U[S]=t;for(S=f;f+X>S;S++)K[S]=t;if(P)for(S=j;j+o>S;S++)P[S]=t;n[D]=!0}}for(D in n){y=z[D],O=y.ds,c=y.vs,U=y.cs,K=y.ps,P=y.ls;var M=[];for(S=0;S<O.length;S++)O[S]!==t&&M.push(O[S]);if(0===M.length)delete z[D];else{for(y.ds=M,M=[],S=0;S<c.length;S++)c[S]!==t&&M.push(c[S]);for(y.vs=M,M=[],S=0;S<U.length;S++)U[S]!==t&&M.push(U[S]);for(y.cs=M,M=[],S=0;S<K.length;S++)K[S]!==t&&M.push(K[S]);if(y.ps=M,P){for(M=[],S=0;S<P.length;S++)P[S]!==t&&M.push(P[S]);y.ls=M}}}}H.iv()}},handleDataModelChange:function(A){var t=this,S=A.kind,Y=A.data;if("add"===S)t.invalidateData(Y),ql(Y)&&Y.getEdgeGroup()&&Y.getEdgeGroup().eachSiblingEdge(t.invalidateData,t),Cr(Y)&&t.invalidateLight();else if(S===to){var I=Y._id,d=t._25I[I];d&&(d.dispose(),delete t._25I[I],t.iv()),Y===t._currentSubGraph&&t.setCurrentSubGraph(R),an(t,Y),Cr(Y)&&t.invalidateLight()}else S===cj&&(t.invalidateAll(!0),t.setCurrentSubGraph(R),an(t),t.invalidateLight())},toCanvas:function(O){var v=this,I=v.getGL();if(v.validate(),O){var p=I.getParameter(I.COLOR_CLEAR_VALUE);yk(I,O)}v._42(R,1);var g=v.getWidth(),c=v.getHeight(),N=new Uint8Array(4*g*c),w=bg(),L=w.getContext("2d");I.readPixels(0,0,g,c,I.RGBA,I.UNSIGNED_BYTE,N),ds(w,g,c,1);for(var i=L.getImageData(0,0,g,c),a=i.data,u=0;u<a.length;u+=4){var S=u/4,A=Y(S/g),$=S-A*g;S=4*((c-1-A)*g+$),a[S]=N[u],a[S+1]=N[u+1],a[S+2]=N[u+2],a[S+3]=N[u+3]}return L.putImageData(i,0,0),O&&yk(I,p),v._42(R,v._devicePixelRatio||Md),w},toDataURL:function(e,Q){var h=this,J=h.getGL();if(h.validate(),e){var M=J.getParameter(J.COLOR_CLEAR_VALUE);yk(J,e)}h._42(R,1);var l=h._canvas.toDataURL(Q||"image/png",1);return e&&yk(J,M),h._42(R,h._devicePixelRatio||Md),l},getGL:function(){var u=this,$=u._26I,O=u._prg;if(!$)try{u._2O={},$=u._26I=u._canvas.getContext("webgl",u._attributes)||u._canvas.getContext("experimental-webgl",u._attributes),$._emptyTexture=qd($),u._buffer={vs:Gp($),ns:Gp($),is:Gp($),uv:Gp($),batchColor:Gp($),batchBlend:Gp($),batchBrightness:Gp($),lineDistance:Gp($)},u._1O=Qd($);var n=u._cube={vs:Gp($),ns:Gp($),is:Gp($),uv:Gp($)};xo($,n.vs,Ig),xo($,n.ns,Sj),xo($,n.uv,zg),Pk($,n.is,sr)}catch(L){}if($&&!O){if(O=u._prg=$.createProgram(),!O)return R;var B=u._dirs.length,V=u._spots.length,P=u._59O.length,v=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uTransparent","uTexture","uSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];B&&v.push("uDirColor","uDirPosition"),V&&v.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotCenter"),P&&v.push("uPointColor","uPointRange","uPointPosition"),yk($,[0,0,0,0]),$.clearDepth(1),$.enable($.DEPTH_TEST),$.depthFunc($.LEQUAL),$.enable($.BLEND),$.blendFunc($.SRC_ALPHA,$.ONE_MINUS_SRC_ALPHA),uk||(oe=km(oe.substring(0,oe.indexOf("^#"))),Ic=km(Ic),uk=!0);var Q=["#define MAX_DIR "+B,"#define MAX_SPOT "+V,"#define MAX_POINT "+P,u._fogDisabled?"":"#define FOG",u._dashDisabled?"":"#define DASH",u._batchColorDisabled?"":"#define BATCHCOLOR",u._batchBlendDisabled?"":"#define BATCHBLEND",u._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),K=kh($,O,$.VERTEX_SHADER,oe.replace("PREFIX",Q)),s=kh($,O,$.FRAGMENT_SHADER,Ic.replace("PREFIX",Q));C?v.push("aPosition"):(O.aPosition=0,$.bindAttribLocation(O,0,"aPosition")),$.linkProgram(O),v.forEach(function(u){O[u]=/^u/.test(u)?$.getUniformLocation(O,u):$.getAttribLocation(O,u)}),$.useProgram(O),$.deleteShader(K),$.deleteShader(s)}return $},getBrightness:function(D){var Y=D.s("brightness"),$=this.isSelected(D)?D.s("select.brightness"):R;return Y==R?$:$==R?Y:Y*$},getWireframe:function(d){var T=d.s("wf.visible"),S=d.s("wf.width");return T===!0||S>0&&"selected"===T&&this.isSelected(d)?{color:d.s("wf.color"),width:S,"short":d.s("wf.short"),mat:d.s("wf.mat")}:void 0},getBodyColor:function(u){return u.s("body.color")},getMat:function(O){return O.getMat?O.getMat():O.s("mat")},getFaceMat:function(w,n){return w.getFaceMat?w.getFaceMat(n):w.s(n+".mat")},getFaceBlend:function(A,R){return A.s(R+".blend")||A.s("all.blend")},getFaceColor:function(I,X){return I.s(X+".color")||I.s("all.color")},getFaceImage:function(x,e){return x.s(e+".image")||x.s("all.image")},getFaceDiscardSelectable:function(O,k){var c=O.s(k+".discard.selectable");return c==R?O.s("all.discard.selectable"):c},getFaceUv:function(W,L){return W.s(L+".uv")||W.s("all.uv")},getFaceUvOffset:function(e,y){return e.s(y+".uv.offset")||e.s("all.uv.offset")},getFaceUvScale:function(E,J){return E.s(J+".uv.scale")||E.s("all.uv.scale")},getFaceLight:function(s,N){var a=s.s(N+".light");return a==R?s.s("all.light"):a},getFaceVisible:function(h,f){var Z=h.s(f+".visible");return Z==R?h.s("all.visible"):Z},getFaceOpacity:function(q,W){var Q=q.s(W+".opacity");return Q==R?q.s("all.opacity"):Q},getFaceTransparent:function(U,T){var w=U.s(T+".transparent");return w==R?U.s("all.transparent"):w},getFaceReverseColor:function(o,w){return o.s(w+".reverse.color")||o.s("all.reverse.color")},getFaceReverseFlip:function(A,h){var i=A.s(h+".reverse.flip");return i==R?A.s("all.reverse.flip"):i},getFaceReverseCull:function(P,p){var g=P.s(p+".reverse.cull");return g==R?P.s("all.reverse.cull"):g},getTextureMap:function(){return this._2O},deleteTexture:function(W){var n=this,N=n._2O[W];N&&(delete n._2O[W],n.getGL().deleteTexture(N))},getTexture:function(f,v){if(!f)return R;var p=this,K=p.getGL(),q=p._2O[f];if(!q){var t=rd(f);if(t)if(t.tagName){if(t.dynamic)return Qd(K,t,p._1O);q=p._2O[f]=Qd(K,t)}else{var A=ag(t,v),L=Eh(t,v);if(A>=1&&L>=1){var m=io(A,L);return Mn(m,t,0,0,A,L,v,p),m.restore(),Qd(K,fd,p._1O)}}}return q},redraw:function(){this.iv()},validateImpl:function(){var A=this;if(A._lightChanged){A._lightChanged=!1;var b=[],s=[],U=[];A.dm().each(function(g){if(Cr(g)){var Z=g.s("light.type");Z===as?b.push(g):Z===Ur?s.push(g):Z===Yj&&U.push(g)}}),(b.length!==A._59O.length||s.length!==A._spots.length||U.length!==A._dirs.length)&&Uh(A),A._59O=b,A._spots=s,A._dirs=U}A._42(),A._1o.iv()},_42:function(p,O){var i=this;if(!i._35O&&(!rg||ap(rg))){var C,D;p&&(p instanceof Dj?D=p:C=p);var o=i._canvas,I=i.getWidth(),X=i.getHeight(),k=i.getGL(),d=i._prg;if(k){if(O?p||ds(o,I,X,O):(O=i._devicePixelRatio||Md,p||I===o.clientWidth&&X===o.clientHeight||ds(o,I,X,O)),k.viewport(0,0,I*O,X*O),i._81O=R,k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),$q(k,d.uBrightness,1),$q(k,d.uOpacity,1),$q(k,d.uPartOpacity,1),k._picking=!!p,$q(k,d.uPick,!!p),$q(k,d.uTexture,!1),$q(k,d.uFix,!1),$q(k,d.uTransparent,!1),$q(k,d.uBatchColor,!1),$q(k,d.uBatchBlend,!1),$q(k,d.uBatchBrightness,!1),p||(Xd(i,k,d),i._fogDisabled||($q(k,d.uFogColor,i._fogColor),$q(k,d.uFogNear,i._fogNear),$q(k,d.uFogFar,i._fogFar))),ie(k,d.aPosition),ie(k,d.aNormal),Sp(k,d.aUv),Sp(k,d.aBatchColor),Sp(k,d.aBatchBlend),Sp(k,d.aBatchBrightness),Sp(k,d.aLineDistance),$q(k,d.uPMatrix,Sf(i)),$q(k,d.uViewMatrix,Dp(i,i._7O)),D){var r=k.getParameter(k.COLOR_CLEAR_VALUE);k.clearColor(0,0,0,0),k.disable(k.BLEND),Sp(k,d.aNormal),xo(k,i._cube.vs,R,d.aPosition),Pk(k,i._cube.is),vl(D,i,Ai,0),vl(D,i,rh,6),vl(D,i,Br,12),vl(D,i,vr,18),vl(D,i,Id,24),vl(D,i,Zf,30),ie(k,d.aNormal),yk(k,r)}else if(C){C.value=2;var r=k.getParameter(k.COLOR_CLEAR_VALUE);k.clearColor(0,0,0,0),k.disable(k.BLEND),i._95I(k,d,C),lm(i,C),Zi(i,i._polylineModelMap,C),Zi(i,i._wireframeModelMap,C),$q(k,d.uTransparent,!0),i._95I(k,d,C,!0),lm(i,C,!0),Zi(i,i._polylineModelMap,C,!0),Zi(i,i._wireframeModelMap,C,!0),$q(k,d.uTransparent,!1),k.disable(k.DEPTH_TEST),i._30O._42(k,d,C),k.enable(k.DEPTH_TEST),yk(k,r)}else k.disable(k.BLEND),i.drawSky(k,d),i._31O._42(k,d),i._95I(k,d),lm(i),Zi(i,i._polylineModelMap),Zi(i,i._wireframeModelMap),k.enable(k.BLEND),k.depthMask(!1),$q(k,d.uTransparent,!0),i._95I(k,d,R,!0),lm(i,R,!0),Zi(i,i._polylineModelMap,R,!0),Zi(i,i._wireframeModelMap,R,!0),$q(k,d.uTransparent,!1),k.depthMask(!0),k.disable(k.BLEND),k.disable(k.DEPTH_TEST),i._32O._42(k,d),i._30O._42(k,d),k.enable(k.DEPTH_TEST);xo(k,R),Pk(k,R),i._33Q=!1}}},_updateSkyBoxPosition:function(m){if(this._skyBox&&m&&"eye"===m.property){var Y=m.newValue;this._skyBox.p3(Y[0],Y[1],Y[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(O){this._skyBox=O,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),O&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(P,c,g){var w=this,S=w._skyBox;if(S){var V=w._headlightIntensity,e=no(w._headlightColor),c=w._prg;1!==V&&(e=[e[0]*V,e[1]*V,e[2]*V]),$q(P,c.uHeadlightColor,[e[0],e[1],e[2],1]);var E=w.getData3dUI(S);E&&E._42(P,c,g,function(){return!0}),P.clear(P.DEPTH_BUFFER_BIT),$q(P,c.uHeadlightColor,[e[0],e[1],e[2],w._headlightDisabled?1:0])}},_95I:function(o,c,F,u){function l(D){if(J.isVisible(D)&&(!x||O)){if(!F&&J.isTransparentMask(D))return;var M=J.getData3dUI(D);M&&M._42(o,c,F,s)}}var J=this,s=function(s){return u?s:!s};J.sky&&o.clear(o.DEPTH_BUFFER_BIT),J.dm().each(l)},getLogicalPoint:function(a){return Sk(a,this._canvas)},getHitFaceInfo:function(z){z.target&&(z=this.lp(z));var n=this.getDataInfoAt(z);if(n){var U=this._1o.face(n.data,Tn(z.x,z.y));if(U)return{data:n.data,face:U}}return R},getDataAt:function(s){var w=this.getDataInfoAt(s);return w?w.data:R},getDataInfoAt:function(z,M){return z.target&&(z=this.lp(z)),this._1o.get(Tn(z.x,z.y,M),!0)},getDatasInRect:function(K){return this._1o.get(K)},setEditable:function(W){var d=this,K=d._editable;d._editable=W,this.fp(ii,K,W)},isEditable:function(i){var G=this;return G._editable?Vp(i)?i.s("3d.editable")?G._editableFunc?G._editableFunc(i):!0:!1:!1:!1},isSelectable:function(M){return M.s("3d.selectable")&&this.sm().isSelectable(M)},isMovable:function(x){var M=this;return ql(x)&&x.getStyle(oh)!==tg?!1:x.s("3d.movable")?M._movableFunc?M._movableFunc(x):!0:!1},isSizeEditable:function(v){return Vp(v)?this._sizeEditableFunc?this._sizeEditableFunc(v):!0:!1},isRotationEditable:function(P){return Vp(P)&&P.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(P):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(H){this.setZoom(oq,H)},zoomOut:function(s){this.setZoom(1/oq,s)},setZoom:function(U,B){if(1!==U){var $=this;if($._ortho)return $.setOrthoZoom(U,B),void 0;$._14o&&$._14o.stop(!0);var e=1/U,c=$._eye,x=$._center,C=x[0]+(c[0]-x[0])*e-c[0],T=x[1]+(c[1]-x[1])*e-c[1],d=x[2]+(c[2]-x[2])*e-c[2];if(!(Tr(c,x)<$._moveStep&&1>e)){if(B=Gd(B)){var Y=Fm(c);return B.action=function(V){$.fi({kind:$._zooming?"betweenZoom":"beginZoom"}),$._zooming=1,c[0]=Y[0]+C*V,c[1]=Y[1]+T*V,c[2]=Y[2]+d*V,$.fp(ik,R,c)},B._37o=function(){delete $._14o,delete $._zooming,$.fi({kind:"endZoom"}),$.onZoomEnded()},$._14o=Gj(B)}c[0]+=C,c[1]+=T,c[2]+=d,$.fp(ik,R,c)}}},setOrthoZoom:function(Y,l){if(1!==Y){var b=this;b._14o&&b._14o.stop(!0);var q=b._orthoWidth,h=q/Y-q;if(!(q<b._moveStep&&Y>1))return(l=Gd(l))?(l.action=function(K){b.fi({kind:b._zooming?"betweenZoom":"beginZoom"}),b._zooming=1,b.setOrthoWidth(q+h*K)},l._37o=function(){delete b._14o,delete b._zooming,b.fi({kind:"endZoom"}),b.onZoomEnded()},b._14o=Gj(l)):(b.setOrthoWidth(q/Y),void 0)}},getPositionInfo:function(S){var g=this,$=g._eye,m=g._center,q=g.getAspect(),f=S?dj(ad(m,$,!0),ad(S,$)):Tr($,m);if(g._ortho){var i=g._orthoWidth;return{length:f,height:i/q,width:i}}var b=2*E(g._fovy/2)*f;return{length:f,height:b,width:b*q}},getCenterInfo:function(){var o=this;return o._81O||(o._81O=o.getPositionInfo()),Fm(o._81O)},rotate:function(H,Y,G,w){var n=this;if(H||Y){w==R&&(w=n._firstPersonMode),n._88O&&n._88O.stop(!0);var b=n._center,v=n._eye,m=n.getCenterInfo().length,i=w?b:v,L=w?v:b,j=ad(i,L),I=f(j[0],j[2]),X=f(Z(j[0]*j[0]+j[2]*j[2]),j[1]),F=w?vo:ik;return w&&(Y=-Y),(G=Gd(G))?(G.action=function(G){n.fi({kind:n._rotating?"betweenRotate":"beginRotate"}),n._rotating=1;var e=I+H*G,b=X+Y*G;b=ll(b),j[0]=m*P(b)*P(e),j[1]=m*_(b),j[2]=m*P(b)*_(e),i[0]=L[0]+j[0],i[1]=L[1]+j[1],i[2]=L[2]+j[2],n.fp(F,R,i)},G._37o=function(){delete n._88O,delete n._rotating,n.fi({kind:"endRotate"}),n.onRotateEnded()},n._88O=Gj(G)):(I+=H,X+=Y,X=ll(X),j[0]=m*P(X)*P(I),j[1]=m*_(X),j[2]=m*P(X)*_(I),i[0]=L[0]+j[0],i[1]=L[1]+j[1],i[2]=L[2]+j[2],n.fp(F,R,i),void 0)}},pan:function(C,l,E,K){if(C||l){var k=this;K==R&&(K=k._firstPersonMode),k._89O&&k._89O.stop(!0);var I=Dp(k),B=[I[0]*C,I[4]*C,I[8]*C],M=[I[1]*l,I[5]*l,I[9]*l],G=B[0]+M[0],b=B[1]+M[1],A=B[2]+M[2],r=k._center,m=k._eye;if(K){var V=th(k.getBoundaries(),m[0],m[2],m[0]+G,m[2]+A,Z(G*G+A*A));G=V[0],A=V[1]}if(E=Gd(E)){var D=Fm(m),P=Fm(r);return E.action=function(L){k.fi({kind:k._panning?"betweenPan":"beginPan"}),k._panning=1,r[0]=P[0]+G*L,r[1]=P[1]+b*L,r[2]=P[2]+A*L,m[0]=D[0]+G*L,m[1]=D[1]+b*L,m[2]=D[2]+A*L,k.fp(ik,R,m),k.fp(vo,R,r)},E._37o=function(){delete k._89O,delete k._panning,k.fi({kind:"endPan"}),k.onPanEnded()},k._89O=Gj(E)}r[0]+=G,r[1]+=b,r[2]+=A,m[0]+=G,m[1]+=b,m[2]+=A,k.fp(ik,R,m),k.fp(vo,R,r)}},walk:function(A,Y,g){if(A){var L=this;g==R&&(g=L._firstPersonMode),L._90O&&L._90O.stop(!0);var H=L._center,e=L._eye,I=ad(H,e,!0);if(g){var i=th(L.getBoundaries(),e[0],e[2],e[0]+I[0]*A,e[2]+I[2]*A,Q(A));if(A=Tr(i),!A)return;I=[i[0]/A,0,i[1]/A]}if(Y=Gd(Y)){var G=Fm(e),D=Fm(H);return Y.action=function(T){L.fi({kind:L._walking?"betweenWalk":"beginWalk"}),L._walking=1;var i=A*T;e[0]=G[0]+I[0]*i,e[1]=G[1]+I[1]*i,e[2]=G[2]+I[2]*i,H[0]=D[0]+I[0]*i,H[1]=D[1]+I[1]*i,H[2]=D[2]+I[2]*i,L.fp(ik,R,e),L.fp(vo,R,H)},Y._37o=function(){delete L._90O,delete L._walking,L.fi({kind:"endWalk"}),L.onWalkEnded()},L._90O=Gj(Y)}e[0]+=I[0]*A,e[1]+=I[1]*A,e[2]+=I[2]*A,H[0]+=I[0]*A,H[1]+=I[1]*A,H[2]+=I[2]*A,L.fp(ik,R,e),L.fp(vo,R,H)}},handleScroll:function(n,i){n.preventDefault();var A=this,a=A._moveStep;A.isFirstPersonMode()?A.isPannable()&&A.pan(0,i>0?a:-a):A.isZoomable()&&A.setZoom(0>i?1/ki:ki)},handlePinch:function(C,y){this.isZoomable()&&this.setZoom(y>C?1/Ok:Ok)},reset:function(){this.setCenter(M.graph3dViewCenter),this.setEye(M.graph3dViewEye),this.setUp(M.graph3dViewUp)},moveSelection:function(y,o,$){var m,a=this,C=a.dm();C&&(m=C.getHistoryManager()),m&&m.beginInteraction(),Eo(this.sm().toSelection(this.isMovable,this),y,o,$),m&&m.endInteraction()},getMoveMode:function($,F){var G=F.s("3d.move.mode");if(G)return G;var L="88",u="89",q="90";return Ng($)||Tf[L]&&Tf[u]&&Tf[q]?"xyz":Tf[L]&&Tf[u]?"xy":Tf[L]&&Tf[q]?"xz":Tf[u]&&Tf[q]?"yz":Tf[L]?"x":Tf[u]?"y":Tf[q]?"z":"xz"},handleTick:function(){var $=this,q=!1,J=$._moveStep,a=J,O=!1,p=!0,j=$._rotateStep*(p?-1:1);if($.isWalkable()||(a=0),$.isPannable()||(J=0),$.isRotatable()||(j=0),$._32Q){var P=(se()-$._32Q)/50;a*=P,J*=P,j*=P}$._31Q&&(xg($._31Q),delete $._31Q,delete $._32Q),Fb()&&(q=!0,$.pan(-J,0,O,p)),go()&&(q=!0,$.pan(J,0,O,p)),Ie()&&(q=!0,Ng()?$.pan(0,J,O,p):$.walk(a,O,p)),od()&&(q=!0,Ng()?$.pan(0,-J,O,p):$.walk(-a,O,p)),fh()&&(q=!0,$.rotate(-j,0,O,p)),Kd()&&(q=!0,$.rotate(j,0,O,p)),Aq()&&(q=!0,$.rotate(0,-j/2,O,p)),ed()&&(q=!0,$.rotate(0,j/2,O,p)),q&&($._32Q=se(),$._31Q=Jb($.handleTick,$))},handleKeyDown:function(W){var M=this;!sq(W)&&Me[W.keyCode]?M.handleTick():Ye(W)?M.selectAll():lf(W)?M.handleDelete(W):gl(W)&&this.isResettable()&&M.reset()},checkDoubleClickOnNote:function(T,B,m){var A=this;if(m===Qf){if(B.s("note.toggleable"))return B.s(Fd,!B.s(Fd)),A.fi({kind:"toggleNote",event:T,data:B,part:m}),!0}else if(m===Lg&&B.s("note2.toggleable"))return B.s(pe,!B.s(pe)),A.fi({kind:"toggleNote2",event:T,data:B,part:m}),!0;return!1},checkDoubleClickOnRotation:function(M,N,V){return V===Cm?(N.setRotationX(0),!0):V===Wr?(N.setRotationY(0),!0):V===ar?(N.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(w){var Q=this,D=Q.getWidth()/2,R=Q.getHeight()/2,v=Q._18Q;return v||(v=Sf(Q),Q._18Q=le(v,v,Dp(Q))),w=wm([w[0],w[1],w[2],1],v),{x:D+D*w[0]/w[3],y:R-R*w[1]/w[3]}},getHitPosition:function(T,Q,j){var v=this,J=v.getWidth(),M=v.getHeight(),d=T.target?v.lp(T):T,q=d.x-J/2,B=d.y-M/2,X=v.getCenterInfo(),L=Dp(v);Q=Q?Q:[0,0,0],j=j?j:[0,1,0],q=q/J*X.width,B=-1*B/M*X.height;var x=[L[0]*q,L[4]*q,L[8]*q],V=[L[1]*B,L[5]*B,L[9]*B],c=[x[0]+V[0],x[1]+V[1],x[2]+V[2]],D=v.getCenter(),F=Tp(v,Q,j,[c[0]+D[0],c[1]+D[1],c[2]+D[2]]);return F?F:[0,0,0]},getLineLength:function(s){this.validate();var x=this.getData3dUI(s);if(x&&x.getCache){var A=x.getCache();if(A)return A[A.length-1].length}return 0},getLineOffset:function(T,V){var w=this.getData3dUI(T);if(w&&w.getCache){var M=w.getCache();if(M)return lj(M,V)}return R},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}});var Hd=Mh.Interactor=function(r){this.gv=r};jm("Interactor",v,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var fg=Mh.DefaultInteractor=function(C){Lk(fg,this,[C])};jm("DefaultInteractor",Hd,{handle_contextmenu:function(I){Ch(I)},handle_mousewheel:function(D){this.gv.handleScroll(D,D.wheelDelta/40)},handle_DOMMouseScroll:function(N){2===N.axis&&this.gv.handleScroll(N,-N.detail)},handle_keydown:function(B){this.gv.handleKeyDown(B)},handle_mousedown:function(F){this.handle_touchstart(F)},handle_touchstart:function(O){Ch(O);var G=this,y=G.gv,U=fq(O),N=y.getDataInfoAt(O),u=N?N.data:R,e=N?N.part:R,B=y.sm(),W=wi(O),x=Ag(O);y.setFocus(O)&&(G._62O=R,G._57I=R,u?sq(O)?B.co(u)?B.rs(u):B.as(u):B.co(u)||B.ss(u):U&&(sq(O)?y.isRectSelectable()&&(G._62O=xj):G._57I=de(O)),G._31Q&&(xg(G._31Q),delete G._31Q,delete G._32Q),G._62O||(y.isFirstPersonMode()&&(Ng(O)||x>2?G._62O="pan":y.isMouseRoamable()||b?(G._62O="roaming",G.foward=W&&fq(O),G._32Q=se(),G._31Q=Jb(G.tick,G)):U||(G._62O="roaming")),G._62O||(U&&W&&We[e]?(G._62O=e,G.p3=u.p3()):U&&W&&Vp(u)&&y.isSelected(u)&&y.isMovable(u)?(G._62O="move",G.p3=u.p3(),G.movedata=u):b&&(x>2?G._62O="pan":2===x&&(G.dist=Dm(O),G._62O="pinch")))),G.point=y.lp(O),ws(G,O),vs(O)?y.handleDoubleClick(O,u,e):y.handleClick(O,u,e))},tick:function(){var y=this,e=y.gv,S=e._moveStep;y.point&&e.isWalkable()&&(y._32Q&&(S*=(se()-y._32Q)/50),e.walk(y.foward?S:-S),y._32Q=se(),y._31Q=Jb(y.tick,y))},handle_mouseup:function(O){this.handle_touchend(O)},handle_touchend:function(V){var e=this._57I;e&&(Tr(e,de(V))<=1&&this.gv.sm().cs(),this._57I=R)},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(z){var P,c,$=this,g=$.gv,n=$._62O,R=$.point,G=g.dm(),N=G.getHistoryManager(),u=g.lp(z),d=u.x-R.x,A=u.y-R.y,V=-B*d/g.getWidth(),q=-B*A/g.getHeight();if("roaming"===n)$.rotate(z,V/2,q/2);else if(n===Cm||n===Wr||n===ar)N&&!g._86O&&N.beginInteraction(),g.fi({kind:g._86O?"betweenEditRotation":"beginEditRotation",event:z}),g._86O=1,g.sm().each(function(s){if(Vp(s)&&g.isRotationEditable(s)){var y=Q(V)>Q(q)?V:q;n===Cm?s.setRotationX(s.getRotationX()+y):n===Wr?s.setRotationY(s.getRotationY()+y):n===ar&&s.setRotationZ(s.getRotationZ()+y)}});else if("move"===n||We[n]){n===ef||n===Hg||n===Vr?(N&&!g._87O&&N.beginInteraction(),g.fi({kind:g._87O?"betweenEditSize":"beginEditSize",event:z}),g._87O=1):(N&&!g._moving&&N.beginInteraction(),g.fi({kind:g._moving?"betweenMove":"beginMove",event:z}),g._moving=1);var k,W=$.p3,E=g.getPositionInfo(W),j=Dp(g);k=n===En?"x":n===Ih?"y":n===Zn?"z":n===ef?"sx":n===Hg?"sy":n===Vr?"sz":g.getMoveMode(z,$.movedata),d=d/g.getWidth()*E.width,A=-1*A/g.getHeight()*E.height;var T,K,t=[j[0]*d,j[4]*d,j[8]*d],a=[j[1]*A,j[5]*A,j[9]*A],Z=t[0]+a[0],m=t[1]+a[1],y=t[2]+a[2],O=[W[0]+Z,W[1]+m,W[2]+y],D=ad(g.getEye(),O,!0);if("xyz"===k?(T=O,g.moveSelection(Z,m,y)):"xz"===k?(T=Tp(g,W,[0,1,0],O),T&&g.moveSelection(T[0]-W[0],0,T[2]-W[2])):"xy"===k?(T=Tp(g,W,[0,0,1],O),T&&g.moveSelection(T[0]-W[0],T[1]-W[1],0)):"yz"===k?(T=Tp(g,W,[1,0,0],O),T&&g.moveSelection(0,T[1]-W[1],T[2]-W[2])):"x"===k||"sx"===k?(D[0]=0,T=Tp(g,W,D,O),T&&(K=T[0]-W[0],"x"===k?g.moveSelection(K,0,0):g.sm().each(function(u){Vp(u)&&g.isSizeEditable(u)&&(P=I(Hj,u.getWidth()+K),c=P/u.getWidth(),u.setWidth(P),Ng(z)&&(u.setHeight(u.getHeight()*c),u.setTall(u.getTall()*c)))}))):"y"===k||"sy"===k?(D[1]=0,T=Tp(g,W,D,O),T&&(K=T[1]-W[1],"y"===k?g.moveSelection(0,K,0):g.sm().each(function(V){Vp(V)&&g.isSizeEditable(V)&&(P=I(Hj,V.getTall()+K),c=P/V.getTall(),V.setTall(P),Ng(z)&&(V.setHeight(V.getHeight()*c),V.setWidth(V.getWidth()*c)))}))):("z"===k||"sz"===k)&&(D[2]=0,T=Tp(g,W,D,O),T&&(K=T[2]-W[2],"z"===k?g.moveSelection(0,0,K):g.sm().each(function(H){Vp(H)&&g.isSizeEditable(H)&&(P=I(Hj,H.getHeight()+K),c=P/H.getHeight(),H.setHeight(P),Ng(z)&&(H.setTall(H.getTall()*c),H.setWidth(H.getWidth()*c)))}))),!T)return;$.p3=T}else if(n===xj){var X=$.div;X||(X=$.div=so(),Gl($.getView(),X),X.op=R,X.style.background=g.getRectSelectBackground()),g.fi({kind:g._rectSelecting?"betweenRectSelect":"beginRectSelect",event:z}),g._rectSelecting=1,X.rect=Ef(X.op,u),Se(X,X.rect)}else if("pinch"===n&&2===Ag(z)){g.fi({kind:g._pinching?"betweenPinch":"beginPinch",event:z}),g._pinching=1;var K=Dm(z);g.handlePinch(K,$.dist),$.dist=K}else"pan"===n||Ng(z)?$.pan(z,d,A):g.isFirstPersonMode()||(fq(z)?$.rotate(z,V,q):($.pan(z,d,0),g.isWalkable()&&(g.fi({kind:g._walking?"betweenWalk":"beginWalk",event:z}),g._walking=1,g.walk(A/g.getHeight()*g.getCenterInfo().height))));$.point=u},pan:function(V,n,f){var t=this.gv;if(t.isPannable()){var I=t.getCenterInfo(),z=n/t.getWidth()*I.width,y=-1*f/t.getHeight()*I.height;t.fi({kind:t._panning?"betweenPan":"beginPan",event:V}),t._panning=1,t.pan(-z,-y)}},rotate:function(Q,y,H){var W=this.gv;W.isRotatable()&&(W.fi({kind:W._rotating?"betweenRotate":"beginRotate",event:Q}),W._rotating=1,W.rotate(y,H))},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(O){var c=this,m=c.gv,f=m.dm(),y=f.getHistoryManager(),V=c.div;if(V){var w=m.getDatasInRect(V.rect);if(!w.isEmpty()){var Y=m.sm(),d=Y.toSelection();w.each(function(b){Y.co(b)?d.remove(b):d.add(b)}),Y.ss(d)}Mf(V)}m._moving&&(delete m._moving,m.fi({kind:"endMove",event:O}),m.onMoveEnded(),y&&y.endInteraction()),m._panning&&(delete m._panning,m.fi({kind:"endPan",event:O}),m.onPanEnded()),m._rotating&&(delete m._rotating,m.fi({kind:"endRotate",event:O}),m.onRotateEnded()),m._86O&&(delete m._86O,m.fi({kind:"endEditRotation",event:O}),y&&y.endInteraction()),m._87O&&(delete m._87O,m.fi({kind:"endEditSize",event:O}),y&&y.endInteraction()),m._pinching&&(delete m._pinching,m.fi({kind:"endPinch",event:O}),m.onPinchEnded()),m._rectSelecting&&(delete m._rectSelecting,m.fi({kind:"endRectSelect",event:O}),m.onRectSelectEnded()),m._walking&&(delete m._walking,m.fi({kind:"endWalk",event:O}),m.onWalkEnded()),c.dist=c.point=c._62O=c.p3=c.movedata=c.div=c._57I=c._32Q=c._31Q=c.foward=R
}});var Mb=function(H){this.gv=H};jl(Mb,v,{_iv:!0,iv:function(){this._iv=!0},face:function(r,t){var $=this,k=$.gv.getGL();if(!k||!Vp(r))return R;var B=t.x,N=t.width,c=t.height,C=$.height-t.y-c,V=Y(N/2),m=new Uint8Array(4*N*c),A=0;for($.iv(),$.validate(r),Th(k,$.frame),k.readPixels(B,C,N,c,k.RGBA,k.UNSIGNED_BYTE,m),Th(k,R),$.iv();V>=A;A++)for(var a=V-A,G=V+A,J=a;G>=J;J++)for(var M=a;G>=M;M++)if(J===a||J===G||M===a||M===G){var E=Dr.m[m[4*(J*N+M)]];if(E)return E}},get:function(c,H){this.validate();var B=this,J=B.gv.getGL();if(!J)return R;var q,K,V=c.x,d=c.width,u=c.height,r=B.height-c.y-u,n=Y(d/2),l=new Uint8Array(4*d*u),t=0,M=l.length,N=H?R:new fo,x=H?R:{};if(Th(J,B.frame),J.readPixels(V,r,d,u,J.RGBA,J.UNSIGNED_BYTE,l),Th(J,R),H){for(;n>=t;t++)for(var Q=n-t,a=n+t,j=Q;a>=j;j++)for(var D=Q;a>=D;D++)if((j===Q||j===a||D===Q||D===a)&&(q=B.info(l,4*(j*d+D))))return q}else for(;M>t;t+=4)q=B.info(l,t),q&&(K=q.data,x[K._id]||(N.add(K),x[K._id]=K));return N},info:function(l,U){return this.colorMap[(l[U]<<24)+(l[U+1]<<16)+(l[U+2]<<8)+l[U+3]]},validate:function(r){var C=this,_=C.gv,c=_.getGL();if(c){var Q=_.getWidth(),l=_.getHeight(),S=c.RGBA,h=c.TEXTURE_2D,s=c.RENDERBUFFER,U=c.FRAMEBUFFER;C.texture||(C.texture=Qd(c),C.render=c.createRenderbuffer(),C.frame=c.createFramebuffer()),(C.width!==Q||C.height!==l)&&(Mq(c,C.texture),c.texImage2D(h,0,S,Q,l,0,S,c.UNSIGNED_BYTE,R),Dl(c,c.TEXTURE_MIN_FILTER,c.LINEAR),c.bindRenderbuffer(s,C.render),c.renderbufferStorage(s,c.DEPTH_COMPONENT16,Q,l),Th(c,C.frame),c.framebufferTexture2D(U,c.COLOR_ATTACHMENT0,h,C.texture,0),c.framebufferRenderbuffer(U,c.DEPTH_ATTACHMENT,s,C.render),Mq(c,R),c.bindRenderbuffer(s,R),Th(c,R),C.width=Q,C.height=l),C._iv&&(C._iv=!1,Th(c,C.frame),_._42(r||(C.colorMap={}),1),Th(c,R))}}});var ur=function(U){this.gv=U};jl(ur,v,{gap:0,size:0,_42:function(z,u){var y=this,n=y.gv,M=n._gridGap,U=n._gridSize;if(n._gridVisible){if(y.gap!==M||y.size!==U){for(var f=[],F=n._gridSize/2,h=M*F,l=0;2*F+1>l;l++){var m=6*l,W=6*(2*F+1)+m;f[m]=-h,f[m+1]=0,f[m+2]=-h+l*M,f[m+3]=h,f[m+4]=0,f[m+5]=-h+l*M,f[W]=-h+l*M,f[W+1]=0,f[W+2]=-h,f[W+3]=-h+l*M,f[W+4]=0,f[W+5]=h}y.vs=new mj(f),y.gap=M,y.size=U}Rn(n),_q(z,u),ae(z),zp(z,u,1,n._gridColor,n._buffer.vs,y.vs),wh(z,0,y.vs.length/3,z.LINES),Ml(z),Mm(z,u)}else y.vs=y.gap=y.size=R}});var Rr=function(j){this.gv=j};jl(Rr,v,{_42:function(V,i){var G=this.gv,$=G._buffer.vs,S=G._axisXColor,o=G._axisYColor,x=G._axisZColor,D=G._originAxisVisible,b=G._centerAxisVisible;if(D||b){var n=C?V.TRIANGLES:V.TRIANGLE_FAN,E=V.LINES;if(Rn(G),_q(V,i),ae(V),D){var J=G.getCenterInfo(),T=j(J.width,J.height)/5,v=.8*T,O=.05*T;zp(V,i,1.5,S,$,new mj([0,0,0,T,0,0,v,O,0,v,0,O,v,-O,0,v,0,-O,v,O,0,0,0,0,0,T,0,O,v,0,0,v,O,-O,v,0,0,v,-O,O,v,0,0,0,0,0,0,T,O,0,v,0,O,v,-O,0,v,0,-O,v,O,0,v])),wh(V,0,2,E),wh(V,1,6,n),zp(V,i,R,o),wh(V,7,2,E),wh(V,8,6,n),zp(V,i,R,x),wh(V,14,2,E),wh(V,15,6,n)}if(b){var z=G._center,H=z[0],Q=z[1],X=z[2],J=G.getPositionInfo(z);T=j(J.width,J.height)/20,zp(V,i,1.5,S,$,new mj([H,Q,X,H+T,Q,X,H,Q,X,H,Q+T,X,H,Q,X,H,Q,X+T])),wh(V,0,2,E),zp(V,i,R,o),wh(V,2,2,E),zp(V,i,R,x),wh(V,4,2,E)}Ml(V),Mm(V,i)}}});var fr=function(F){this.gv=F},En="edit_tx",Ih="edit_ty",Zn="edit_tz",Cm="edit_rx",Wr="edit_ry",ar="edit_rz",ef="edit_sx",Hg="edit_sy",Vr="edit_sz",We={};We[En]=1,We[Ih]=1,We[Zn]=1,We[Cm]=1,We[Wr]=1,We[ar]=1,We[ef]=1,We[Hg]=1,We[Vr]=1,jl(fr,v,{_42:function(O,Y,B){var J=this,g=J.gv,V=g.sm().ld();if(g.isEditable(V)&&Vp(V)&&(!g.isFirstPersonMode()||!g.isMouseRoamable()&&!b)){Rn(g);var I,z,p=g.isMovable(V),f=g.isRotationEditable(V),W=g.isSizeEditable(V),_=g._axisXColor,P=g._axisYColor,N=g._axisZColor,v=g._editSizeColor,F=g.getCenterInfo(),o=j(F.width,F.height)/10,X=o/(B?5:10),U=.7*o,i=.4*U,t=V.p3(),y=t[0],r=t[1],m=t[2];I=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],p&&J._17O(O,Y,V,B,En,_,I,[y,r-X,m,y+U,r-X,m,y+U,r,m,y+U,r,m,y,r,m,y,r-X,m,y,r-X,m+X,y+U,r-X,m+X,y+U,r-X,m,y+U,r-X,m,y,r-X,m,y,r-X,m+X]),z=y+U,W&&J._17O(O,Y,V,B,ef,v,I,[z,r-X,m,z+i,r-X,m,z+i,r,m,z+i,r,m,z,r,m,z,r-X,m,z,r-X,m+X,z+i,r-X,m+X,z+i,r-X,m,z+i,r-X,m,z,r-X,m,z,r-X,m+X]),z+=i,f&&J._17O(O,Y,V,B,Cm,_,I,[z,r-X,m,z+i,r-X,m,z+i,r,m,z+i,r,m,z,r,m,z,r-X,m,z,r-X,m+X,z+i,r-X,m+X,z+i,r-X,m,z+i,r-X,m,z,r-X,m,z,r-X,m+X]),I=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],p&&J._17O(O,Y,V,B,Ih,P,I,[y,r,m,y,r+U,m,y-X,r+U,m,y-X,r+U,m,y-X,r,m,y,r,m,y,r,m,y,r,m-X,y,r+U,m-X,y,r+U,m-X,y,r+U,m,y,r,m]),z=r+U,W&&J._17O(O,Y,V,B,Hg,v,I,[y,z,m,y,z+i,m,y-X,z+i,m,y-X,z+i,m,y-X,z,m,y,z,m,y,z,m,y,z,m-X,y,z+i,m-X,y,z+i,m-X,y,z+i,m,y,z,m]),z+=i,f&&J._17O(O,Y,V,B,Wr,P,I,[y,z,m,y,z+i,m,y-X,z+i,m,y-X,z+i,m,y-X,z,m,y,z,m,y,z,m,y,z,m-X,y,z+i,m-X,y,z+i,m-X,y,z+i,m,y,z,m]),I=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],p&&J._17O(O,Y,V,B,Zn,N,I,[y,r,m,y,r,m+U,y,r-X,m+U,y,r-X,m+U,y,r-X,m,y,r,m,y,r-X,m,y-X,r-X,m,y-X,r-X,m+U,y-X,r-X,m+U,y,r-X,m+U,y,r-X,m]),z=m+U,W&&J._17O(O,Y,V,B,Vr,v,I,[y,r,z,y,r,z+i,y,r-X,z+i,y,r-X,z+i,y,r-X,z,y,r,z,y,r-X,z,y-X,r-X,z,y-X,r-X,z+i,y-X,r-X,z+i,y,r-X,z+i,y,r-X,z]),z+=i,f&&J._17O(O,Y,V,B,ar,N,I,[y,r,z,y,r,z+i,y,r-X,z+i,y,r-X,z+i,y,r-X,z,y,r,z,y,r-X,z,y-X,r-X,z,y-X,r-X,z+i,y-X,r-X,z+i,y,r-X,z+i,y,r-X,z])}},_17O:function(o,x,Y,Z,e,E,q,U){var v=this.gv._buffer;rs(o,x,Z,!0,Y,e),Qg(o,x,R,!0,R,!0,R,!1),$q(o,x.uDiffuse,E),xo(o,v.vs,new mj(U),x.aPosition),xo(o,v.ns,new mj(q),x.aNormal),ae(o),wh(o,0,12),Ml(o),vf(o,x)}});var Hb=function(y,g){this.gv=y,this.s=function(r,H,f){return H==R&&(H=f),H==R?g.getStyle(r):Sl(H,g,y)},this.data=g};jl(Hb,v,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(q,N,B,J){var W=this,o=W.data;if(!(o instanceof Lh||o instanceof nq)){var w,_,Y,M,S,P,$,F=W.gv,O=o._id,z=W.s("batch"),i=F._34O,p=F._33O,e=F.isSelectable(o),I=F.getBrightness(o),h=I!=R&&1!==I;if(W._iv){if(Y=Er(i,p,o,z),W.validate(Y,z?qn[z]||Rm:R),Y&&(M=i[O],S=M.size=Y.vs.length/3-M.begin,$=Y.rs))for(I=h?I:1,P=0;S>P;P++)$.push(I);if(Vp(o)){var t=F.getWireframe(o);t&&$e(F,o,t)}W.labelInfo=W.label2Info=W.noteInfo=W.note2Info=W._38o=R,W._24O(zj,"getLabel"),W._24O(qo,"getLabel2"),W._26O(Qf,"getNote"),W._26O(Lg,"getNote2"),W._15O(),W._iv=!1}h&&$q(q,N.uBrightness,I),_=rs(q,N,B,e,o,Xo),_&&(zd(_,i[O],p),zd(_,F._polylineIndexMap[O],F._polylineModelMap),zd(_,F._wireframeIndexMap[O],F._wireframeModelMap)),i[O]||W._80o(q,N,J),F.isLabelVisible(o)&&((w=W.labelInfo)&&(rs(q,N,B,e,o,zj),W._28O(w,zj,J)),(w=W.label2Info)&&(rs(q,N,B,e,o,qo),W._28O(w,qo,J))),F.isNoteVisible(o)&&((w=W.noteInfo)&&(rs(q,N,B,e,o,Qf),W._29O(w,Qf,J)),(w=W.note2Info)&&(rs(q,N,B,e,o,Lg),W._29O(w,Lg,J))),(w=W._38o)&&W._99O(q,N,w,B,e,J),h&&$q(q,N.uBrightness,1)}},validate:function(){},_16O:function(){return yr},_80o:function(){},dispose:function(){},getBodyColor:function(J){var o=this.data,b=this.gv.getBodyColor(o);return b?b:J?o.getStyle(J):R},_24O:function(Y,k){var O=this,p=O.data,a=O.gv,b=O.s,T=a[k](p);if(T!=R){var J=b(Y+".scale"),N=b(Y+".max"),y=O[Y+"Info"]={label:T,textureScale:b(Y+".texture.scale"),color:a[k+"Color"](p),font:b(Y+".font"),align:b(Y+".align"),background:a[k+"Background"](p)},Z=y.rect=fi(y,T);N>0&&N<Z.width&&(y.labelWidth=Z.width,Z.width=N),Z.x=Z.y=0,Z.width*=J,Z.height*=J,y.mat=O._16O(b(Y+".autorotate"),b(Y+".position"),Z,b(Y+".face"),b(Y+".t3"),b(Y+".r3"),b(Y+".rotationMode"));var n=Z.width/2,g=Z.height/2;y.vs=new mj([-n,g,0,-n,-g,0,n,-g,0,n,g,0]),Z.width/=J,Z.height/=J}},_26O:function(d,F){var y=this,p=y.data,m=y.gv,q=y.s,H=m[F](p);if(H!=R){var s=q(d+".scale"),Q=this[d+"Info"]={note:H,textureScale:q(d+".texture.scale"),expanded:q(d+".expanded"),font:q(d+".font"),color:q(d+".color"),align:q(d+".align"),borderWidth:q(d+".border.width"),borderColor:q(d+".border.color"),background:m[F+"Background"](p)};if(Q.expanded){var w=q(d+".max"),G=fi(Q,H);G.width+=6,G.height+=2,w>0&&w<G.width&&(Q.labelWidth=G.width,G.width=w);var o={x:-G.width/2,y:-8-G.height,width:G.width,height:G.height+8}}else o={x:-6,y:-18,width:12,height:18};Q.mat=y._16O(q(d+".autorotate"),q(d+".position"),R,q(d+".face"),q(d+".t3"),q(d+".r3"),q(d+".rotationMode")),Q.rect=o,1!==s&&(o=Fm(o),o.x*=s,o.height*=s,o.y=-o.height,o.width*=s);var j=o.x,C=o.y,r=o.width,k=o.height;Q.vs=new mj([j,-C,0,j,-C-k,0,j+r,-C-k,0,j+r,-C,0])}},_28O:function(n,v,D){if(D(this.s(v+".transparent"))){var y=n.rect,P=n.textureScale,Q=y.width*P,H=y.height*P;if(Q>=1&&H>=1){var t=io(Q,H);1!==P&&(t.translate(t,y.x,y.y),t.scale(P,P),t.translate(t,-y.x,-y.y)),Rp(t,n),t.restore(),hp(this,v,n.mat,n.vs,!0)}}},_29O:function(C,o,T){if(T(this.s(o+".transparent"))){var S=C.rect,k=C.textureScale,f=S.x,l=S.y,D=S.width*k,d=S.height*k;if(D>=1&&d>=1){S.x=S.y=0;var a=io(D,d);1!==k&&a.scale(k,k),Jr(a,C),a.restore(),S.x=f,S.y=l,hp(this,o,C.mat,C.vs,!1)}}},_99O:function(E,D,B,o,s,K){if(B){var Z=this,t=Z.gv,q=Z.data,T=t._buffer,P=t._1O,I=B.icons;for(var L in I){var p=I[L],H=B.rects[L];if(H&&K(Sl(p.transparent,q,t))){rs(E,D,o,s,q,L);var x=Sl(p.shape3d,q,t),_=x?[x]:Sl(p.names,q,t),i=_?_.length:0,v=Sl(p.textureScale,q,t)||1,k=Sl(p.light,q,t);k==R&&(k=x?!0:!1),Qg(E,D,Sl(p.blend,q,t),k,Sl(p.opacity,q,t),Sl(p.reverseFlip,q,t),Sl(p.reverseColor,q,t),Sl(p.reverseCull,q,t));for(var w=0;i>w;w++){var N=_[w],Q=H[w];if(Pd(Z,Q.mat),x)vk(t,q,hj(Z,x),Z);else{var U=rd(N);if(U){var C=Q.width*v,z=Q.height*v;if(C>=1&&z>=1){var $=io(C,z);Ti($,U,Sl(p.stretch,q,t),0,0,C,z,q,t),$.restore(),Qd(E,fd,P),ae(E,D,P,Sl(p.discardSelectable,q,t),T.uv,Oj),xo(E,T.vs,Q.vs,D.aPosition),xo(E,T.ns,rp,D.aNormal),Pk(E,T.is,Od),hi(E,0,Od.length),Ml(E,D,P)}}}Rh(t)}vf(E,D)}}}}});var Jg=function(R,x){Lk(Jg,this,[R,x])};jl(Jg,Hb,{_16O:function(x,H,Y,v,R,O,B,t,f){var G=this.data,$=si(H,G.s3(),Y,v,t,f);return Wc(uo(),$,G.p3(),v,R,O,B,x,G.r3(),G.getRotationMode())},clear:function(){var L=this;L.faceMat=L.mat=L.shapeModel=L.left=L.right=L.front=L.back=L.top=L.bottom=L.csg=R},validate:function(V,L){var A=this,w=A.gv,W=A.data,z=hj(A),Z=gj(W,w.getMat(W),z?A.s("shape3d.scaleable"):!0);if(A.clear(),V){var q=[];z?pf(w,W,z,A,A.getBodyColor(),[Z],V,q):(gp(w,W,V,L,Z,Ai,q,il),gp(w,W,V,L,Z,Br,q,cr),gp(w,W,V,L,Z,Id,q,ym),gp(w,W,V,L,Z,Zf,q,_j),gp(w,W,V,L,Z,rh,q,ai),gp(w,W,V,L,Z,vr,q,Ah)),q.length&&(Vk(V.vs,q),Vk(V.ns,ps(q)))}else A.mat=Z,(A.shapeModel=z)||(A.vf(Ai),A.vf(Br),A.vf(rh),A.vf(vr),A.vf(Id),A.vf(Zf))},vf:function(Y){var g=this;if(g.gv.getFaceVisible(g.data,Y)){var I=be(g,Y);return I.mat&&(g.faceMat=!0),I}},_80o:function(M,S,b){var A=this,t=A.gv,m=A.data,p=t._cube,w=A.shapeModel;Rn(t,A.mat),w?vk(t,m,w,A,A.getBodyColor(),b):(xo(M,p.vs,R,S.aPosition),xo(M,p.ns,R,S.aNormal),Pk(M,p.is),A._18O(M,S,A.left,0,b),A._18O(M,S,A.front,6,b),A._18O(M,S,A.right,12,b),A._18O(M,S,A.back,18,b),A._18O(M,S,A.top,24,b),A._18O(M,S,A.bottom,30,b)),Rh(t),A.faceMat&&(A._18O(M,S,A.left,0,b,!0),A._18O(M,S,A.front,6,b,!0),A._18O(M,S,A.right,12,b,!0),A._18O(M,S,A.back,18,b,!0),A._18O(M,S,A.top,24,b,!0),A._18O(M,S,A.bottom,30,b,!0))},_18O:function(H,C,Z,O,M,f){if(Z){if(!M(Z.transparent))return;if(f&&!Z.mat||!f&&Z.mat)return;f&&Rn(this.gv,Z.mat);var L=this,Y=L.data,Q=L.gv,T=Q.getTexture(Z.texture,Y),B=Z.uv,J=Z.uvScale,A=Z.uvOffset,o=Z.discardSelectable;if(T)if(B){for(var w=8*(O/6),$=0;8>$;$++)te[w+$]=B[$];ae(H,C,T,o,Q._buffer.uv,te,A,J)}else ae(H,C,T,o,Q._cube.uv,R,A,J);else ae(H);Qg(H,C,Z.blend,Z.light,Z.opacity,Z.reverseFlip,Z.reverseColor,Z.reverseCull),$q(H,C.uDiffuse,Z.color),hi(H,O,6),vf(H,C),Ml(H,C,T),f&&Rh(Q)}}});var hd=function(u,l){Lk(hd,this,[u,l])};jl(hd,Hb,{_25Q:1,validate:function(i){var c=this,a=c.gv,X=c.data,y=c.s,t=y("edge.width"),n=X._40I,m=X._41I;if(c.shapeModel=c.info=R,n&&m){var d,W,O,l,x,A,I,J,g,U,v=X.isLooped(),s=y(oh),$=M.getEdgeType(s);if($){var D=$(X,Bm(c,a,X,v,s),a,c._19Q);if(!D.points||D.points.isEmpty())return;A=c.info={},I=D.segments,x=D.points,J=x.size();for(var T=n.getElevation(),f=m.getElevation(),Z=0;J>Z;Z++){var r=x.get(Z);r.e==R&&(r.e=T+(f-T)*Z/(J-1))}g=Yr(x.get(0)),U=Yr(x.get(J-1));var z=J%2;0===z?(A.c1=Yr(x.get(J/2-1)),A.c2=Yr(x.get(J/2))):A.p3=Yr(x.get((J-z)/2)),A.s1=g,A.s2=Yr(x.get(1)),A.t1=Yr(x.get(J-2)),A.t2=U}else{x=new fo,A=c.info={};var G=y("edge.offset"),b=y("edge.center"),Y=y("edge.source.t3"),E=y("edge.target.t3"),F=n.p3(),L=m.p3();if(Y&&(F[0]+=Y[0],F[1]+=Y[1],F[2]+=Y[2]),E&&(L[0]+=E[0],L[1]+=E[1],L[2]+=E[2]),s===tg){I=y("edge.segments");var C=A.points=y(kn)||Ze;if(J=C.size()){g=Yr(C.get(0)),U=Yr(C.get(J-1)),!b&&G&&(O=ad(g,F,!0),G=j(G,Tr(F,g)),F=[F[0]+O[0]*G,F[1]+O[1]*G,F[2]+O[2]*G],O=ad(L,U,!0),G=j(G,Tr(U,L)),L=[L[0]-O[0]*G,L[1]-O[1]*G,L[2]-O[2]*G]);var z=J%2;0===z?(d=Yr(C.get(J/2-1)),W=Yr(C.get(J/2))):A.p3=Yr(C.get((J-z)/2)),A.s1=F,A.s2=g,A.t1=U,A.t2=L}else!b&&G&&(O=ad(L,F,!0),l=Tr(F,L),G=rb(G,l),F=[F[0]+O[0]*G,F[1]+O[1]*G,F[2]+O[2]*G],L=[L[0]-O[0]*G,L[1]-O[1]*G,L[2]-O[2]*G]),d=F,W=L;x.add({x:F[0],y:F[2],e:F[1]}),x.addAll(C),x.add({x:L[0],y:L[2],e:L[1]})}else{var q=Bm(c,a,X,v,s);if(c._19Q||(q=-q),v){var S=F[0],Q=F[1],p=F[2],K=n.getTall()/2+q;d=[S-q,Q+K,p],W=[S+q,Q+K,p],x.add({x:S-q,y:p,e:Q}),x.add({x:S-q,y:p,e:Q+K}),x.add({x:S+q,y:p,e:Q+K}),x.add({x:S+q,y:p,e:Q})}else{O=ad(L,F,!0),l=Tr(F,L);var k={x:F[0],y:F[2]},H={x:L[0],y:L[2]},B=ej(R,k,H,q),u=B.x-k.x,o=B.y-k.y;G=rb(G,l),O[0]*=G,O[1]*=G,O[2]*=G,d=[F[0]+O[0]+u,F[1]+O[1],F[2]+O[2]+o],W=[L[0]-O[0]+u,L[1]-O[1],L[2]-O[2]+o],b?(x.add({x:F[0],y:F[2],e:F[1]}),x.add({x:d[0],y:d[2],e:d[1]}),x.add({x:W[0],y:W[2],e:W[1]}),x.add({x:L[0],y:L[2],e:L[1]})):(x.add({x:d[0],y:d[2],e:d[1]}),x.add({x:W[0],y:W[2],e:W[1]}))}}A.c1=d,A.c2=W}A.list=y(hn)===ls?c.createTubeModel(x,I,t/2,i):c.createLineModel(x,I,t,"edge","edge.dash")}}});var Pc=function(A,o){Lk(Pc,this,[A,o])};jl(Pc,Jg,{_80o:function(E,G,f){var c=this,m=c.gv,g=c.shapeModel;Rn(m,c.mat),g?vk(m,c.data,g,c,c.getBodyColor(),f):(Ar(c,E,G,c.left,f),Ar(c,E,G,c.front,f),Ar(c,E,G,c.right,f),Ar(c,E,G,c.back,f),Ar(c,E,G,c.top,f),Ar(c,E,G,c.bottom,f)),Rh(m)},validate:function(e,u){var U,h,V=this,v=V.s,y=V.data,x=y.p3(),j=y._thickness/2,T=y.isClosePath(),J=y.getPoints(),m=y.getSegments(),B=v(Bs),Q=e&&e.uv;if(V.clear(),0>j)h=V.shapeModel=mc(J,m,v(Yq),v(Wl),B,v(fp),y.getTall(),y.getElevation(),T),v(Mg)?v("shape3d.image")||delete h.uv:(delete h.vs,delete h.ns,delete h.uv),v("shape3d.top.image")||delete h.top_uv,v("shape3d.bottom.image")||delete h.bottom_uv;else if(v(hn)===ls)U=Do(J,m,B,T),h=V.shapeModel={vs:[]},v("shape3d.image")&&(h.uv=[],h.sum=v(fp)||wf(U)||1,h.len=0),v(Yq)&&!T&&(h.top_vs=[],v("shape3d.top.image")&&(h.top_uv=[])),v(Wl)&&!T&&(h.bottom_vs=[],v("shape3d.bottom.image")&&(h.bottom_uv=[])),V._12O(U,j);else{var D,k,f,_,o,r,p,F,S,l;U=Do(J,m,B,T),o=V.vf(rh,Q,!1,u),j&&(r=V.vf(vr,Q,!1,u),p=T?R:V.vf(Ai,Q,!1,u),F=T?R:V.vf(Br,Q,!1,u),S=V.vf(Id,Q,!1,u),l=V.vf(Zf,Q,!1,u)),j?V._12O(U,j):o&&U.forEach(function(y){if(_=y.length,_>0)for(D=y[0],f=1;_>f;f++)k=y[f],V.addV(o.vs,D,k),D=k}),V._20Q(U),e||(o&&(o.ns=ps(o.vs),Ei(o,"vs"),Ei(o,$n)),j&&(r&&(r.ns=ps(r.vs),Ei(r,"vs"),Ei(r,$n)),p&&(p.ns=ps(p.vs),Ei(p,"vs"),Ei(p,$n)),F&&(F.ns=ps(F.vs),Ei(F,"vs"),Ei(F,$n)),S&&(S.ns=ps(S.vs),Ei(S,"vs"),Ei(S,$n)),l&&(l.ns=ps(l.vs),Ei(l,"vs"),Ei(l,$n))))}var N=V.mat=uo();ud(N,x),Kk(N,y.r3(),y.getRotationMode()),ud(N,ir(x)),e&&(Ed(V,N,e,h),V.clear())},_20Q:function(u){var K,G,L,W,N,r,x,U=this,J=U.front,F=U.back,p=U.top,E=U.bottom,q=J?J.tuv:R,T=F?F.tuv:R,O=p?p.tuv:R,h=E?E.tuv:R,M=0;(q||T||O||h)&&(K=U.s(fp)||wf(u)||1,u.forEach(function(T){if(G=T.length,G>0)for(r=T[0],L=1;G>L;L++)x=T[L],W=M/K,M+=Tr(r,x),N=M/K,U._14O(J,W,N),U._14O(F,1-N,1-W),U._14O(p,W,N),U._14O(E,W,N),r=x}))},_14O:function(g,M,T){if(g){var b=g.uv,P=g.tuv;if(P){if(b)var y=b[0]+(b[6]-b[0])*M,h=b[1]+(b[7]-b[1])*M,s=b[2]+(b[4]-b[2])*M,x=b[3]+(b[5]-b[3])*M,n=b[2]+(b[4]-b[2])*T,Y=b[3]+(b[5]-b[3])*T,S=b[0]+(b[6]-b[0])*T,u=b[1]+(b[7]-b[1])*T;else y=M,h=0,s=M,x=1,n=T,Y=1,S=T,u=0;P.push(s,x,n,Y,S,u,S,u,y,h,s,x)}}},_13O:function(S){var g=S.uv,j=S.tuv;j&&(g?j.push(g[2],g[3],g[4],g[5],g[6],g[7],g[6],g[7],g[0],g[1],g[2],g[3]):j.push(0,1,1,1,1,0,1,0,0,0,0,1))},_12O:function(q,h){var n,T,e,p,L,G=this;q.forEach(function(q){if(L=q.length,L>0)for(n={p:q[0],n:!0},p=1;L>p;p++)T=q[p],e=L-1>p?q[p+1]:R,G.addPoint(n,T,e,h,q)})},addPoint:function(d,z,p,Q,P){var G,a,F,M,W,r,I,Y,k,l=this,f=d.p,v=d.f,$=d.b,U=l.s("shape3d.side")||ri,w=l.s("shape3d.start.angle"),c=l.s("shape3d.sweep.angle"),m=l.shapeModel,i=l.data.isClosePath();if(d.n&&(d.n=!1,v=i&&P.length>2?ej(P[P.length-2],f,z,Q):ej(R,f,z,Q),$=ep(f,v),m?m.top_vs&&l._10O($,v,U,w,c,m.top_vs,m.top_uv):(G=l.left)&&(l.addV(G.vs,$,v),l._13O(G))),a=p?ej(f,z,p,Q):i&&P.length>2?ej(f,z,P[1],Q):ej(f,z,R,Q),F=ep(z,a),m){var O,E,K=m.vs,q=m.uv,h=m.sum;for(q&&(O=m.len/h,m.len+=Tr(f,z),E=m.len/h),r=l._9O($,v,U,w,c),I=l._9O(F,a,U,w,c),Y=0;U>Y;Y++)k=Y+1,Vk(K,r[k]),Vk(K,I[Y]),Vk(K,r[Y]),Vk(K,I[Y]),Vk(K,r[k]),Vk(K,I[k]),q&&(M=Y/U,W=k/U,q.push(O,W,E,M,O,M,E,M,O,W,E,W));!p&&m.bottom_vs&&l._10O(F,a,U,w,c,m.bottom_vs,m.bottom_uv,!0)}else!p&&(G=l.right)&&(l.addV(G.vs,a,F),l._13O(G)),(G=l.front)&&l.addV(G.vs,v,a),(G=l.back)&&l.addV(G.vs,F,$),(G=l.top)&&l.addH(G.vs,v,a,F,$,!0),(G=l.bottom)&&l.addH(G.vs,$,F,a,v);d.p=z,d.f=a,d.b=F},_10O:function(b,T,i,L,$,k,E,w){var Z,D,W=this,n=W.data,j=W._9O(b,T,i,L,$),t=(b.x+T.x)/2,U=(b.y+T.y)/2,M=n.getElevation(),V=0;for(V=0;i>V;V++)w?(Vk(k,j[V]),Vk(k,j[V+1])):(Vk(k,j[V+1]),Vk(k,j[V])),Vk(k,[t,M,U]),E&&(w?(Z=B*(V+1)/i+L,D=B*V/i+L):(Z=B*V/i+L,D=B*(V+1)/i+L),E.push(.5-.5*_(D),.5-.5*P(D),.5-.5*_(Z),.5-.5*P(Z),.5,.5))},_9O:function(z,M,b,n,j){var e,l,d=this,G=d.data,Y=[],u=(z.x+M.x)/2,L=(z.y+M.y)/2,Z=G.getTall()/2,f=G.getElevation(),i=0;for(j=j||B;b>=i;i++)e=j*i/b+n,l=_(e),Y.push([u+(z.x-u)*l,f+Z*P(e),L+(z.y-L)*l]);return Y},addV:function(X,K,S){var Z=K.x,P=K.y,f=S.x,E=S.y,R=this.data,v=R.getElevation(),w=R.getTall()/2;X.push(Z,v-w,P,f,v-w,E,f,v+w,E,f,v+w,E,Z,v+w,P,Z,v-w,P)},addH:function(r,n,w,t,p,R){var N=this.data,z=N.getTall()/2,Q=N.getElevation()+(R?z:-z);r.push(n.x,Q,n.y,w.x,Q,w.y,t.x,Q,t.y,t.x,Q,t.y,p.x,Q,p.y,n.x,Q,n.y)},vf:function(C,W,t,f){var u,o=this,x=o.gv.getFaceVisible(o.data,C);return(t||x)&&(u=be(o,C,f),u.vs=[],u.tuv=x&&(u.texture||W)?[]:R,u.visible=x),u}});var we=function(a,E){Lk(we,this,[a,E])};jl(we,Hb,{_25Q:1,validate:function(g){var b=this,k=b.data,d=b.s,s=k.getPoints(),t=s.size();if(b.shapeModel=b.info=R,t>1){var P=b.info={},e=k.getSegments(),X=k.getThickness(),$=Yr(s.get(0)),M=Yr(s.get(t-1)),i=t%2;0===i?(P.c1=Yr(s.get(t/2-1)),P.c2=Yr(s.get(t/2))):P.p3=Yr(s.get((t-i)/2)),P.s1=$,P.s2=Yr(s.get(1)),P.t1=Yr(s.get(t-2)),P.t2=M,P.list=d(hn)===ls?b.createTubeModel(s,e,X/2,g):b.createLineModel(s,e,X,"shape.border","shape.dash")}}}),Jn(M,{accordionViewExpandIcon:wn(Xq),accordionViewCollapseIcon:wn(Xq,!0),accordionViewLabelColor:qe,accordionViewLabelFont:Ne,accordionViewTitleBackground:Eb,accordionViewSelectBackground:He,accordionViewSelectWidth:3,accordionViewSeparatorColor:t,splitViewDividerSize:1,splitViewDividerBackground:Eb,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:_g,rect:[2,2,12,12],background:Xq}]},propertyViewLabelColor:Iq,propertyViewLabelSelectColor:qe,propertyViewLabelFont:Ne,propertyViewExpandIcon:wn(Om),propertyViewCollapseIcon:wn(Om,!0),propertyViewBackground:Hf,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Hh,propertyViewColumnLineColor:Hh,propertyViewSelectBackground:He,listViewLabelColor:Iq,listViewLabelSelectColor:qe,listViewLabelFont:Ne,listViewRowLineVisible:!1,listViewRowLineColor:Hh,listViewSelectBackground:He,treeViewLabelColor:Iq,treeViewLabelSelectColor:qe,treeViewLabelFont:Ne,treeViewExpandIcon:wn(Kb),treeViewCollapseIcon:wn(Kb,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Hh,treeViewSelectBackground:He,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Iq,tableViewLabelSelectColor:qe,tableViewLabelFont:Ne,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Hh,tableViewColumnLineColor:Hh,tableViewSelectBackground:He,treeTableViewLabelColor:Iq,treeTableViewLabelSelectColor:qe,treeTableViewLabelFont:Ne,treeTableViewExpandIcon:wn(Kb),treeTableViewCollapseIcon:wn(Kb,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Hh,treeTableViewColumnLineColor:Hh,treeTableViewSelectBackground:He,tableHeaderLabelColor:Iq,tableHeaderLabelFont:Ne,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:tn,tableHeaderBackground:Hf,tableHeaderMoveBackground:yo,tableHeaderInsertColor:He,tableHeaderSortDescIcon:Bc(Om,!0),tableHeaderSortAscIcon:Bc(Om),tabViewTabGap:1,tabViewLabelColor:qe,tabViewLabelFont:Ne,tabViewTabBackground:Eb,tabViewSelectWidth:3,tabViewSelectBackground:He,tabViewMoveBackground:yo,tabViewInsertColor:He,toolbarLabelColor:Iq,toolbarLabelSelectColor:qe,toolbarLabelFont:Ne,toolbarBackground:Hf,toolbarSelectBackground:He,toolbarItemGap:8,toolbarSeparatorColor:js},!0);var hr={translateX:1,sortColumn:1},Pe={sortable:1,sortOrder:1,sortFunc:1},qi={focusData:1},di={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},ms={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},on=function(D,r){r.add(D),D.hasChildren()&&D.eachChild(function(y){on(y,r)})},qm=function(U,c,j,Y,J,n,X,b,Q,$,H){var r,v=j.getValueType($),s=j.getAlign($);if(j.getEnumValues($)){var w=j.toEnumLabel(c,$),E=um||0,P=0,z=n,Z=M.getTextSize(Y,w).width;return r=rd(j.toEnumIcon(c,$)),r&&(P=n+um/2,"center"===s?P+=(b-(E+Z))/2:"right"===s&&(P=P+b-(E+Z)),Zq(U,r,P,X+Q/2),z=P+um/2),w!=R&&(r?ji(U,w,Y,J,z,X,b-(z-n),Q):ji(U,w,Y,J,n,X,b,Q,s)),void 0}return c=j.formatValue(c),c!=R?v===ho?(Ko(U,n,X,b,Q,c),void 0):v===zn||!v&&nj(c)?(r=rd(c?qc:yi),Zq(U,r,n+b/2,X+Q/2,$,H),void 0):(ji(U,c,Y,J,n,X,b,Q,s),void 0):void 0},Fq=function(v,D){var o=D.view,Q=o.getDataModel().getHistoryManager(),d=El(v),b=D.column||D.property;Q&&Q.beginInteraction(),D.editor=v,v.info=D,o.setCurrentEditor(v),o.getView().insertBefore(d,o._79O),Se(v,D.editorRect),v.setFocus?v.setFocus():Zj(v),v.commitValue=function(){v._17Q&&(v=v._17Q),o.setValue(D.data,b,v.getValue?v.getValue():v.value),v.close&&v.close(),Mf(d)},b.onEditorCreated&&b.onEditorCreated(D)},Jo=function(G,u,d,$,l){var z=Wp(G,d),S=u.value,h=u.view,s=l.getValueType(u.data);return z.onblur=z.onchange=function(){h.endEditing()},"input"===G?(S=l.formatValue(S),S!=R&&(z.value=S),z.onkeydown=function(O){Ad(O)&&h.endEditing()},(s===Eg||s===ib)&&z.addEventListener(cf,M.numberListener,!1)):G===xj&&$.forEach(function(k){var h=X.createElement("option");h.innerHTML=l.toEnumLabel(k),h.value=k,l.isEnumEqual(S,k)&&(h.selected=!0),Gl(z,h)}),Fq(z,u),z},Tc=K.widget={},Xr=function(b,v,k){jl(d+".widget."+b,v,k)};Jn(qs,{ms_value:function($){$.getValue=function(X){var d=this.getItemById(X),i=d.element;return Bn(i)?i:i?i.getValue?i.getValue():i.value:d.selected},$.setValue=function(A,g){var z=this.getItemById(A),Y=z.element;Y&&!Bn(Y)?Y.setValue?Y.setValue(g):Y.value=g:nj(g)?(z.selected=g,this.iv()):(z.element=g,this.iv())},$.v=function(m,E){var V=this;if(2===arguments.length)V.setValue(m,E);else{if(!zr(m))return V.getValue(m);for(var g in m)V.setValue(g,m[g])}return V}},_46o:function(w){w._icon=R,w._accessType=R,w._valueType=R,w._editable=!1,w._batchEditable=!0,w._align=Ai,w._nullable=!0,w._emptiable=!1,w.setParent=li,w.formatValue=function(u){var b=this,C=b._valueType;return b.getEnumValues()?b.toEnumLabel(u):C===zn?!!u:u!=R&&C===Eg?l(u):u},w.setEnum=function(x,i,s,F,e,b,p){var _=this;x&&!dr(x)&&x.values&&(F=x.editable,s=x.icons,i=x.labels,e=x.strict,b=x.maxHeight,p=x.dropDownWidth,x=x.values),_p(x)&&(x=x._as),_p(i)&&(i=i._as),_p(s)&&(s=s._as),_._enumValues=x,_._enumLabels=i,_._enumIcons=s,_._enumEditable=F,_._enumStrict=e==R?!0:e,_._enumMaxHeight=b,_._enumDropDownWidth=p,x&&x.length&&kj(x[0])&&(_._valueType=ib),_.fp("enum",!1,!0)},w.getEnumDropDownWidth=function(){return this._enumDropDownWidth},w.getEnumMaxHeight=function(){return this._enumMaxHeight},w.isEnumEditable=function(){return this._enumEditable},w.getEnumValues=function(){return this._enumValues},w.getEnumLabels=function(){return this._enumLabels},w.getEnumIcons=function(){return this._enumIcons},w.isEnumStrict=function(){return this._enumStrict},w.isEnumEqual=function(n,M){return this._enumStrict?n===M:n==M},w.toEnumLabel=function(W,s){var l=this,P=l.getEnumValues(s),d=l.getEnumLabels(s);if(P&&d)for(var E=0;E<P.length;E++)if(l.isEnumEqual(W,P[E]))return d[E];return W},w.toEnumIcon=function(n,Y){var v=this,P=v.getEnumValues(Y),i=v.getEnumIcons(Y);if(P&&i)for(var l=0;l<P.length;l++)if(v.isEnumEqual(n,P[l]))return i[l];return t}},_45o:function(v){v._87o=function(J,e,r,d,L,x){if(J){var R=this,h=R._90I,U=so(1);R._columnLineVisible&&(L-=1),R._rowLineVisible&&(x-=1),0>=L||0>=x||(R._90I||(h=R._90I={}),h[e]||(h[e]=new fo),Se(U,R.tx()+r,R.ty()+d,L,x),Gl(U,J),R._view.insertBefore(U,R._79O),J.onParentAdded&&J.onParentAdded(U),h[e].add(U))}},v._76o=function(){var G=this,J=G._90I;if(J){for(var r in J)J[r].each(function(t){Mf(t)});delete G._90I}},v._77o=function(A){var p=this;if(p._90I){var H=p._90I[A];H&&(H.each(function(T){Mf(T)}),delete p._90I[A])}}},_47o:function(A){A.getValue=function(Q,M){return M.getValue?M.getValue(Q,M,this):Vj(Q,M.getAccessType(),M.getName())},A.setValue=function(o,n,k){if(n.isEmptiable(o)||""!==k||(k=t),n.isNullable(o)||k!=R){var x=this,D=n.getName(o),X=n.getAccessType(o),K=n.getValueType(o);K===Eg&&Bn(k)?k=h(k):K===ib&&Bn(k)?k=parseFloat(k):K===zn&&Bn(k)&&(k="true"===k),x._batchEditable&&n._batchEditable&&x.isSelected(o)?x.sm().each(function(r){n.setValue?n.setValue(r,n,k,x):$p(r,X,D,k)}):n.setValue?n.setValue(o,n,k,x):$p(o,X,D,k)}},A.setCurrentEditor=function(T){this.endEditing(),this._currentEditor=T,this.redraw()},A.isEditing=function(Z,i){var O=this,t=O._currentEditor;if(!t)return!1;if(i){var m=t.info;return m?(m.column||m.property)===i&&m.data===Z:!1}return!0},A.endEditing=function(){var F=this,b=F._currentEditor,e=F.getDataModel().getHistoryManager();b&&(delete F._currentEditor,b.commitValue&&b.commitValue(b.info),F.redraw(),e&&e.endInteraction())},A.beginEditing=function(o){this.endEditing();var j=this,n=o.column||o.property;if(n.beginEditing)n.beginEditing(o);else{var P=o.data,L=o.value,w=j.getSelectBackground(P),N=n.getEnumValues(P),O=n.getSlider(P),U=n.getColorPicker(P);if(O){var p=ue(Tc.Slider,O);return p.setValue(L),p.getView().onblur=function(){j.endEditing()},p.isInstant()&&(p.onValueChanged=function(){j.setValue(P,n,p.getValue())}),Fq(p,o),void 0}if(U||n.getValueType(P)===ho){var q=ue(Tc.ColorPicker,U);return q.setValue(L),q.onClosed=function(){j.endEditing()},q.isInstant()&&(q.onValueChanged=function($,T){j.setValue(P,n,T)}),Fq(q,o),q.open(),void 0}if(N){if(Tc.ComboBox){var k=new Tc.ComboBox;k.setValue(L),k.setValues(N),k.setLabels(n.getEnumLabels(P)),k.setIcons(n.getEnumIcons(P)),k.setEditable(n.isEnumEditable(P)),k.setStrict(n.isEnumStrict(P)),k.setMaxHeight(n.getEnumMaxHeight(P)),k.setDropDownWidth(n.getEnumDropDownWidth(P)),k.onClosed=function(){j.endEditing()},Fq(k,o),k.open()}else Jo(xj,o,w,N,n);return}var a=n.getValueType(P);if(a===zn||nj(L))return j.setValue(P,n,!L),void 0;if(n.getItemEditor(P)){var y=Nc(n.getItemEditor(P)),F=new y(P,n,j,o),u=F.getView();return u._17Q=F,F.setValue(L),vi(u),Fq(u,o),F.editBeginning&&F.editBeginning(),void 0}Jo("input",o,w,R,n)}}},_44o:function(R){R.init=function(c){var b=this,C=b.th=new Hp(c),w=b._view=Qm(1,b);b.tv=b._tableView=c,Gl(w,C.getView()),Gl(w,c.getView()),C.mp(function(z){z.property===vd&&b.iv()}),b.iv()},R.getTableView=function(){return this.tv},R.getTableHeader=function(){return this.th},R.getDataModel=function(){return this.tv.dm()},R.getColumnModel=function(){return this.tv.getColumnModel()},R.setColumns=function(d){this.tv.setColumns(d)},R.addColumns=function(D){this.tv.addColumns(D)},R.endEditing=function(){this.tv.endEditing()},R.validateImpl=function(){var A=this,j=A.th,F=fj(j),O={x:0,y:0,width:A.getWidth(),height:F};Se(j,O),O.y=F,O.height=I(0,A.getHeight()-F),Se(A.tv,O)}},ms_vs:function(c){c._41o=function(){return this._29I.height<this._59I},c._43o=function(){var F=this;F._41o()&&(F._58I||(e(function(){F._94O()},Xe),F.iv()),F._58I=new Date)},c._94O=function(){var W=this;if(W._58I){var Y=new Date;Y.getTime()-W._58I.getTime()>=Xe?(delete W._58I,W.iv()):e(function(){W._94O()},Xe)}},c._93I=function(){var W=this,F=W._27I;if(W._58I||!W._autoHideScrollBar){F||Gl(W._79O,F=W._27I=so());var f=W._29I,u=f.height,o=W._59I,h=W.getScrollBarSize(),i=f.width-h-2,q=u*(-W.ty()/o),V=u*(u/o),n=F.style;o>u?(fe>V&&(q=q+V/2-fe/2,0>q&&(q=0),q+fe>u&&(q=u-fe),V=fe),n.visibility=Cn,n.background=W.getScrollBarColor(),n.borderRadius=h/2+Yo,Se(F,i,q,h,V)):n.visibility=nm}else F&&(F.style.visibility=nm)}},ms_hs:function(V){V._40o=function(){return this._29I.width<this._91I},V._42o=function(){var J=this;J._40o()&&(J._95O||(e(function(){J._94I()},Xe),J.iv()),J._95O=new Date)},V._94I=function(){var H=this;if(H._95O){var C=new Date;C.getTime()-H._95O.getTime()>=Xe?(delete H._95O,H.iv()):e(function(){H._94I()},Xe)}},V._92I=function(){var R=this,Q=R._28I;if(R._95O||!R._autoHideScrollBar){Q||Gl(R._79O,Q=R._28I=so());var j=R._29I,B=j.width,i=R._91I,m=R.getScrollBarSize(),N=j.height-m-2,D=B*(-R.tx()/i),M=B*(B/i),c=Q.style;i>B?(fe>M&&(D=D+M/2-fe/2,0>D&&(D=0),D+fe>B&&(D=B-fe),M=fe),c.visibility=Cn,c.background=R.getScrollBarColor(),c.borderRadius=m/2+Yo,Se(Q,D,N,M,m)):c.visibility=nm}else Q&&(Q.style.visibility=nm)}}}),Ij(qc,Vg(16,16,[{type:ch,rect:[1,1,14,14],background:He},{type:bi,rect:[1,1,14,14],width:1,color:Sn},{type:kr,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Ij(yi,Vg(16,16,{type:bi,rect:[1,1,14,14],width:1,color:Sn})),Ij(Xj,Vg(16,16,[{type:Ll,rect:[2,2,12,12],borderWidth:1,borderColor:Sn,background:"#FFF"},{type:Ll,rect:[4,4,8,8],background:He}])),Ij(nc,Vg(16,16,{type:Ll,rect:[2,2,12,12],borderWidth:1,borderColor:Sn})),qs._15Q=function(L){L._29I=fc,L._59I=0,L._91I=0,L._5o=function(H){var F=this;F._30I=new fo,F._rows=new fo,F._rowMap={},F._31I=0,F._14I=0,F._view=Qm(1,F),F._canvas=bg(F._view),Gl(F._view,F._79O=so()),F.dm(H?H:new mf)},L.getCheckIcon=function(X){var R=this.sm(),Q=R.co(X);return R.sg()?rd(Q?Xj:nc):rd(Q?qc:yi)},L.checkData=function(F){var C=this.sm(),h=C.co(F);C.sg()&&h||(this._32o=1,h?C.rs(F):C.as(F),delete this._32o)},L.getDataAt=function(q){q.target&&(q=this.lp(q));var M=Y(q.y/this._rowHeight),H=this._rows;return 0>M||M>=H.size()?R:H.get(M)},L.onDataDoubleClicked=function(){},L.onDataClicked=function(){},L.adjustTranslateX=function(){return 0},L.adjustTranslateY=function(t){var Z=this.getHeight()-this._59I;return Z>t&&(t=Z),t>0?0:l(t)},L.onPropertyChanged=function(Y){var J=this,C=Y.property;di[C]?J.ivm():qi[C]||J.redraw(),C===Jq?J._42o():C===_f&&J._43o()},L.getLabel=function(p){return p.toLabel()},L.getLabelFont=function(){return this._labelFont},L.getLabelColor=function(C){var p=this;if(p.isCheckMode()){if(p._focusData===C)return p._labelSelectColor}else if(p.isSelected(C))return p._labelSelectColor;return p._labelColor},L.getStartRowIndex=function(){return this._31I},L.getEndRowIndex=function(){return this._14I},L.getRowDatas=function(){return this._rows},L.getRowIndex=function(A){return this._rowMap[A._id]},L.getRowSize=function(){return this._rows.size()},L.getViewRect=function(){return Fm(this._29I)},L.isVisible=function(w){return this._visibleFunc?this._visibleFunc(w):!0},L.getCurrentSortFunc=function(){return this._sortFunc},L.setDataModel=function(x){var t=this,U=t._dataModel,X=t._selectionModel;U!==x&&(U&&(U.umm(t.handleDataModelChange,t),U.umd(t.handleDataPropertyChange,t),U.umh(t.handleHierarchyChange,t),X||U.sm().ums(t.handleSelectionChange,t)),t._dataModel=x,x.mm(t.handleDataModelChange,t),x.md(t.handleDataPropertyChange,t),x.mh(t.handleHierarchyChange,t),X?X._21I(x):x.sm().ms(t.handleSelectionChange,t),t.fp("dataModel",U,x))},L.validateModel=function(){var d=this;d._rows.clear(),d._rowMap={},d.buildChildren(d._dataModel._roots);var N=d._rows=d._rows.toList(d.isVisible,d),V=0,M=d.getCurrentSortFunc(),Y=N.size();for(M&&N.sort(M);Y>V;V++)d._rowMap[N.get(V)._id]=V},L.buildChildren=function(v){var z=this;v.each(function(h){z._rows.add(h),z.buildChildren(h._children)})},L.handleDataModelChange=function(){this.ivm()},L.handleDataPropertyChange=function(P){"parent"===P.property?this.ivm():this.invalidateData(P.data)
},L.handleHierarchyChange=function(){this.ivm()},L.handleSelectionChange=function(L){L.datas.each(this.invalidateData,this),this.onSelectionChanged(L)},L.onSelectionChanged=function(B){var T=this,G=T.sm();!T.isAutoMakeVisible()||1!==G.size()||"set"!==B.kind&&"append"!==B.kind||T._32o||T.makeVisible(G.ld())},L.handleBackgroundClick=function(z){fq(z)&&!this.isCheckMode()&&this.sm().cs()},L.makeVisible=function(k){k&&(this._23I=k,this.iv())},L.scrollToIndex=function(p){var $=this,C=$._29I,k=C.height,s=$._rowHeight,a=s*p;p>=0&&p<$._rows.size()&&k>0&&(a+s>C.y+k?$.ty(-a+k-s):a<C.y&&$.ty(-a))},L.autoScroll=function(W,L){var k=this,E=k._rowHeight,Y=E,u=E/4,I=k._29I,D=k.lp(W),s={x:k.tx(),y:k.ty()};return E>0&&I&&(D.x-I.x<Y?k.translate(u,0):I.x+I.width-D.x<Y&&k.translate(-u,0),D.y-I.y<Y?k.translate(0,u):I.y+I.height-D.y<Y&&k.translate(0,-u)),s.x=k.tx()-s.x,s.y=k.ty()-s.y,L&&(L.x+=s.x,L.y+=s.y),s},L.getTopRowOrderSelection=function(){var w=this.sm().getTopSelection(),P={},b=new fo;return w.each(function(q){P[q._id]=q}),this._rows.each(function(C){P[C._id]&&b.add(C)}),b},L.getRowOrderSelection=function(){var I=new fo;return this._rows.each(function($){this.isSelected($)&&I.add($)},this),I},L.ivm=function(){this.invalidateModel()},L.invalidateModel=function(){var A=this;A._96I||(A._96I=1,A._32I=1,delete A._24I),A.iv()},L.redraw=function(){var N=this;N._32I||(N._32I=1,delete N._24I,N.iv())},L.invalidateData=function(K){var A=this;H?A.redraw():A._32I||(A._24I||(A._24I={}),A._24I[K._id]=K,A.iv())},L.getFocusData=function(){return this._focusData},L.setFocusDataById=function(r){this.setFocusData(this.dm().getDataById(r))},L.setFocusData=function(C){var S=this,o=S._focusData;o!==C&&(S._focusData=C,S.fp("focusData",o,C),o&&S.invalidateData(o),C&&(S.invalidateData(C),S.isAutoMakeVisible()&&S.makeVisible(C)))},L.drawRowBackground=function(i,S,V,s,b,e,H){var j=this,k=j.isCheckMode();(S===j._focusData&&k||V&&!k)&&Ko(i,s,b,e,H,j.getSelectBackground(S))},L.drawData=function(A,L,g){var a=this,W=a._rowHeight,N=W*g,i=a._29I,D=i.x,e=i.width;A.save(),A.beginPath(),A.rect(D,N,e,W),A.clip(),a._87o(a.drawRow(A,L,a.isSelected(L),D,N,e,W),g,D,N,e,W),A.restore(),a._rowLineVisible&&Ko(A,D,N+W-1,e,1,a._rowLineColor)},L._12I=function(u){var X=this,z=X._31I,U=X._29I,W=U.x,d=U.y,j=U.width,t=U.height;for(u.beginPath(),u.rect(W,d,j,t),u.clip(),u.clearRect(W,d,j,t),X._76o(),X._93db(u);z<X._14I;z++)X.drawData(u,X._rows.get(z),z);X._92db(u)},L._13I=function(e){for(var M,$=this,_=$._rowHeight,D=$._29I,x=D.x,A=D.width,w=$._31I,q=$._30I;w<$._14I;w++)M=$._rows.get(w),$._24I[M._id]&&q.add({data:M,index:w});q.isEmpty()||(e.beginPath(),q.each(function(T){e.rect(x,T.index*_,A,_)}),e.clip(),q.each(function(S){e.clearRect(x,S.index*_,A,_)}),q.each(function(c){$._77o(c.index)}),$._93db(e),q.each(function(G){$.drawData(e,G.data,G.index)}),$._92db(e),q.clear())},L.validateImpl=function(){var J=this,Q=J._canvas,N=J.getWidth(),A=J.getHeight(),u=J._rowHeight,G=J._32I;(N!==Q.clientWidth||A!==Q.clientHeight)&&(ds(Q,N,A),G=1);var L=x&&!O;J._96I&&!L&&J.validateModel();var P=J._29I,D={x:-J.tx(),y:-J.ty(),width:N,height:A},m=J._rows.size(),p=mm(Q),b=J._23I;G||Tm(D,P)||(G=1),J._29I=D,J._59I=m*u,J._31I=Y(D.y/u),J._14I=y((D.y+D.height)/u),J._31I<0&&(J._31I=0),J._14I>m&&(J._14I=m),J._99I&&G&&J._99I(),vg(p,J.tx(),J.ty(),1),G?J._12I(p):J._24I&&J._13I(p),J._93I(),J._92I(),p.restore(),J._32I=J._24I=J._96I=R,b&&(J.scrollToIndex(J.getRowIndex(b)),delete J._23I),J.tx(J.tx()),J.ty(J.ty())}},qs._48o=function(O){O._rootVisible=!0,O._rootData=R,O._35o=function(){this._expandMap={},this._levelMap={}},O.validateModel=function(){var i=this,u=i._rootData;i._rows.clear(),i._levelMap={},i._rowMap={},i._currentLevel=0,u?i._rootVisible?i.isVisible(u)&&i.buildData(u):i.buildChildren(u):i.buildChildren(),delete i._currentLevel},O.buildData=function(j){var J=this,Y=j._id,H=J._rows;J._rowMap[Y]=H.size(),H.add(j),J._levelMap[Y]=J._currentLevel,J.isExpanded(j)&&(J._currentLevel++,J.buildChildren(j),J._currentLevel--)},O.buildChildren=function(X){var E=this,W=X?X._children:E._dataModel._roots,h=E.getCurrentSortFunc();h&&E.isChildrenSortable(X)?W.toList(E.isVisible,E).sort(h).each(E.buildData,E):W.each(function(B){E.isVisible(B)&&E.buildData(B)})},O.getLevel=function(z){return this._levelMap[z._id]},O.getToggleIcon=function(q){var r=this,f=r._loader,b=r._collapseIcon;return f&&!f.isLoaded(q)?b:q.hasChildren()?r.isExpanded(q)?r._expandIcon:b:R},O.isCheckMode=function(){return this._checkMode!=R},O.isChildrenSortable=function(){return!0},O.handleDataModelChange=function(f){var V=this;f.kind===to?delete V._expandMap[f.data._id]:f.kind===cj&&(V._expandMap={}),V.ivm()},O.toggle=function(a){var T=this;T.isExpanded(a)?T.collapse(a):T.expand(a)},O.isExpanded=function(H){return 1===this._expandMap[H._id]},O.expand=function(A){var b=this,$=b._loader;b.isExpanded(A)||($&&!$.isLoaded(A)&&$.load(A),b._expandMap[A._id]=1,b.ivm(),b.onExpanded(A))},O.onExpanded=function(){},O.collapse=function(J){var z=this;z.isExpanded(J)&&(delete z._expandMap[J._id],z.ivm(),z.onCollapsed(J))},O.onCollapsed=function(){},O.expandAll=function(){var A=this;A._dataModel.each(function(H){H.hasChildren()&&(A._expandMap[H._id]=1)}),A.ivm()},O.collapseAll=function(){this._expandMap={},this.ivm()},O.makeVisible=function(H){if(H){var P=this;if(!P._rootData||H.isDescendantOf(P._rootData)){for(var T=H._parent;T;)P.expand(T),T=T._parent;P._23I=H,P.iv()}}},O.checkData=function(C){var k,N=this,G=N._checkMode,T=N.sm(),E=T.co(C);if(!T.sg()||!E){if(N._32o=1,G===$)E?T.rs(C):T.as(C);else if(G===Tb)k=new fo(C),k.addAll(C._children);else if("descendant"===G)k=new fo,on(C,k);else if("all"===G&&(k=new fo,on(C,k),!E))for(var u=C._parent;u;)k.add(u),u=u._parent;k&&(E?T.rs(k):T.as(k)),delete N._32o}},O._97I=function(Y,z,F,y,l,C,O){var E=this,Z=E._indent,g=E._levelMap[z._id],q=E.getIconWidth(z),M=rd(E.getToggleIcon(z));M?(y+=Z*g,Zq(Y,M,y+Z/2,l+O/2,z,E),y+=Z):y+=Z*(g+1),E._checkMode&&(Zq(Y,E.getCheckIcon(z),y+Z/2,l+O/2,z,E),y+=Z),E.drawIcon(Y,z,y,l,q,O),E.drawLabel(Y,z,y+q,l,O)}},qs._14Q=function(I){I.getIcon=function(I){return I.getIcon()},I.getIconWidth=function(u){return this.getIcon(u)?this._indent:0},I.drawIcon=function(d,w,O,i,h,D){if(h){var G=this,e=G.getBodyColor(w),l=rd(G.getIcon(w),e);l&&(D-=G.isRowLineVisible()?1:0,Ti(d,l,ff,O,i,h,D,w,G,e),un(d,G.getBorderColor(w),O,i,h,D))}},I.drawLabel=function(S,L,g,j,o){var a=this;ji(S,a.getLabel(L),a.getLabelFont(L),a.getLabelColor(L),g,j,0,o)}},qs._50o=function(S){S._98I=function(){var a=this,r=a._39o=new mf;a._60I=new fo,r.mm(a._17o,a),r.md(a._18o,a),r.mh(a._19o,a)},S.setColumns=function(E){this._39o.clear(),this.addColumns(E)},S.addColumns=function(T){var U=this._39o;T.forEach(function(f){if(!(f instanceof ts)){var i=Nc(f.className);f=ue(i?i:ts,f)}U.add(f)})},S.onColumnClicked=function(){},S.onCheckColumnClicked=function(){},S._3Q=function(H){for(var F,K=0,M=this._60I,A=M.size();A>K;K++)if(F=M.get(K),F.column===H)return F;return R},S.getColumnAt=function(r){var Q=this._4Q(r);return Q?Q.column:R},S._4Q=function(g){for(var K=this,L=g.target?K.lp(g).x:g.x,u=K._60I,P=0;P<u.size();P++){var d=u.get(P),x=d.startX;if(L>=x&&L<x+d.column.getWidth())return d}return R},S.getToolTip=function(T){var h=this,n=h.getDataAt(T),S=h.getColumnAt(T);return n&&S?S.getToolTip(n,h):R},S.adjustTranslateX=function(x){var $=this.getWidth()-this._91I;return $>x&&(x=$),x>0?0:l(x)},S._99I=function(){var Y=this,J=Y._29I,h=Y._60I;h.clear(),Y._91I=0,Y._39o._roots.each(function(P){if(P.isVisible()){var p=Y._91I+P.getWidth();Y._91I<=J.x+J.width&&p>=J.x&&h.add({column:P,startX:Y._91I}),Y._91I=p}})},S.drawData=function(n,y,H){var u=this,v=u._rowHeight,S=v*H,P=u.isSelected(y),_=u._29I,O=_.x,A=_.width;u.drawRowBackground(n,y,P,O,S,A,v),u._60I.each(function(i){var q=i.column,z=i.startX,O=q.getWidth();O>0&&!u.isEditing(y,q)&&(n.save(),n.beginPath(),n.rect(z,S,O,v),n.clip(),u._87o(u.drawCell(n,y,P,q,z,S,O,v),H,z,S,O,v),u._columnLineVisible&&Ko(n,z+O-1,S,1,v,u._columnLineColor),n.restore())}),u._rowLineVisible&&Ko(n,O,S+v-1,A,1,u._rowLineColor)},S.drawCell=function(W,w,S,c,V,r,t,R){var U=this;if(c.drawCell)return c.drawCell(W,w,S,c,V,r,t,R,U);var f=U.getValue(w,c);qm(W,f,c,U.getLabelFont(w,c,f),U.getLabelColor(w,c,f),V,r,t,R,w,U)},S.getColumnModel=function(){return this._39o},S._17o=function(){this.redraw()},S._18o=function(A){var D=this;A.data===D._sortColumn&&Pe[A.property]?D.ivm():(D._42o(),D.redraw())},S._19o=function(){this.redraw()},S.getCurrentSortFunc=function(){var I=this,X=I._sortColumn;if(X&&X.isSortable()){var n=X.getSortFunc(),l=hq===X.getSortOrder()?1:-1;return n||(n=An),function(s,Y){return n.call(I,I.getValue(s,X),I.getValue(Y,X),s,Y)*l}}return I._sortFunc},S.isCellEditable=function(A,N){return N.isEditable()&&this.isEditable()},S._37O=function(w,c){if(fq(c))for(var L=this,B=L.lp(c),W=L._60I,P=L._rowHeight,_=L._29I,N=_.x,M=_.y,e=_.width,F=_.height,k=0;k<W.size();k++){var z=W.get(k),T=z.startX,H=z.column,I=H.getWidth();if(H!==L._31o&&H!==L._4o&&L.isCellEditable(w,H,c)&&B.x>=T&&B.x<T+I){var i={x:T,y:L.getRowIndex(w)*P,width:I,height:P},K={x:i.x+L.tx(),y:i.y+L.ty(),width:i.width,height:i.height},m=0,Z=0;return i.x<N?m=i.x-N:i.x+i.width>N+e&&(m=i.x+i.width-N-e),m&&(L.tx(L.tx()-m),K.x-=m),i.y<M?Z=i.y-M:i.y+P>M+F&&(Z=i.y+P-M-F),Z&&(L.ty(L.ty()-Z),K.y-=Z),L.beginEditing({data:w,column:H,value:L.getValue(w,H),event:c,rect:i,editorRect:K,view:L}),void 0}}}},Tc.BaseItemEditor=function(x,G,a,o){this._data=x,this._column=G,this._master=a,this._editInfo=o},Xr("BaseItemEditor",v,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ci=K.Tab=function(){Lk(ci,this)};Qr("Tab",Gr,{ms_ac:["view","closable","disabled"],_icon:R,_closable:!1,_disabled:!1,setParent:li});var ts=K.Column=function(){Lk(ts,this)};Qr("Column",Gr,{_46o:1,ms_ac:["accessType","valueType",Cn,ii,Lj,ld,"align",ho,"sortOrder",nd,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:hq,_sortFunc:R,_sortable:!0,_clickable:!0,setWidth:function(X){16>X&&(X=16);var f=this._width;this._width=X,this.fp(ld,f,X)},getToolTip:function(n,q){return this.formatValue(q.getValue(n,this))}});var Vh=K.Property=function(){Lk(Vh,this)};Qr("Property",Gr,{_46o:1,ms_ac:["accessType","valueType",ii,Lj,"categoryName",ho,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:R,getToolTip:function(V,Z,u){var A=this;return Z?A.formatValue(u.getValue(V,A)):u.getPropertyName(A)}}),Tc.AccordionView=function(){var m=this;m._20o={},m._21o=new fo,m._10o=R,m._9o=R,m._11o=R,m._view=Qm(0,m),m.iv()},Xr("AccordionView",v,{ms_v:1,ms_fire:1,ms_ac:[xq,Si,"titleHeight",ub,Qq,"titleBackground","selectWidth",im,"orientation","separatorColor"],_expandIcon:M.accordionViewExpandIcon,_collapseIcon:M.accordionViewCollapseIcon,_titleHeight:np,_labelColor:M.accordionViewLabelColor,_labelFont:M.accordionViewLabelFont,_titleBackground:M.accordionViewTitleBackground,_selectBackground:M.accordionViewSelectBackground,_selectWidth:M.accordionViewSelectWidth,_orientation:"v",_separatorColor:M.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(e,h,z,C){var E=this,r=so();if(E._20o[e])throw e+" already exists";r.onmousedown=Ch,r.style.cursor=$j,r.addEventListener(b?Af:pm,function(Z){Ch(Z)},!1),r.addEventListener(b?Qp:Wi,function(q){Ch(q),fq(q)&&(E._10o===e?E.collapse():E.expand(e))},!1),Gl(E._view,r),E._20o[e]={content:h,div:r,canvas:bg(r),icon:C},E._21o.add(e),z&&E.expand(e),E.iv()},remove:function(z){var l=this,u=l._20o[z];u&&(Mf(u.div),delete l._20o[z],l._21o.remove(z),l.iv())},clear:function(){var Z=this;Z._20o={},Z._21o.clear(),Z.iv()},isExpanded:function(A){return this._10o===A},expand:function(C){var X=this;X._20o[C]&&X._10o!==C&&(X._10o=C,X.onExpanded(C),X.iv())},onExpanded:function(){},collapse:function(){var L=this;L._10o&&(L.onCollapsed(L._10o),delete L._10o,L.iv())},onCollapsed:function(){},initCanvas:function(v,s,b){ds(v,s,b);var h=mm(v);return vg(h,0,0,1),h.clearRect(0,0,s,b),h},drawTitle:function(d,l,h,y,C){var u=this,V=rd(C.icon),J=u.isExpanded(l),w=u._titleHeight,D=u._titleBackground,W=u._selectWidth,H=u._separatorColor,Q=rd(J?u._expandIcon:u._collapseIcon),F=W+4;Ko(d,0,0,h,y,D),J&&W&&Ko(d,0,0,W,y,u._selectBackground),(J||u._21o.get(u._21o.size()-1)!==l)&&Ko(d,0,y-1,h,1,H?H:Kc(D)),V&&(Zq(d,V,F+ag(V)/2,w/2),F+=ag(V)+2),ji(d,l,u.getLabelFont(l),u.getLabelColor(l),F,0,0,w),Q&&Zq(d,Q,h-ag(Q)/2-4,w/2)},validateImpl:function(){var R=this,a=R._view,p=0,L=0,P=R.getWidth(),w=R.getHeight(),K=R._titleHeight,r=R._21o.size()*K,t=R._11o,m=R._9o;delete R._11o,delete R._9o,R._21o.each(function(f){var X,V,E=R._20o[f],m=E.content,k=R._10o===f;op(R)?(Se(E.div,p,0,K,w),X=R.initCanvas(E.canvas,K,w),Lf(X,0,w),Xg(X,-G),R.drawTitle(X,f,w,K,E),X.restore(),k?(V=I(0,P-r),m&&(R._11o=m,R._9o=El(m),Se(m,p+K,0,V,w)),p+=K+V):p+=K):(Se(E.div,0,L,P,K),X=R.initCanvas(E.canvas,P,K),R.drawTitle(X,f,P,K,E),X.restore(),k?(V=I(0,w-r),m&&(R._11o=m,R._9o=El(m),Se(m,0,L+K,P,V)),L+=K+V):L+=K)});var c=R._9o;t&&t!==R._11o&&t.endEditing&&t.endEditing(),c&&c!==m&&Gl(a,c),m&&m!==c&&Mf(m)}}),Tc.SplitView=function(q,_,t,e){var c=this,V=c._dividerDiv=so(),G=c._60O=bg(),j=c._61O=bg(),H=G.style,f=j.style;c._view=Qm(1,c),Gl(c._view,V),H.msTouchAction=Nn,H.pointerEvents=Nn,H.cursor=$j,f.msTouchAction=Nn,f.pointerEvents=Nn,f.cursor=$j,q&&c.setLeftView(q),_&&c.setRightView(_),t&&c.setOrientation(t),e!=R&&c.setPosition(e),c.setStatus(Ui),new $k(c)},Xr("SplitView",v,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:M.splitViewDividerSize,_dividerBackground:M.splitViewDividerBackground,_dragOpacity:M.splitViewDragOpacity,_toggleIcon:M.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(f,c){var j=this,V=j._position;isNaN(f)||(c||(j._82O=0>f?-1:f>1?1:0),j._position=f,j.fp(Zo,V,f))},getLeftView:function(){return this._leftView},setLeftView:function(E){var G=this,m=G._leftView,e=G._view;if(G._leftView!==E){if(m&&m!==G._rightView){var F=El(m);F.parentNode===e&&Mf(F)}if(G._leftView=E,E){var M=El(E);M.parentNode!==e&&e.insertBefore(M,G._dividerDiv)}G.fp("leftView",m,E)}},getRightView:function(){return this._rightView},setRightView:function(o){var A=this,S=A._rightView,Q=A._view;if(A._rightView!==o){if(S&&S!==A._leftView){var F=El(S);F.parentNode===Q&&Mf(F)}if(A._rightView=o,o){var u=El(o);u.parentNode!==Q&&Q.insertBefore(u,A._dividerDiv)}A.fp("rightView",S,o)}},validateImpl:function(){var H=this,Q=H._draggable,z=H._position,W=H.getWidth(),J=H.getHeight(),o=H._dividerSize,V=H._dividerBackground,c=b?18:8,r=H._dividerDiv,N=H._82O,h=H._60O,e=H._61O,B=H._toggleIcon,g=H._status,F=r.style,n=null,M=b?20:4,O=B.comps[0];o>=c||0===o?H._coverDiv&&(Mf(H._coverDiv),delete H._coverDiv):H._coverDiv||(H._coverDiv=so(),C&&(H._coverDiv.style.background=Ge),Gl(r,H._coverDiv)),H._togglable?h.parentNode||(Gl(r,h),Gl(r,e)):(Mf(h),Mf(e));var v=H._coverDiv,Y=H._leftView,L=H._rightView;if(op(H)){if(o>W&&(o=W),g===Ui)if(1===N)var K=j(z,W),x=I(0,W-o-K);else-1===N?(x=j(-z,W),K=I(0,W-o-x)):(K=l((W-o)*z),x=I(0,W-o-K));else"cl"===g?(K=0,x=I(0,W-o)):"cr"===g&&(x=0,K=I(0,W-o));Y&&Se(Y,0,0,K,J),L&&Se(L,K+o,0,x,J),Se(r,K,0,o,J),H._22o=K,v&&(Se(v,o/2-c/2,0,c,J),v.style.cursor=Q?Ld:""),r.style.cursor=Q?Ld:"";var m=r.clientHeight/2,i=r.clientWidth;ds(h,i,i),Se(h,0,m-i-M,i,i),n=mm(h),vg(n,0,0,1),O.rotation=-G,Mn(n,B,0,0,i,i),n.restore(),ds(e,i,i),Se(e,0,m+M,i,i),n=mm(e),vg(n,0,0,1),O.rotation=G,Mn(n,B,0,0,i,i),n.restore()}else{if(o>J&&(o=J),g===Ui)if(1===N)var d=j(z,J),p=I(0,J-o-d);else-1===N?(p=j(-z,J),d=I(0,J-o-p)):(d=l((J-o)*z),p=I(0,J-o-d));else"cl"===g?(d=0,p=I(0,J-o)):"cr"===g&&(p=0,d=I(0,J-o));Y&&Se(Y,0,0,W,d),L&&Se(L,0,d+o,W,p),Se(r,0,d,W,o),H._22o=d,v&&(Se(v,0,o/2-c/2,W,c),v.style.cursor=Q?Uq:""),F.cursor=Q?Uq:"";var f=r.clientWidth/2,i=r.clientHeight;ds(h,i,i),Se(h,f-i-M,0,i,i),n=mm(h),vg(n,0,0,1),O.rotation=0,Mn(n,B,0,0,i,i),n.restore(),ds(e,i,i),Se(e,f+M,0,i,i),n=mm(e),vg(n,0,0,1),O.rotation=u,Mn(n,B,0,0,i,i),n.restore()}F.background=V}});var $k=function(I){this.sv=I,this.addListeners()};jl($k,v,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(e){var K=this,L=K.sv,E=L._dividerDiv,X=L._60O,I=L._61O,q=L._status,J=e.target;if(J===X)q===Ui?L.setStatus("cl"):"cr"===q&&L.setStatus(Ui);else if(J===I)q===Ui?L.setStatus("cr"):"cl"===q&&L.setStatus(Ui);else if(wi(e)&&(J===E||J===L._coverDiv)&&(Ch(e),L.isDraggable())){L.getLeftView(),L.getRightView();var R=K.maskDiv=so();if(R.style.left=0,R.style.top=0,R.style.width=L.getWidth()+"px",R.style.height=L.getHeight()+"px",L.getView().appendChild(R),!L.isContinuousLayout()){var z=K.resizeDiv=so();z.style.left=E.style.left,z.style.top=E.style.top,z.style.width=E.style.width,z.style.height=E.style.height,z.style.opacity=L.getDragOpacity(),z.style.background=L.getDividerBackground(),Gl(K.getView(),z)}K._lastAbsPosition=L._22o,K._86o=op(L)?de(e).x:de(e).y,ws(K,e)}},handleWindowTouchMove:function(v){wi(v)&&this.update(v,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(h){var z=this;z.update(h,!0),z.sv.setStatus(Ui),z.maskDiv&&Mf(z.maskDiv),z.resizeDiv&&Mf(z.resizeDiv),z.maskDiv=z.resizeDiv=R},handle_mousedown:function(N){fq(N)&&this.handle_touchstart(N)},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},update:function(b,i){var F=this,O=F.sv,p=op(O)?O.getWidth():O.getHeight(),V=O._dividerSize,y=F._lastAbsPosition-F._86o;op(O)?(y+=de(b).x,y>p-V&&(y=p-V),0>y&&(y=0),F.resizeDiv&&(F.resizeDiv.style.left=y+Yo)):(y+=de(b).y,y>p-V&&(y=p-V),0>y&&(y=0),F.resizeDiv&&(F.resizeDiv.style.top=y+Yo)),i&&p!==V&&(1===O._82O?O.setPosition(y,1):-1===O._82O?O.setPosition(y-p+V,1):O.setPosition(y/(p-V),1))}}),Tc.TabView=function(){var T=this,W=T._view=Qm(1,T),M=T._91O=so(1),Q=T._tabModel=new mf,L=Q.sm(),l=T.invalidate;T._7o=new fo,T._canvas=bg(M),Gl(W,M),Gl(W,T._92O=so(1)),L.setSelectionMode(hf),L.ms(l,T),Q.mm(l,T),Q.md(l,T),Q.mh(l,T),new os(T),T.iv()},Xr("TabView",v,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",ub,Qq,"tabBackground","selectWidth",im,"moveBackground","insertColor"],_tabPosition:Id,_tabHeight:np,_tabGap:M.tabViewTabGap,_labelColor:M.tabViewLabelColor,_labelFont:M.tabViewLabelFont,_tabBackground:M.tabViewTabBackground,_selectWidth:M.tabViewSelectWidth,_selectBackground:M.tabViewSelectBackground,_moveBackground:M.tabViewMoveBackground,_insertColor:M.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(o,J,d){var Z=new ci,z=this._tabModel;return Z.setName(o),Z.setView(J),z.add(Z),d&&z.sm().ss(Z),Z},getLabel:function(b){return b.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(C){this._23o=C,this.iv()},get:function(t){var l=this,D=l._tabModel;if(kj(t))return D._roots.get(t);if(Bn(t)){var c;return D.each(function(r){t===l.getLabel(r)&&(c=r)}),c}return t instanceof ci?t:R},select:function($){this._tabModel.sm().ss(this.get($))},remove:function(F){var l=this;if(F=l.get(F)){var D=l._tabModel,h=D._roots.indexOf(F);l._tabModel.remove(F),l._12Q(--h)}},getCurrentTab:function(){return this._8o},hideTabView:function(u,v){v.parentNode===this._92O&&(Ue(v)?(v.style.display=_i,v._tab_=u):Mf(v),Bh())},showTabView:function(C,j){Ue(j)&&(j.style.display="block",j._tab_=C),j.parentNode!==this._92O&&(Gl(this._92O,j),Bh())},_24o:function(){var I,$=this,J=$._8o,q=$._9o,B=$._tabModel.sm().ld();B&&(I=El(B.getView())),I!==q&&(q&&(J.getView()&&J.getView().endEditing&&J.getView().endEditing(),$.hideTabView(J,q)),I&&$.showTabView(B,I)),$._8o=B,$._9o=I,J!==B&&$.onTabChanged(J,B)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(A,Y){this._12Q(--Y)},_12Q:function(l){var Z=this,e=Z._tabModel,x=e.size();if(x&&!e.sm().ld()){l==R&&(l=0),l>=x&&(l=x-1),0>l&&(l=0);for(var m=l;m>=0;m--){var J=Z.get(m);if(!J.isDisabled())return Z.select(J),J}for(m=l+1;x>m;m++)if(J=Z.get(m),!J.isDisabled())return Z.select(J),J}},_9Q:function(q){var x=4,j=rd(q.getIcon());j&&(x+=ag(j,q)+4);var Q=this.getLabel(q);return Q&&(x+=je(this.getLabelFont(q),Q).width+4),q.isClosable()&&(x+=10),x},drawTab:function($,p,i,T,H,D,h){var R,Z=this,Y=Z._tabPosition,c=i+4,d=Z._selectWidth,E=rd(p.getIcon()),k=p.isDisabled(),B=Z.getLabelColor(p),M=Z.getLabelFont(p),X=Z.getLabel(p),Q=Z._selectBackground,b=Y===Ai+"-vertical",s=Y===Br+"-vertical";(b||s)&&(c=T+4),k&&($.globalAlpha=nf),Ko($,i,T,H,D,h),p===Z._8o&&d&&(Y===Id?Ko($,i,T+D-d,H,d,Q):Y===Ai?Ko($,i+H-d,T,d,D,Q):Y===Br?Ko($,i,T,d,D,Q):b?Ko($,i+H-d,T,d,D,Q):s?Ko($,i,T,d,D,Q):Ko($,i,T,H,d,Q));var _=H/2;if(b&&(Lf($,_,T+D/2),Xg($,u),Lf($,-_,-T-D/2)),E){var W=Eh(E,p),J=ag(E,p);if(b||s){var y=i+H/2,v=c+W/2;Lf($,y,v),Xg($,G),Lf($,-y,-v),Zq($,E,i+H/2,c+W/2,p,Z),Lf($,y,v),Xg($,-G),Lf($,-y,-v),c+=W+4}else Zq($,E,c+J/2,T+D/2,p,Z),c+=J+4}return b||s?(Lf($,H/2,c+H/2),Xg($,G),Lf($,-H/2,-c-H/2),ji($,X,M,B,i,c,D,H),Lf($,H/2,c+H/2),Xg($,-G),Lf($,-H/2,-c-H/2)):ji($,X,M,B,c,T,H,D),b&&(Lf($,_,T+D/2),Xg($,-u),Lf($,-_,-T-D/2)),p.isClosable()&&(R=s?{x:i+H-12,y:T+D-12,width:12,height:12}:{x:i+H-12,y:T+2,width:12,height:12},this.drawCloseIcon(p,$,B,R)),k&&($.globalAlpha=1),R},drawCloseIcon:function(U,z,J,C){var n=C.x,N=C.y;z.strokeStyle=J,z.lineWidth=1,z.beginPath(),z.moveTo(n+2,N+8),z.lineTo(n+8,N+2),z.moveTo(n+8,N+8),z.lineTo(n+2,N+2),z.stroke()},validateImpl:function(){var c=this;c._24o();var S,w=c._canvas,x=c._tabPosition,d=c._91O,B=c._92O,N=c._tabModel,y=c.getWidth(),$=c.getHeight(),C=c._tabHeight,Z=c._7o,e=c._tabGap,H=x===Id,W=x===Ai,R=x===Br,T=x===Ai+"-vertical",l=x===Br+"-vertical",m=c._23o,g=0;if((W||R)&&N._roots.each(function(t){g=I(c._9Q(t),g)}),H?(Se(d,0,0,y,C),S={x:0,y:C,width:y,height:I(0,$-C)}):W?(Se(d,0,0,g,$),S={x:g,y:0,width:I(0,y-g),height:$}):R?(Se(d,y-g,0,g,$),S={x:0,y:0,width:I(0,y-g),height:$}):T?(Se(d,0,0,C,$),S={x:C,y:0,width:I(0,y-C),height:$}):l?(Se(d,y-C,0,C,$),S={x:0,y:0,width:I(0,y-C),height:$}):(Se(d,0,$-C,y,C),S={x:0,y:0,width:y,height:I(0,$-C)}),Se(B,S),T||l){c._9o&&(S.x=0,Se(c._8o.getView(),S)),ds(w,C,$);var k=mm(w),o=0;if(vg(k,0,c.ty(),1),k.clearRect(0,0,C,$),Z.clear(),N._roots.each(function(v){var R,$=c._9Q(v);m&&m.tab===v||(R=c.drawTab(k,v,0,o,C,$,c._tabBackground)),Z.add({_75o:R,tab:v,startY:o,endY:o+$,height:$}),o+=$+e}),c._23Q=I(0,o-e),m){var h=m.position;c.drawTab(k,m.tab,0,m.startY,C,m.height,c._moveBackground),Ko(k,0,h,C,1,c._insertColor)}k.restore(),c.ty(c.ty())}else if(W||R){c._9o&&(S.x=0,Se(c._8o.getView(),S)),ds(w,g,$);var k=mm(w),o=0;if(vg(k,0,c.ty(),1),k.clearRect(0,0,g,$),Z.clear(),N._roots.each(function(K){var X;m&&m.tab===K||(X=c.drawTab(k,K,0,o,g,C,c._tabBackground)),Z.add({_75o:X,tab:K,startY:o,endY:o+C,height:C}),o+=C+e}),c._23Q=I(0,o-e),m){var h=m.position;c.drawTab(k,m.tab,0,m.startY,g,m.height,c._moveBackground),Ko(k,0,h,g,1,c._insertColor)}k.restore(),c.ty(c.ty())}else{c._9o&&(S.y=0,Se(c._8o.getView(),S)),ds(w,y,C);var k=mm(w),E=0;if(vg(k,c.tx(),0,1),k.clearRect(0,0,y,C),Z.clear(),N._roots.each(function(S){var U,z=c._9Q(S);m&&m.tab===S||(U=c.drawTab(k,S,E,0,z,C,c._tabBackground)),Z.add({_75o:U,tab:S,startX:E,endX:E+z,width:z}),E+=z+e}),c._64I=I(0,E-e),m){var h=m.position;c.drawTab(k,m.tab,m.startX,0,m.width,C,c._moveBackground),qf(k,c._insertColor,h,0,C)}k.restore(),c.tx(c.tx())}for(var F=[],p=B.children,M=0;M<p.length;M++){var V=p[M],z=V._tab_;z&&!N.contains(z)&&F.push(V)}F.forEach(function(o){B.removeChild(o)})}});var os=function(t){this.tv=t,this.addListeners()};jl(os,v,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(t){this.handleScroll(t,10*(t.wheelDelta/40))},handle_DOMMouseScroll:function(b){this.handleScroll(b,10*-b.detail)},handleScroll:function(s,y){Ch(s);var B=this.tv,e=B._tabPosition;!B._40o()||e!==Id&&e!==Zf||B.tx(this.tv.tx()+y),!B._41o()||e!==Ai&&e!==Br&&e!==Ai+"-vertical"&&e!==Br+"-vertical"||B.ty(this.tv.ty()+y)},_8Q:function(k){var x,p,Q=this.tv,J=Q._tabPosition,M=Q._7o;if(J===Id||J===Zf){var i=Q.lp(k).x;for(x=0;x<M.size();x++)if(p=M.get(x),p.startX<=i&&i<=p.endX)return p}else if(J===Ai||J===Br||J===Ai+"-vertical"||J===Br+"-vertical"){var V=Q.lp(k).y;for(x=0;x<M.size();x++)if(p=M.get(x),p.startY<=V&&V<=p.endY)return p}return R},isClickable:function(K){var Y=this.tv,V=Y._tabPosition,s=this._73o=this._8Q(K);return!Y._40o()||V!==Id&&V!==Zf?!Y._41o()||V!==Ai&&V!==Br&&V!==Ai+"-vertical"&&V!==Br+"-vertical"?s&&(!s.tab.isDisabled()||Y.isMovable()):!0:!0},handle_mousemove:function(D){var Q=this;Ji?Q._74o=Q._8Q(D):Q.getView().style.cursor=Q.isClickable(D)?$j:""},handle_mousedown:function(o){this.handle_mousemove(o),this.handle_touchstart(o)},handle_touchstart:function(o){var R=this,B=R.tv,j=B._tabPosition;Ch(o),R.isClickable(o)&&(j===Id||j===Zf?(R.x=de(o).x,R.lp=B.lp(o),R.tx=B.tx()):(R.y=de(o).y,R.lp=B.lp(o),R.ty=B.ty()),ws(R,o))},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(D){var t,m=this,N=m.tv,n=N._tabPosition,f=m._73o;if(n===Id||n===Zf){if(t=de(D).x-m.x,!m._25o&&!m.moving&&Q(t)>2&&(N._40o()&&!sq(D)?m._25o=1:f&&N.isMovable()&&(m.moving=1)),m._25o)N.tx(m.tx+t);else if(m.moving){var U=m.lp.x+t,E=N._tabGap/2;N._7o.each(function(Z){var C=Z.endX,p=U-Z.startX<C-U;U>=Z.startX&&C>=U&&N._7Q({tab:f.tab,startX:f.startX+t,width:f.width,front:p,insertTab:Z.tab,position:p?I(0,Z.startX-E):j(N._64I,C+E)})})}}else if(t=de(D).y-m.y,!m._25o&&!m.moving&&Q(t)>2&&(N._41o()&&!sq(D)?m._25o=1:f&&N.isMovable()&&(m.moving=1)),m._25o)N.ty(m.ty+t);else if(m.moving){var Y=m.lp.y+t,E=N._tabGap/2;N._7o.each(function(A){var k=A.endY,m=Y-A.startY<k-Y;Y>=A.startY&&k>=Y&&N._7Q({tab:f.tab,startY:f.startY+t,height:f.height,front:m,insertTab:A.tab,position:m?I(0,A.startY-E):j(N._23Q,k+E)})})}},handleWindowMouseUp:function(N){this.handleWindowTouchEnd(N)},handleWindowTouchEnd:function(){var s=this,G=s.tv,e=G._tabPosition,V=G.getTabModel(),c=V._roots,w=s._73o;if(s.moving){var d=G._23o;if(d&&d.insertTab!==d.tab){var J=d.tab,q=c.remove(J),F=c.indexOf(d.insertTab);F>=0&&(d.front||F++,F<=c.size()&&(c.add(J,F),V._38I(J,q,F)))}G._7Q(R),delete s.moving}else if(!s._25o&&w){J=w.tab;var Z=s._74o;if(!Z||Z.tab===J)if(!J.isDisabled()&&Ul(w._75o,s.lp)){var U=function(){var l=c.indexOf(J);V.remove(J),G.onTabClosed(J,l)};G.onTabClosing(J,U)&&U()}else J.isDisabled()||G._8o===J||V.sm().ss(J)}s._25o=s._73o=s._74o=e===Id||e===Zf?s.x=s.lp=s.tx=R:s.y=s.lp=s.ty=R}}),Tc.PropertyView=function($){var p=this;p._view=Qm(1,p),p._canvas=bg(p._view),Gl(p._view,p._79O=so()),p._rows=new fo,p._28o=new fo,p._26o={},p._26Q={};var l=p._propertyModel=new mf,w=p.ivm;l.mm(w,p),l.md(w,p),l.mh(w,p),p.dm($?$:new mf),new zm(p)},Xr("PropertyView",v,{ms_ac:[ub,Bq,Qq,ii,Lj,"categorizable",Vd,nd,Vi,xq,Si,ak,gk,jc,"selectRowIndex",im,"background",Bl,_l,$d,uq,Ep],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:fc,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:um,_background:M.propertyViewBackground,_expandIcon:M.propertyViewExpandIcon,_collapseIcon:M.propertyViewCollapseIcon,_scrollBarColor:Qe,_scrollBarSize:Re,_autoHideScrollBar:Mp,_selectBackground:M.propertyViewSelectBackground,_rowHeight:bj,_rowLineVisible:M.propertyViewRowLineVisible,_rowLineColor:M.propertyViewRowLineColor,_10I:.5,_columnLineVisible:M.propertyViewColumnLineVisible,_columnLineColor:M.propertyViewColumnLineColor,_labelColor:M.propertyViewLabelColor,_labelSelectColor:M.propertyViewLabelSelectColor,_labelFont:M.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(a){0>a&&(a=0),a>1&&(a=1);var V=this,Q=V._10I;V._10I=a,V.fp("columnPosition",Q,a)},getPropertyName:function(q){return q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(j,O,D){return D===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(c,$){return $===this._selectRowIndex?this._labelSelectColor:c.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(e){var G=this.getHeight()-this._59I;return G>e&&(e=G),e>0?0:l(e)},isExpanded:function(N){if(!N)return!0;var K=this._26o[N];return K?K.isExpanded:!(this._26Q[N]===!1)},toggle:function(l){var M=this;M.isExpanded(l)?M.collapse(l):M.expand(l)},expandAll:function(){this.validate();for(var H in this._26o)this.expand(H)},expand:function(m){if(m&&m!==_i){var X=this,S=X._26o[m];S&&!S.isExpanded&&(S.isExpanded=!0,X.onExpanded(m),X.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var P in this._26o)this.collapse(P)},collapse:function(L){if(L&&L!==_i){var E=this,x=E._26o[L];x&&x.isExpanded&&(x.isExpanded=!1,E.onCollapsed(L),E.ivm())}},onCollapsed:function(){},getCategoryName:function(I){if(!this.isCategorizable())return _i;var k=I.getCategoryName();return k?k:_i},getPropertyModel:function(){return this._propertyModel},setDataModel:function(S){var k=this,y=k._dataModel;y!==S&&(y&&(y.umd(k.handlePropertyChange,k),k._selectionModel||y.sm().ums(k.ivm,k)),k._dataModel=S,S.md(k.handlePropertyChange,k),k._selectionModel?k._selectionModel._21I(S):S.sm().ms(k.ivm,k),k.fp(Kg,y,S))},isVisible:function(n){return this._visibleFunc?this._visibleFunc(n):!0},onPropertyChanged:function(J){var E=this,Y=J.property;ms[Y]?E.ivm():E.iv(),Y===_f&&E._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Ze},handlePropertyChange:function(b){this._27o===b.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var I=this;I._96I||(I.setSelectRowIndex(-1),I._96I=1,I.iv())},redraw:function(){this.iv()},validateModel:function(){var q=this,b=q._rows,R=q._28o,S={},L=new fo,l=q._27o;q.updateCurrentData(),l!==q._27o&&q.endEditing(),b.clear(),R.clear(),q.getRawProperties().each(function(O){if(q.isVisible(O)){L.add(O);var J=q.getCategoryName(O);S[J]||(R.add(J,J===_i?0:t),S[J]={isExpanded:q.isExpanded(J),properties:new fo})}}),q._sortFunc&&L.sort(q._sortFunc);for(var x in q._26o)q._26Q[x]=q.isExpanded(x);q._26o=S,R.each(function(Z){Z!==_i&&b.add(Z);var B=S[Z];B.isExpanded&&L.each(function(a){q.getCategoryName(a)===Z&&(B.properties.add(a),b.add({property:a,data:q._27o}))},q)})},validateImpl:function(){var H=this;H._76o(),H._96I&&(H.validateModel(),delete H._96I);var J=H._canvas,e=H.getWidth(),g=H.getHeight(),U=-H.ty(),E=H._rowHeight,I=H._indent,Q=e-I,z=H._rows,D=z.size(),b=H._9I=I+Q*H._10I,s=H._59I=D*E;ds(J,e,g),H._29I={x:0,y:U,width:e,height:g},H._31I=Y(U/E),H._14I=y((U+g)/E),H._31I<0&&(H._31I=0),H._14I>D&&(H._14I=D);var p,c=mm(J),f=H._background;vg(c,0,-U,1),c.beginPath(),c.rect(0,U,e,g),c.clip(),c.clearRect(0,U,e,g),H._93db(c),f&&Ko(c,0,0,I,s,f);for(var v=H._31I;v<H._14I;v++){var d=z.get(v),U=E*v;if(Bn(d))f&&Ko(c,I,U,Q,E,f),p=rd(H.isExpanded(d)?H._expandIcon:H._collapseIcon),p&&Ti(c,p,ff,0,U,I,E),c.save(),c.beginPath(),c.rect(I,U,Q,E),c.clip(),H.drawCategoryName(c,d,v,I,U,Q,E),c.restore();else{var j=d.property,$=d.data,p=rd(j.getIcon()),o=H._selectRowIndex===v?H.getSelectBackground():R;if(p&&Ti(c,p,ff,0,U,I,E),o&&Ko(c,I,U,Q,E,o),c.save(),c.beginPath(),c.rect(I,U,b-I,E),c.clip(),H.drawPropertyName(c,j,v,I,U,b-I,E),c.restore(),!H.isEditing($,j)){var k=b+1,t=e-b-1;c.save(),c.beginPath(),c.rect(k,U,t,E),c.clip(),H._87o(H.drawPropertyValue(c,j,H.getValue($,j),v,k,U,t,E,$),v,k,U,t,E),c.restore()
}}H._rowLineVisible&&Ko(c,I,U+E-1,Q,1,H._rowLineColor)}H._columnLineVisible&&(Ko(c,b,0,1,s,H._columnLineColor),Ko(c,e-1,0,1,s)),H._92db(c),H._93I(),c.restore(),H.ty(H.ty())},drawCategoryName:function(H,k,x,G,L,Z,B){ji(H,k,this.getCategoryFont(k),this.getCategoryColor(k),G,L,Z,B)},drawPropertyName:function(v,j,M,Q,Y,_,o){return j.drawPropertyName?(j.drawPropertyName(v,j,M,Q,Y,_,o,this),void 0):(ji(v,this.getPropertyName(j),this.getPropertyFont(j,M),this.getPropertyColor(j,M),Q,Y,_,o),void 0)},drawPropertyValue:function(V,g,Q,Z,d,b,r,A,a){return g.drawPropertyValue?g.drawPropertyValue(V,g,Q,Z,d,b,r,A,a,this):(qm(V,Q,g,this.getLabelFont(g,Q,Z),this.getLabelColor(g,Q,Z),d,b,r,A,a,this),void 0)},isPropertyEditable:function(G){return G.isEditable()&&this.isEditable()},setProperties:function(k){this._propertyModel.clear(),this.addProperties(k)},addProperties:function(F){if(F){var N=this._propertyModel;F.forEach(function(r){if(!(r instanceof Vh)){var h=Nc(r.className);r=ue(h?h:Vh,r)}N.add(r)})}},getRowIndexAt:function(F){var P=this,n=Y(P.lp(F).y/P._rowHeight);return n>=0&&n<P._rows.size()?n:-1},getPropertyAt:function(S){var s=this,K=s.getRowIndexAt(S);return K>=0?s._rows.get(K).property:R},getToolTip:function(o){var a=this,s=a.getPropertyAt(o),l=a._27o;return s&&l?s.getToolTip(l,a._9I<a.lp(o).x,a):R}});var zm=function(L){this.pv=L,this.addListeners()};jl(zm,v,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(t){this.getView().style.cursor=t},clear:function(){var c=this;c._62O=c.cp=c.ty=c.p=R,c.setCursor($)},handle_mousedown:function(n){this.handle_touchstart(n)},handle_touchstart:function(Z){var r=this,v=r.pv;Ch(Z),v.setFocus(Z)&&(fq(Z)?(r.cp=de(Z),r.ty=v.ty(),r.p=v.getColumnPosition(),r.handle_touchmove(Z)):v.setSelectRowIndex(v.getRowIndexAt(Z)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(H){this.handle_touchend(H)},handle_touchend:function(J){var E=this;if(E.cp&&!E._62O){var y=E.pv,g=y.lp(J),d=g.x,F=g.y,w=y._indent,X=y.getRowIndexAt(J),K=y._9I;if(X>=0){var Y=y._rowHeight,s=Y*X,i=y._rows.get(X),A=i.property;if(Bn(i))rd(y.isExpanded(i)?y._expandIcon:y._collapseIcon)&&d>=0&&w>=d&&F>=s&&s+Y>=F?y.toggle(i):vs(J)&&y.toggle(i);else if(d>K&&y.isPropertyEditable(A,J)){var l={x:K+1,y:s,width:y.getWidth()-K-1,height:Y},u={x:l.x+y.tx(),y:l.y+y.ty(),width:l.width,height:l.height},p=0,n=y._29I;l.y<n.y?p=l.y-n.y:l.y+Y>n.y+n.height&&(p=l.y+Y-n.y-n.height),p&&(y.ty(y.ty()-p),u.y-=p),y.beginEditing({data:i.data,property:A,value:y.getValue(i.data,A),event:J,rect:l,editorRect:u,view:y})}}y.setSelectRowIndex(X)}E.clear()},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(U){var j=this,g=j.pv,i=j.ty,t=j.cp,y=de(U),e=j._62O;if("p"===e)g.setTranslateY(i+y.y-t.y);else if("c"===e){var I=g.getWidth()-g._indent;if(I>16){var k=j.p-(t.x-y.x)/I,K=16/I;K>k&&(k=K),k>1-K&&(k=1-K),g.setColumnPosition(k)}}else"s"===e&&g.setTranslateY(i+(t.y-y.y)*g._59I/g._29I.height)},handle_mousemove:function(I){this.handle_touchmove(I)},handle_touchmove:function(e){if(!Ji&&fq(e)){var E=this,A=E.pv,K=Q(A.lp(e).x-A._9I)<=(b?8:3);E.cp?E._62O||(K?(E._62O="c",ws(E)):Q(de(e).y-E.cp.y)>=2&&(E._62O=E.isV(e)?"s":"p",ws(E))):(K?E.setCursor(Ld):E.setCursor($),E.isV(e)&&A._43o())}},isV:function(C){var V=this.pv,T=V._29I;return V._41o()&&T.x+T.width-V.lp(C).x<mq},handle_mousewheel:function(P){this.handleScroll(P,P.wheelDelta/40)},handle_DOMMouseScroll:function(j){2===j.axis&&this.handleScroll(j,-j.detail)},handleScroll:function(o,W){var u=this.pv;Ch(o),u.endEditing(),u.translate(0,W*u.getRowHeight())},handle_keydown:function(O){var F=this.pv,s=F._rows.size(),n=F._selectRowIndex+(Aq(O)?-1:1);(Aq(O)||ed(O))&&(0>n&&(n=0),n>=s&&(n=s-1),F.setSelectRowIndex(n))}}),Tc.ListView=function(P){this._5o(P),new Uf(this)},Xr("ListView",v,{ms_ac:[ub,Bq,Qq,Bl,Vd,_l,$d,nd,Vi,ak,gk,jc,Lr,im],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:um,_rowHeight:bj,_rowLineVisible:M.listViewRowLineVisible,_rowLineColor:M.listViewRowLineColor,_scrollBarColor:Qe,_scrollBarSize:Re,_autoMakeVisible:Bi,_autoHideScrollBar:Mp,_selectBackground:M.listViewSelectBackground,_labelColor:M.listViewLabelColor,_labelSelectColor:M.listViewLabelSelectColor,_labelFont:M.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(R){var x=this,K=x._checkMode;x._checkMode=R,x.fp(vm,K,R)},drawRow:function(m,t,M,R,K,C,g){var L=this,X=0,k=L._indent,e=L.getIconWidth(t);L.drawRowBackground(m,t,M,R,K,C,g),L._checkMode&&(Zq(m,L.getCheckIcon(t),X+k/2,K+g/2,t,L),X+=k),L.drawIcon(m,t,X,K,e,g),L.drawLabel(m,t,X+e,K,g)}});var Uf=function(M){this.list=M,this._lastSelectDataTime=se(),this.addListeners()};jl(Uf,v,{ms_listener:1,getView:function(){return this.list._view},clear:function(J){var T=this,j=T.list;J&&"d"===T._62O&&!T.dragCancel&&j.handleDragAndDrop(J,"end"),j.draggingData&&(j.draggingData=null,j.redraw()),T.dragCancel=T._62O=T._isV=T._isH=T.cp=T.tx=T.ty=R},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(L){var G=this,v=G.list;if(Ch(L),v.setFocus(L)){var z=v.getDataAt(L);G.cp=de(L),G.tx=v.tx(),G.ty=v.ty(),fq(L)?z&&v.handleDragAndDrop&&!G.isV(L)&&!G.isH(L)&&(v.draggingData=z,v.redraw(),v.handleDragAndDrop(L,"prepare")):(z&&G._33o(L,z),G.clear(L))}},handleWindowMouseUp:function($){this.clear($)},handleWindowTouchEnd:function(e){this.clear(e)},handle_mouseup:function(F){this.handle_touchend(F)},handle_touchend:function(P){var Q=this,J=Q.list;if(!Q._isV&&!Q._isH&&Q.cp&&!Q._62O){var L=J.getDataAt(P);L?(J.isCheckMode()?Q._34o(P,L):Q._33o(P,L),vs(P)?J.onDataDoubleClicked(L,P):J.onDataClicked(L,P)):J.handleBackgroundClick(P)}Q.clear(P)},handleWindowMouseMove:function(S){this.handleWindowTouchMove(S)},handleWindowTouchMove:function(w){var j=this,O=j.list,X=j._62O,c=j.tx,H=j.ty,R=j.cp,Q=de(w),f=O._29I;"p"===X?O.setTranslate(c+Q.x-R.x,H+Q.y-R.y):"v"===X?O.ty(H+(R.y-Q.y)*O._59I/f.height):"h"===X?O.tx(c+(R.x-Q.x)*O._91I/f.width):"d"===X&&(j.dragCancel||O.handleDragAndDrop(w,"between"))},handle_mousemove:function(t){this.handle_touchmove(t)},handle_touchmove:function(e){if(!Ji&&fq(e)){var T=this,y=T.list;if(T._isV=T.isV(e),T._isH=T.isH(e),T.cp){if(!T._62O){if(Tr(de(e),T.cp)<2)return;T._isV?T._62O="v":T._isH?T._62O="h":y.draggingData&&!this.dragCancel?(T._62O="d",y.handleDragAndDrop(e,"begin")):T._62O="p",T._62O&&"d"!==T._62O&&y.draggingData&&(y.draggingData=null,y.redraw()),ws(T)}}else T._isV&&y._43o(),T._isH&&y._42o()}},isV:function(N){var r=this.list,I=r._29I;return r._41o()&&I.x+I.width-r.lp(N).x<mq},isH:function(J){var _=this.list,L=_._29I;return _._40o()&&L.y+L.height-_.lp(J).y<mq},handle_mousewheel:function(i){this.handleScroll(i,i.wheelDelta/40,i.wheelDelta!==i.wheelDeltaX)},handle_DOMMouseScroll:function(V){this.handleScroll(V,-V.detail,1)},handleScroll:function(D,w,l){var M=this.list;Ch(D),M.endEditing&&M.endEditing(),l&&M._41o()?M.translate(0,w*M.getRowHeight()):M._40o()&&M.translate(10*w,0)},handle_keydown:function(d){if(!M.isInput(d.target)){var H,s=this.list,$=s.sm(),x=s._rows,i=x.size();if(Ye(d))s.selectAll();else if(lf(d))s.handleDelete&&s.handleDelete(d);else if(Op(d))"d"!==this._62O||this.dragCancel||(s.handleDragAndDrop(d,"cancel"),this.dragCancel=!0);else if(gl(d))s.isCheckMode()&&(H=s.getFocusData(),H&&s.checkData(H));else if(Aq(d)||ed(d)){var v=s.isCheckMode();if(H=v?s.getFocusData():$.ld()){var k=s.getRowIndex(H);k>=0&&(Aq(d)?0!==k&&(H=x.get(k-1),v?s.setFocusData(H):$.ss(H)):k!==i-1&&(H=x.get(k+1),v?s.setFocusData(H):$.ss(H)))}else i>0&&(H=x.get(0),v?s.setFocusData(H):$.ss(H))}}},_34o:function(u,A){var y=this.list,F=y.lp(u).x;return F>=0&&F<=y._indent?(y.checkData(A),void 0):(y.setFocusData(A),void 0)},_33o:function(n,C){var m=this.list,o=m.sm(),y=o.ld();if(sq(n))m.isSelected(C)?o.rs(C):o.as(C);else if(Ng(n))if(y)for(var g=m.getRowIndex(y),T=m.getRowIndex(C);g!==T;)g+=T>g?1:-1,o.as(m._rows.get(g));else o.ss(C);else if(fq(n)){var h=se();if(o.contains(C)){var x=h-this._lastSelectDataTime;m.handleDataDoubleSelect&&x>500&&1500>x&&m.handleDataDoubleSelect(n,C)}o.ss(C),this._lastSelectDataTime=h}else o.contains(C)||o.ss(C)}}),Tc.TreeView=function(l){var V=this;V._35o(),V._5o(l),new Gg(V)},Xr("TreeView",v,{ms_ac:[ub,Bq,Qq,"rootVisible",vm,"rootData",nd,Vi,ak,gk,jc,Vd,Bl,_l,$d,xq,Si,Lr,im,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:R,_indent:um,_rowHeight:bj,_rowLineVisible:M.treeViewRowLineVisible,_rowLineColor:M.treeViewRowLineColor,_scrollBarColor:Qe,_scrollBarSize:Re,_autoHideScrollBar:Mp,_expandIcon:M.treeViewExpandIcon,_collapseIcon:M.treeViewCollapseIcon,_autoMakeVisible:Bi,_selectBackground:M.treeViewSelectBackground,_labelColor:M.treeViewLabelColor,_labelSelectColor:M.treeViewLabelSelectColor,_labelFont:M.treeViewLabelFont,_doubleClickToToggle:M.treeViewDoubleClickToToggle,drawRow:function($,G,l,C,N,m,Y){var R=this;R.drawRowBackground($,G,l,C,N,m,Y),R._97I($,G,l,0,N,m,Y)},isOnToggleIcon:function(n){var h=this.getDataAt(n);if(h){var z=this.getIndent(),r=this.lp(n).x;if(rd(this.getToggleIcon(h))){var A=z*this.getLevel(h);if(r>=A&&A+z>=r)return!0}}return!1}});var Gg=function(B){Lk(Gg,this,[B])};jl(Gg,Uf,{toggle:function(J,B,v,r){var O=this.list,W=O.lp(J).x;if(rd(O.getToggleIcon(B))){var o=v*r;if(W>=o&&o+v>=W)return O.toggle(B),!0}return O.isDoubleClickToToggle()&&vs(J)?(O.toggle(B),!0):!1},_34o:function(s,V){var n=this.list,d=n.lp(s).x,a=n._levelMap[V._id],B=n._indent,Q=B*(a+1);return d>=Q&&Q+B>=d?(n.checkData(V),void 0):(this.toggle(s,V,B,a)||n.setFocusData(V),void 0)},_33o:function(Y,T){var _=this,F=_.list;_.toggle(Y,T,F._indent,F.getLevel(T))||Gg.superClass._33o.call(_,Y,T)},handle_keydown:function(A){if(fh(A)||Kd(A)){var h=this.list,F=h._rows,R=h.isCheckMode(),T=h.sm(),Z=R?h.getFocusData():T.ld();Z?Z.hasChildren()&&(fh(A)?h.collapse(Z):h.expand(Z)):F.size()>0&&(Z=F.get(0),R?h.setFocusData(Z):T.ss(Z))}else Gg.superClass.handle_keydown.call(this,A)}});var Xm=Tc.TableView=function(e){this._98I(),this._5o(e),new Dd(this)};Xr("TableView",v,{ms_ac:[ub,Bq,Qq,"sortMode",ii,Lj,Bl,_l,$d,uq,Ep,"sortColumn",nd,Vi,ak,gk,jc,Lr,im],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:On,_editable:!0,_batchEditable:!1,_rowHeight:bj,_rowLineVisible:M.tableViewRowLineVisible,_rowLineColor:M.tableViewRowLineColor,_columnLineVisible:M.tableViewColumnLineVisible,_columnLineColor:M.tableViewColumnLineColor,_scrollBarColor:Qe,_scrollBarSize:Re,_autoHideScrollBar:Mp,_autoMakeVisible:Bi,_selectBackground:M.tableViewSelectBackground,_labelColor:M.tableViewLabelColor,_labelSelectColor:M.tableViewLabelSelectColor,_labelFont:M.tableViewLabelFont,getCheckColumn:function(){var m=this;if(!m._31o){var E=m._31o=new ts;E.setEditable(!0),E.setWidth(40),E.getValue=m.getCheckColumValue,E.drawCell=m.drawCheckColumnCell}return m._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(D){var d=this,p=d._39o,$=d.getCheckColumn();D!==d.isCheckMode()&&(D?p.add($,0):p.remove($),d.fp(vm,!D,D))},getCheckColumValue:function($,G,b){return b.isSelected($)},drawCheckColumnCell:function(L,r,d,E,D,H,R,z,u){Zq(L,u.getCheckIcon(r),D+R/2,H+z/2,r,u)}});var Dd=function(d){Lk(Dd,this,[d])};jl(Dd,Uf,{_34o:function(X,H){var r=this.list,$=r._31o;if(r.isCellEditable(H,$,X)){var b=r._3Q($),c=r.lp(X).x;if(b&&c>=b.startX&&c<b.startX+$.getWidth())return r.checkData(H),void 0}r.setFocusData(H),r._37O(H,X)},_33o:function(r,K){Dd.superClass._33o.apply(this,arguments),this.list._37O(K,r)}});var qp=Tc.TreeTableView=function(L){var G=this,P=G._4o=new ts;G._35o(),G._98I(),G._5o(L),P.setDisplayName("Name"),P.setEditable(!0),P.setWidth(180),P.drawCell=Qk,P.getValue=Ek,G._39o.add(P),new Oh(G)},Qk=function(H,g,j,C,Y,M,F,P,K){K._97I(H,g,j,Y,M,F,P)},Ek=function(j,a,Z){return Z.getLabel(j)};Xr("TreeTableView",v,{ms_ac:[ub,Bq,Qq,"sortMode",ii,Lj,Vd,vm,"rootData","rootVisible",nd,Vi,"sortColumn",xq,Si,ak,gk,jc,Lr,$d,Bl,_l,uq,Ep,im,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:On,_checkMode:R,_editable:!0,_batchEditable:!1,_indent:um,_rowHeight:bj,_rowLineVisible:M.treeTableViewRowLineVisible,_rowLineColor:M.treeTableViewRowLineColor,_columnLineVisible:M.treeTableViewColumnLineVisible,_columnLineColor:M.treeTableViewColumnLineColor,_expandIcon:M.treeTableViewExpandIcon,_collapseIcon:M.treeTableViewCollapseIcon,_scrollBarColor:Qe,_scrollBarSize:Re,_autoHideScrollBar:Mp,_autoMakeVisible:Bi,_selectBackground:M.treeTableViewSelectBackground,_labelColor:M.treeTableViewLabelColor,_labelSelectColor:M.treeTableViewLabelSelectColor,_labelFont:M.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Oh=function(R){Lk(Oh,this,[R])};jl(Oh,Uf,{_34o:function(t,r){var b=this.list,N=b._4o,O=b._3Q(N),G=b.lp(t).x;if(O){var L=b._indent,H=O.startX+L*b.getLevel(r);if(rd(b.getToggleIcon(r))&&G>=H&&H+L>=G)return b.toggle(r),void 0;if(b.isCellEditable(r,N)&&(H+=L,G>=H&&H+L>=G))return b.checkData(r),void 0}b.setFocusData(r),b._37O(r,t)},_33o:function(o,e){var x=this.list,V=x.lp(o).x;if(rd(x.getToggleIcon(e))){var S=x._3Q(x._4o);if(S){var c=x._indent,I=S.startX+c*x.getLevel(e);if(V>=I&&I+c>=V)return x.toggle(e),void 0}}Oh.superClass._33o.apply(this,arguments),x._37O(e,o)}});var Hp=Tc.TableHeader=function(F){var y=this,f=y._view=Qm(1,y),g=y._39o=F.getColumnModel(),m=y.iv;y.tv=y._tableView=F,y._60I=new fo,y._canvas=bg(f),f.style.background=M.tableHeaderBackground||"",f.style.height=qb+Yo,g.mm(m,y),g.md(m,y),g.mh(m,y),F.mp(function(J){hr[J.property]&&y.iv()},y),new rn(y),y.iv()};Xr("TableHeader",v,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",ub,Qq,Vd,"moveBackground","insertColor",uq,Ep,"resizable","movable"],_checkIcon:yi,_movable:!0,_resizable:!0,_labelColor:M.tableHeaderLabelColor,_labelFont:M.tableHeaderLabelFont,_columnLineColor:M.tableHeaderColumnLineColor,_columnLineVisible:M.tableHeaderColumnLineVisible,_sortDescIcon:M.tableHeaderSortDescIcon,_sortAscIcon:M.tableHeaderSortAscIcon,_moveBackground:M.tableHeaderMoveBackground,_insertColor:M.tableHeaderInsertColor,_indent:um,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(Q){return Q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(e){return e.getColor()||this._labelColor},getLabelAlign:function(h){return h._align},onPropertyChanged:function(){this.iv()},_5Q:function(F){this._61I=F,this.iv()},getLogicalPoint:function(T){return Sk(T,this._canvas,this.tv.tx())},validateImpl:function(){var m=this,y=m._canvas,v=m.getWidth(),q=m.getHeight(),E=m.tv,M=m._60I,e=m._61I,K=-E.tx(),h=0;(v!==y.clientWidth||q!==y.clientHeight)&&ds(y,v,q),M.clear(),m._39o._roots.each(function(q){if(q.isVisible()){var N=h+q.getWidth();K+v>=h&&N>=K&&M.add({column:q,startX:h}),h=N}});var _=mm(y);if(vg(_,-K,0,1),_.beginPath(),_.rect(K,0,v,q),_.clip(),_.clearRect(K,0,v,q),M.each(function(T){var Z=T.column,S=T.startX,I=Z.getWidth();I>0&&(_.save(),_.beginPath(),_.rect(S,0,I,q),_.clip(),e&&e.column===Z||m.drawColumn(_,Z,S,0,I,q),m._columnLineVisible&&Ko(_,S+I-1,0,1,q,m._columnLineColor),_.restore())}),e){var u=e.column,h=e.startX,o=e.position,g=u.getWidth();_.save(),_.beginPath(),_.rect(h,0,g,q),_.clip(),_.fillStyle=m._moveBackground,_.fill(),m.drawColumn(_,u,h,0,g,q),_.restore(),qf(_,m._insertColor,o,0,q)}_.restore()},_6Q:function(m){var z=this.tv;return z._31o===m&&z.sm().getSelectionMode()===Wk},drawColumn:function(S,_,P,o,I,Q){var f=this,w=f.tv,j=rd(_.getIcon()),T=f.getLabelAlign(_);if(f._6Q(_)){var h=rd(f._checkIcon);Zq(S,h,P+I/2,o+Q/2,_,f)}else{var W=f.getLabel(_),s=f.getLabelFont(_),z=f.getLabelColor(_),x=je(s,W).width,d=j?f._indent:0;T===Ai?(j&&Ti(S,j,ff,P,o,d,Q),ji(S,W,s,z,P+d,o,I,Q,Ai)):T===Br?(j&&Ti(S,j,ff,P+I-x-d,o,d,Q),ji(S,W,s,z,P,o,I,Q,Br)):(j&&Ti(S,j,ff,P+(I-x-d)/2,o,d,Q),ji(S,W,s,z,P+(I-x+d)/2,o,0,Q,Ai))}if(_.isSortable()&&w.getSortColumn()===_&&(j=rd(_.getSortOrder()===hq?f._sortAscIcon:f._sortDescIcon))){var R=ag(j,_)/2+2;Zq(S,j,T===Br?P+R:P+I-R,o+Q/2,_,w)}}});var rn=function(g){var d=this;d.th=g,d.tv=g._tableView,d.addListeners()};jl(rn,v,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(d){this.getView().style.cursor=d},handle_mousemove:function(w){if(!Ji){var U=this;delete U._29o,U.setCursor($);for(var u=U.th,P=u._60I,v=u.lp(w).x,N=P.size()-1;N>=0;N--){var S=P.get(N),D=S.column,y=S.startX+D.getWidth();if(u.isResizable()&&Q(y-v)<=(b?10:3))return U._29o=S,U.setCursor(Ld),void 0;v>S.startX&&y>v&&(U._29o=S),(D.isClickable()||D.isSortable()||u.isMovable()||U.tv.getCheckColumn&&D===U.tv.getCheckColumn())&&v>S.startX&&y>v&&U.setCursor($j)}}},handle_mousedown:function(M){this.handle_touchstart(M)},handle_touchstart:function(o){var _=this;Ch(o),_.tv.endEditing(),_.handle_mousemove(o),_._29o&&(_.x=de(o).x,_.lx=_.th.lp(o).x,_.w=_._29o.column.getWidth(),ws(_,o))},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(C){var i=this,S=i.th,E=i.getView().style.cursor,Z=i._29o,L=de(C).x-i.x;if(i.resizing||i.moving||(E===Ld?i.resizing=1:S.isMovable()&&E===$j&&Q(L)>2&&(i.moving=1)),i.resizing)Z.column.setWidth(i.w+L);else if(i.moving){var k=i.lx+L;S._60I.each(function(p){var j=p.startX,H=j+p.column.getWidth();if(k>=j&&H>=k){var J={column:Z.column,startX:Z.startX+L,front:H-k>k-j,insertColumn:p.column};J.position=J.front?j:H,S._5Q(J)}})}},_16Q:function(e,I){var w=this,d=w.tv,S=w.th,U=S._checkIcon;if(S._6Q(e)){var L=rd(U),E=w.lx,Q=e.getWidth(),C=ag(L,e);if(E>=I+Q/2-C&&I+Q/2+C>=E){S.setCheckIcon(U===qc?yi:qc);var h=d.sm(),G=d._rows;return U===qc?h.rs(G):h.ss(G),d.onCheckColumnClicked(e),!0}}return!1},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(I){var a=this,Y=a.tv,K=a.th,p=a._29o;if(a.moving){var _=K._61I;if(_&&_.insertColumn!==_.column){var i=_.column,X=Y.getColumnModel()._roots,G=X.remove(i),M=X.indexOf(_.insertColumn);M>=0&&(_.front||M++,M<=X.size()&&(X.add(i,M),Y.getColumnModel()._38I(i,G,M)))}K._5Q(R),delete a.moving}else if(!a.resizing&&p){i=p.column;var e=K.lp(I).x,k=p.startX,S=!0;if(K.onColumnClicked){var D=K.onColumnClicked(i,I,k);D===!1&&(S=!1)}if(S&&e>=k&&e<=k+i.getWidth()&&!a._16Q(i,k)){if(i.isSortable()){var j=Y.getSortMode(),q=i.getSortOrder();j===On?Y.getSortColumn()===i?(q===ck&&Y.setSortColumn(R),i.setSortOrder(q===hq?ck:hq)):Y.setSortColumn(i):"bistate"===j&&(Y.getSortColumn()===i?i.setSortOrder(q===hq?ck:hq):Y.setSortColumn(i))}Y.onColumnClicked(i,I,k)}}a._29o=a.resizing=a.x=a.lx=a.w=R}}),Tc.TablePane=function(x){this.init(new Xm(x))},Xr("TablePane",v,{ms_v:1,_44o:1}),Tc.TreeTablePane=function(v){this.init(new qp(v))},Xr("TreeTablePane",v,{ms_v:1,_44o:1}),Tc.Toolbar=function(L){var u=this,$=u._view=Qm(1,u),I=$.style;I.background=M.toolbarBackground||"",I.height=np+Yo,u._canvas=bg($),u._30o=new fo,u._90I=new fo,u.setItems(L||[]),$.handleGroupSelectedChanged=function(L){if(L.isSelected()){var M=L.getGroupId();null!=M&&u._items.forEach(function(g){var O=g.element;O&&O!==L&&O.setSelected&&O.getGroupId&&O.getGroupId()===M&&O.setSelected(!1)})}},new Nk(u)},Xr("Toolbar",v,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Sh,ub,Qq,Bq,im,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:M.toolbarLabelColor,_labelSelectColor:M.toolbarLabelSelectColor,_labelFont:M.toolbarLabelFont,_selectBackground:M.toolbarSelectBackground,_itemGap:M.toolbarItemGap,_separatorColor:M.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(G){var o=this.getItemInfoAt(G);return o?o.item.toolTip:R},getLabelColor:function(w){return w&&w.selected&&w.type!==qc&&w.type!==zs?this._labelSelectColor:this._labelColor},onPropertyChanged:function(L){this.iv(),L.property===Sh&&this._items.forEach(function(b){Kl(b)})},redraw:function(){this.iv()},addItem:function(E,o){var T=this._items;o==R?T.push(E):T.splice(o,0,E),this.fp(Sh,R,T)},removeItem:function(t){if(t)for(var o=this._items,j=0;j<o.length;j++)t===o[j]&&(o.splice(j,1),this.fp(Sh,R,o))},removeItemById:function(K){if(K!=R)for(var w=this._items,F=0;F<w.length;F++)if(K===w[F].id){var y=w.splice(F,1)[0];return this.fp(Sh,R,w),y}},getItemById:function(N){if(N!=R)for(var Q=this._items,d=0;d<Q.length;d++){var s=Q[d];if(N===s.id)return s}},setItemVisible:function(U,S){var Q=this.getItemById(U);Q&&(Q.visible=S)},getItemInfos:function(){return this._30o},getItemInfoAt:function(Q){var Y=this,Z=0,l=Y._30o,x=Y.lp(Q),s=x.x,i=x.y;if(i>=0&&i<=Y.getHeight())for(;Z<l.size();Z++){var b=l.get(Z);if(b.startX<=s&&s<=b.endX)return b}return R},drawItem:function(H,b,N,W,P){if(b.visible===!1)return 0;if(Cb(b.visible)&&b.visible()===!1)return 0;var J=this,B=b.disabled;B&&(H.globalAlpha=nf);var o=J.drawItemImpl(H,b,N,W,P),g=J._itemGap;return B&&(H.globalAlpha=1),this._currentItem!==b||"separator"===b||b.separator===!0||b.unfocusable||un(H,J._separatorColor,N-g/2,0,o+g,W),o},drawItemImpl:function(K,x,T,m,r){var e=this,b=e._view,Q=e._itemGap,q=m/2,$=x.type,l=x.element,i=x.label;Bn(l)&&(i=l,l=R);var I,c=e.getLabelFont(x),j=e.getLabelColor(x),Y=x.selected,H=rd(x.icon),Z=ag(H,x),U=0,C=Z+(i?je(c,i).width:0);if("separator"===x||x.separator===!0)return qf(K,e._separatorColor,T,m/4,q),1;if(l){H&&Zq(K,H,T+Z/2,q,x,e),ji(K,i,c,j,T+Z,0,0,m);var L=El(l);r||e._90I.add(L),L.parentNode!==b&&Gl(b,L),l.iv&&l.iv(),l.validate&&l.validate();var p=L.getBoundingClientRect(),_=p.width,u=L.style;return vi(L),u.left=e.tx()+T+C+Yo,u.top=(m-p.height)/2+Yo,C+_}return $===zs?I=rd(Y?Xj:nc):$===qc&&(I=rd(Y?qc:yi)),I?(U=ag(I,x),Zq(K,I,T+U/2,q,x,e),T+=U,C+=U):Y&&Ko(K,T-Q/2,0,C+Q,m,e.getSelectBackground(x)),H&&Zq(K,H,T+Z/2,q,x,e),ji(K,i,c,j,T+Z,0,0,m),C},validateImpl:function(){var X=this,H=X._canvas,F=X.getWidth(),T=X.getHeight(),g=X._30o,S=X._items;ds(H,F,T);var D=mm(H),V=X._itemGap,J=V/2;vg(D,X.tx(),0,1),D.clearRect(0,0,F,T);var w=X._90I;X._90I=new fo,g.clear(),S.forEach(function(s){var d=X.drawItem(D,s,J,T);g.add({item:s,startX:J,endX:J+d,width:d}),d&&(J+=d+V)}),w.each(function(i){X._90I.contains(i)||Mf(i)});var p=X._64I;X._64I=I(0,J),D.restore(),X._stickToRight?(X._65O=0,D=mm(H),J=F-X._64I+V,vg(D,0,0,1),D.clearRect(0,0,F,T),g.clear(),S.forEach(function(Z){var e=X.drawItem(D,Z,J,T,!0);g.add({item:Z,startX:J,endX:J+e,width:e}),e&&(J+=e+V)}),D.restore()):X.tx(X.tx()),p!==X._64I&&X.onSumWidthChanged(p,X._64I)},onSumWidthChanged:function(){},handleClick:function(z,S){var c=this,V=z.type,w=z.action,U=z.groupId,x=z.selected;z.disabled||(U!=R?x||(z.selected=!0,this._items.forEach(function(Z){Z.groupId===U&&z!==Z&&(Z.selected=!1)}),w&&z.action(z,c,S)):V===qc||"toggle"===V?(z.selected=!x,w&&z.action(z,c,S)):w&&z.action(z,c,S)),Bh(),c.iv()}});var Nk=function(L){this.tb=L,this.addListeners()};jl(Nk,v,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(M){this.handleScroll(M,10*(M.wheelDelta/40))},handle_DOMMouseScroll:function(k){this.handleScroll(k,10*-k.detail)},handleScroll:function(N,d){Ch(N);var Z=this.tb;Z.isScrollable()&&!Z._stickToRight&&(Z.tx(Z.tx()+d),Jh())},handle_mousemove:function(C){var E=this;Ji||E.setItem(C)},handle_mouseout:function(G){var D=this;G.target===D.getView()?D.tb.setCurrentItem(R):D.handle_mousemove(G)},handle_mousedown:function(Y){this.handle_mousemove(Y),this.handle_touchstart(Y)},handle_touchstart:function(U){var h=this,y=h.tb,Y=U.target;fq(U)&&(Y===h.getView()||Y===y._canvas)&&(Ch(U),y.setFocus(U)&&(this.setItem(U,!0),(y.isScrollable()||h.info&&!h.info.item.disabled)&&(h.x=de(U).x,h.tx=y.tx(),ws(h,U))))},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(T){var C=this,F=C.tb;if(!F._stickToRight){var b=de(T).x-C.x;!C._25o&&Q(b)>2&&F.isScrollable()&&(C._25o=1),C._25o&&F.tx(C.tx+b)}},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(m){var _=this,k=_.tb,M=_.info,Y=_.tb.getItemInfoAt(m);if(!_._25o&&M){var O=M.item;Y&&Y.item===O&&k.handleClick(O,m)}_._25o=_.x=_.tx=R,_.setItem()},setItem:function(w,l){var H=this,B=H.tb,i=H.info=w?B.getItemInfoAt(w):R,o=i?i.item:R;B.setCurrentItem(o),l&&o&&Cb(o.onDown)&&o.onDown(w)}}),Tc.BorderPane=function(){this._view=Qm(1,this),this.iv()},Xr("BorderPane",v,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(j,m){this._12o("leftView",j),m!=R&&this.setLeftWidth(m)},getRightView:function(){return this._rightView},setRightView:function(q,T){this._12o("rightView",q),T!=R&&this.setRightWidth(T)},getTopView:function(){return this._topView},setTopView:function(T,p){this._12o("topView",T),p!=R&&this.setTopHeight(p)},getBottomView:function(){return this._bottomView},setBottomView:function(V,i){this._12o("bottomView",V),i!=R&&this.setBottomHeight(i)},getCenterView:function(){return this._centerView},setCenterView:function(E){this._12o("centerView",E)},_12o:function(I,L){var b=this,J="_"+I,Z=b._view,n=b[J];n!==L&&(n&&(n.getView?Mf(n.getView()):Mf(n)),b[J]=L,L&&(L.getView?Gl(Z,L.getView(),1):Gl(Z,L,1)),b.fp(I,n,L))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var V=this,x=V._topView,J=V._bottomView,G=V._leftView,S=V._rightView,T=V._centerView,N=V.getWidth(),O=V.getHeight(),C=0,m=0,E=N,q=O,y=0,Q=0,D=0,$=0;x&&(y=V._topHeight==R?fj(x):V._topHeight,m=y),J&&(Q=V._bottomHeight==R?fj(J):V._bottomHeight,q=O-Q),G&&(D=V._leftWidth==R?As(G):V._leftWidth,C=D),S&&($=V._rightWidth==R?As(S):V._rightWidth,E=N-$);var s=I(0,E-C),u=I(0,q-m);x&&Se(x,0,0,N,y),J&&Se(J,0,q,N,Q),G&&Se(G,0,m,D,u),S&&Se(S,E,m,$,u),T&&Se(T,C,m,s,u)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);