!function(D,P,s){"use strict";var y="px",R="0",l="innerHTML",I="className",C=ht.Default,V=ht.Color,U=ht.Node,X="position",n="top",N="left",_=C.animate,S=C.getInternal(),J="width",R="0",i="none",g="max-height",E="font",Y="background",x="border-box",w="user-select",d="box-sizing",j="overflow",B=C.isTouchable,S=C.getInternal(),a=V.titleIconBackground,A=C.scrollBarInteractiveSize,F=/msie 9/.test(D.navigator?D.navigator.userAgent.toLowerCase():""),u=null,p=function(){return document},H=function(N){return p().createElement(N)},k=function(){return H("div")},z=function(){var m=k(),M=m.style;return M.msTouchAction=i,M.cursor="default",B&&M.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",u),M.position="absolute",M.left=R,M.top=R,m},v=function(){return H("canvas")},h=function(){return document.body},O=function(e,t,x){e.style.setProperty(t,x,u)},T=function(r,d){r.style.removeProperty(d)},K=function(U,q,Y){C.def(ht.widget[U],q,Y)},G=function(U,K){U.appendChild(K)},Z=function(v,N){v.removeChild(N)},t=function(R,N,V,u){R.addEventListener(N,V,!!u)};S.addMethod(C,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:a,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:a}]},paletteTitleLabelColor:C.labelSelectColor,paletteTitleLabelFont:C.labelFont,paletteContentLabelFont:C.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:C.widgetTitleHeight,paletteTitleBackground:V.titleBackground,paletteTitleHoverBackground:V.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:s,paletteItemHoverBorderColor:V.highlight,paletteItemSelectBackground:V.highlight},!0);var e=".palette-item:hover{border: 1px solid "+C.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+C.paletteTitleHoverBackground+" !important}",o=document.createElement("style");B||(o.styleSheet?o.styleSheet.cssText=e:o.appendChild(p().createTextNode(e))),p().getElementsByTagName("head")[0].appendChild(o);var c=function(d){var s=this;s.$22h=d,s.addListeners()};C.def(c,P,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var Z=this;Z.$36h&&h().removeChild(Z.$36h),Z.$23h=Z.$24h=Z.$25h=Z.$35h=Z.$36h=u},handle_touchstart:function(q){for(var O,S=this,W=S.$22h,X=q.target,A=W.sm(),i=W.dm(),R="palette-header",M="palette-header-tool",x="palette-item",u=!1,a=!1,U=!1;X&&(X[I]||"").indexOf(R)<0&&(X[I]||"").indexOf(x)<0;)X=X.parentNode;if(X&&X[I].indexOf(M)>=0?u=!0:X&&X[I].indexOf(R)>=0?U=!0:X&&X[I].indexOf(x)>=0&&(a=!0),C.isLeftButton(q))if(S.$27h(q))S.$24h=C.getClientPoint(q),S.$25h=W.ty();else if(u){C.preventDefault(q),O=X.parentNode.$11h;var m=i.getDataById(O),l=m.s("tools")[X.toolIndex];l.action&&l.action.call(W)}else if(U){C.preventDefault(q),O=X.$11h;var m=i.getDataById(O);m.isExpanded()?m.setExpanded(!1):m.setExpanded(!0)}else if(a){O=X.$11h;var N=i.getDataById(O);A.ss(N),W.handleDragAndDrop&&(C.preventDefault(q),N.s("draggable")&&(W.handleDragAndDrop(q,"prepare"),S.$35h=0)),N.s("draggable")||(C.preventDefault(q),S.$24h=C.getClientPoint(q),S.$25h=W.ty())}else C.preventDefault(q),S.$24h=C.getClientPoint(q),S.$25h=W.ty();else S.$26h(q)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_mousewheel:function(v){this.handleScroll(v,v.wheelDelta/40,v.wheelDelta!==v.wheelDeltaX)},handle_DOMMouseScroll:function(L){this.handleScroll(L,-L.detail,1)},handleScroll:function(e,R,f){var D=this.$22h;C.preventDefault(e),f&&D._41o()&&D.ty(D.ty()+20*R)},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(G){var E=this;E.$37h(G),E.$26h(G)},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(x){var N=this;N.$37h(x),N.$26h(x)},$37h:function(g){var r=this,$=r.$22h;2===r.$35h&&(r.$35h=3,$.handleDragAndDrop(g,"end"))},handleWindowMouseMove:function(j){this.handleWindowTouchMove(j)},handleWindowTouchMove:function(j){var p=this,c=p.$22h,m=p.$23h,Z=p.$24h,U=p.$25h,f=C.getClientPoint(j),O=c._29I,e=p.$36h;if(1===p.$35h||2===p.$35h){if(p.$35h=2,c.handleDragAndDrop(j,"between"),B){var g=j.touches[0];j=g?g:j.changedTouches[0]}e.style.left=j.pageX-parseInt(e.width)/2+y,e.style.top=j.pageY-parseInt(e.height)/2+y}else"p"===m?c.ty(U+f.y-Z.y):"v"===m&&c.ty(U+(Z.y-f.y)/O.height*c._59I)},handle_mousemove:function(h){this.handle_touchmove(h)},handle_touchmove:function(i){if(!C.isDragging()&&C.isLeftButton(i)){var A=this,s=A.$22h,c=A.$27h(i);if(A.$24h){if(!A.$23h){if(C.getDistance(C.getClientPoint(i),A.$24h)<2)return;A.$23h=c?"v":"p",C.startDragging(A)}}else if(c)s._43o();else if(0===A.$35h){if(A.$35h=1,s.handleDragAndDrop(i,"begin"),B){var t=i.touches[0];i=t?t:i.changedTouches[0]}var S=A.$36h=new Image,E=s.$10h[s.sm().ld().getId()].querySelector(".image-box"),u=parseInt(E.style.width),d=parseInt(E.style.height);S.draggable=!1,S.src=E.toDataURL(),S.width=u,S.height=d,S.style.position="absolute",S.style.left=i.pageX-u/2+y,S.style.top=i.pageY-d/2+y,h().appendChild(S),C.startDragging(A)}}},$27h:function(t){var L=this.$22h,g=L.getView(),p=g.getBoundingClientRect(),Y=L._29I,u=t.clientX-p.left+g.scrollLeft;return L._41o()&&Y.x+Y.width-u<A}}),ht.widget.Palette=function(R){var Z=this,N=Z._view=S.createView(null,Z);Z.$9h={},Z.$10h={},Z.$4h={},Z._29I={x:0,y:0,width:0,height:0},Z._59I=0,Z.dm(R?R:new ht.DataModel),N[I]="ht-widget-palette",Z.$29h=new c(Z),O(N,Y,C.paletteContentBackground),O(N,j,"auto"),O(N,d,x),O(N,"-moz-"+d,x),O(N,"-webkit-"+w,i),O(N,"-moz-"+w,i),O(N,"-ms-"+w,i),O(N,w,i),O(N,"position","absolute"),O(N,"overflow","hidden"),G(N,Z._79O=z()),t(N,"dragstart",function(s){s.dataTransfer&&(s.dataTransfer.setData("Text","nodeid:"+s.target.$11h),s.dataTransfer.effectAllowed="all",Z.$29h.$26h())})},K("Palette",P,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:C.autoHideScrollBar,_scrollBarSize:C.scrollBarSize,_scrollBarColor:C.scrollBarColor,getViewRect:function(){return this._29I},ty:function(F){return F?(this.setTranslateY(F),void 0):this.getTranslateY()},setTranslateY:function(D){if(this.$32h==u){var f=this,_=f.$33h(D),b=f.$30h;f.$30h=_,f.fp("translateY",b,_)}},getTranslateY:function(){return this.$30h},setLayout:function(V){var t,d,n=this,j=n._layout;n._layout=V,"smallicons"===V?t=d=20:"iconsonly"===V?t=d=50:(t=70,d=50),n.setItemImageWidth(t),n.setItemImageHeight(d),n.setItemImagePadding(4),n.fp("layout",j,V)},getDataAt:function(j){for(var t=j.target;t&&t.$11h==u;)t=t.parentNode;return t&&t.$11h!=u?this.getDataModel().getDataById(t.$11h):void 0},$20h:function(){var z=16;return B&&(z*=1.2),z},$19h:function(){return C.paletteTitleHeight},$18h:function(){var d=C.paletteSeparatorWidth,v=C.paletteTitleBackground,r=C.paletteSeparatorColor||C.brighter(v);return d+y+" solid "+r},$17h:function(k){O(k,"cursor","pointer"),O(k,"display","inline-block"),O(k,"margin-right",(B?8:4)+y),O(k,"vertical-align",n)},$1h:function(K){var r=this,b=k(),W=k(),L=H("span");b[I]="palette-header",O(b,X,"relative"),O(b,Y,C.paletteTitleBackground),O(b,"color",C.paletteTitleLabelColor),O(b,n,R),O(b,d,x),O(b,"-moz-"+d,x),O(b,"padding","0 5px 0 0"),O(b,"border-top",r.$18h()),O(b,J,"100%"),O(b,"cursor","pointer"),O(b,"white-space","nowrap"),O(b,j,"hidden"),O(b,E,C.paletteTitleLabelFont),O(b,"line-height",r.$19h()+y),b.$11h=K.getId();var p=v(),z=r.$19h(),a=r.$20h();r.$17h(p),S.setCanvas(p,a,z),G(b,p);var Q=K.s("tools");if(Q)for(var g=0;g<Q.length;g++){var m=v();r.$17h(m),S.setCanvas(m,a,z),m[I]="palette-header-tool palette-header-tool"+K.getId()+"-"+g,m.style.position="absolute",m.style.right=(a+10)*g+"px",m.toolIndex=g,G(b,m)}return p[I]="palette-toggle-icon-"+K.getId(),W[I]="palette-content",O(W,"max-height",0+y),O(W,E,C.paletteContentLabelFont),O(W,j,"hidden"),W.$11h=K.getId(),r.$9h[K.getId()]=W,L[l]=K.getName(),O(L,E,C.paletteTitleLabelFont),G(b,p),G(b,L),[b,W]},$2h:function(t){var P=this,o=P._layout,p=F&&t.s("draggable")?H("a"):k(),B=v(),z=k(),e=t.getName()||"",Z=t.s("title")||t.getToolTip()||e,s=P._itemMargin;B[I]="image-box";var w=P.getItemImageWidth(),$=P.getItemImageHeight();return S.setCanvas(B,w,$),G(p,B),z[l]=e,z[I]="label-box","iconsonly"!==o&&G(p,z),p[I]="palette-item",O(p,"vertical-align",n),O(p,"cursor","pointer"),O(p,"border-radius",5+y),O(p,"border","1px solid transparent"),O(p,"text-align","center"),O(p,"display","inline-block"),O(p,"margin-left",s+y),O(p,"margin-top",s+y),O(p,"color",C.paletteContentLabelColor),"smallicons"===o?(O(B,"vertical-align","middle"),O(p,"margin-left",2+y),O(p,"margin-top",2+y),O(p,"padding",2+y),O(p,"text-align",N),O(z,"display","inline-block"),O(z,"min-width",P.$21h+P._itemMargin+y)):"largeicons"===o&&(O(z,"max-width",w+y),O(z,"overflow","hidden")),p.$11h=t.getId(),Z&&(p.title=Z),t.s("draggable")&&!P.handleDragAndDrop&&(F?(p.href="#",O(p,"text-decoration",i)):p.draggable="true"),p},$16h:function(R,q,b,M){var K=S.initContext(R);S.translateAndScale(K,0,0,1),K.clearRect(0,0,b,b);var x=(b-M)/2;C.drawStretchImage(K,C.getImage(q),"fill",0,x,M,M),K.restore()},$15h:function(M){var o=this,S=M.getId(),D=o._view.querySelector(".palette-toggle-icon-"+S),R=M.isExpanded()?C.paletteCollapseIcon:C.paletteExpandIcon;if(D&&R){var J=o.$19h(),f=o.$20h();o.$16h(D,R,J,f)}},_drawToolsIcon:function(I){var N=this,s=I.s("tools");if(s)for(var F=0;F<s.length;F++){var Q=N._view.querySelector(".palette-header-tool"+I.getId()+"-"+F),H=s[F].icon,O=N.$19h(),b=N.$20h();N.$16h(Q,H,O,b)}},$14h:function(L){var K=this,O=L.getId(),I=K.$10h[O].querySelector(".image-box"),k=L.getImage(),$=L.s("image.stretch");if(I&&k){var T=S.initContext(I),P=K.getItemImagePadding();P="smallicons"===K._layout?P/2:P;var h=K.getItemImageWidth()-2*P,v=K.getItemImageHeight()-2*P;S.translateAndScale(T,0,0,1),T.clearRect(0,0,h,v),C.drawStretchImage(T,C.getImage(k),$,P,P,h,v,L,K),T.restore()}},validateImpl:function(){var n,K,J,e=this,D=e.$9h,x=e._layout,A=e.$10h,O=e.$4h,B=e._view,c=e.dm();if(e.$13h&&(delete e.$13h,O={},c.each(function(R){O[R.getId()]=R})),"smallicons"===x)for(var r in O){var i=O[r];if(i instanceof U){var V=i.getName()||"",a=C.getTextSize(C.paletteContentLabelFont,V).width;e.$21h!=u&&e.$21h>a||(e.$21h=a)}}for(var r in O){J=O[r];var f,w;if(c.contains(J)){if(J instanceof ht.Group){var o,X=e.$1h(J),q=A[J.getId()];q&&(o=q.nextSibling,Z(B,o),Z(B,q)),K=c.getSiblings(J).indexOf(J);var v=B.children[2*K]||e._79O;v&&v.parentNode?(B.insertBefore(X[0],v),B.insertBefore(o||X[1],v)):(B.appendChild(X[0]),B.appendChild(o||X[1])),A[J.getId()]=X[0],n=D[J.getId()]=o||X[1],w=J.$12h;var I=J.s("promptText");w||(J.$12h=H("div"),J.$12h[l]=I||"",w=J.$12h),0===J.getChildren().size()?n.contains(w)||G(n,w):n.contains(w)&&Z(n,w)}else if(f=J.getParent()){var P=e.$2h(J),Q=A[J.getId()];n=D[f.getId()],Q&&Z(Q.parentNode,Q),K=c.getSiblings(J).indexOf(J);var t=n.children[K];t?n.insertBefore(P,t):G(n,P),A[J.getId()]=P,e.$14h(J)}}else{var S=A[J.getId()],E=S.parentNode;if(J instanceof ht.Group){var L=S.nextSibling;Z(B,S),Z(B,L),delete D[J.getId()]}else Z(E,S),0===E.children.length&&(f=c.getDataById(E.$11h),w=f.$12h,w&&!E.contains(w)&&G(E,w));delete A[J.getId()]}}e.$4h={};var m=function(){var r=e._59I,j=0;e.$32h!=u&&(clearInterval(e.$32h),j=0,delete e.$32h),e.$32h=setInterval(function(){e.$31h(),r===e._59I?(j++,j>=2&&(clearInterval(e.$32h),delete e.$32h)):(j=0,r=e._59I)},30)};for(var h in D)if(n=D[h],J=c.getDataById(D[h].$11h),e.$15h(J),e._drawToolsIcon(J),J.isExpanded()){if(n.style.maxHeight===0+y){var Y=n.scrollHeight+e._itemMargin+y;_(n).duration(200).set(g,Y).set("padding-bottom",e._itemMargin+y).end(function(){return function(){m()}}(Y))}else n.style.maxHeight=n.scrollHeight+y;n.style.paddingBottom=e._itemMargin+y}else n.style.maxHeight!==0+y&&_(n).duration(200).set(g,R).set("padding-bottom",R).end(function(){return function(){m()}}(n));e.$28h(),e.$31h()},$31h:function(){for(var X=this,Z=X._view,d=0,G=Z.children,B=0;B<G.length;B++){var u=G[B];u.className&&u.className.indexOf("palette-")>=0&&(d+=u.offsetHeight)}X._59I=d,X.$30h=X.$33h(X.ty());var U=X.ty();Z.scrollTop=-U,X._29I={x:0,y:-U,width:Z.clientWidth,height:Z.clientHeight},O(X._79O,n,-U+y),X._93I()},$33h:function(e){var t=this,O=t._29I.height-t._59I;return O>e&&(e=O),e>0?0:Math.round(e)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(f){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(f.property)<0&&this.redraw(),"translateY"===f.property&&(this.iv(),this._43o())},findDataByName:function(W){for(var I=this.dm().getDatas(),M=0;M<I.size();M++){var T=I.get(M);if(T.getName()===W)return T}},setDataModel:function(e){var C=this,u=C._dataModel,U=C._selectionModel;u!==e&&(u&&(u.umm(C.$6h,C),u.umd(C.$8h,C),u.umh(C.$7h,C),U||u.sm().ums(C.$28h,C)),C._dataModel=e,e.mm(C.$6h,C),e.md(C.$8h,C),e.mh(C.$7h,C),U?U._21I(e):e.sm().ms(C.$28h,C),C.sm().setSelectionMode("single"),C.fp("dataModel",u,e))},$6h:function(a){var M=this,z=M._view,b=a.data,N=M.$4h;"add"===a.kind?N[b.getId()]=b:"remove"===a.kind?N[b.getId()]=b:"clear"===a.kind&&(M.$10h={},M.$9h={},M.$4h={},z[l]=""),M.iv()},$7h:function(Z){var o=this,a=Z.data;o.$4h[a.getId()]=a,o.iv()},$8h:function(T){var U=this,i=T.data,G=T.property;"expanded"===G?U.iv():(U.$4h[i.getId()]=i,U.iv())},$28h:function(){var V,$=this,b=$.sm(),r="palette-item",Z=b.ld();this.dm().each(function(w){V=$.$10h[w.getId()],V&&V[I].indexOf(r)>=0&&(w===Z?O(V,Y,C.paletteItemSelectBackground):T(V,Y))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);