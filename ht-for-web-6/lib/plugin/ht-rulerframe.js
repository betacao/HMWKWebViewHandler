!function(l,N){"use strict";var s="position",$="absolute",h="relative",S="px",f="left",Y="right",m="top",A="bottom",F="display",j="none",Z="block",b=ht.Default,H=b.getInternal(),I=Math.floor,i=Math.ceil,w=Math.PI,q=null,O=l.parseInt,u=function(K){return K.getContext("2d")},t=function(){return document},E=function(v){return t().createElement(v)},x=function(){return E("canvas")},B=function(R,m,h){R.style.setProperty(m,h,q)},C=function(M,p,n){b.def(ht.widget[M],p,n)},e=function(x,J){x.appendChild(J)},W=function(y,b){y.removeChild(b)},g=function(T,e,w,Z){T.addEventListener(e,w,!!Z)},R=function(j,u,X,Y){j.removeEventListener(u,X,!!Y)};ht.widget.RulerFrame=function(j){var z=this,G=z._view=H.createView(null,z),a=z.$1k=x(),r=z.$2k=x(),k=z.$3k=x(),N=z.$4k=x();z._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},z._topRulerConfig={visible:!0},z._rightRulerConfig={visible:!1},z._bottomRulerConfig={visible:!1},z._leftRulerConfig={visible:!0},e(G,a),e(G,k),e(G,r),e(G,N),B(G,s,h),B(G,"box-sizing","border-box"),B(G,"-moz-box-sizing","border-box"),B(a,s,$),B(r,s,$),B(k,s,$),B(N,s,$),z.$14k=function(){z.$13k=1,z.iv()},z.$15k=function(k){if(z._topRulerConfig.guideVisible||z._rightRulerConfig.guideVisible||z._bottomRulerConfig.guideVisible||z._leftRulerConfig.guideVisible||z._defaultRulerConfig.guideVisible||(z._topRulerConfig.guideTipVisible||z._rightRulerConfig.guideTipVisible||z._bottomRulerConfig.guideTipVisible||z._leftRulerConfig.guideTipVisible||z._defaultRulerConfig.guideTipVisible)&&z._component){var F=G.getBoundingClientRect();z.$16k={x:k.clientX-F.left,y:k.clientY-F.top},z.$5k()}},z.setComponent(j)},C("RulerFrame",N,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(f){var P=this,n=P._component,b=P.getView();if(b){if(P._component=f,P.fp("component",n,f),n){var V=P.getComponentView(n);W(b,V),R(b,"mousemove",P.$15k),P.removeComponentPropertyChangeListener(n,P.$14k)}if(f){var j=P.getComponentView(f);e(b,j),B(j,s,$),g(b,"mousemove",P.$15k),P.addComponentPropertyChangeListener(f,P.$14k)}}},addComponentPropertyChangeListener:function(h,H){h&&h.mp&&h.mp(H)},removeComponentPropertyChangeListener:function(W,m){W&&W.ump&&W.ump(m)},getComponentHZoom:function(i){return i&&i.getZoom?i.getZoom():1},getComponentVZoom:function(E){return E&&E.getZoom?E.getZoom():1},getComponentViewRect:function(A){return A&&A.getViewRect?A.getViewRect():void 0},getComponentView:function(M){return M&&M.getView?M.getView():M},invalidateComponent:function(D){D&&D.iv&&D.iv()},validateComponent:function(t){t&&t.validate&&t.validate()},$7k:function(M,b,c,S,K,L,X,l,e,i,n,N){if(b.visible){var r=this._defaultRulerConfig,R="borderStyle",Y="borderColor",d="borderWidth",C="background",x=b[R]||r[R],_=b[Y]||r[Y],W=b[d]||r[d],h=b.size!=q?b.size:r.size,U=b[C]||r[C],I=h+W,y=this.$6k(W,x,_,M,c,K,I,X,l,e,i,n,N);B(M,K,"0px"),L?H.setCanvas(M,S-y,h):H.setCanvas(M,h,S-y),B(M,"background",U),B(M,F,Z)}else B(M,F,j),B(this.getComponentView(this._component),K,"0px")},$6k:function(x,Y,v,H,f,r,i,U,l,$,b,D,c){var e=0;return B(H,f,x+"px "+Y+" "+v),B(this.getComponentView(this._component),r,i+S),U?(B(H,l,$+S),e+=$):B(H,l,"0px"),b?(B(H,D,c+S),e+=c):B(H,D,"0px"),e},validateImpl:function(){var D=this,V=D._component,N=D.$1k,j=D.$2k,e=D.$3k,H=D.$4k,o=D._view,T=D._defaultRulerConfig,r=D._topRulerConfig,y=D._rightRulerConfig,U=D._bottomRulerConfig,_=D._leftRulerConfig,d=T.size;if(o&&V){var w=r.size!=q?r.size:d,L=y.size!=q?y.size:d,u=U.size!=q?U.size:d,h=_.size!=q?_.size:d;D.$7k(N,r,"border-bottom",o.offsetWidth,m,!0,_.visible,f,h,y.visible,Y,L),D.$7k(j,y,"border-left",o.offsetHeight,Y,!1,r.visible,m,w,U.visible,A,u),D.$7k(e,U,"border-top",o.offsetWidth,A,!0,_.visible,f,h,y.visible,Y,L),D.$7k(H,_,"border-right",o.offsetHeight,f,!1,r.visible,m,w,U.visible,A,u),D.$13k?delete D.$13k:D.invalidateComponent(V),D.validateComponent(V),D.$5k()}},$5k:function(){function n(f,k,L,A,i,Q){if(k.visible){var $=u(f),b=k[S]||D,Y=k[Z]!=q?k[Z]:r,v=k[g]||V,n=k[o]||G,P=k.size!=q?k.size:R,Kf=k[C]||_,tg=k[w]||O,gf=k[h]||I,Md=k[T]!=q?k[T]:j,Xk=k[M]!=q?k[M]:l,jb=k[X]!=q?k[X]:F,tc=k[a]!=q?k[a]:z,si=k[x]!=q?k[x]:y,Fh=k[B]!=q?k[B]:J,lh=k[E]||im,rf=k[c]||aj;Y&&(b=d[Q]=d.$8k(d[Q]||b,k[m]||N,k[U]||t,A?s:p,tg)),L.call(d,$,e,K,W,H,P,A?s:p,b,v,n,i,Kf,gf);var On=d.$16k;(Md||Xk)&&On&&(A?d.$9k($,On.x,P,lh,rf,Md,Xk,jb,tc,si,Fh):d.$10k($,On.y,P,lh,rf,Md,Xk,jb,tc,si,Fh,i))}}var d=this,P=d.$1k,f=d.$2k,v=d.$3k,L=d.$4k,k=d._topRulerConfig,i=d._rightRulerConfig,b=d._bottomRulerConfig,Y=d._leftRulerConfig,$=d._defaultRulerConfig,Q=d._component,A=d.getComponentViewRect(Q),s=d.getComponentHZoom(Q),p=d.getComponentVZoom(Q),e=A.x*s,W=e+A.width*s,K=A.y*p,H=K+A.height*p,R=d._defaultRulerConfig.size,S="defaultMajorTickSpacing",m="maxPhysicalMajorTickSpacing",U="minPhysicalMajorTickSpacing",Z="tickSpacingAdaptable",g="majorTickTextFont",o="majorTickTextColor",C="majorTickColor",h="minorTickColor",T="guideVisible",M="guideTipVisible",X="guideTipBorderColor",a="guideTipTextColor",x="guideTipTextFont",B="guideTipBackground",E="guideColor",c="guideWidth",w="minMajorTickSpacing",D=$[S],N=$[m],t=$[U],r=$[Z],V=$[g],G=$[o],_=$[C],O=$[w],I=$[h],j=$[T],l=$[M],F=$[X],z=$[a],y=$[x],J=$[B],im=$[E],aj=$[c];d._view&&Q&&(n(P,k,d.$11k,!0,!1,"_currentTopMajorTickSpacing"),n(f,i,d.$12k,!1,!0,"_currentRightMajorTickSpacing"),n(v,b,d.$11k,!0,!0,"_currentBottomMajorTickSpacing"),n(L,Y,d.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(M,L,d,p,O){return d>M*p?M=I(L/p/O)*O:M*p>L&&(M=i(d/p/O)*O),M},getHTipText:function(x){var q=this,C=q._component,r=0,p=q._view.getBoundingClientRect();return C.lp?r=O(C.lp({clientX:x.x+p.left,clientY:x.y}).x):r-=O(this.getComponentView(C).style.left)||0,r},$9k:function(T,h,s,K,M,m,C,B,D,Z,_){var e=this,f=e._component;T.save(),H.translateAndScale(T,0,0,1);var o=h-(O(this.getComponentView(f).style.left)||0),v=0;if(h=e.getHTipText(e.$16k),m&&(T.beginPath(),T.fillStyle=K,T.rect(o,v,M,s),T.fill()),C){T.beginPath(),T.textAlign="center",T.textBaseline="middle",T.font=Z;var b=T.measureText(h).width+6;T.fillStyle=_,T.rect(o-b/2,v,b,s),T.fill(),T.strokeStyle=B,T.stroke(),T.beginPath(),T.fillStyle=D,T.fillText(h,o,v+s/2)}T.restore()},getVTipText:function(o){var n=this,v=n._component,c=0,i=n._view.getBoundingClientRect();return v.lp?c=O(v.lp({clientX:o.x,clientY:o.y+i.top}).y):c-=O(this.getComponentView(v).style.top)||0,c},formatScaleText:function(q){return Math.round(q)},$10k:function(o,V,I,q,u,v,f,d,T,g,e,Y){var m=this,J=m._component;o.save(),H.translateAndScale(o,0,0,1);var Q=I/2,X=V-(O(this.getComponentView(J).style.top)||0);if(V=m.getVTipText(m.$16k),v&&(o.beginPath(),o.fillStyle=q,o.rect(Q-I/2,X,I,u),o.fill()),f){o.translate(Q,X),o.rotate((Y?90:-90)*w/180),o.translate(-Q,-X),o.beginPath(),o.textAlign="center",o.textBaseline="middle",o.font=g;var B=o.measureText(V).width+6;o.fillStyle=e,o.rect(Q-B/2,X-I/2,B,I),o.fill(),o.strokeStyle=d,o.stroke(),o.fillStyle=T,o.fillText(V,Q,X)}o.restore()},$11k:function(r,V,E,k,F,f,C,G,p,M,n,b,o){r.save(),E=0;var d=V,L=k,B=(d+L)/2;V=0,k=L-d,H.translateAndScale(r,0,0,1);var Q=0,t=0,v=O(f/2),X=f-v,g=n?0:v,N=G*C,c=N/10;V-=N,k+=N,r.clearRect(V,0,k-V,f),r.beginPath(),r.fillStyle=o;var K=I(B/c)*c-d;for(Q=K;k>Q;Q+=c)r.rect(Q,E+g,1,X);for(Q=K;Q>V;Q-=c)r.rect(Q,E+g,1,X);for(r.fill(),g=n?0:1,r.beginPath(),r.fillStyle=b,K=I(B/N)*N-d,Q=K;k>Q;Q+=N)r.rect(Q,E+g,1,f-1);for(Q=K;Q>V;Q-=N)r.rect(Q,E+g,1,f-1);r.fill();var W=O(/\d+px/.exec(p)[0]),P=(W||10)/2;r.textBaseline="middle",g=n?f-P-2:P+2,r.beginPath(),r.fillStyle=M,r.font=p;var e=I(B/N)*N/C;for(Q=K,t=e;k>Q;Q+=N,t+=G){var i=this.getHScaleText?this.getHScaleText(Q):t;r.fillText(this.formatScaleText(i),Q+2,E+g)}for(Q=K,t=e;Q>V;Q-=N,t-=G){var i=this.getHScaleText?this.getHScaleText(Q):t;r.fillText(this.formatScaleText(i),Q+2,E+g)}r.restore()},$12k:function(a,o,u,p,_,B,$,l,T,Q,A,G,d){function K(z,x,J,y,l,G){l=D.getVScaleText?D.getVScaleText(J):l,l=D.formatScaleText(l),a.translate(z+x,J),a.rotate(-y),a.translate(-z-x,-J),a.fillText(l,z+x+(G?2:1),J),a.translate(z+x,J),a.rotate(y),a.translate(-z-x,-J)}a.save(),o=0;var q=u,v=_,W=(q+v)/2;u=0,_=v-q,H.translateAndScale(a,0,0,1);var X=0,D=this,R=0,s=O(B/2),E=B-s,F=A?0:s,j=l*$,S=j/10;u-=j,_+=j,a.clearRect(o,0,B,_-u),a.beginPath(),a.fillStyle=d;var f=I(W/S)*S-q;for(X=f;_>X;X+=S)a.rect(o+F,X,E,1);for(X=f;X>u;X-=S)a.rect(o+F,X,E,1);for(a.fill(),F=A?0:1,a.beginPath(),a.fillStyle=G,f=I(W/j)*j-q,X=f;_>X;X+=j)a.rect(o+F,X,B-1,1);for(X=f;X>u;X-=j)a.rect(o+F,X,B-1,1);a.fill();var C=O(/\d+px/.exec(T)[0]),m=(C||10)/2,U=90*w/180;a.textBaseline="middle",F=A?B-m:m+2,U=A?-U:U,a.beginPath(),a.fillStyle=Q,a.font=T;var Y=I(W/j)*j/$;for(X=f,R=Y;_>X;X+=j,R+=l)K(o,F,X,U,R,A);for(X=f,R=Y;X>u;X-=j,R-=l)K(o,F,X,U,R,A);a.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var T=this,n=T._component,J=T._view;n&&T.removeComponentPropertyChangeListener(n,T.$14k),J&&(R(J,"mousemove",T.$15k),W(J.parentNode,J),T._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);